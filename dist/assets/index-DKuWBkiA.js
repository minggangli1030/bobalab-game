(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();var Og={exports:{}},Pl={},Fg={exports:{}},he={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Mo=Symbol.for("react.element"),Xv=Symbol.for("react.portal"),Jv=Symbol.for("react.fragment"),Zv=Symbol.for("react.strict_mode"),e_=Symbol.for("react.profiler"),t_=Symbol.for("react.provider"),n_=Symbol.for("react.context"),r_=Symbol.for("react.forward_ref"),s_=Symbol.for("react.suspense"),i_=Symbol.for("react.memo"),o_=Symbol.for("react.lazy"),Rf=Symbol.iterator;function a_(t){return t===null||typeof t!="object"?null:(t=Rf&&t[Rf]||t["@@iterator"],typeof t=="function"?t:null)}var zg={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Bg=Object.assign,Ug={};function ii(t,e,n){this.props=t,this.context=e,this.refs=Ug,this.updater=n||zg}ii.prototype.isReactComponent={};ii.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};ii.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function $g(){}$g.prototype=ii.prototype;function yd(t,e,n){this.props=t,this.context=e,this.refs=Ug,this.updater=n||zg}var vd=yd.prototype=new $g;vd.constructor=yd;Bg(vd,ii.prototype);vd.isPureReactComponent=!0;var Pf=Array.isArray,Wg=Object.prototype.hasOwnProperty,_d={current:null},Hg={key:!0,ref:!0,__self:!0,__source:!0};function qg(t,e,n){var r,s={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)Wg.call(e,r)&&!Hg.hasOwnProperty(r)&&(s[r]=e[r]);var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){for(var u=Array(l),h=0;h<l;h++)u[h]=arguments[h+2];s.children=u}if(t&&t.defaultProps)for(r in l=t.defaultProps,l)s[r]===void 0&&(s[r]=l[r]);return{$$typeof:Mo,type:t,key:i,ref:o,props:s,_owner:_d.current}}function l_(t,e){return{$$typeof:Mo,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function xd(t){return typeof t=="object"&&t!==null&&t.$$typeof===Mo}function u_(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var bf=/\/+/g;function _u(t,e){return typeof t=="object"&&t!==null&&t.key!=null?u_(""+t.key):e.toString(36)}function Pa(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Mo:case Xv:o=!0}}if(o)return o=t,s=s(o),t=r===""?"."+_u(o,0):r,Pf(s)?(n="",t!=null&&(n=t.replace(bf,"$&/")+"/"),Pa(s,e,n,"",function(h){return h})):s!=null&&(xd(s)&&(s=l_(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(bf,"$&/")+"/")+t)),e.push(s)),1;if(o=0,r=r===""?".":r+":",Pf(t))for(var l=0;l<t.length;l++){i=t[l];var u=r+_u(i,l);o+=Pa(i,e,n,u,s)}else if(u=a_(t),typeof u=="function")for(t=u.call(t),l=0;!(i=t.next()).done;)i=i.value,u=r+_u(i,l++),o+=Pa(i,e,n,u,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function ua(t,e,n){if(t==null)return t;var r=[],s=0;return Pa(t,r,"","",function(i){return e.call(n,i,s++)}),r}function c_(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Nt={current:null},ba={transition:null},d_={ReactCurrentDispatcher:Nt,ReactCurrentBatchConfig:ba,ReactCurrentOwner:_d};function Gg(){throw Error("act(...) is not supported in production builds of React.")}he.Children={map:ua,forEach:function(t,e,n){ua(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return ua(t,function(){e++}),e},toArray:function(t){return ua(t,function(e){return e})||[]},only:function(t){if(!xd(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};he.Component=ii;he.Fragment=Jv;he.Profiler=e_;he.PureComponent=yd;he.StrictMode=Zv;he.Suspense=s_;he.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=d_;he.act=Gg;he.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=Bg({},t.props),s=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=_d.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(u in e)Wg.call(e,u)&&!Hg.hasOwnProperty(u)&&(r[u]=e[u]===void 0&&l!==void 0?l[u]:e[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){l=Array(u);for(var h=0;h<u;h++)l[h]=arguments[h+2];r.children=l}return{$$typeof:Mo,type:t.type,key:s,ref:i,props:r,_owner:o}};he.createContext=function(t){return t={$$typeof:n_,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:t_,_context:t},t.Consumer=t};he.createElement=qg;he.createFactory=function(t){var e=qg.bind(null,t);return e.type=t,e};he.createRef=function(){return{current:null}};he.forwardRef=function(t){return{$$typeof:r_,render:t}};he.isValidElement=xd;he.lazy=function(t){return{$$typeof:o_,_payload:{_status:-1,_result:t},_init:c_}};he.memo=function(t,e){return{$$typeof:i_,type:t,compare:e===void 0?null:e}};he.startTransition=function(t){var e=ba.transition;ba.transition={};try{t()}finally{ba.transition=e}};he.unstable_act=Gg;he.useCallback=function(t,e){return Nt.current.useCallback(t,e)};he.useContext=function(t){return Nt.current.useContext(t)};he.useDebugValue=function(){};he.useDeferredValue=function(t){return Nt.current.useDeferredValue(t)};he.useEffect=function(t,e){return Nt.current.useEffect(t,e)};he.useId=function(){return Nt.current.useId()};he.useImperativeHandle=function(t,e,n){return Nt.current.useImperativeHandle(t,e,n)};he.useInsertionEffect=function(t,e){return Nt.current.useInsertionEffect(t,e)};he.useLayoutEffect=function(t,e){return Nt.current.useLayoutEffect(t,e)};he.useMemo=function(t,e){return Nt.current.useMemo(t,e)};he.useReducer=function(t,e,n){return Nt.current.useReducer(t,e,n)};he.useRef=function(t){return Nt.current.useRef(t)};he.useState=function(t){return Nt.current.useState(t)};he.useSyncExternalStore=function(t,e,n){return Nt.current.useSyncExternalStore(t,e,n)};he.useTransition=function(){return Nt.current.useTransition()};he.version="18.3.1";Fg.exports=he;var L=Fg.exports;/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var h_=L,f_=Symbol.for("react.element"),p_=Symbol.for("react.fragment"),g_=Object.prototype.hasOwnProperty,m_=h_.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,y_={key:!0,ref:!0,__self:!0,__source:!0};function Qg(t,e,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)g_.call(e,r)&&!y_.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:f_,type:t,key:i,ref:o,props:s,_owner:m_.current}}Pl.Fragment=p_;Pl.jsx=Qg;Pl.jsxs=Qg;Og.exports=Pl;var d=Og.exports,Kg={exports:{}},rn={},Yg={exports:{}},Xg={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(N,F){var H=N.length;N.push(F);e:for(;0<H;){var Z=H-1>>>1,ee=N[Z];if(0<s(ee,F))N[Z]=F,N[H]=ee,H=Z;else break e}}function n(N){return N.length===0?null:N[0]}function r(N){if(N.length===0)return null;var F=N[0],H=N.pop();if(H!==F){N[0]=H;e:for(var Z=0,ee=N.length,oe=ee>>>1;Z<oe;){var Ae=2*(Z+1)-1,ge=N[Ae],de=Ae+1,ce=N[de];if(0>s(ge,H))de<ee&&0>s(ce,ge)?(N[Z]=ce,N[de]=H,Z=de):(N[Z]=ge,N[Ae]=H,Z=Ae);else if(de<ee&&0>s(ce,H))N[Z]=ce,N[de]=H,Z=de;else break e}}return F}function s(N,F){var H=N.sortIndex-F.sortIndex;return H!==0?H:N.id-F.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var u=[],h=[],p=1,g=null,v=3,k=!1,R=!1,P=!1,O=typeof setTimeout=="function"?setTimeout:null,C=typeof clearTimeout=="function"?clearTimeout:null,I=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(N){for(var F=n(h);F!==null;){if(F.callback===null)r(h);else if(F.startTime<=N)r(h),F.sortIndex=F.expirationTime,e(u,F);else break;F=n(h)}}function b(N){if(P=!1,w(N),!R)if(n(u)!==null)R=!0,te(V);else{var F=n(h);F!==null&&U(b,F.startTime-N)}}function V(N,F){R=!1,P&&(P=!1,C(_),_=-1),k=!0;var H=v;try{for(w(F),g=n(u);g!==null&&(!(g.expirationTime>F)||N&&!E());){var Z=g.callback;if(typeof Z=="function"){g.callback=null,v=g.priorityLevel;var ee=Z(g.expirationTime<=F);F=t.unstable_now(),typeof ee=="function"?g.callback=ee:g===n(u)&&r(u),w(F)}else r(u);g=n(u)}if(g!==null)var oe=!0;else{var Ae=n(h);Ae!==null&&U(b,Ae.startTime-F),oe=!1}return oe}finally{g=null,v=H,k=!1}}var j=!1,T=null,_=-1,m=5,S=-1;function E(){return!(t.unstable_now()-S<m)}function A(){if(T!==null){var N=t.unstable_now();S=N;var F=!0;try{F=T(!0,N)}finally{F?x():(j=!1,T=null)}}else j=!1}var x;if(typeof I=="function")x=function(){I(A)};else if(typeof MessageChannel<"u"){var W=new MessageChannel,X=W.port2;W.port1.onmessage=A,x=function(){X.postMessage(null)}}else x=function(){O(A,0)};function te(N){T=N,j||(j=!0,x())}function U(N,F){_=O(function(){N(t.unstable_now())},F)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(N){N.callback=null},t.unstable_continueExecution=function(){R||k||(R=!0,te(V))},t.unstable_forceFrameRate=function(N){0>N||125<N?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):m=0<N?Math.floor(1e3/N):5},t.unstable_getCurrentPriorityLevel=function(){return v},t.unstable_getFirstCallbackNode=function(){return n(u)},t.unstable_next=function(N){switch(v){case 1:case 2:case 3:var F=3;break;default:F=v}var H=v;v=F;try{return N()}finally{v=H}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(N,F){switch(N){case 1:case 2:case 3:case 4:case 5:break;default:N=3}var H=v;v=N;try{return F()}finally{v=H}},t.unstable_scheduleCallback=function(N,F,H){var Z=t.unstable_now();switch(typeof H=="object"&&H!==null?(H=H.delay,H=typeof H=="number"&&0<H?Z+H:Z):H=Z,N){case 1:var ee=-1;break;case 2:ee=250;break;case 5:ee=1073741823;break;case 4:ee=1e4;break;default:ee=5e3}return ee=H+ee,N={id:p++,callback:F,priorityLevel:N,startTime:H,expirationTime:ee,sortIndex:-1},H>Z?(N.sortIndex=H,e(h,N),n(u)===null&&N===n(h)&&(P?(C(_),_=-1):P=!0,U(b,H-Z))):(N.sortIndex=ee,e(u,N),R||k||(R=!0,te(V))),N},t.unstable_shouldYield=E,t.unstable_wrapCallback=function(N){var F=v;return function(){var H=v;v=F;try{return N.apply(this,arguments)}finally{v=H}}}})(Xg);Yg.exports=Xg;var v_=Yg.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var __=L,nn=v_;function $(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Jg=new Set,oo={};function hs(t,e){Hs(t,e),Hs(t+"Capture",e)}function Hs(t,e){for(oo[t]=e,t=0;t<e.length;t++)Jg.add(e[t])}var Zn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ec=Object.prototype.hasOwnProperty,x_=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Df={},Nf={};function w_(t){return ec.call(Nf,t)?!0:ec.call(Df,t)?!1:x_.test(t)?Nf[t]=!0:(Df[t]=!0,!1)}function S_(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function E_(t,e,n,r){if(e===null||typeof e>"u"||S_(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Mt(t,e,n,r,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var yt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){yt[t]=new Mt(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];yt[e]=new Mt(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){yt[t]=new Mt(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){yt[t]=new Mt(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){yt[t]=new Mt(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){yt[t]=new Mt(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){yt[t]=new Mt(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){yt[t]=new Mt(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){yt[t]=new Mt(t,5,!1,t.toLowerCase(),null,!1,!1)});var wd=/[\-:]([a-z])/g;function Sd(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(wd,Sd);yt[e]=new Mt(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(wd,Sd);yt[e]=new Mt(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(wd,Sd);yt[e]=new Mt(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){yt[t]=new Mt(t,1,!1,t.toLowerCase(),null,!1,!1)});yt.xlinkHref=new Mt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){yt[t]=new Mt(t,1,!1,t.toLowerCase(),null,!0,!0)});function Ed(t,e,n,r){var s=yt.hasOwnProperty(e)?yt[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(E_(e,n,s,r)&&(n=null),r||s===null?w_(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var or=__.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ca=Symbol.for("react.element"),As=Symbol.for("react.portal"),Cs=Symbol.for("react.fragment"),Td=Symbol.for("react.strict_mode"),tc=Symbol.for("react.profiler"),Zg=Symbol.for("react.provider"),em=Symbol.for("react.context"),Id=Symbol.for("react.forward_ref"),nc=Symbol.for("react.suspense"),rc=Symbol.for("react.suspense_list"),Ad=Symbol.for("react.memo"),pr=Symbol.for("react.lazy"),tm=Symbol.for("react.offscreen"),Mf=Symbol.iterator;function Ri(t){return t===null||typeof t!="object"?null:(t=Mf&&t[Mf]||t["@@iterator"],typeof t=="function"?t:null)}var Be=Object.assign,xu;function Oi(t){if(xu===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);xu=e&&e[1]||""}return`
`+xu+t}var wu=!1;function Su(t,e){if(!t||wu)return"";wu=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(h){var r=h}Reflect.construct(t,[],e)}else{try{e.call()}catch(h){r=h}t.call(e.prototype)}else{try{throw Error()}catch(h){r=h}t()}}catch(h){if(h&&r&&typeof h.stack=="string"){for(var s=h.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,l=i.length-1;1<=o&&0<=l&&s[o]!==i[l];)l--;for(;1<=o&&0<=l;o--,l--)if(s[o]!==i[l]){if(o!==1||l!==1)do if(o--,l--,0>l||s[o]!==i[l]){var u=`
`+s[o].replace(" at new "," at ");return t.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",t.displayName)),u}while(1<=o&&0<=l);break}}}finally{wu=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Oi(t):""}function T_(t){switch(t.tag){case 5:return Oi(t.type);case 16:return Oi("Lazy");case 13:return Oi("Suspense");case 19:return Oi("SuspenseList");case 0:case 2:case 15:return t=Su(t.type,!1),t;case 11:return t=Su(t.type.render,!1),t;case 1:return t=Su(t.type,!0),t;default:return""}}function sc(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Cs:return"Fragment";case As:return"Portal";case tc:return"Profiler";case Td:return"StrictMode";case nc:return"Suspense";case rc:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case em:return(t.displayName||"Context")+".Consumer";case Zg:return(t._context.displayName||"Context")+".Provider";case Id:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Ad:return e=t.displayName||null,e!==null?e:sc(t.type)||"Memo";case pr:e=t._payload,t=t._init;try{return sc(t(e))}catch{}}return null}function I_(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return sc(e);case 8:return e===Td?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Nr(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function nm(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function A_(t){var e=nm(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function da(t){t._valueTracker||(t._valueTracker=A_(t))}function rm(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=nm(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Qa(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function ic(t,e){var n=e.checked;return Be({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Vf(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Nr(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function sm(t,e){e=e.checked,e!=null&&Ed(t,"checked",e,!1)}function oc(t,e){sm(t,e);var n=Nr(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?ac(t,e.type,n):e.hasOwnProperty("defaultValue")&&ac(t,e.type,Nr(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function jf(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function ac(t,e,n){(e!=="number"||Qa(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Fi=Array.isArray;function Os(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Nr(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function lc(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error($(91));return Be({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Lf(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error($(92));if(Fi(n)){if(1<n.length)throw Error($(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Nr(n)}}function im(t,e){var n=Nr(e.value),r=Nr(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function Of(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function om(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function uc(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?om(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var ha,am=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(ha=ha||document.createElement("div"),ha.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=ha.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function ao(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Gi={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},C_=["Webkit","ms","Moz","O"];Object.keys(Gi).forEach(function(t){C_.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Gi[e]=Gi[t]})});function lm(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Gi.hasOwnProperty(t)&&Gi[t]?(""+e).trim():e+"px"}function um(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=lm(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var k_=Be({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function cc(t,e){if(e){if(k_[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error($(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error($(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error($(61))}if(e.style!=null&&typeof e.style!="object")throw Error($(62))}}function dc(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var hc=null;function Cd(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var fc=null,Fs=null,zs=null;function Ff(t){if(t=Lo(t)){if(typeof fc!="function")throw Error($(280));var e=t.stateNode;e&&(e=Vl(e),fc(t.stateNode,t.type,e))}}function cm(t){Fs?zs?zs.push(t):zs=[t]:Fs=t}function dm(){if(Fs){var t=Fs,e=zs;if(zs=Fs=null,Ff(t),e)for(t=0;t<e.length;t++)Ff(e[t])}}function hm(t,e){return t(e)}function fm(){}var Eu=!1;function pm(t,e,n){if(Eu)return t(e,n);Eu=!0;try{return hm(t,e,n)}finally{Eu=!1,(Fs!==null||zs!==null)&&(fm(),dm())}}function lo(t,e){var n=t.stateNode;if(n===null)return null;var r=Vl(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error($(231,e,typeof n));return n}var pc=!1;if(Zn)try{var Pi={};Object.defineProperty(Pi,"passive",{get:function(){pc=!0}}),window.addEventListener("test",Pi,Pi),window.removeEventListener("test",Pi,Pi)}catch{pc=!1}function R_(t,e,n,r,s,i,o,l,u){var h=Array.prototype.slice.call(arguments,3);try{e.apply(n,h)}catch(p){this.onError(p)}}var Qi=!1,Ka=null,Ya=!1,gc=null,P_={onError:function(t){Qi=!0,Ka=t}};function b_(t,e,n,r,s,i,o,l,u){Qi=!1,Ka=null,R_.apply(P_,arguments)}function D_(t,e,n,r,s,i,o,l,u){if(b_.apply(this,arguments),Qi){if(Qi){var h=Ka;Qi=!1,Ka=null}else throw Error($(198));Ya||(Ya=!0,gc=h)}}function fs(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function gm(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function zf(t){if(fs(t)!==t)throw Error($(188))}function N_(t){var e=t.alternate;if(!e){if(e=fs(t),e===null)throw Error($(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return zf(s),t;if(i===r)return zf(s),e;i=i.sibling}throw Error($(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,l=s.child;l;){if(l===n){o=!0,n=s,r=i;break}if(l===r){o=!0,r=s,n=i;break}l=l.sibling}if(!o){for(l=i.child;l;){if(l===n){o=!0,n=i,r=s;break}if(l===r){o=!0,r=i,n=s;break}l=l.sibling}if(!o)throw Error($(189))}}if(n.alternate!==r)throw Error($(190))}if(n.tag!==3)throw Error($(188));return n.stateNode.current===n?t:e}function mm(t){return t=N_(t),t!==null?ym(t):null}function ym(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=ym(t);if(e!==null)return e;t=t.sibling}return null}var vm=nn.unstable_scheduleCallback,Bf=nn.unstable_cancelCallback,M_=nn.unstable_shouldYield,V_=nn.unstable_requestPaint,Ke=nn.unstable_now,j_=nn.unstable_getCurrentPriorityLevel,kd=nn.unstable_ImmediatePriority,_m=nn.unstable_UserBlockingPriority,Xa=nn.unstable_NormalPriority,L_=nn.unstable_LowPriority,xm=nn.unstable_IdlePriority,bl=null,Nn=null;function O_(t){if(Nn&&typeof Nn.onCommitFiberRoot=="function")try{Nn.onCommitFiberRoot(bl,t,void 0,(t.current.flags&128)===128)}catch{}}var En=Math.clz32?Math.clz32:B_,F_=Math.log,z_=Math.LN2;function B_(t){return t>>>=0,t===0?32:31-(F_(t)/z_|0)|0}var fa=64,pa=4194304;function zi(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Ja(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var l=o&~s;l!==0?r=zi(l):(i&=o,i!==0&&(r=zi(i)))}else o=n&~s,o!==0?r=zi(o):i!==0&&(r=zi(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-En(e),s=1<<n,r|=t[n],e&=~s;return r}function U_(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function $_(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-En(i),l=1<<o,u=s[o];u===-1?(!(l&n)||l&r)&&(s[o]=U_(l,e)):u<=e&&(t.expiredLanes|=l),i&=~l}}function mc(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function wm(){var t=fa;return fa<<=1,!(fa&4194240)&&(fa=64),t}function Tu(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Vo(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-En(e),t[e]=n}function W_(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-En(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function Rd(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-En(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var Ee=0;function Sm(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Em,Pd,Tm,Im,Am,yc=!1,ga=[],wr=null,Sr=null,Er=null,uo=new Map,co=new Map,mr=[],H_="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Uf(t,e){switch(t){case"focusin":case"focusout":wr=null;break;case"dragenter":case"dragleave":Sr=null;break;case"mouseover":case"mouseout":Er=null;break;case"pointerover":case"pointerout":uo.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":co.delete(e.pointerId)}}function bi(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=Lo(e),e!==null&&Pd(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function q_(t,e,n,r,s){switch(e){case"focusin":return wr=bi(wr,t,e,n,r,s),!0;case"dragenter":return Sr=bi(Sr,t,e,n,r,s),!0;case"mouseover":return Er=bi(Er,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return uo.set(i,bi(uo.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,co.set(i,bi(co.get(i)||null,t,e,n,r,s)),!0}return!1}function Cm(t){var e=Xr(t.target);if(e!==null){var n=fs(e);if(n!==null){if(e=n.tag,e===13){if(e=gm(n),e!==null){t.blockedOn=e,Am(t.priority,function(){Tm(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Da(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=vc(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);hc=r,n.target.dispatchEvent(r),hc=null}else return e=Lo(n),e!==null&&Pd(e),t.blockedOn=n,!1;e.shift()}return!0}function $f(t,e,n){Da(t)&&n.delete(e)}function G_(){yc=!1,wr!==null&&Da(wr)&&(wr=null),Sr!==null&&Da(Sr)&&(Sr=null),Er!==null&&Da(Er)&&(Er=null),uo.forEach($f),co.forEach($f)}function Di(t,e){t.blockedOn===e&&(t.blockedOn=null,yc||(yc=!0,nn.unstable_scheduleCallback(nn.unstable_NormalPriority,G_)))}function ho(t){function e(s){return Di(s,t)}if(0<ga.length){Di(ga[0],t);for(var n=1;n<ga.length;n++){var r=ga[n];r.blockedOn===t&&(r.blockedOn=null)}}for(wr!==null&&Di(wr,t),Sr!==null&&Di(Sr,t),Er!==null&&Di(Er,t),uo.forEach(e),co.forEach(e),n=0;n<mr.length;n++)r=mr[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<mr.length&&(n=mr[0],n.blockedOn===null);)Cm(n),n.blockedOn===null&&mr.shift()}var Bs=or.ReactCurrentBatchConfig,Za=!0;function Q_(t,e,n,r){var s=Ee,i=Bs.transition;Bs.transition=null;try{Ee=1,bd(t,e,n,r)}finally{Ee=s,Bs.transition=i}}function K_(t,e,n,r){var s=Ee,i=Bs.transition;Bs.transition=null;try{Ee=4,bd(t,e,n,r)}finally{Ee=s,Bs.transition=i}}function bd(t,e,n,r){if(Za){var s=vc(t,e,n,r);if(s===null)Mu(t,e,r,el,n),Uf(t,r);else if(q_(s,t,e,n,r))r.stopPropagation();else if(Uf(t,r),e&4&&-1<H_.indexOf(t)){for(;s!==null;){var i=Lo(s);if(i!==null&&Em(i),i=vc(t,e,n,r),i===null&&Mu(t,e,r,el,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else Mu(t,e,r,null,n)}}var el=null;function vc(t,e,n,r){if(el=null,t=Cd(r),t=Xr(t),t!==null)if(e=fs(t),e===null)t=null;else if(n=e.tag,n===13){if(t=gm(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return el=t,null}function km(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(j_()){case kd:return 1;case _m:return 4;case Xa:case L_:return 16;case xm:return 536870912;default:return 16}default:return 16}}var vr=null,Dd=null,Na=null;function Rm(){if(Na)return Na;var t,e=Dd,n=e.length,r,s="value"in vr?vr.value:vr.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===s[i-r];r++);return Na=s.slice(t,1<r?1-r:void 0)}function Ma(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function ma(){return!0}function Wf(){return!1}function sn(t){function e(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?ma:Wf,this.isPropagationStopped=Wf,this}return Be(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=ma)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=ma)},persist:function(){},isPersistent:ma}),e}var oi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Nd=sn(oi),jo=Be({},oi,{view:0,detail:0}),Y_=sn(jo),Iu,Au,Ni,Dl=Be({},jo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Md,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Ni&&(Ni&&t.type==="mousemove"?(Iu=t.screenX-Ni.screenX,Au=t.screenY-Ni.screenY):Au=Iu=0,Ni=t),Iu)},movementY:function(t){return"movementY"in t?t.movementY:Au}}),Hf=sn(Dl),X_=Be({},Dl,{dataTransfer:0}),J_=sn(X_),Z_=Be({},jo,{relatedTarget:0}),Cu=sn(Z_),e1=Be({},oi,{animationName:0,elapsedTime:0,pseudoElement:0}),t1=sn(e1),n1=Be({},oi,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),r1=sn(n1),s1=Be({},oi,{data:0}),qf=sn(s1),i1={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},o1={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},a1={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function l1(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=a1[t])?!!e[t]:!1}function Md(){return l1}var u1=Be({},jo,{key:function(t){if(t.key){var e=i1[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Ma(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?o1[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Md,charCode:function(t){return t.type==="keypress"?Ma(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Ma(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),c1=sn(u1),d1=Be({},Dl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Gf=sn(d1),h1=Be({},jo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Md}),f1=sn(h1),p1=Be({},oi,{propertyName:0,elapsedTime:0,pseudoElement:0}),g1=sn(p1),m1=Be({},Dl,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),y1=sn(m1),v1=[9,13,27,32],Vd=Zn&&"CompositionEvent"in window,Ki=null;Zn&&"documentMode"in document&&(Ki=document.documentMode);var _1=Zn&&"TextEvent"in window&&!Ki,Pm=Zn&&(!Vd||Ki&&8<Ki&&11>=Ki),Qf=" ",Kf=!1;function bm(t,e){switch(t){case"keyup":return v1.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Dm(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var ks=!1;function x1(t,e){switch(t){case"compositionend":return Dm(e);case"keypress":return e.which!==32?null:(Kf=!0,Qf);case"textInput":return t=e.data,t===Qf&&Kf?null:t;default:return null}}function w1(t,e){if(ks)return t==="compositionend"||!Vd&&bm(t,e)?(t=Rm(),Na=Dd=vr=null,ks=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Pm&&e.locale!=="ko"?null:e.data;default:return null}}var S1={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Yf(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!S1[t.type]:e==="textarea"}function Nm(t,e,n,r){cm(r),e=tl(e,"onChange"),0<e.length&&(n=new Nd("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Yi=null,fo=null;function E1(t){Wm(t,0)}function Nl(t){var e=bs(t);if(rm(e))return t}function T1(t,e){if(t==="change")return e}var Mm=!1;if(Zn){var ku;if(Zn){var Ru="oninput"in document;if(!Ru){var Xf=document.createElement("div");Xf.setAttribute("oninput","return;"),Ru=typeof Xf.oninput=="function"}ku=Ru}else ku=!1;Mm=ku&&(!document.documentMode||9<document.documentMode)}function Jf(){Yi&&(Yi.detachEvent("onpropertychange",Vm),fo=Yi=null)}function Vm(t){if(t.propertyName==="value"&&Nl(fo)){var e=[];Nm(e,fo,t,Cd(t)),pm(E1,e)}}function I1(t,e,n){t==="focusin"?(Jf(),Yi=e,fo=n,Yi.attachEvent("onpropertychange",Vm)):t==="focusout"&&Jf()}function A1(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Nl(fo)}function C1(t,e){if(t==="click")return Nl(e)}function k1(t,e){if(t==="input"||t==="change")return Nl(e)}function R1(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var In=typeof Object.is=="function"?Object.is:R1;function po(t,e){if(In(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!ec.call(e,s)||!In(t[s],e[s]))return!1}return!0}function Zf(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function ep(t,e){var n=Zf(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Zf(n)}}function jm(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?jm(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Lm(){for(var t=window,e=Qa();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Qa(t.document)}return e}function jd(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function P1(t){var e=Lm(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&jm(n.ownerDocument.documentElement,n)){if(r!==null&&jd(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=ep(n,i);var o=ep(n,r);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var b1=Zn&&"documentMode"in document&&11>=document.documentMode,Rs=null,_c=null,Xi=null,xc=!1;function tp(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;xc||Rs==null||Rs!==Qa(r)||(r=Rs,"selectionStart"in r&&jd(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Xi&&po(Xi,r)||(Xi=r,r=tl(_c,"onSelect"),0<r.length&&(e=new Nd("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Rs)))}function ya(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Ps={animationend:ya("Animation","AnimationEnd"),animationiteration:ya("Animation","AnimationIteration"),animationstart:ya("Animation","AnimationStart"),transitionend:ya("Transition","TransitionEnd")},Pu={},Om={};Zn&&(Om=document.createElement("div").style,"AnimationEvent"in window||(delete Ps.animationend.animation,delete Ps.animationiteration.animation,delete Ps.animationstart.animation),"TransitionEvent"in window||delete Ps.transitionend.transition);function Ml(t){if(Pu[t])return Pu[t];if(!Ps[t])return t;var e=Ps[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in Om)return Pu[t]=e[n];return t}var Fm=Ml("animationend"),zm=Ml("animationiteration"),Bm=Ml("animationstart"),Um=Ml("transitionend"),$m=new Map,np="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Or(t,e){$m.set(t,e),hs(e,[t])}for(var bu=0;bu<np.length;bu++){var Du=np[bu],D1=Du.toLowerCase(),N1=Du[0].toUpperCase()+Du.slice(1);Or(D1,"on"+N1)}Or(Fm,"onAnimationEnd");Or(zm,"onAnimationIteration");Or(Bm,"onAnimationStart");Or("dblclick","onDoubleClick");Or("focusin","onFocus");Or("focusout","onBlur");Or(Um,"onTransitionEnd");Hs("onMouseEnter",["mouseout","mouseover"]);Hs("onMouseLeave",["mouseout","mouseover"]);Hs("onPointerEnter",["pointerout","pointerover"]);Hs("onPointerLeave",["pointerout","pointerover"]);hs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));hs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));hs("onBeforeInput",["compositionend","keypress","textInput","paste"]);hs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));hs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));hs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Bi="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),M1=new Set("cancel close invalid load scroll toggle".split(" ").concat(Bi));function rp(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,D_(r,e,void 0,t),t.currentTarget=null}function Wm(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var l=r[o],u=l.instance,h=l.currentTarget;if(l=l.listener,u!==i&&s.isPropagationStopped())break e;rp(s,l,h),i=u}else for(o=0;o<r.length;o++){if(l=r[o],u=l.instance,h=l.currentTarget,l=l.listener,u!==i&&s.isPropagationStopped())break e;rp(s,l,h),i=u}}}if(Ya)throw t=gc,Ya=!1,gc=null,t}function Ne(t,e){var n=e[Ic];n===void 0&&(n=e[Ic]=new Set);var r=t+"__bubble";n.has(r)||(Hm(e,t,2,!1),n.add(r))}function Nu(t,e,n){var r=0;e&&(r|=4),Hm(n,t,r,e)}var va="_reactListening"+Math.random().toString(36).slice(2);function go(t){if(!t[va]){t[va]=!0,Jg.forEach(function(n){n!=="selectionchange"&&(M1.has(n)||Nu(n,!1,t),Nu(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[va]||(e[va]=!0,Nu("selectionchange",!1,e))}}function Hm(t,e,n,r){switch(km(e)){case 1:var s=Q_;break;case 4:s=K_;break;default:s=bd}n=s.bind(null,e,n,t),s=void 0,!pc||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function Mu(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var l=r.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var u=o.tag;if((u===3||u===4)&&(u=o.stateNode.containerInfo,u===s||u.nodeType===8&&u.parentNode===s))return;o=o.return}for(;l!==null;){if(o=Xr(l),o===null)return;if(u=o.tag,u===5||u===6){r=i=o;continue e}l=l.parentNode}}r=r.return}pm(function(){var h=i,p=Cd(n),g=[];e:{var v=$m.get(t);if(v!==void 0){var k=Nd,R=t;switch(t){case"keypress":if(Ma(n)===0)break e;case"keydown":case"keyup":k=c1;break;case"focusin":R="focus",k=Cu;break;case"focusout":R="blur",k=Cu;break;case"beforeblur":case"afterblur":k=Cu;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":k=Hf;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":k=J_;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":k=f1;break;case Fm:case zm:case Bm:k=t1;break;case Um:k=g1;break;case"scroll":k=Y_;break;case"wheel":k=y1;break;case"copy":case"cut":case"paste":k=r1;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":k=Gf}var P=(e&4)!==0,O=!P&&t==="scroll",C=P?v!==null?v+"Capture":null:v;P=[];for(var I=h,w;I!==null;){w=I;var b=w.stateNode;if(w.tag===5&&b!==null&&(w=b,C!==null&&(b=lo(I,C),b!=null&&P.push(mo(I,b,w)))),O)break;I=I.return}0<P.length&&(v=new k(v,R,null,n,p),g.push({event:v,listeners:P}))}}if(!(e&7)){e:{if(v=t==="mouseover"||t==="pointerover",k=t==="mouseout"||t==="pointerout",v&&n!==hc&&(R=n.relatedTarget||n.fromElement)&&(Xr(R)||R[er]))break e;if((k||v)&&(v=p.window===p?p:(v=p.ownerDocument)?v.defaultView||v.parentWindow:window,k?(R=n.relatedTarget||n.toElement,k=h,R=R?Xr(R):null,R!==null&&(O=fs(R),R!==O||R.tag!==5&&R.tag!==6)&&(R=null)):(k=null,R=h),k!==R)){if(P=Hf,b="onMouseLeave",C="onMouseEnter",I="mouse",(t==="pointerout"||t==="pointerover")&&(P=Gf,b="onPointerLeave",C="onPointerEnter",I="pointer"),O=k==null?v:bs(k),w=R==null?v:bs(R),v=new P(b,I+"leave",k,n,p),v.target=O,v.relatedTarget=w,b=null,Xr(p)===h&&(P=new P(C,I+"enter",R,n,p),P.target=w,P.relatedTarget=O,b=P),O=b,k&&R)t:{for(P=k,C=R,I=0,w=P;w;w=Ss(w))I++;for(w=0,b=C;b;b=Ss(b))w++;for(;0<I-w;)P=Ss(P),I--;for(;0<w-I;)C=Ss(C),w--;for(;I--;){if(P===C||C!==null&&P===C.alternate)break t;P=Ss(P),C=Ss(C)}P=null}else P=null;k!==null&&sp(g,v,k,P,!1),R!==null&&O!==null&&sp(g,O,R,P,!0)}}e:{if(v=h?bs(h):window,k=v.nodeName&&v.nodeName.toLowerCase(),k==="select"||k==="input"&&v.type==="file")var V=T1;else if(Yf(v))if(Mm)V=k1;else{V=A1;var j=I1}else(k=v.nodeName)&&k.toLowerCase()==="input"&&(v.type==="checkbox"||v.type==="radio")&&(V=C1);if(V&&(V=V(t,h))){Nm(g,V,n,p);break e}j&&j(t,v,h),t==="focusout"&&(j=v._wrapperState)&&j.controlled&&v.type==="number"&&ac(v,"number",v.value)}switch(j=h?bs(h):window,t){case"focusin":(Yf(j)||j.contentEditable==="true")&&(Rs=j,_c=h,Xi=null);break;case"focusout":Xi=_c=Rs=null;break;case"mousedown":xc=!0;break;case"contextmenu":case"mouseup":case"dragend":xc=!1,tp(g,n,p);break;case"selectionchange":if(b1)break;case"keydown":case"keyup":tp(g,n,p)}var T;if(Vd)e:{switch(t){case"compositionstart":var _="onCompositionStart";break e;case"compositionend":_="onCompositionEnd";break e;case"compositionupdate":_="onCompositionUpdate";break e}_=void 0}else ks?bm(t,n)&&(_="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(_="onCompositionStart");_&&(Pm&&n.locale!=="ko"&&(ks||_!=="onCompositionStart"?_==="onCompositionEnd"&&ks&&(T=Rm()):(vr=p,Dd="value"in vr?vr.value:vr.textContent,ks=!0)),j=tl(h,_),0<j.length&&(_=new qf(_,t,null,n,p),g.push({event:_,listeners:j}),T?_.data=T:(T=Dm(n),T!==null&&(_.data=T)))),(T=_1?x1(t,n):w1(t,n))&&(h=tl(h,"onBeforeInput"),0<h.length&&(p=new qf("onBeforeInput","beforeinput",null,n,p),g.push({event:p,listeners:h}),p.data=T))}Wm(g,e)})}function mo(t,e,n){return{instance:t,listener:e,currentTarget:n}}function tl(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=lo(t,n),i!=null&&r.unshift(mo(t,i,s)),i=lo(t,e),i!=null&&r.push(mo(t,i,s))),t=t.return}return r}function Ss(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function sp(t,e,n,r,s){for(var i=e._reactName,o=[];n!==null&&n!==r;){var l=n,u=l.alternate,h=l.stateNode;if(u!==null&&u===r)break;l.tag===5&&h!==null&&(l=h,s?(u=lo(n,i),u!=null&&o.unshift(mo(n,u,l))):s||(u=lo(n,i),u!=null&&o.push(mo(n,u,l)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var V1=/\r\n?/g,j1=/\u0000|\uFFFD/g;function ip(t){return(typeof t=="string"?t:""+t).replace(V1,`
`).replace(j1,"")}function _a(t,e,n){if(e=ip(e),ip(t)!==e&&n)throw Error($(425))}function nl(){}var wc=null,Sc=null;function Ec(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Tc=typeof setTimeout=="function"?setTimeout:void 0,L1=typeof clearTimeout=="function"?clearTimeout:void 0,op=typeof Promise=="function"?Promise:void 0,O1=typeof queueMicrotask=="function"?queueMicrotask:typeof op<"u"?function(t){return op.resolve(null).then(t).catch(F1)}:Tc;function F1(t){setTimeout(function(){throw t})}function Vu(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),ho(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);ho(e)}function Tr(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function ap(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var ai=Math.random().toString(36).slice(2),Dn="__reactFiber$"+ai,yo="__reactProps$"+ai,er="__reactContainer$"+ai,Ic="__reactEvents$"+ai,z1="__reactListeners$"+ai,B1="__reactHandles$"+ai;function Xr(t){var e=t[Dn];if(e)return e;for(var n=t.parentNode;n;){if(e=n[er]||n[Dn]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=ap(t);t!==null;){if(n=t[Dn])return n;t=ap(t)}return e}t=n,n=t.parentNode}return null}function Lo(t){return t=t[Dn]||t[er],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function bs(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error($(33))}function Vl(t){return t[yo]||null}var Ac=[],Ds=-1;function Fr(t){return{current:t}}function Ve(t){0>Ds||(t.current=Ac[Ds],Ac[Ds]=null,Ds--)}function be(t,e){Ds++,Ac[Ds]=t.current,t.current=e}var Mr={},Ct=Fr(Mr),zt=Fr(!1),ss=Mr;function qs(t,e){var n=t.type.contextTypes;if(!n)return Mr;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function Bt(t){return t=t.childContextTypes,t!=null}function rl(){Ve(zt),Ve(Ct)}function lp(t,e,n){if(Ct.current!==Mr)throw Error($(168));be(Ct,e),be(zt,n)}function qm(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error($(108,I_(t)||"Unknown",s));return Be({},n,r)}function sl(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Mr,ss=Ct.current,be(Ct,t),be(zt,zt.current),!0}function up(t,e,n){var r=t.stateNode;if(!r)throw Error($(169));n?(t=qm(t,e,ss),r.__reactInternalMemoizedMergedChildContext=t,Ve(zt),Ve(Ct),be(Ct,t)):Ve(zt),be(zt,n)}var Hn=null,jl=!1,ju=!1;function Gm(t){Hn===null?Hn=[t]:Hn.push(t)}function U1(t){jl=!0,Gm(t)}function zr(){if(!ju&&Hn!==null){ju=!0;var t=0,e=Ee;try{var n=Hn;for(Ee=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Hn=null,jl=!1}catch(s){throw Hn!==null&&(Hn=Hn.slice(t+1)),vm(kd,zr),s}finally{Ee=e,ju=!1}}return null}var Ns=[],Ms=0,il=null,ol=0,an=[],ln=0,is=null,Qn=1,Kn="";function Qr(t,e){Ns[Ms++]=ol,Ns[Ms++]=il,il=t,ol=e}function Qm(t,e,n){an[ln++]=Qn,an[ln++]=Kn,an[ln++]=is,is=t;var r=Qn;t=Kn;var s=32-En(r)-1;r&=~(1<<s),n+=1;var i=32-En(e)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,Qn=1<<32-En(e)+s|n<<s|r,Kn=i+t}else Qn=1<<i|n<<s|r,Kn=t}function Ld(t){t.return!==null&&(Qr(t,1),Qm(t,1,0))}function Od(t){for(;t===il;)il=Ns[--Ms],Ns[Ms]=null,ol=Ns[--Ms],Ns[Ms]=null;for(;t===is;)is=an[--ln],an[ln]=null,Kn=an[--ln],an[ln]=null,Qn=an[--ln],an[ln]=null}var tn=null,Jt=null,je=!1,Sn=null;function Km(t,e){var n=cn(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function cp(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,tn=t,Jt=Tr(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,tn=t,Jt=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=is!==null?{id:Qn,overflow:Kn}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=cn(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,tn=t,Jt=null,!0):!1;default:return!1}}function Cc(t){return(t.mode&1)!==0&&(t.flags&128)===0}function kc(t){if(je){var e=Jt;if(e){var n=e;if(!cp(t,e)){if(Cc(t))throw Error($(418));e=Tr(n.nextSibling);var r=tn;e&&cp(t,e)?Km(r,n):(t.flags=t.flags&-4097|2,je=!1,tn=t)}}else{if(Cc(t))throw Error($(418));t.flags=t.flags&-4097|2,je=!1,tn=t}}}function dp(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;tn=t}function xa(t){if(t!==tn)return!1;if(!je)return dp(t),je=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Ec(t.type,t.memoizedProps)),e&&(e=Jt)){if(Cc(t))throw Ym(),Error($(418));for(;e;)Km(t,e),e=Tr(e.nextSibling)}if(dp(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error($(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Jt=Tr(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Jt=null}}else Jt=tn?Tr(t.stateNode.nextSibling):null;return!0}function Ym(){for(var t=Jt;t;)t=Tr(t.nextSibling)}function Gs(){Jt=tn=null,je=!1}function Fd(t){Sn===null?Sn=[t]:Sn.push(t)}var $1=or.ReactCurrentBatchConfig;function Mi(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error($(309));var r=n.stateNode}if(!r)throw Error($(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var l=s.refs;o===null?delete l[i]:l[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error($(284));if(!n._owner)throw Error($(290,t))}return t}function wa(t,e){throw t=Object.prototype.toString.call(e),Error($(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function hp(t){var e=t._init;return e(t._payload)}function Xm(t){function e(C,I){if(t){var w=C.deletions;w===null?(C.deletions=[I],C.flags|=16):w.push(I)}}function n(C,I){if(!t)return null;for(;I!==null;)e(C,I),I=I.sibling;return null}function r(C,I){for(C=new Map;I!==null;)I.key!==null?C.set(I.key,I):C.set(I.index,I),I=I.sibling;return C}function s(C,I){return C=kr(C,I),C.index=0,C.sibling=null,C}function i(C,I,w){return C.index=w,t?(w=C.alternate,w!==null?(w=w.index,w<I?(C.flags|=2,I):w):(C.flags|=2,I)):(C.flags|=1048576,I)}function o(C){return t&&C.alternate===null&&(C.flags|=2),C}function l(C,I,w,b){return I===null||I.tag!==6?(I=$u(w,C.mode,b),I.return=C,I):(I=s(I,w),I.return=C,I)}function u(C,I,w,b){var V=w.type;return V===Cs?p(C,I,w.props.children,b,w.key):I!==null&&(I.elementType===V||typeof V=="object"&&V!==null&&V.$$typeof===pr&&hp(V)===I.type)?(b=s(I,w.props),b.ref=Mi(C,I,w),b.return=C,b):(b=Ba(w.type,w.key,w.props,null,C.mode,b),b.ref=Mi(C,I,w),b.return=C,b)}function h(C,I,w,b){return I===null||I.tag!==4||I.stateNode.containerInfo!==w.containerInfo||I.stateNode.implementation!==w.implementation?(I=Wu(w,C.mode,b),I.return=C,I):(I=s(I,w.children||[]),I.return=C,I)}function p(C,I,w,b,V){return I===null||I.tag!==7?(I=ns(w,C.mode,b,V),I.return=C,I):(I=s(I,w),I.return=C,I)}function g(C,I,w){if(typeof I=="string"&&I!==""||typeof I=="number")return I=$u(""+I,C.mode,w),I.return=C,I;if(typeof I=="object"&&I!==null){switch(I.$$typeof){case ca:return w=Ba(I.type,I.key,I.props,null,C.mode,w),w.ref=Mi(C,null,I),w.return=C,w;case As:return I=Wu(I,C.mode,w),I.return=C,I;case pr:var b=I._init;return g(C,b(I._payload),w)}if(Fi(I)||Ri(I))return I=ns(I,C.mode,w,null),I.return=C,I;wa(C,I)}return null}function v(C,I,w,b){var V=I!==null?I.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return V!==null?null:l(C,I,""+w,b);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case ca:return w.key===V?u(C,I,w,b):null;case As:return w.key===V?h(C,I,w,b):null;case pr:return V=w._init,v(C,I,V(w._payload),b)}if(Fi(w)||Ri(w))return V!==null?null:p(C,I,w,b,null);wa(C,w)}return null}function k(C,I,w,b,V){if(typeof b=="string"&&b!==""||typeof b=="number")return C=C.get(w)||null,l(I,C,""+b,V);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case ca:return C=C.get(b.key===null?w:b.key)||null,u(I,C,b,V);case As:return C=C.get(b.key===null?w:b.key)||null,h(I,C,b,V);case pr:var j=b._init;return k(C,I,w,j(b._payload),V)}if(Fi(b)||Ri(b))return C=C.get(w)||null,p(I,C,b,V,null);wa(I,b)}return null}function R(C,I,w,b){for(var V=null,j=null,T=I,_=I=0,m=null;T!==null&&_<w.length;_++){T.index>_?(m=T,T=null):m=T.sibling;var S=v(C,T,w[_],b);if(S===null){T===null&&(T=m);break}t&&T&&S.alternate===null&&e(C,T),I=i(S,I,_),j===null?V=S:j.sibling=S,j=S,T=m}if(_===w.length)return n(C,T),je&&Qr(C,_),V;if(T===null){for(;_<w.length;_++)T=g(C,w[_],b),T!==null&&(I=i(T,I,_),j===null?V=T:j.sibling=T,j=T);return je&&Qr(C,_),V}for(T=r(C,T);_<w.length;_++)m=k(T,C,_,w[_],b),m!==null&&(t&&m.alternate!==null&&T.delete(m.key===null?_:m.key),I=i(m,I,_),j===null?V=m:j.sibling=m,j=m);return t&&T.forEach(function(E){return e(C,E)}),je&&Qr(C,_),V}function P(C,I,w,b){var V=Ri(w);if(typeof V!="function")throw Error($(150));if(w=V.call(w),w==null)throw Error($(151));for(var j=V=null,T=I,_=I=0,m=null,S=w.next();T!==null&&!S.done;_++,S=w.next()){T.index>_?(m=T,T=null):m=T.sibling;var E=v(C,T,S.value,b);if(E===null){T===null&&(T=m);break}t&&T&&E.alternate===null&&e(C,T),I=i(E,I,_),j===null?V=E:j.sibling=E,j=E,T=m}if(S.done)return n(C,T),je&&Qr(C,_),V;if(T===null){for(;!S.done;_++,S=w.next())S=g(C,S.value,b),S!==null&&(I=i(S,I,_),j===null?V=S:j.sibling=S,j=S);return je&&Qr(C,_),V}for(T=r(C,T);!S.done;_++,S=w.next())S=k(T,C,_,S.value,b),S!==null&&(t&&S.alternate!==null&&T.delete(S.key===null?_:S.key),I=i(S,I,_),j===null?V=S:j.sibling=S,j=S);return t&&T.forEach(function(A){return e(C,A)}),je&&Qr(C,_),V}function O(C,I,w,b){if(typeof w=="object"&&w!==null&&w.type===Cs&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case ca:e:{for(var V=w.key,j=I;j!==null;){if(j.key===V){if(V=w.type,V===Cs){if(j.tag===7){n(C,j.sibling),I=s(j,w.props.children),I.return=C,C=I;break e}}else if(j.elementType===V||typeof V=="object"&&V!==null&&V.$$typeof===pr&&hp(V)===j.type){n(C,j.sibling),I=s(j,w.props),I.ref=Mi(C,j,w),I.return=C,C=I;break e}n(C,j);break}else e(C,j);j=j.sibling}w.type===Cs?(I=ns(w.props.children,C.mode,b,w.key),I.return=C,C=I):(b=Ba(w.type,w.key,w.props,null,C.mode,b),b.ref=Mi(C,I,w),b.return=C,C=b)}return o(C);case As:e:{for(j=w.key;I!==null;){if(I.key===j)if(I.tag===4&&I.stateNode.containerInfo===w.containerInfo&&I.stateNode.implementation===w.implementation){n(C,I.sibling),I=s(I,w.children||[]),I.return=C,C=I;break e}else{n(C,I);break}else e(C,I);I=I.sibling}I=Wu(w,C.mode,b),I.return=C,C=I}return o(C);case pr:return j=w._init,O(C,I,j(w._payload),b)}if(Fi(w))return R(C,I,w,b);if(Ri(w))return P(C,I,w,b);wa(C,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,I!==null&&I.tag===6?(n(C,I.sibling),I=s(I,w),I.return=C,C=I):(n(C,I),I=$u(w,C.mode,b),I.return=C,C=I),o(C)):n(C,I)}return O}var Qs=Xm(!0),Jm=Xm(!1),al=Fr(null),ll=null,Vs=null,zd=null;function Bd(){zd=Vs=ll=null}function Ud(t){var e=al.current;Ve(al),t._currentValue=e}function Rc(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Us(t,e){ll=t,zd=Vs=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Ft=!0),t.firstContext=null)}function fn(t){var e=t._currentValue;if(zd!==t)if(t={context:t,memoizedValue:e,next:null},Vs===null){if(ll===null)throw Error($(308));Vs=t,ll.dependencies={lanes:0,firstContext:t}}else Vs=Vs.next=t;return e}var Jr=null;function $d(t){Jr===null?Jr=[t]:Jr.push(t)}function Zm(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,$d(e)):(n.next=s.next,s.next=n),e.interleaved=n,tr(t,r)}function tr(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var gr=!1;function Wd(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function ey(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Yn(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Ir(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,ve&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,tr(t,n)}return s=r.interleaved,s===null?(e.next=e,$d(r)):(e.next=s.next,s.next=e),r.interleaved=e,tr(t,n)}function Va(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Rd(t,n)}}function fp(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function ul(t,e,n,r){var s=t.updateQueue;gr=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var u=l,h=u.next;u.next=null,o===null?i=h:o.next=h,o=u;var p=t.alternate;p!==null&&(p=p.updateQueue,l=p.lastBaseUpdate,l!==o&&(l===null?p.firstBaseUpdate=h:l.next=h,p.lastBaseUpdate=u))}if(i!==null){var g=s.baseState;o=0,p=h=u=null,l=i;do{var v=l.lane,k=l.eventTime;if((r&v)===v){p!==null&&(p=p.next={eventTime:k,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var R=t,P=l;switch(v=e,k=n,P.tag){case 1:if(R=P.payload,typeof R=="function"){g=R.call(k,g,v);break e}g=R;break e;case 3:R.flags=R.flags&-65537|128;case 0:if(R=P.payload,v=typeof R=="function"?R.call(k,g,v):R,v==null)break e;g=Be({},g,v);break e;case 2:gr=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,v=s.effects,v===null?s.effects=[l]:v.push(l))}else k={eventTime:k,lane:v,tag:l.tag,payload:l.payload,callback:l.callback,next:null},p===null?(h=p=k,u=g):p=p.next=k,o|=v;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;v=l,l=v.next,v.next=null,s.lastBaseUpdate=v,s.shared.pending=null}}while(!0);if(p===null&&(u=g),s.baseState=u,s.firstBaseUpdate=h,s.lastBaseUpdate=p,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);as|=o,t.lanes=o,t.memoizedState=g}}function pp(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error($(191,s));s.call(r)}}}var Oo={},Mn=Fr(Oo),vo=Fr(Oo),_o=Fr(Oo);function Zr(t){if(t===Oo)throw Error($(174));return t}function Hd(t,e){switch(be(_o,e),be(vo,t),be(Mn,Oo),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:uc(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=uc(e,t)}Ve(Mn),be(Mn,e)}function Ks(){Ve(Mn),Ve(vo),Ve(_o)}function ty(t){Zr(_o.current);var e=Zr(Mn.current),n=uc(e,t.type);e!==n&&(be(vo,t),be(Mn,n))}function qd(t){vo.current===t&&(Ve(Mn),Ve(vo))}var Fe=Fr(0);function cl(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Lu=[];function Gd(){for(var t=0;t<Lu.length;t++)Lu[t]._workInProgressVersionPrimary=null;Lu.length=0}var ja=or.ReactCurrentDispatcher,Ou=or.ReactCurrentBatchConfig,os=0,ze=null,rt=null,ut=null,dl=!1,Ji=!1,xo=0,W1=0;function St(){throw Error($(321))}function Qd(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!In(t[n],e[n]))return!1;return!0}function Kd(t,e,n,r,s,i){if(os=i,ze=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,ja.current=t===null||t.memoizedState===null?Q1:K1,t=n(r,s),Ji){i=0;do{if(Ji=!1,xo=0,25<=i)throw Error($(301));i+=1,ut=rt=null,e.updateQueue=null,ja.current=Y1,t=n(r,s)}while(Ji)}if(ja.current=hl,e=rt!==null&&rt.next!==null,os=0,ut=rt=ze=null,dl=!1,e)throw Error($(300));return t}function Yd(){var t=xo!==0;return xo=0,t}function bn(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ut===null?ze.memoizedState=ut=t:ut=ut.next=t,ut}function pn(){if(rt===null){var t=ze.alternate;t=t!==null?t.memoizedState:null}else t=rt.next;var e=ut===null?ze.memoizedState:ut.next;if(e!==null)ut=e,rt=t;else{if(t===null)throw Error($(310));rt=t,t={memoizedState:rt.memoizedState,baseState:rt.baseState,baseQueue:rt.baseQueue,queue:rt.queue,next:null},ut===null?ze.memoizedState=ut=t:ut=ut.next=t}return ut}function wo(t,e){return typeof e=="function"?e(t):e}function Fu(t){var e=pn(),n=e.queue;if(n===null)throw Error($(311));n.lastRenderedReducer=t;var r=rt,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var l=o=null,u=null,h=i;do{var p=h.lane;if((os&p)===p)u!==null&&(u=u.next={lane:0,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null}),r=h.hasEagerState?h.eagerState:t(r,h.action);else{var g={lane:p,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null};u===null?(l=u=g,o=r):u=u.next=g,ze.lanes|=p,as|=p}h=h.next}while(h!==null&&h!==i);u===null?o=r:u.next=l,In(r,e.memoizedState)||(Ft=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=u,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,ze.lanes|=i,as|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function zu(t){var e=pn(),n=e.queue;if(n===null)throw Error($(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=t(i,o.action),o=o.next;while(o!==s);In(i,e.memoizedState)||(Ft=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function ny(){}function ry(t,e){var n=ze,r=pn(),s=e(),i=!In(r.memoizedState,s);if(i&&(r.memoizedState=s,Ft=!0),r=r.queue,Xd(oy.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||ut!==null&&ut.memoizedState.tag&1){if(n.flags|=2048,So(9,iy.bind(null,n,r,s,e),void 0,null),ct===null)throw Error($(349));os&30||sy(n,e,s)}return s}function sy(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=ze.updateQueue,e===null?(e={lastEffect:null,stores:null},ze.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function iy(t,e,n,r){e.value=n,e.getSnapshot=r,ay(e)&&ly(t)}function oy(t,e,n){return n(function(){ay(e)&&ly(t)})}function ay(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!In(t,n)}catch{return!0}}function ly(t){var e=tr(t,1);e!==null&&Tn(e,t,1,-1)}function gp(t){var e=bn();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:wo,lastRenderedState:t},e.queue=t,t=t.dispatch=G1.bind(null,ze,t),[e.memoizedState,t]}function So(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=ze.updateQueue,e===null?(e={lastEffect:null,stores:null},ze.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function uy(){return pn().memoizedState}function La(t,e,n,r){var s=bn();ze.flags|=t,s.memoizedState=So(1|e,n,void 0,r===void 0?null:r)}function Ll(t,e,n,r){var s=pn();r=r===void 0?null:r;var i=void 0;if(rt!==null){var o=rt.memoizedState;if(i=o.destroy,r!==null&&Qd(r,o.deps)){s.memoizedState=So(e,n,i,r);return}}ze.flags|=t,s.memoizedState=So(1|e,n,i,r)}function mp(t,e){return La(8390656,8,t,e)}function Xd(t,e){return Ll(2048,8,t,e)}function cy(t,e){return Ll(4,2,t,e)}function dy(t,e){return Ll(4,4,t,e)}function hy(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function fy(t,e,n){return n=n!=null?n.concat([t]):null,Ll(4,4,hy.bind(null,e,t),n)}function Jd(){}function py(t,e){var n=pn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Qd(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function gy(t,e){var n=pn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Qd(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function my(t,e,n){return os&21?(In(n,e)||(n=wm(),ze.lanes|=n,as|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Ft=!0),t.memoizedState=n)}function H1(t,e){var n=Ee;Ee=n!==0&&4>n?n:4,t(!0);var r=Ou.transition;Ou.transition={};try{t(!1),e()}finally{Ee=n,Ou.transition=r}}function yy(){return pn().memoizedState}function q1(t,e,n){var r=Cr(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},vy(t))_y(e,n);else if(n=Zm(t,e,n,r),n!==null){var s=bt();Tn(n,t,r,s),xy(n,e,r)}}function G1(t,e,n){var r=Cr(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(vy(t))_y(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,l=i(o,n);if(s.hasEagerState=!0,s.eagerState=l,In(l,o)){var u=e.interleaved;u===null?(s.next=s,$d(e)):(s.next=u.next,u.next=s),e.interleaved=s;return}}catch{}finally{}n=Zm(t,e,s,r),n!==null&&(s=bt(),Tn(n,t,r,s),xy(n,e,r))}}function vy(t){var e=t.alternate;return t===ze||e!==null&&e===ze}function _y(t,e){Ji=dl=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function xy(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Rd(t,n)}}var hl={readContext:fn,useCallback:St,useContext:St,useEffect:St,useImperativeHandle:St,useInsertionEffect:St,useLayoutEffect:St,useMemo:St,useReducer:St,useRef:St,useState:St,useDebugValue:St,useDeferredValue:St,useTransition:St,useMutableSource:St,useSyncExternalStore:St,useId:St,unstable_isNewReconciler:!1},Q1={readContext:fn,useCallback:function(t,e){return bn().memoizedState=[t,e===void 0?null:e],t},useContext:fn,useEffect:mp,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,La(4194308,4,hy.bind(null,e,t),n)},useLayoutEffect:function(t,e){return La(4194308,4,t,e)},useInsertionEffect:function(t,e){return La(4,2,t,e)},useMemo:function(t,e){var n=bn();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=bn();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=q1.bind(null,ze,t),[r.memoizedState,t]},useRef:function(t){var e=bn();return t={current:t},e.memoizedState=t},useState:gp,useDebugValue:Jd,useDeferredValue:function(t){return bn().memoizedState=t},useTransition:function(){var t=gp(!1),e=t[0];return t=H1.bind(null,t[1]),bn().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=ze,s=bn();if(je){if(n===void 0)throw Error($(407));n=n()}else{if(n=e(),ct===null)throw Error($(349));os&30||sy(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,mp(oy.bind(null,r,i,t),[t]),r.flags|=2048,So(9,iy.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=bn(),e=ct.identifierPrefix;if(je){var n=Kn,r=Qn;n=(r&~(1<<32-En(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=xo++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=W1++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},K1={readContext:fn,useCallback:py,useContext:fn,useEffect:Xd,useImperativeHandle:fy,useInsertionEffect:cy,useLayoutEffect:dy,useMemo:gy,useReducer:Fu,useRef:uy,useState:function(){return Fu(wo)},useDebugValue:Jd,useDeferredValue:function(t){var e=pn();return my(e,rt.memoizedState,t)},useTransition:function(){var t=Fu(wo)[0],e=pn().memoizedState;return[t,e]},useMutableSource:ny,useSyncExternalStore:ry,useId:yy,unstable_isNewReconciler:!1},Y1={readContext:fn,useCallback:py,useContext:fn,useEffect:Xd,useImperativeHandle:fy,useInsertionEffect:cy,useLayoutEffect:dy,useMemo:gy,useReducer:zu,useRef:uy,useState:function(){return zu(wo)},useDebugValue:Jd,useDeferredValue:function(t){var e=pn();return rt===null?e.memoizedState=t:my(e,rt.memoizedState,t)},useTransition:function(){var t=zu(wo)[0],e=pn().memoizedState;return[t,e]},useMutableSource:ny,useSyncExternalStore:ry,useId:yy,unstable_isNewReconciler:!1};function xn(t,e){if(t&&t.defaultProps){e=Be({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Pc(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Be({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Ol={isMounted:function(t){return(t=t._reactInternals)?fs(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=bt(),s=Cr(t),i=Yn(r,s);i.payload=e,n!=null&&(i.callback=n),e=Ir(t,i,s),e!==null&&(Tn(e,t,s,r),Va(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=bt(),s=Cr(t),i=Yn(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=Ir(t,i,s),e!==null&&(Tn(e,t,s,r),Va(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=bt(),r=Cr(t),s=Yn(n,r);s.tag=2,e!=null&&(s.callback=e),e=Ir(t,s,r),e!==null&&(Tn(e,t,r,n),Va(e,t,r))}};function yp(t,e,n,r,s,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!po(n,r)||!po(s,i):!0}function wy(t,e,n){var r=!1,s=Mr,i=e.contextType;return typeof i=="object"&&i!==null?i=fn(i):(s=Bt(e)?ss:Ct.current,r=e.contextTypes,i=(r=r!=null)?qs(t,s):Mr),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Ol,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function vp(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Ol.enqueueReplaceState(e,e.state,null)}function bc(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},Wd(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=fn(i):(i=Bt(e)?ss:Ct.current,s.context=qs(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(Pc(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&Ol.enqueueReplaceState(s,s.state,null),ul(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function Ys(t,e){try{var n="",r=e;do n+=T_(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function Bu(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Dc(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var X1=typeof WeakMap=="function"?WeakMap:Map;function Sy(t,e,n){n=Yn(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){pl||(pl=!0,Uc=r),Dc(t,e)},n}function Ey(t,e,n){n=Yn(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){Dc(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){Dc(t,e),typeof r!="function"&&(Ar===null?Ar=new Set([this]):Ar.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function _p(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new X1;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=dx.bind(null,t,e,n),e.then(t,t))}function xp(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function wp(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Yn(-1,1),e.tag=2,Ir(n,e,1))),n.lanes|=1),t)}var J1=or.ReactCurrentOwner,Ft=!1;function Pt(t,e,n,r){e.child=t===null?Jm(e,null,n,r):Qs(e,t.child,n,r)}function Sp(t,e,n,r,s){n=n.render;var i=e.ref;return Us(e,s),r=Kd(t,e,n,r,i,s),n=Yd(),t!==null&&!Ft?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,nr(t,e,s)):(je&&n&&Ld(e),e.flags|=1,Pt(t,e,r,s),e.child)}function Ep(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!oh(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,Ty(t,e,i,r,s)):(t=Ba(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:po,n(o,r)&&t.ref===e.ref)return nr(t,e,s)}return e.flags|=1,t=kr(i,r),t.ref=e.ref,t.return=e,e.child=t}function Ty(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(po(i,r)&&t.ref===e.ref)if(Ft=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(Ft=!0);else return e.lanes=t.lanes,nr(t,e,s)}return Nc(t,e,n,r,s)}function Iy(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},be(Ls,Xt),Xt|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,be(Ls,Xt),Xt|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,be(Ls,Xt),Xt|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,be(Ls,Xt),Xt|=r;return Pt(t,e,s,n),e.child}function Ay(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Nc(t,e,n,r,s){var i=Bt(n)?ss:Ct.current;return i=qs(e,i),Us(e,s),n=Kd(t,e,n,r,i,s),r=Yd(),t!==null&&!Ft?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,nr(t,e,s)):(je&&r&&Ld(e),e.flags|=1,Pt(t,e,n,s),e.child)}function Tp(t,e,n,r,s){if(Bt(n)){var i=!0;sl(e)}else i=!1;if(Us(e,s),e.stateNode===null)Oa(t,e),wy(e,n,r),bc(e,n,r,s),r=!0;else if(t===null){var o=e.stateNode,l=e.memoizedProps;o.props=l;var u=o.context,h=n.contextType;typeof h=="object"&&h!==null?h=fn(h):(h=Bt(n)?ss:Ct.current,h=qs(e,h));var p=n.getDerivedStateFromProps,g=typeof p=="function"||typeof o.getSnapshotBeforeUpdate=="function";g||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==r||u!==h)&&vp(e,o,r,h),gr=!1;var v=e.memoizedState;o.state=v,ul(e,r,o,s),u=e.memoizedState,l!==r||v!==u||zt.current||gr?(typeof p=="function"&&(Pc(e,n,p,r),u=e.memoizedState),(l=gr||yp(e,n,l,r,v,u,h))?(g||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=u),o.props=r,o.state=u,o.context=h,r=l):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,ey(t,e),l=e.memoizedProps,h=e.type===e.elementType?l:xn(e.type,l),o.props=h,g=e.pendingProps,v=o.context,u=n.contextType,typeof u=="object"&&u!==null?u=fn(u):(u=Bt(n)?ss:Ct.current,u=qs(e,u));var k=n.getDerivedStateFromProps;(p=typeof k=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==g||v!==u)&&vp(e,o,r,u),gr=!1,v=e.memoizedState,o.state=v,ul(e,r,o,s);var R=e.memoizedState;l!==g||v!==R||zt.current||gr?(typeof k=="function"&&(Pc(e,n,k,r),R=e.memoizedState),(h=gr||yp(e,n,h,r,v,R,u)||!1)?(p||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,R,u),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,R,u)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&v===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&v===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=R),o.props=r,o.state=R,o.context=u,r=h):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&v===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&v===t.memoizedState||(e.flags|=1024),r=!1)}return Mc(t,e,n,r,i,s)}function Mc(t,e,n,r,s,i){Ay(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return s&&up(e,n,!1),nr(t,e,i);r=e.stateNode,J1.current=e;var l=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=Qs(e,t.child,null,i),e.child=Qs(e,null,l,i)):Pt(t,e,l,i),e.memoizedState=r.state,s&&up(e,n,!0),e.child}function Cy(t){var e=t.stateNode;e.pendingContext?lp(t,e.pendingContext,e.pendingContext!==e.context):e.context&&lp(t,e.context,!1),Hd(t,e.containerInfo)}function Ip(t,e,n,r,s){return Gs(),Fd(s),e.flags|=256,Pt(t,e,n,r),e.child}var Vc={dehydrated:null,treeContext:null,retryLane:0};function jc(t){return{baseLanes:t,cachePool:null,transitions:null}}function ky(t,e,n){var r=e.pendingProps,s=Fe.current,i=!1,o=(e.flags&128)!==0,l;if((l=o)||(l=t!==null&&t.memoizedState===null?!1:(s&2)!==0),l?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),be(Fe,s&1),t===null)return kc(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=Bl(o,r,0,null),t=ns(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=jc(n),e.memoizedState=Vc,t):Zd(e,o));if(s=t.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return Z1(t,e,o,r,l,s,n);if(i){i=r.fallback,o=e.mode,s=t.child,l=s.sibling;var u={mode:"hidden",children:r.children};return!(o&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=u,e.deletions=null):(r=kr(s,u),r.subtreeFlags=s.subtreeFlags&14680064),l!==null?i=kr(l,i):(i=ns(i,o,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=t.child.memoizedState,o=o===null?jc(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=Vc,r}return i=t.child,t=i.sibling,r=kr(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Zd(t,e){return e=Bl({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Sa(t,e,n,r){return r!==null&&Fd(r),Qs(e,t.child,null,n),t=Zd(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function Z1(t,e,n,r,s,i,o){if(n)return e.flags&256?(e.flags&=-257,r=Bu(Error($(422))),Sa(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=Bl({mode:"visible",children:r.children},s,0,null),i=ns(i,s,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&Qs(e,t.child,null,o),e.child.memoizedState=jc(o),e.memoizedState=Vc,i);if(!(e.mode&1))return Sa(t,e,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var l=r.dgst;return r=l,i=Error($(419)),r=Bu(i,r,void 0),Sa(t,e,o,r)}if(l=(o&t.childLanes)!==0,Ft||l){if(r=ct,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,tr(t,s),Tn(r,t,s,-1))}return ih(),r=Bu(Error($(421))),Sa(t,e,o,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=hx.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,Jt=Tr(s.nextSibling),tn=e,je=!0,Sn=null,t!==null&&(an[ln++]=Qn,an[ln++]=Kn,an[ln++]=is,Qn=t.id,Kn=t.overflow,is=e),e=Zd(e,r.children),e.flags|=4096,e)}function Ap(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Rc(t.return,e,n)}function Uu(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function Ry(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(Pt(t,e,r.children,n),r=Fe.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Ap(t,n,e);else if(t.tag===19)Ap(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(be(Fe,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&cl(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),Uu(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&cl(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}Uu(e,!0,n,null,i);break;case"together":Uu(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Oa(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function nr(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),as|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error($(153));if(e.child!==null){for(t=e.child,n=kr(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=kr(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function ex(t,e,n){switch(e.tag){case 3:Cy(e),Gs();break;case 5:ty(e);break;case 1:Bt(e.type)&&sl(e);break;case 4:Hd(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;be(al,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(be(Fe,Fe.current&1),e.flags|=128,null):n&e.child.childLanes?ky(t,e,n):(be(Fe,Fe.current&1),t=nr(t,e,n),t!==null?t.sibling:null);be(Fe,Fe.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return Ry(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),be(Fe,Fe.current),r)break;return null;case 22:case 23:return e.lanes=0,Iy(t,e,n)}return nr(t,e,n)}var Py,Lc,by,Dy;Py=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Lc=function(){};by=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,Zr(Mn.current);var i=null;switch(n){case"input":s=ic(t,s),r=ic(t,r),i=[];break;case"select":s=Be({},s,{value:void 0}),r=Be({},r,{value:void 0}),i=[];break;case"textarea":s=lc(t,s),r=lc(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=nl)}cc(n,r);var o;n=null;for(h in s)if(!r.hasOwnProperty(h)&&s.hasOwnProperty(h)&&s[h]!=null)if(h==="style"){var l=s[h];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else h!=="dangerouslySetInnerHTML"&&h!=="children"&&h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&h!=="autoFocus"&&(oo.hasOwnProperty(h)?i||(i=[]):(i=i||[]).push(h,null));for(h in r){var u=r[h];if(l=s!=null?s[h]:void 0,r.hasOwnProperty(h)&&u!==l&&(u!=null||l!=null))if(h==="style")if(l){for(o in l)!l.hasOwnProperty(o)||u&&u.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in u)u.hasOwnProperty(o)&&l[o]!==u[o]&&(n||(n={}),n[o]=u[o])}else n||(i||(i=[]),i.push(h,n)),n=u;else h==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,l=l?l.__html:void 0,u!=null&&l!==u&&(i=i||[]).push(h,u)):h==="children"?typeof u!="string"&&typeof u!="number"||(i=i||[]).push(h,""+u):h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&(oo.hasOwnProperty(h)?(u!=null&&h==="onScroll"&&Ne("scroll",t),i||l===u||(i=[])):(i=i||[]).push(h,u))}n&&(i=i||[]).push("style",n);var h=i;(e.updateQueue=h)&&(e.flags|=4)}};Dy=function(t,e,n,r){n!==r&&(e.flags|=4)};function Vi(t,e){if(!je)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Et(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function tx(t,e,n){var r=e.pendingProps;switch(Od(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Et(e),null;case 1:return Bt(e.type)&&rl(),Et(e),null;case 3:return r=e.stateNode,Ks(),Ve(zt),Ve(Ct),Gd(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(xa(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Sn!==null&&(Hc(Sn),Sn=null))),Lc(t,e),Et(e),null;case 5:qd(e);var s=Zr(_o.current);if(n=e.type,t!==null&&e.stateNode!=null)by(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error($(166));return Et(e),null}if(t=Zr(Mn.current),xa(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[Dn]=e,r[yo]=i,t=(e.mode&1)!==0,n){case"dialog":Ne("cancel",r),Ne("close",r);break;case"iframe":case"object":case"embed":Ne("load",r);break;case"video":case"audio":for(s=0;s<Bi.length;s++)Ne(Bi[s],r);break;case"source":Ne("error",r);break;case"img":case"image":case"link":Ne("error",r),Ne("load",r);break;case"details":Ne("toggle",r);break;case"input":Vf(r,i),Ne("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Ne("invalid",r);break;case"textarea":Lf(r,i),Ne("invalid",r)}cc(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var l=i[o];o==="children"?typeof l=="string"?r.textContent!==l&&(i.suppressHydrationWarning!==!0&&_a(r.textContent,l,t),s=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&_a(r.textContent,l,t),s=["children",""+l]):oo.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&Ne("scroll",r)}switch(n){case"input":da(r),jf(r,i,!0);break;case"textarea":da(r),Of(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=nl)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=om(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[Dn]=e,t[yo]=r,Py(t,e,!1,!1),e.stateNode=t;e:{switch(o=dc(n,r),n){case"dialog":Ne("cancel",t),Ne("close",t),s=r;break;case"iframe":case"object":case"embed":Ne("load",t),s=r;break;case"video":case"audio":for(s=0;s<Bi.length;s++)Ne(Bi[s],t);s=r;break;case"source":Ne("error",t),s=r;break;case"img":case"image":case"link":Ne("error",t),Ne("load",t),s=r;break;case"details":Ne("toggle",t),s=r;break;case"input":Vf(t,r),s=ic(t,r),Ne("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=Be({},r,{value:void 0}),Ne("invalid",t);break;case"textarea":Lf(t,r),s=lc(t,r),Ne("invalid",t);break;default:s=r}cc(n,s),l=s;for(i in l)if(l.hasOwnProperty(i)){var u=l[i];i==="style"?um(t,u):i==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&am(t,u)):i==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&ao(t,u):typeof u=="number"&&ao(t,""+u):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(oo.hasOwnProperty(i)?u!=null&&i==="onScroll"&&Ne("scroll",t):u!=null&&Ed(t,i,u,o))}switch(n){case"input":da(t),jf(t,r,!1);break;case"textarea":da(t),Of(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Nr(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?Os(t,!!r.multiple,i,!1):r.defaultValue!=null&&Os(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=nl)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Et(e),null;case 6:if(t&&e.stateNode!=null)Dy(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error($(166));if(n=Zr(_o.current),Zr(Mn.current),xa(e)){if(r=e.stateNode,n=e.memoizedProps,r[Dn]=e,(i=r.nodeValue!==n)&&(t=tn,t!==null))switch(t.tag){case 3:_a(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&_a(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Dn]=e,e.stateNode=r}return Et(e),null;case 13:if(Ve(Fe),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(je&&Jt!==null&&e.mode&1&&!(e.flags&128))Ym(),Gs(),e.flags|=98560,i=!1;else if(i=xa(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error($(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error($(317));i[Dn]=e}else Gs(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Et(e),i=!1}else Sn!==null&&(Hc(Sn),Sn=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Fe.current&1?st===0&&(st=3):ih())),e.updateQueue!==null&&(e.flags|=4),Et(e),null);case 4:return Ks(),Lc(t,e),t===null&&go(e.stateNode.containerInfo),Et(e),null;case 10:return Ud(e.type._context),Et(e),null;case 17:return Bt(e.type)&&rl(),Et(e),null;case 19:if(Ve(Fe),i=e.memoizedState,i===null)return Et(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)Vi(i,!1);else{if(st!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=cl(t),o!==null){for(e.flags|=128,Vi(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return be(Fe,Fe.current&1|2),e.child}t=t.sibling}i.tail!==null&&Ke()>Xs&&(e.flags|=128,r=!0,Vi(i,!1),e.lanes=4194304)}else{if(!r)if(t=cl(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Vi(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!je)return Et(e),null}else 2*Ke()-i.renderingStartTime>Xs&&n!==1073741824&&(e.flags|=128,r=!0,Vi(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Ke(),e.sibling=null,n=Fe.current,be(Fe,r?n&1|2:n&1),e):(Et(e),null);case 22:case 23:return sh(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Xt&1073741824&&(Et(e),e.subtreeFlags&6&&(e.flags|=8192)):Et(e),null;case 24:return null;case 25:return null}throw Error($(156,e.tag))}function nx(t,e){switch(Od(e),e.tag){case 1:return Bt(e.type)&&rl(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Ks(),Ve(zt),Ve(Ct),Gd(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return qd(e),null;case 13:if(Ve(Fe),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error($(340));Gs()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Ve(Fe),null;case 4:return Ks(),null;case 10:return Ud(e.type._context),null;case 22:case 23:return sh(),null;case 24:return null;default:return null}}var Ea=!1,It=!1,rx=typeof WeakSet=="function"?WeakSet:Set,J=null;function js(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){qe(t,e,r)}else n.current=null}function Oc(t,e,n){try{n()}catch(r){qe(t,e,r)}}var Cp=!1;function sx(t,e){if(wc=Za,t=Lm(),jd(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,l=-1,u=-1,h=0,p=0,g=t,v=null;t:for(;;){for(var k;g!==n||s!==0&&g.nodeType!==3||(l=o+s),g!==i||r!==0&&g.nodeType!==3||(u=o+r),g.nodeType===3&&(o+=g.nodeValue.length),(k=g.firstChild)!==null;)v=g,g=k;for(;;){if(g===t)break t;if(v===n&&++h===s&&(l=o),v===i&&++p===r&&(u=o),(k=g.nextSibling)!==null)break;g=v,v=g.parentNode}g=k}n=l===-1||u===-1?null:{start:l,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(Sc={focusedElem:t,selectionRange:n},Za=!1,J=e;J!==null;)if(e=J,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,J=t;else for(;J!==null;){e=J;try{var R=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(R!==null){var P=R.memoizedProps,O=R.memoizedState,C=e.stateNode,I=C.getSnapshotBeforeUpdate(e.elementType===e.type?P:xn(e.type,P),O);C.__reactInternalSnapshotBeforeUpdate=I}break;case 3:var w=e.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error($(163))}}catch(b){qe(e,e.return,b)}if(t=e.sibling,t!==null){t.return=e.return,J=t;break}J=e.return}return R=Cp,Cp=!1,R}function Zi(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&Oc(e,n,i)}s=s.next}while(s!==r)}}function Fl(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Fc(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function Ny(t){var e=t.alternate;e!==null&&(t.alternate=null,Ny(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Dn],delete e[yo],delete e[Ic],delete e[z1],delete e[B1])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function My(t){return t.tag===5||t.tag===3||t.tag===4}function kp(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||My(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function zc(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=nl));else if(r!==4&&(t=t.child,t!==null))for(zc(t,e,n),t=t.sibling;t!==null;)zc(t,e,n),t=t.sibling}function Bc(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Bc(t,e,n),t=t.sibling;t!==null;)Bc(t,e,n),t=t.sibling}var ht=null,wn=!1;function fr(t,e,n){for(n=n.child;n!==null;)Vy(t,e,n),n=n.sibling}function Vy(t,e,n){if(Nn&&typeof Nn.onCommitFiberUnmount=="function")try{Nn.onCommitFiberUnmount(bl,n)}catch{}switch(n.tag){case 5:It||js(n,e);case 6:var r=ht,s=wn;ht=null,fr(t,e,n),ht=r,wn=s,ht!==null&&(wn?(t=ht,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):ht.removeChild(n.stateNode));break;case 18:ht!==null&&(wn?(t=ht,n=n.stateNode,t.nodeType===8?Vu(t.parentNode,n):t.nodeType===1&&Vu(t,n),ho(t)):Vu(ht,n.stateNode));break;case 4:r=ht,s=wn,ht=n.stateNode.containerInfo,wn=!0,fr(t,e,n),ht=r,wn=s;break;case 0:case 11:case 14:case 15:if(!It&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&Oc(n,e,o),s=s.next}while(s!==r)}fr(t,e,n);break;case 1:if(!It&&(js(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){qe(n,e,l)}fr(t,e,n);break;case 21:fr(t,e,n);break;case 22:n.mode&1?(It=(r=It)||n.memoizedState!==null,fr(t,e,n),It=r):fr(t,e,n);break;default:fr(t,e,n)}}function Rp(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new rx),e.forEach(function(r){var s=fx.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function _n(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,o=e,l=o;e:for(;l!==null;){switch(l.tag){case 5:ht=l.stateNode,wn=!1;break e;case 3:ht=l.stateNode.containerInfo,wn=!0;break e;case 4:ht=l.stateNode.containerInfo,wn=!0;break e}l=l.return}if(ht===null)throw Error($(160));Vy(i,o,s),ht=null,wn=!1;var u=s.alternate;u!==null&&(u.return=null),s.return=null}catch(h){qe(s,e,h)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)jy(e,t),e=e.sibling}function jy(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(_n(e,t),Pn(t),r&4){try{Zi(3,t,t.return),Fl(3,t)}catch(P){qe(t,t.return,P)}try{Zi(5,t,t.return)}catch(P){qe(t,t.return,P)}}break;case 1:_n(e,t),Pn(t),r&512&&n!==null&&js(n,n.return);break;case 5:if(_n(e,t),Pn(t),r&512&&n!==null&&js(n,n.return),t.flags&32){var s=t.stateNode;try{ao(s,"")}catch(P){qe(t,t.return,P)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,l=t.type,u=t.updateQueue;if(t.updateQueue=null,u!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&sm(s,i),dc(l,o);var h=dc(l,i);for(o=0;o<u.length;o+=2){var p=u[o],g=u[o+1];p==="style"?um(s,g):p==="dangerouslySetInnerHTML"?am(s,g):p==="children"?ao(s,g):Ed(s,p,g,h)}switch(l){case"input":oc(s,i);break;case"textarea":im(s,i);break;case"select":var v=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var k=i.value;k!=null?Os(s,!!i.multiple,k,!1):v!==!!i.multiple&&(i.defaultValue!=null?Os(s,!!i.multiple,i.defaultValue,!0):Os(s,!!i.multiple,i.multiple?[]:"",!1))}s[yo]=i}catch(P){qe(t,t.return,P)}}break;case 6:if(_n(e,t),Pn(t),r&4){if(t.stateNode===null)throw Error($(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(P){qe(t,t.return,P)}}break;case 3:if(_n(e,t),Pn(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{ho(e.containerInfo)}catch(P){qe(t,t.return,P)}break;case 4:_n(e,t),Pn(t);break;case 13:_n(e,t),Pn(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(nh=Ke())),r&4&&Rp(t);break;case 22:if(p=n!==null&&n.memoizedState!==null,t.mode&1?(It=(h=It)||p,_n(e,t),It=h):_n(e,t),Pn(t),r&8192){if(h=t.memoizedState!==null,(t.stateNode.isHidden=h)&&!p&&t.mode&1)for(J=t,p=t.child;p!==null;){for(g=J=p;J!==null;){switch(v=J,k=v.child,v.tag){case 0:case 11:case 14:case 15:Zi(4,v,v.return);break;case 1:js(v,v.return);var R=v.stateNode;if(typeof R.componentWillUnmount=="function"){r=v,n=v.return;try{e=r,R.props=e.memoizedProps,R.state=e.memoizedState,R.componentWillUnmount()}catch(P){qe(r,n,P)}}break;case 5:js(v,v.return);break;case 22:if(v.memoizedState!==null){bp(g);continue}}k!==null?(k.return=v,J=k):bp(g)}p=p.sibling}e:for(p=null,g=t;;){if(g.tag===5){if(p===null){p=g;try{s=g.stateNode,h?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=g.stateNode,u=g.memoizedProps.style,o=u!=null&&u.hasOwnProperty("display")?u.display:null,l.style.display=lm("display",o))}catch(P){qe(t,t.return,P)}}}else if(g.tag===6){if(p===null)try{g.stateNode.nodeValue=h?"":g.memoizedProps}catch(P){qe(t,t.return,P)}}else if((g.tag!==22&&g.tag!==23||g.memoizedState===null||g===t)&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===t)break e;for(;g.sibling===null;){if(g.return===null||g.return===t)break e;p===g&&(p=null),g=g.return}p===g&&(p=null),g.sibling.return=g.return,g=g.sibling}}break;case 19:_n(e,t),Pn(t),r&4&&Rp(t);break;case 21:break;default:_n(e,t),Pn(t)}}function Pn(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(My(n)){var r=n;break e}n=n.return}throw Error($(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(ao(s,""),r.flags&=-33);var i=kp(t);Bc(t,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,l=kp(t);zc(t,l,o);break;default:throw Error($(161))}}catch(u){qe(t,t.return,u)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function ix(t,e,n){J=t,Ly(t)}function Ly(t,e,n){for(var r=(t.mode&1)!==0;J!==null;){var s=J,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||Ea;if(!o){var l=s.alternate,u=l!==null&&l.memoizedState!==null||It;l=Ea;var h=It;if(Ea=o,(It=u)&&!h)for(J=s;J!==null;)o=J,u=o.child,o.tag===22&&o.memoizedState!==null?Dp(s):u!==null?(u.return=o,J=u):Dp(s);for(;i!==null;)J=i,Ly(i),i=i.sibling;J=s,Ea=l,It=h}Pp(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,J=i):Pp(t)}}function Pp(t){for(;J!==null;){var e=J;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:It||Fl(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!It)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:xn(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&pp(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}pp(e,o,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var u=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var h=e.alternate;if(h!==null){var p=h.memoizedState;if(p!==null){var g=p.dehydrated;g!==null&&ho(g)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error($(163))}It||e.flags&512&&Fc(e)}catch(v){qe(e,e.return,v)}}if(e===t){J=null;break}if(n=e.sibling,n!==null){n.return=e.return,J=n;break}J=e.return}}function bp(t){for(;J!==null;){var e=J;if(e===t){J=null;break}var n=e.sibling;if(n!==null){n.return=e.return,J=n;break}J=e.return}}function Dp(t){for(;J!==null;){var e=J;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Fl(4,e)}catch(u){qe(e,n,u)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(u){qe(e,s,u)}}var i=e.return;try{Fc(e)}catch(u){qe(e,i,u)}break;case 5:var o=e.return;try{Fc(e)}catch(u){qe(e,o,u)}}}catch(u){qe(e,e.return,u)}if(e===t){J=null;break}var l=e.sibling;if(l!==null){l.return=e.return,J=l;break}J=e.return}}var ox=Math.ceil,fl=or.ReactCurrentDispatcher,eh=or.ReactCurrentOwner,dn=or.ReactCurrentBatchConfig,ve=0,ct=null,Je=null,gt=0,Xt=0,Ls=Fr(0),st=0,Eo=null,as=0,zl=0,th=0,eo=null,Lt=null,nh=0,Xs=1/0,Wn=null,pl=!1,Uc=null,Ar=null,Ta=!1,_r=null,gl=0,to=0,$c=null,Fa=-1,za=0;function bt(){return ve&6?Ke():Fa!==-1?Fa:Fa=Ke()}function Cr(t){return t.mode&1?ve&2&&gt!==0?gt&-gt:$1.transition!==null?(za===0&&(za=wm()),za):(t=Ee,t!==0||(t=window.event,t=t===void 0?16:km(t.type)),t):1}function Tn(t,e,n,r){if(50<to)throw to=0,$c=null,Error($(185));Vo(t,n,r),(!(ve&2)||t!==ct)&&(t===ct&&(!(ve&2)&&(zl|=n),st===4&&yr(t,gt)),Ut(t,r),n===1&&ve===0&&!(e.mode&1)&&(Xs=Ke()+500,jl&&zr()))}function Ut(t,e){var n=t.callbackNode;$_(t,e);var r=Ja(t,t===ct?gt:0);if(r===0)n!==null&&Bf(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&Bf(n),e===1)t.tag===0?U1(Np.bind(null,t)):Gm(Np.bind(null,t)),O1(function(){!(ve&6)&&zr()}),n=null;else{switch(Sm(r)){case 1:n=kd;break;case 4:n=_m;break;case 16:n=Xa;break;case 536870912:n=xm;break;default:n=Xa}n=Hy(n,Oy.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function Oy(t,e){if(Fa=-1,za=0,ve&6)throw Error($(327));var n=t.callbackNode;if($s()&&t.callbackNode!==n)return null;var r=Ja(t,t===ct?gt:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=ml(t,r);else{e=r;var s=ve;ve|=2;var i=zy();(ct!==t||gt!==e)&&(Wn=null,Xs=Ke()+500,ts(t,e));do try{ux();break}catch(l){Fy(t,l)}while(!0);Bd(),fl.current=i,ve=s,Je!==null?e=0:(ct=null,gt=0,e=st)}if(e!==0){if(e===2&&(s=mc(t),s!==0&&(r=s,e=Wc(t,s))),e===1)throw n=Eo,ts(t,0),yr(t,r),Ut(t,Ke()),n;if(e===6)yr(t,r);else{if(s=t.current.alternate,!(r&30)&&!ax(s)&&(e=ml(t,r),e===2&&(i=mc(t),i!==0&&(r=i,e=Wc(t,i))),e===1))throw n=Eo,ts(t,0),yr(t,r),Ut(t,Ke()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error($(345));case 2:Kr(t,Lt,Wn);break;case 3:if(yr(t,r),(r&130023424)===r&&(e=nh+500-Ke(),10<e)){if(Ja(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){bt(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=Tc(Kr.bind(null,t,Lt,Wn),e);break}Kr(t,Lt,Wn);break;case 4:if(yr(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var o=31-En(r);i=1<<o,o=e[o],o>s&&(s=o),r&=~i}if(r=s,r=Ke()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*ox(r/1960))-r,10<r){t.timeoutHandle=Tc(Kr.bind(null,t,Lt,Wn),r);break}Kr(t,Lt,Wn);break;case 5:Kr(t,Lt,Wn);break;default:throw Error($(329))}}}return Ut(t,Ke()),t.callbackNode===n?Oy.bind(null,t):null}function Wc(t,e){var n=eo;return t.current.memoizedState.isDehydrated&&(ts(t,e).flags|=256),t=ml(t,e),t!==2&&(e=Lt,Lt=n,e!==null&&Hc(e)),t}function Hc(t){Lt===null?Lt=t:Lt.push.apply(Lt,t)}function ax(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!In(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function yr(t,e){for(e&=~th,e&=~zl,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-En(e),r=1<<n;t[n]=-1,e&=~r}}function Np(t){if(ve&6)throw Error($(327));$s();var e=Ja(t,0);if(!(e&1))return Ut(t,Ke()),null;var n=ml(t,e);if(t.tag!==0&&n===2){var r=mc(t);r!==0&&(e=r,n=Wc(t,r))}if(n===1)throw n=Eo,ts(t,0),yr(t,e),Ut(t,Ke()),n;if(n===6)throw Error($(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Kr(t,Lt,Wn),Ut(t,Ke()),null}function rh(t,e){var n=ve;ve|=1;try{return t(e)}finally{ve=n,ve===0&&(Xs=Ke()+500,jl&&zr())}}function ls(t){_r!==null&&_r.tag===0&&!(ve&6)&&$s();var e=ve;ve|=1;var n=dn.transition,r=Ee;try{if(dn.transition=null,Ee=1,t)return t()}finally{Ee=r,dn.transition=n,ve=e,!(ve&6)&&zr()}}function sh(){Xt=Ls.current,Ve(Ls)}function ts(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,L1(n)),Je!==null)for(n=Je.return;n!==null;){var r=n;switch(Od(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&rl();break;case 3:Ks(),Ve(zt),Ve(Ct),Gd();break;case 5:qd(r);break;case 4:Ks();break;case 13:Ve(Fe);break;case 19:Ve(Fe);break;case 10:Ud(r.type._context);break;case 22:case 23:sh()}n=n.return}if(ct=t,Je=t=kr(t.current,null),gt=Xt=e,st=0,Eo=null,th=zl=as=0,Lt=eo=null,Jr!==null){for(e=0;e<Jr.length;e++)if(n=Jr[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}Jr=null}return t}function Fy(t,e){do{var n=Je;try{if(Bd(),ja.current=hl,dl){for(var r=ze.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}dl=!1}if(os=0,ut=rt=ze=null,Ji=!1,xo=0,eh.current=null,n===null||n.return===null){st=1,Eo=e,Je=null;break}e:{var i=t,o=n.return,l=n,u=e;if(e=gt,l.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var h=u,p=l,g=p.tag;if(!(p.mode&1)&&(g===0||g===11||g===15)){var v=p.alternate;v?(p.updateQueue=v.updateQueue,p.memoizedState=v.memoizedState,p.lanes=v.lanes):(p.updateQueue=null,p.memoizedState=null)}var k=xp(o);if(k!==null){k.flags&=-257,wp(k,o,l,i,e),k.mode&1&&_p(i,h,e),e=k,u=h;var R=e.updateQueue;if(R===null){var P=new Set;P.add(u),e.updateQueue=P}else R.add(u);break e}else{if(!(e&1)){_p(i,h,e),ih();break e}u=Error($(426))}}else if(je&&l.mode&1){var O=xp(o);if(O!==null){!(O.flags&65536)&&(O.flags|=256),wp(O,o,l,i,e),Fd(Ys(u,l));break e}}i=u=Ys(u,l),st!==4&&(st=2),eo===null?eo=[i]:eo.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var C=Sy(i,u,e);fp(i,C);break e;case 1:l=u;var I=i.type,w=i.stateNode;if(!(i.flags&128)&&(typeof I.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(Ar===null||!Ar.has(w)))){i.flags|=65536,e&=-e,i.lanes|=e;var b=Ey(i,l,e);fp(i,b);break e}}i=i.return}while(i!==null)}Uy(n)}catch(V){e=V,Je===n&&n!==null&&(Je=n=n.return);continue}break}while(!0)}function zy(){var t=fl.current;return fl.current=hl,t===null?hl:t}function ih(){(st===0||st===3||st===2)&&(st=4),ct===null||!(as&268435455)&&!(zl&268435455)||yr(ct,gt)}function ml(t,e){var n=ve;ve|=2;var r=zy();(ct!==t||gt!==e)&&(Wn=null,ts(t,e));do try{lx();break}catch(s){Fy(t,s)}while(!0);if(Bd(),ve=n,fl.current=r,Je!==null)throw Error($(261));return ct=null,gt=0,st}function lx(){for(;Je!==null;)By(Je)}function ux(){for(;Je!==null&&!M_();)By(Je)}function By(t){var e=Wy(t.alternate,t,Xt);t.memoizedProps=t.pendingProps,e===null?Uy(t):Je=e,eh.current=null}function Uy(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=nx(n,e),n!==null){n.flags&=32767,Je=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{st=6,Je=null;return}}else if(n=tx(n,e,Xt),n!==null){Je=n;return}if(e=e.sibling,e!==null){Je=e;return}Je=e=t}while(e!==null);st===0&&(st=5)}function Kr(t,e,n){var r=Ee,s=dn.transition;try{dn.transition=null,Ee=1,cx(t,e,n,r)}finally{dn.transition=s,Ee=r}return null}function cx(t,e,n,r){do $s();while(_r!==null);if(ve&6)throw Error($(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error($(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(W_(t,i),t===ct&&(Je=ct=null,gt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Ta||(Ta=!0,Hy(Xa,function(){return $s(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=dn.transition,dn.transition=null;var o=Ee;Ee=1;var l=ve;ve|=4,eh.current=null,sx(t,n),jy(n,t),P1(Sc),Za=!!wc,Sc=wc=null,t.current=n,ix(n),V_(),ve=l,Ee=o,dn.transition=i}else t.current=n;if(Ta&&(Ta=!1,_r=t,gl=s),i=t.pendingLanes,i===0&&(Ar=null),O_(n.stateNode),Ut(t,Ke()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(pl)throw pl=!1,t=Uc,Uc=null,t;return gl&1&&t.tag!==0&&$s(),i=t.pendingLanes,i&1?t===$c?to++:(to=0,$c=t):to=0,zr(),null}function $s(){if(_r!==null){var t=Sm(gl),e=dn.transition,n=Ee;try{if(dn.transition=null,Ee=16>t?16:t,_r===null)var r=!1;else{if(t=_r,_r=null,gl=0,ve&6)throw Error($(331));var s=ve;for(ve|=4,J=t.current;J!==null;){var i=J,o=i.child;if(J.flags&16){var l=i.deletions;if(l!==null){for(var u=0;u<l.length;u++){var h=l[u];for(J=h;J!==null;){var p=J;switch(p.tag){case 0:case 11:case 15:Zi(8,p,i)}var g=p.child;if(g!==null)g.return=p,J=g;else for(;J!==null;){p=J;var v=p.sibling,k=p.return;if(Ny(p),p===h){J=null;break}if(v!==null){v.return=k,J=v;break}J=k}}}var R=i.alternate;if(R!==null){var P=R.child;if(P!==null){R.child=null;do{var O=P.sibling;P.sibling=null,P=O}while(P!==null)}}J=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,J=o;else e:for(;J!==null;){if(i=J,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Zi(9,i,i.return)}var C=i.sibling;if(C!==null){C.return=i.return,J=C;break e}J=i.return}}var I=t.current;for(J=I;J!==null;){o=J;var w=o.child;if(o.subtreeFlags&2064&&w!==null)w.return=o,J=w;else e:for(o=I;J!==null;){if(l=J,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Fl(9,l)}}catch(V){qe(l,l.return,V)}if(l===o){J=null;break e}var b=l.sibling;if(b!==null){b.return=l.return,J=b;break e}J=l.return}}if(ve=s,zr(),Nn&&typeof Nn.onPostCommitFiberRoot=="function")try{Nn.onPostCommitFiberRoot(bl,t)}catch{}r=!0}return r}finally{Ee=n,dn.transition=e}}return!1}function Mp(t,e,n){e=Ys(n,e),e=Sy(t,e,1),t=Ir(t,e,1),e=bt(),t!==null&&(Vo(t,1,e),Ut(t,e))}function qe(t,e,n){if(t.tag===3)Mp(t,t,n);else for(;e!==null;){if(e.tag===3){Mp(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Ar===null||!Ar.has(r))){t=Ys(n,t),t=Ey(e,t,1),e=Ir(e,t,1),t=bt(),e!==null&&(Vo(e,1,t),Ut(e,t));break}}e=e.return}}function dx(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=bt(),t.pingedLanes|=t.suspendedLanes&n,ct===t&&(gt&n)===n&&(st===4||st===3&&(gt&130023424)===gt&&500>Ke()-nh?ts(t,0):th|=n),Ut(t,e)}function $y(t,e){e===0&&(t.mode&1?(e=pa,pa<<=1,!(pa&130023424)&&(pa=4194304)):e=1);var n=bt();t=tr(t,e),t!==null&&(Vo(t,e,n),Ut(t,n))}function hx(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),$y(t,n)}function fx(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error($(314))}r!==null&&r.delete(e),$y(t,n)}var Wy;Wy=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||zt.current)Ft=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Ft=!1,ex(t,e,n);Ft=!!(t.flags&131072)}else Ft=!1,je&&e.flags&1048576&&Qm(e,ol,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Oa(t,e),t=e.pendingProps;var s=qs(e,Ct.current);Us(e,n),s=Kd(null,e,r,t,s,n);var i=Yd();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Bt(r)?(i=!0,sl(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Wd(e),s.updater=Ol,e.stateNode=s,s._reactInternals=e,bc(e,r,t,n),e=Mc(null,e,r,!0,i,n)):(e.tag=0,je&&i&&Ld(e),Pt(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Oa(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=gx(r),t=xn(r,t),s){case 0:e=Nc(null,e,r,t,n);break e;case 1:e=Tp(null,e,r,t,n);break e;case 11:e=Sp(null,e,r,t,n);break e;case 14:e=Ep(null,e,r,xn(r.type,t),n);break e}throw Error($(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:xn(r,s),Nc(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:xn(r,s),Tp(t,e,r,s,n);case 3:e:{if(Cy(e),t===null)throw Error($(387));r=e.pendingProps,i=e.memoizedState,s=i.element,ey(t,e),ul(e,r,null,n);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=Ys(Error($(423)),e),e=Ip(t,e,r,n,s);break e}else if(r!==s){s=Ys(Error($(424)),e),e=Ip(t,e,r,n,s);break e}else for(Jt=Tr(e.stateNode.containerInfo.firstChild),tn=e,je=!0,Sn=null,n=Jm(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Gs(),r===s){e=nr(t,e,n);break e}Pt(t,e,r,n)}e=e.child}return e;case 5:return ty(e),t===null&&kc(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,o=s.children,Ec(r,s)?o=null:i!==null&&Ec(r,i)&&(e.flags|=32),Ay(t,e),Pt(t,e,o,n),e.child;case 6:return t===null&&kc(e),null;case 13:return ky(t,e,n);case 4:return Hd(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Qs(e,null,r,n):Pt(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:xn(r,s),Sp(t,e,r,s,n);case 7:return Pt(t,e,e.pendingProps,n),e.child;case 8:return Pt(t,e,e.pendingProps.children,n),e.child;case 12:return Pt(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,be(al,r._currentValue),r._currentValue=o,i!==null)if(In(i.value,o)){if(i.children===s.children&&!zt.current){e=nr(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var l=i.dependencies;if(l!==null){o=i.child;for(var u=l.firstContext;u!==null;){if(u.context===r){if(i.tag===1){u=Yn(-1,n&-n),u.tag=2;var h=i.updateQueue;if(h!==null){h=h.shared;var p=h.pending;p===null?u.next=u:(u.next=p.next,p.next=u),h.pending=u}}i.lanes|=n,u=i.alternate,u!==null&&(u.lanes|=n),Rc(i.return,n,e),l.lanes|=n;break}u=u.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error($(341));o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),Rc(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}Pt(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,Us(e,n),s=fn(s),r=r(s),e.flags|=1,Pt(t,e,r,n),e.child;case 14:return r=e.type,s=xn(r,e.pendingProps),s=xn(r.type,s),Ep(t,e,r,s,n);case 15:return Ty(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:xn(r,s),Oa(t,e),e.tag=1,Bt(r)?(t=!0,sl(e)):t=!1,Us(e,n),wy(e,r,s),bc(e,r,s,n),Mc(null,e,r,!0,t,n);case 19:return Ry(t,e,n);case 22:return Iy(t,e,n)}throw Error($(156,e.tag))};function Hy(t,e){return vm(t,e)}function px(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function cn(t,e,n,r){return new px(t,e,n,r)}function oh(t){return t=t.prototype,!(!t||!t.isReactComponent)}function gx(t){if(typeof t=="function")return oh(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Id)return 11;if(t===Ad)return 14}return 2}function kr(t,e){var n=t.alternate;return n===null?(n=cn(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Ba(t,e,n,r,s,i){var o=2;if(r=t,typeof t=="function")oh(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Cs:return ns(n.children,s,i,e);case Td:o=8,s|=8;break;case tc:return t=cn(12,n,e,s|2),t.elementType=tc,t.lanes=i,t;case nc:return t=cn(13,n,e,s),t.elementType=nc,t.lanes=i,t;case rc:return t=cn(19,n,e,s),t.elementType=rc,t.lanes=i,t;case tm:return Bl(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Zg:o=10;break e;case em:o=9;break e;case Id:o=11;break e;case Ad:o=14;break e;case pr:o=16,r=null;break e}throw Error($(130,t==null?t:typeof t,""))}return e=cn(o,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function ns(t,e,n,r){return t=cn(7,t,r,e),t.lanes=n,t}function Bl(t,e,n,r){return t=cn(22,t,r,e),t.elementType=tm,t.lanes=n,t.stateNode={isHidden:!1},t}function $u(t,e,n){return t=cn(6,t,null,e),t.lanes=n,t}function Wu(t,e,n){return e=cn(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function mx(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Tu(0),this.expirationTimes=Tu(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Tu(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function ah(t,e,n,r,s,i,o,l,u){return t=new mx(t,e,n,l,u),e===1?(e=1,i===!0&&(e|=8)):e=0,i=cn(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Wd(i),t}function yx(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:As,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function qy(t){if(!t)return Mr;t=t._reactInternals;e:{if(fs(t)!==t||t.tag!==1)throw Error($(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Bt(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error($(171))}if(t.tag===1){var n=t.type;if(Bt(n))return qm(t,n,e)}return e}function Gy(t,e,n,r,s,i,o,l,u){return t=ah(n,r,!0,t,s,i,o,l,u),t.context=qy(null),n=t.current,r=bt(),s=Cr(n),i=Yn(r,s),i.callback=e??null,Ir(n,i,s),t.current.lanes=s,Vo(t,s,r),Ut(t,r),t}function Ul(t,e,n,r){var s=e.current,i=bt(),o=Cr(s);return n=qy(n),e.context===null?e.context=n:e.pendingContext=n,e=Yn(i,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Ir(s,e,o),t!==null&&(Tn(t,s,o,i),Va(t,s,o)),o}function yl(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Vp(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function lh(t,e){Vp(t,e),(t=t.alternate)&&Vp(t,e)}function vx(){return null}var Qy=typeof reportError=="function"?reportError:function(t){console.error(t)};function uh(t){this._internalRoot=t}$l.prototype.render=uh.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error($(409));Ul(t,e,null,null)};$l.prototype.unmount=uh.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;ls(function(){Ul(null,t,null,null)}),e[er]=null}};function $l(t){this._internalRoot=t}$l.prototype.unstable_scheduleHydration=function(t){if(t){var e=Im();t={blockedOn:null,target:t,priority:e};for(var n=0;n<mr.length&&e!==0&&e<mr[n].priority;n++);mr.splice(n,0,t),n===0&&Cm(t)}};function ch(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Wl(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function jp(){}function _x(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var h=yl(o);i.call(h)}}var o=Gy(e,r,t,0,null,!1,!1,"",jp);return t._reactRootContainer=o,t[er]=o.current,go(t.nodeType===8?t.parentNode:t),ls(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var l=r;r=function(){var h=yl(u);l.call(h)}}var u=ah(t,0,!1,null,null,!1,!1,"",jp);return t._reactRootContainer=u,t[er]=u.current,go(t.nodeType===8?t.parentNode:t),ls(function(){Ul(e,u,n,r)}),u}function Hl(t,e,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var l=s;s=function(){var u=yl(o);l.call(u)}}Ul(e,o,t,s)}else o=_x(n,e,t,s,r);return yl(o)}Em=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=zi(e.pendingLanes);n!==0&&(Rd(e,n|1),Ut(e,Ke()),!(ve&6)&&(Xs=Ke()+500,zr()))}break;case 13:ls(function(){var r=tr(t,1);if(r!==null){var s=bt();Tn(r,t,1,s)}}),lh(t,1)}};Pd=function(t){if(t.tag===13){var e=tr(t,134217728);if(e!==null){var n=bt();Tn(e,t,134217728,n)}lh(t,134217728)}};Tm=function(t){if(t.tag===13){var e=Cr(t),n=tr(t,e);if(n!==null){var r=bt();Tn(n,t,e,r)}lh(t,e)}};Im=function(){return Ee};Am=function(t,e){var n=Ee;try{return Ee=t,e()}finally{Ee=n}};fc=function(t,e,n){switch(e){case"input":if(oc(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=Vl(r);if(!s)throw Error($(90));rm(r),oc(r,s)}}}break;case"textarea":im(t,n);break;case"select":e=n.value,e!=null&&Os(t,!!n.multiple,e,!1)}};hm=rh;fm=ls;var xx={usingClientEntryPoint:!1,Events:[Lo,bs,Vl,cm,dm,rh]},ji={findFiberByHostInstance:Xr,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},wx={bundleType:ji.bundleType,version:ji.version,rendererPackageName:ji.rendererPackageName,rendererConfig:ji.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:or.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=mm(t),t===null?null:t.stateNode},findFiberByHostInstance:ji.findFiberByHostInstance||vx,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ia=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ia.isDisabled&&Ia.supportsFiber)try{bl=Ia.inject(wx),Nn=Ia}catch{}}rn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=xx;rn.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!ch(e))throw Error($(200));return yx(t,e,null,n)};rn.createRoot=function(t,e){if(!ch(t))throw Error($(299));var n=!1,r="",s=Qy;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=ah(t,1,!1,null,null,n,!1,r,s),t[er]=e.current,go(t.nodeType===8?t.parentNode:t),new uh(e)};rn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error($(188)):(t=Object.keys(t).join(","),Error($(268,t)));return t=mm(e),t=t===null?null:t.stateNode,t};rn.flushSync=function(t){return ls(t)};rn.hydrate=function(t,e,n){if(!Wl(e))throw Error($(200));return Hl(null,t,e,!0,n)};rn.hydrateRoot=function(t,e,n){if(!ch(t))throw Error($(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=Qy;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=Gy(e,null,t,1,n??null,s,!1,i,o),t[er]=e.current,go(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new $l(e)};rn.render=function(t,e,n){if(!Wl(e))throw Error($(200));return Hl(null,t,e,!1,n)};rn.unmountComponentAtNode=function(t){if(!Wl(t))throw Error($(40));return t._reactRootContainer?(ls(function(){Hl(null,null,t,!1,function(){t._reactRootContainer=null,t[er]=null})}),!0):!1};rn.unstable_batchedUpdates=rh;rn.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Wl(n))throw Error($(200));if(t==null||t._reactInternals===void 0)throw Error($(38));return Hl(t,e,n,!1,r)};rn.version="18.3.1-next-f1338f8080-20240426";function Ky(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Ky)}catch(t){console.error(t)}}Ky(),Kg.exports=rn;var Sx=Kg.exports,Yy,Lp=Sx;Yy=Lp.createRoot,Lp.hydrateRoot;var Op={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xy=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},Ex=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],o=t[n++],l=t[n++],u=((s&7)<<18|(i&63)<<12|(o&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{const i=t[n++],o=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},Jy={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,l=o?t[s+1]:0,u=s+2<t.length,h=u?t[s+2]:0,p=i>>2,g=(i&3)<<4|l>>4;let v=(l&15)<<2|h>>6,k=h&63;u||(k=64,o||(v=64)),r.push(n[p],n[g],n[v],n[k])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(Xy(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):Ex(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],l=s<t.length?n[t.charAt(s)]:0;++s;const h=s<t.length?n[t.charAt(s)]:64;++s;const g=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||l==null||h==null||g==null)throw new Tx;const v=i<<2|l>>4;if(r.push(v),h!==64){const k=l<<4&240|h>>2;if(r.push(k),g!==64){const R=h<<6&192|g;r.push(R)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class Tx extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Ix=function(t){const e=Xy(t);return Jy.encodeByteArray(e,!0)},Zy=function(t){return Ix(t).replace(/\./g,"")},Ax=function(t){try{return Jy.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cx(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kx=()=>Cx().__FIREBASE_DEFAULTS__,Rx=()=>{if(typeof process>"u"||typeof Op>"u")return;const t=Op.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},Px=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&Ax(t[1]);return e&&JSON.parse(e)},dh=()=>{try{return kx()||Rx()||Px()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},bx=t=>{var e,n;return(n=(e=dh())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},Dx=t=>{const e=bx(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},e0=()=>{var t;return(t=dh())===null||t===void 0?void 0:t.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nx{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mx(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Vx(){var t;const e=(t=dh())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function jx(){return!Vx()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Lx(){try{return typeof indexedDB=="object"}catch{return!1}}function Ox(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fx="FirebaseError";class li extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=Fx,Object.setPrototypeOf(this,li.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,t0.prototype.create)}}class t0{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?zx(i,r):"Error",l=`${this.serviceName}: ${o} (${s}).`;return new li(s,l,r)}}function zx(t,e){return t.replace(Bx,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const Bx=/\{\$([^}]+)}/g;function vl(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],o=e[s];if(Fp(i)&&Fp(o)){if(!vl(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function Fp(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function An(t){return t&&t._delegate?t._delegate:t}class Js{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yr="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ux{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new Nx;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Wx(e))try{this.getOrInitializeService({instanceIdentifier:Yr})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=Yr){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Yr){return this.instances.has(e)}getOptions(e=Yr){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(i);r===l&&o.resolve(s)}return s}onInit(e,n){var r;const s=this.normalizeInstanceIdentifier(n),i=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;i.add(e),this.onInitCallbacks.set(s,i);const o=this.instances.get(s);return o&&e(o,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:$x(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Yr){return this.component?this.component.multipleInstances?e:Yr:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function $x(t){return t===Yr?void 0:t}function Wx(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hx{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new Ux(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ye;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(ye||(ye={}));const qx={debug:ye.DEBUG,verbose:ye.VERBOSE,info:ye.INFO,warn:ye.WARN,error:ye.ERROR,silent:ye.SILENT},Gx=ye.INFO,Qx={[ye.DEBUG]:"log",[ye.VERBOSE]:"log",[ye.INFO]:"info",[ye.WARN]:"warn",[ye.ERROR]:"error"},Kx=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=Qx[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class n0{constructor(e){this.name=e,this._logLevel=Gx,this._logHandler=Kx,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ye))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?qx[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ye.DEBUG,...e),this._logHandler(this,ye.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ye.VERBOSE,...e),this._logHandler(this,ye.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ye.INFO,...e),this._logHandler(this,ye.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ye.WARN,...e),this._logHandler(this,ye.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ye.ERROR,...e),this._logHandler(this,ye.ERROR,...e)}}const Yx=(t,e)=>e.some(n=>t instanceof n);let zp,Bp;function Xx(){return zp||(zp=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Jx(){return Bp||(Bp=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const r0=new WeakMap,qc=new WeakMap,s0=new WeakMap,Hu=new WeakMap,hh=new WeakMap;function Zx(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(Rr(t.result)),s()},o=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&r0.set(n,t)}).catch(()=>{}),hh.set(e,t),e}function ew(t){if(qc.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),s()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});qc.set(t,e)}let Gc={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return qc.get(t);if(e==="objectStoreNames")return t.objectStoreNames||s0.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Rr(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function tw(t){Gc=t(Gc)}function nw(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(qu(this),e,...n);return s0.set(r,e.sort?e.sort():[e]),Rr(r)}:Jx().includes(t)?function(...e){return t.apply(qu(this),e),Rr(r0.get(this))}:function(...e){return Rr(t.apply(qu(this),e))}}function rw(t){return typeof t=="function"?nw(t):(t instanceof IDBTransaction&&ew(t),Yx(t,Xx())?new Proxy(t,Gc):t)}function Rr(t){if(t instanceof IDBRequest)return Zx(t);if(Hu.has(t))return Hu.get(t);const e=rw(t);return e!==t&&(Hu.set(t,e),hh.set(e,t)),e}const qu=t=>hh.get(t);function sw(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),l=Rr(o);return r&&o.addEventListener("upgradeneeded",u=>{r(Rr(o.result),u.oldVersion,u.newVersion,Rr(o.transaction),u)}),n&&o.addEventListener("blocked",u=>n(u.oldVersion,u.newVersion,u)),l.then(u=>{i&&u.addEventListener("close",()=>i()),s&&u.addEventListener("versionchange",h=>s(h.oldVersion,h.newVersion,h))}).catch(()=>{}),l}const iw=["get","getKey","getAll","getAllKeys","count"],ow=["put","add","delete","clear"],Gu=new Map;function Up(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Gu.get(e))return Gu.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=ow.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||iw.includes(n)))return;const i=async function(o,...l){const u=this.transaction(o,s?"readwrite":"readonly");let h=u.store;return r&&(h=h.index(l.shift())),(await Promise.all([h[n](...l),s&&u.done]))[0]};return Gu.set(e,i),i}tw(t=>({...t,get:(e,n,r)=>Up(e,n)||t.get(e,n,r),has:(e,n)=>!!Up(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aw{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(lw(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function lw(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Qc="@firebase/app",$p="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rr=new n0("@firebase/app"),uw="@firebase/app-compat",cw="@firebase/analytics-compat",dw="@firebase/analytics",hw="@firebase/app-check-compat",fw="@firebase/app-check",pw="@firebase/auth",gw="@firebase/auth-compat",mw="@firebase/database",yw="@firebase/data-connect",vw="@firebase/database-compat",_w="@firebase/functions",xw="@firebase/functions-compat",ww="@firebase/installations",Sw="@firebase/installations-compat",Ew="@firebase/messaging",Tw="@firebase/messaging-compat",Iw="@firebase/performance",Aw="@firebase/performance-compat",Cw="@firebase/remote-config",kw="@firebase/remote-config-compat",Rw="@firebase/storage",Pw="@firebase/storage-compat",bw="@firebase/firestore",Dw="@firebase/vertexai-preview",Nw="@firebase/firestore-compat",Mw="firebase",Vw="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kc="[DEFAULT]",jw={[Qc]:"fire-core",[uw]:"fire-core-compat",[dw]:"fire-analytics",[cw]:"fire-analytics-compat",[fw]:"fire-app-check",[hw]:"fire-app-check-compat",[pw]:"fire-auth",[gw]:"fire-auth-compat",[mw]:"fire-rtdb",[yw]:"fire-data-connect",[vw]:"fire-rtdb-compat",[_w]:"fire-fn",[xw]:"fire-fn-compat",[ww]:"fire-iid",[Sw]:"fire-iid-compat",[Ew]:"fire-fcm",[Tw]:"fire-fcm-compat",[Iw]:"fire-perf",[Aw]:"fire-perf-compat",[Cw]:"fire-rc",[kw]:"fire-rc-compat",[Rw]:"fire-gcs",[Pw]:"fire-gcs-compat",[bw]:"fire-fst",[Nw]:"fire-fst-compat",[Dw]:"fire-vertex","fire-js":"fire-js",[Mw]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _l=new Map,Lw=new Map,Yc=new Map;function Wp(t,e){try{t.container.addComponent(e)}catch(n){rr.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function To(t){const e=t.name;if(Yc.has(e))return rr.debug(`There were multiple attempts to register component ${e}.`),!1;Yc.set(e,t);for(const n of _l.values())Wp(n,t);for(const n of Lw.values())Wp(n,t);return!0}function i0(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ow={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Pr=new t0("app","Firebase",Ow);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fw{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Js("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Pr.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zw=Vw;function o0(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:Kc,automaticDataCollectionEnabled:!1},e),s=r.name;if(typeof s!="string"||!s)throw Pr.create("bad-app-name",{appName:String(s)});if(n||(n=e0()),!n)throw Pr.create("no-options");const i=_l.get(s);if(i){if(vl(n,i.options)&&vl(r,i.config))return i;throw Pr.create("duplicate-app",{appName:s})}const o=new Hx(s);for(const u of Yc.values())o.addComponent(u);const l=new Fw(n,r,o);return _l.set(s,l),l}function Bw(t=Kc){const e=_l.get(t);if(!e&&t===Kc&&e0())return o0();if(!e)throw Pr.create("no-app",{appName:t});return e}function br(t,e,n){var r;let s=(r=jw[t])!==null&&r!==void 0?r:t;n&&(s+=`-${n}`);const i=s.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const l=[`Unable to register library "${s}" with version "${e}":`];i&&l.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&o&&l.push("and"),o&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),rr.warn(l.join(" "));return}To(new Js(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uw="firebase-heartbeat-database",$w=1,Io="firebase-heartbeat-store";let Qu=null;function a0(){return Qu||(Qu=sw(Uw,$w,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Io)}catch(n){console.warn(n)}}}}).catch(t=>{throw Pr.create("idb-open",{originalErrorMessage:t.message})})),Qu}async function Ww(t){try{const n=(await a0()).transaction(Io),r=await n.objectStore(Io).get(l0(t));return await n.done,r}catch(e){if(e instanceof li)rr.warn(e.message);else{const n=Pr.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});rr.warn(n.message)}}}async function Hp(t,e){try{const r=(await a0()).transaction(Io,"readwrite");await r.objectStore(Io).put(e,l0(t)),await r.done}catch(n){if(n instanceof li)rr.warn(n.message);else{const r=Pr.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});rr.warn(r.message)}}}function l0(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hw=1024,qw=30*24*60*60*1e3;class Gw{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new Kw(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=qp();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i)?void 0:(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const l=new Date(o.date).valueOf();return Date.now()-l<=qw}),this._storage.overwrite(this._heartbeatsCache))}catch(r){rr.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=qp(),{heartbeatsToSend:r,unsentEntries:s}=Qw(this._heartbeatsCache.heartbeats),i=Zy(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return rr.warn(n),""}}}function qp(){return new Date().toISOString().substring(0,10)}function Qw(t,e=Hw){const n=[];let r=t.slice();for(const s of t){const i=n.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),Gp(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),Gp(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class Kw{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Lx()?Ox().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await Ww(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return Hp(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return Hp(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function Gp(t){return Zy(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yw(t){To(new Js("platform-logger",e=>new aw(e),"PRIVATE")),To(new Js("heartbeat",e=>new Gw(e),"PRIVATE")),br(Qc,$p,t),br(Qc,$p,"esm2017"),br("fire-js","")}Yw("");var Xw="firebase",Jw="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */br(Xw,Jw,"app");var Qp=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var rs,u0;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(T,_){function m(){}m.prototype=_.prototype,T.D=_.prototype,T.prototype=new m,T.prototype.constructor=T,T.C=function(S,E,A){for(var x=Array(arguments.length-2),W=2;W<arguments.length;W++)x[W-2]=arguments[W];return _.prototype[E].apply(S,x)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(T,_,m){m||(m=0);var S=Array(16);if(typeof _=="string")for(var E=0;16>E;++E)S[E]=_.charCodeAt(m++)|_.charCodeAt(m++)<<8|_.charCodeAt(m++)<<16|_.charCodeAt(m++)<<24;else for(E=0;16>E;++E)S[E]=_[m++]|_[m++]<<8|_[m++]<<16|_[m++]<<24;_=T.g[0],m=T.g[1],E=T.g[2];var A=T.g[3],x=_+(A^m&(E^A))+S[0]+3614090360&4294967295;_=m+(x<<7&4294967295|x>>>25),x=A+(E^_&(m^E))+S[1]+3905402710&4294967295,A=_+(x<<12&4294967295|x>>>20),x=E+(m^A&(_^m))+S[2]+606105819&4294967295,E=A+(x<<17&4294967295|x>>>15),x=m+(_^E&(A^_))+S[3]+3250441966&4294967295,m=E+(x<<22&4294967295|x>>>10),x=_+(A^m&(E^A))+S[4]+4118548399&4294967295,_=m+(x<<7&4294967295|x>>>25),x=A+(E^_&(m^E))+S[5]+1200080426&4294967295,A=_+(x<<12&4294967295|x>>>20),x=E+(m^A&(_^m))+S[6]+2821735955&4294967295,E=A+(x<<17&4294967295|x>>>15),x=m+(_^E&(A^_))+S[7]+4249261313&4294967295,m=E+(x<<22&4294967295|x>>>10),x=_+(A^m&(E^A))+S[8]+1770035416&4294967295,_=m+(x<<7&4294967295|x>>>25),x=A+(E^_&(m^E))+S[9]+2336552879&4294967295,A=_+(x<<12&4294967295|x>>>20),x=E+(m^A&(_^m))+S[10]+4294925233&4294967295,E=A+(x<<17&4294967295|x>>>15),x=m+(_^E&(A^_))+S[11]+2304563134&4294967295,m=E+(x<<22&4294967295|x>>>10),x=_+(A^m&(E^A))+S[12]+1804603682&4294967295,_=m+(x<<7&4294967295|x>>>25),x=A+(E^_&(m^E))+S[13]+4254626195&4294967295,A=_+(x<<12&4294967295|x>>>20),x=E+(m^A&(_^m))+S[14]+2792965006&4294967295,E=A+(x<<17&4294967295|x>>>15),x=m+(_^E&(A^_))+S[15]+1236535329&4294967295,m=E+(x<<22&4294967295|x>>>10),x=_+(E^A&(m^E))+S[1]+4129170786&4294967295,_=m+(x<<5&4294967295|x>>>27),x=A+(m^E&(_^m))+S[6]+3225465664&4294967295,A=_+(x<<9&4294967295|x>>>23),x=E+(_^m&(A^_))+S[11]+643717713&4294967295,E=A+(x<<14&4294967295|x>>>18),x=m+(A^_&(E^A))+S[0]+3921069994&4294967295,m=E+(x<<20&4294967295|x>>>12),x=_+(E^A&(m^E))+S[5]+3593408605&4294967295,_=m+(x<<5&4294967295|x>>>27),x=A+(m^E&(_^m))+S[10]+38016083&4294967295,A=_+(x<<9&4294967295|x>>>23),x=E+(_^m&(A^_))+S[15]+3634488961&4294967295,E=A+(x<<14&4294967295|x>>>18),x=m+(A^_&(E^A))+S[4]+3889429448&4294967295,m=E+(x<<20&4294967295|x>>>12),x=_+(E^A&(m^E))+S[9]+568446438&4294967295,_=m+(x<<5&4294967295|x>>>27),x=A+(m^E&(_^m))+S[14]+3275163606&4294967295,A=_+(x<<9&4294967295|x>>>23),x=E+(_^m&(A^_))+S[3]+4107603335&4294967295,E=A+(x<<14&4294967295|x>>>18),x=m+(A^_&(E^A))+S[8]+1163531501&4294967295,m=E+(x<<20&4294967295|x>>>12),x=_+(E^A&(m^E))+S[13]+2850285829&4294967295,_=m+(x<<5&4294967295|x>>>27),x=A+(m^E&(_^m))+S[2]+4243563512&4294967295,A=_+(x<<9&4294967295|x>>>23),x=E+(_^m&(A^_))+S[7]+1735328473&4294967295,E=A+(x<<14&4294967295|x>>>18),x=m+(A^_&(E^A))+S[12]+2368359562&4294967295,m=E+(x<<20&4294967295|x>>>12),x=_+(m^E^A)+S[5]+4294588738&4294967295,_=m+(x<<4&4294967295|x>>>28),x=A+(_^m^E)+S[8]+2272392833&4294967295,A=_+(x<<11&4294967295|x>>>21),x=E+(A^_^m)+S[11]+1839030562&4294967295,E=A+(x<<16&4294967295|x>>>16),x=m+(E^A^_)+S[14]+4259657740&4294967295,m=E+(x<<23&4294967295|x>>>9),x=_+(m^E^A)+S[1]+2763975236&4294967295,_=m+(x<<4&4294967295|x>>>28),x=A+(_^m^E)+S[4]+1272893353&4294967295,A=_+(x<<11&4294967295|x>>>21),x=E+(A^_^m)+S[7]+4139469664&4294967295,E=A+(x<<16&4294967295|x>>>16),x=m+(E^A^_)+S[10]+3200236656&4294967295,m=E+(x<<23&4294967295|x>>>9),x=_+(m^E^A)+S[13]+681279174&4294967295,_=m+(x<<4&4294967295|x>>>28),x=A+(_^m^E)+S[0]+3936430074&4294967295,A=_+(x<<11&4294967295|x>>>21),x=E+(A^_^m)+S[3]+3572445317&4294967295,E=A+(x<<16&4294967295|x>>>16),x=m+(E^A^_)+S[6]+76029189&4294967295,m=E+(x<<23&4294967295|x>>>9),x=_+(m^E^A)+S[9]+3654602809&4294967295,_=m+(x<<4&4294967295|x>>>28),x=A+(_^m^E)+S[12]+3873151461&4294967295,A=_+(x<<11&4294967295|x>>>21),x=E+(A^_^m)+S[15]+530742520&4294967295,E=A+(x<<16&4294967295|x>>>16),x=m+(E^A^_)+S[2]+3299628645&4294967295,m=E+(x<<23&4294967295|x>>>9),x=_+(E^(m|~A))+S[0]+4096336452&4294967295,_=m+(x<<6&4294967295|x>>>26),x=A+(m^(_|~E))+S[7]+1126891415&4294967295,A=_+(x<<10&4294967295|x>>>22),x=E+(_^(A|~m))+S[14]+2878612391&4294967295,E=A+(x<<15&4294967295|x>>>17),x=m+(A^(E|~_))+S[5]+4237533241&4294967295,m=E+(x<<21&4294967295|x>>>11),x=_+(E^(m|~A))+S[12]+1700485571&4294967295,_=m+(x<<6&4294967295|x>>>26),x=A+(m^(_|~E))+S[3]+2399980690&4294967295,A=_+(x<<10&4294967295|x>>>22),x=E+(_^(A|~m))+S[10]+4293915773&4294967295,E=A+(x<<15&4294967295|x>>>17),x=m+(A^(E|~_))+S[1]+2240044497&4294967295,m=E+(x<<21&4294967295|x>>>11),x=_+(E^(m|~A))+S[8]+1873313359&4294967295,_=m+(x<<6&4294967295|x>>>26),x=A+(m^(_|~E))+S[15]+4264355552&4294967295,A=_+(x<<10&4294967295|x>>>22),x=E+(_^(A|~m))+S[6]+2734768916&4294967295,E=A+(x<<15&4294967295|x>>>17),x=m+(A^(E|~_))+S[13]+1309151649&4294967295,m=E+(x<<21&4294967295|x>>>11),x=_+(E^(m|~A))+S[4]+4149444226&4294967295,_=m+(x<<6&4294967295|x>>>26),x=A+(m^(_|~E))+S[11]+3174756917&4294967295,A=_+(x<<10&4294967295|x>>>22),x=E+(_^(A|~m))+S[2]+718787259&4294967295,E=A+(x<<15&4294967295|x>>>17),x=m+(A^(E|~_))+S[9]+3951481745&4294967295,T.g[0]=T.g[0]+_&4294967295,T.g[1]=T.g[1]+(E+(x<<21&4294967295|x>>>11))&4294967295,T.g[2]=T.g[2]+E&4294967295,T.g[3]=T.g[3]+A&4294967295}r.prototype.u=function(T,_){_===void 0&&(_=T.length);for(var m=_-this.blockSize,S=this.B,E=this.h,A=0;A<_;){if(E==0)for(;A<=m;)s(this,T,A),A+=this.blockSize;if(typeof T=="string"){for(;A<_;)if(S[E++]=T.charCodeAt(A++),E==this.blockSize){s(this,S),E=0;break}}else for(;A<_;)if(S[E++]=T[A++],E==this.blockSize){s(this,S),E=0;break}}this.h=E,this.o+=_},r.prototype.v=function(){var T=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);T[0]=128;for(var _=1;_<T.length-8;++_)T[_]=0;var m=8*this.o;for(_=T.length-8;_<T.length;++_)T[_]=m&255,m/=256;for(this.u(T),T=Array(16),_=m=0;4>_;++_)for(var S=0;32>S;S+=8)T[m++]=this.g[_]>>>S&255;return T};function i(T,_){var m=l;return Object.prototype.hasOwnProperty.call(m,T)?m[T]:m[T]=_(T)}function o(T,_){this.h=_;for(var m=[],S=!0,E=T.length-1;0<=E;E--){var A=T[E]|0;S&&A==_||(m[E]=A,S=!1)}this.g=m}var l={};function u(T){return-128<=T&&128>T?i(T,function(_){return new o([_|0],0>_?-1:0)}):new o([T|0],0>T?-1:0)}function h(T){if(isNaN(T)||!isFinite(T))return g;if(0>T)return O(h(-T));for(var _=[],m=1,S=0;T>=m;S++)_[S]=T/m|0,m*=4294967296;return new o(_,0)}function p(T,_){if(T.length==0)throw Error("number format error: empty string");if(_=_||10,2>_||36<_)throw Error("radix out of range: "+_);if(T.charAt(0)=="-")return O(p(T.substring(1),_));if(0<=T.indexOf("-"))throw Error('number format error: interior "-" character');for(var m=h(Math.pow(_,8)),S=g,E=0;E<T.length;E+=8){var A=Math.min(8,T.length-E),x=parseInt(T.substring(E,E+A),_);8>A?(A=h(Math.pow(_,A)),S=S.j(A).add(h(x))):(S=S.j(m),S=S.add(h(x)))}return S}var g=u(0),v=u(1),k=u(16777216);t=o.prototype,t.m=function(){if(P(this))return-O(this).m();for(var T=0,_=1,m=0;m<this.g.length;m++){var S=this.i(m);T+=(0<=S?S:4294967296+S)*_,_*=4294967296}return T},t.toString=function(T){if(T=T||10,2>T||36<T)throw Error("radix out of range: "+T);if(R(this))return"0";if(P(this))return"-"+O(this).toString(T);for(var _=h(Math.pow(T,6)),m=this,S="";;){var E=b(m,_).g;m=C(m,E.j(_));var A=((0<m.g.length?m.g[0]:m.h)>>>0).toString(T);if(m=E,R(m))return A+S;for(;6>A.length;)A="0"+A;S=A+S}},t.i=function(T){return 0>T?0:T<this.g.length?this.g[T]:this.h};function R(T){if(T.h!=0)return!1;for(var _=0;_<T.g.length;_++)if(T.g[_]!=0)return!1;return!0}function P(T){return T.h==-1}t.l=function(T){return T=C(this,T),P(T)?-1:R(T)?0:1};function O(T){for(var _=T.g.length,m=[],S=0;S<_;S++)m[S]=~T.g[S];return new o(m,~T.h).add(v)}t.abs=function(){return P(this)?O(this):this},t.add=function(T){for(var _=Math.max(this.g.length,T.g.length),m=[],S=0,E=0;E<=_;E++){var A=S+(this.i(E)&65535)+(T.i(E)&65535),x=(A>>>16)+(this.i(E)>>>16)+(T.i(E)>>>16);S=x>>>16,A&=65535,x&=65535,m[E]=x<<16|A}return new o(m,m[m.length-1]&-2147483648?-1:0)};function C(T,_){return T.add(O(_))}t.j=function(T){if(R(this)||R(T))return g;if(P(this))return P(T)?O(this).j(O(T)):O(O(this).j(T));if(P(T))return O(this.j(O(T)));if(0>this.l(k)&&0>T.l(k))return h(this.m()*T.m());for(var _=this.g.length+T.g.length,m=[],S=0;S<2*_;S++)m[S]=0;for(S=0;S<this.g.length;S++)for(var E=0;E<T.g.length;E++){var A=this.i(S)>>>16,x=this.i(S)&65535,W=T.i(E)>>>16,X=T.i(E)&65535;m[2*S+2*E]+=x*X,I(m,2*S+2*E),m[2*S+2*E+1]+=A*X,I(m,2*S+2*E+1),m[2*S+2*E+1]+=x*W,I(m,2*S+2*E+1),m[2*S+2*E+2]+=A*W,I(m,2*S+2*E+2)}for(S=0;S<_;S++)m[S]=m[2*S+1]<<16|m[2*S];for(S=_;S<2*_;S++)m[S]=0;return new o(m,0)};function I(T,_){for(;(T[_]&65535)!=T[_];)T[_+1]+=T[_]>>>16,T[_]&=65535,_++}function w(T,_){this.g=T,this.h=_}function b(T,_){if(R(_))throw Error("division by zero");if(R(T))return new w(g,g);if(P(T))return _=b(O(T),_),new w(O(_.g),O(_.h));if(P(_))return _=b(T,O(_)),new w(O(_.g),_.h);if(30<T.g.length){if(P(T)||P(_))throw Error("slowDivide_ only works with positive integers.");for(var m=v,S=_;0>=S.l(T);)m=V(m),S=V(S);var E=j(m,1),A=j(S,1);for(S=j(S,2),m=j(m,2);!R(S);){var x=A.add(S);0>=x.l(T)&&(E=E.add(m),A=x),S=j(S,1),m=j(m,1)}return _=C(T,E.j(_)),new w(E,_)}for(E=g;0<=T.l(_);){for(m=Math.max(1,Math.floor(T.m()/_.m())),S=Math.ceil(Math.log(m)/Math.LN2),S=48>=S?1:Math.pow(2,S-48),A=h(m),x=A.j(_);P(x)||0<x.l(T);)m-=S,A=h(m),x=A.j(_);R(A)&&(A=v),E=E.add(A),T=C(T,x)}return new w(E,T)}t.A=function(T){return b(this,T).h},t.and=function(T){for(var _=Math.max(this.g.length,T.g.length),m=[],S=0;S<_;S++)m[S]=this.i(S)&T.i(S);return new o(m,this.h&T.h)},t.or=function(T){for(var _=Math.max(this.g.length,T.g.length),m=[],S=0;S<_;S++)m[S]=this.i(S)|T.i(S);return new o(m,this.h|T.h)},t.xor=function(T){for(var _=Math.max(this.g.length,T.g.length),m=[],S=0;S<_;S++)m[S]=this.i(S)^T.i(S);return new o(m,this.h^T.h)};function V(T){for(var _=T.g.length+1,m=[],S=0;S<_;S++)m[S]=T.i(S)<<1|T.i(S-1)>>>31;return new o(m,T.h)}function j(T,_){var m=_>>5;_%=32;for(var S=T.g.length-m,E=[],A=0;A<S;A++)E[A]=0<_?T.i(A+m)>>>_|T.i(A+m+1)<<32-_:T.i(A+m);return new o(E,T.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,u0=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=h,o.fromString=p,rs=o}).apply(typeof Qp<"u"?Qp:typeof self<"u"?self:typeof window<"u"?window:{});var Aa=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var c0,Ui,d0,Ua,Xc,h0,f0,p0;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(a,c,f){return a==Array.prototype||a==Object.prototype||(a[c]=f.value),a};function n(a){a=[typeof globalThis=="object"&&globalThis,a,typeof window=="object"&&window,typeof self=="object"&&self,typeof Aa=="object"&&Aa];for(var c=0;c<a.length;++c){var f=a[c];if(f&&f.Math==Math)return f}throw Error("Cannot find global object")}var r=n(this);function s(a,c){if(c)e:{var f=r;a=a.split(".");for(var y=0;y<a.length-1;y++){var D=a[y];if(!(D in f))break e;f=f[D]}a=a[a.length-1],y=f[a],c=c(y),c!=y&&c!=null&&e(f,a,{configurable:!0,writable:!0,value:c})}}function i(a,c){a instanceof String&&(a+="");var f=0,y=!1,D={next:function(){if(!y&&f<a.length){var M=f++;return{value:c(M,a[M]),done:!1}}return y=!0,{done:!0,value:void 0}}};return D[Symbol.iterator]=function(){return D},D}s("Array.prototype.values",function(a){return a||function(){return i(this,function(c,f){return f})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},l=this||self;function u(a){var c=typeof a;return c=c!="object"?c:a?Array.isArray(a)?"array":c:"null",c=="array"||c=="object"&&typeof a.length=="number"}function h(a){var c=typeof a;return c=="object"&&a!=null||c=="function"}function p(a,c,f){return a.call.apply(a.bind,arguments)}function g(a,c,f){if(!a)throw Error();if(2<arguments.length){var y=Array.prototype.slice.call(arguments,2);return function(){var D=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(D,y),a.apply(c,D)}}return function(){return a.apply(c,arguments)}}function v(a,c,f){return v=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?p:g,v.apply(null,arguments)}function k(a,c){var f=Array.prototype.slice.call(arguments,1);return function(){var y=f.slice();return y.push.apply(y,arguments),a.apply(this,y)}}function R(a,c){function f(){}f.prototype=c.prototype,a.aa=c.prototype,a.prototype=new f,a.prototype.constructor=a,a.Qb=function(y,D,M){for(var Q=Array(arguments.length-2),Ce=2;Ce<arguments.length;Ce++)Q[Ce-2]=arguments[Ce];return c.prototype[D].apply(y,Q)}}function P(a){const c=a.length;if(0<c){const f=Array(c);for(let y=0;y<c;y++)f[y]=a[y];return f}return[]}function O(a,c){for(let f=1;f<arguments.length;f++){const y=arguments[f];if(u(y)){const D=a.length||0,M=y.length||0;a.length=D+M;for(let Q=0;Q<M;Q++)a[D+Q]=y[Q]}else a.push(y)}}class C{constructor(c,f){this.i=c,this.j=f,this.h=0,this.g=null}get(){let c;return 0<this.h?(this.h--,c=this.g,this.g=c.next,c.next=null):c=this.i(),c}}function I(a){return/^[\s\xa0]*$/.test(a)}function w(){var a=l.navigator;return a&&(a=a.userAgent)?a:""}function b(a){return b[" "](a),a}b[" "]=function(){};var V=w().indexOf("Gecko")!=-1&&!(w().toLowerCase().indexOf("webkit")!=-1&&w().indexOf("Edge")==-1)&&!(w().indexOf("Trident")!=-1||w().indexOf("MSIE")!=-1)&&w().indexOf("Edge")==-1;function j(a,c,f){for(const y in a)c.call(f,a[y],y,a)}function T(a,c){for(const f in a)c.call(void 0,a[f],f,a)}function _(a){const c={};for(const f in a)c[f]=a[f];return c}const m="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function S(a,c){let f,y;for(let D=1;D<arguments.length;D++){y=arguments[D];for(f in y)a[f]=y[f];for(let M=0;M<m.length;M++)f=m[M],Object.prototype.hasOwnProperty.call(y,f)&&(a[f]=y[f])}}function E(a){var c=1;a=a.split(":");const f=[];for(;0<c&&a.length;)f.push(a.shift()),c--;return a.length&&f.push(a.join(":")),f}function A(a){l.setTimeout(()=>{throw a},0)}function x(){var a=F;let c=null;return a.g&&(c=a.g,a.g=a.g.next,a.g||(a.h=null),c.next=null),c}class W{constructor(){this.h=this.g=null}add(c,f){const y=X.get();y.set(c,f),this.h?this.h.next=y:this.g=y,this.h=y}}var X=new C(()=>new te,a=>a.reset());class te{constructor(){this.next=this.g=this.h=null}set(c,f){this.h=c,this.g=f,this.next=null}reset(){this.next=this.g=this.h=null}}let U,N=!1,F=new W,H=()=>{const a=l.Promise.resolve(void 0);U=()=>{a.then(Z)}};var Z=()=>{for(var a;a=x();){try{a.h.call(a.g)}catch(f){A(f)}var c=X;c.j(a),100>c.h&&(c.h++,a.next=c.g,c.g=a)}N=!1};function ee(){this.s=this.s,this.C=this.C}ee.prototype.s=!1,ee.prototype.ma=function(){this.s||(this.s=!0,this.N())},ee.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function oe(a,c){this.type=a,this.g=this.target=c,this.defaultPrevented=!1}oe.prototype.h=function(){this.defaultPrevented=!0};var Ae=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var a=!1,c=Object.defineProperty({},"passive",{get:function(){a=!0}});try{const f=()=>{};l.addEventListener("test",f,c),l.removeEventListener("test",f,c)}catch{}return a}();function ge(a,c){if(oe.call(this,a?a.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,a){var f=this.type=a.type,y=a.changedTouches&&a.changedTouches.length?a.changedTouches[0]:null;if(this.target=a.target||a.srcElement,this.g=c,c=a.relatedTarget){if(V){e:{try{b(c.nodeName);var D=!0;break e}catch{}D=!1}D||(c=null)}}else f=="mouseover"?c=a.fromElement:f=="mouseout"&&(c=a.toElement);this.relatedTarget=c,y?(this.clientX=y.clientX!==void 0?y.clientX:y.pageX,this.clientY=y.clientY!==void 0?y.clientY:y.pageY,this.screenX=y.screenX||0,this.screenY=y.screenY||0):(this.clientX=a.clientX!==void 0?a.clientX:a.pageX,this.clientY=a.clientY!==void 0?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0),this.button=a.button,this.key=a.key||"",this.ctrlKey=a.ctrlKey,this.altKey=a.altKey,this.shiftKey=a.shiftKey,this.metaKey=a.metaKey,this.pointerId=a.pointerId||0,this.pointerType=typeof a.pointerType=="string"?a.pointerType:de[a.pointerType]||"",this.state=a.state,this.i=a,a.defaultPrevented&&ge.aa.h.call(this)}}R(ge,oe);var de={2:"touch",3:"pen",4:"mouse"};ge.prototype.h=function(){ge.aa.h.call(this);var a=this.i;a.preventDefault?a.preventDefault():a.returnValue=!1};var ce="closure_listenable_"+(1e6*Math.random()|0),Le=0;function we(a,c,f,y,D){this.listener=a,this.proxy=null,this.src=c,this.type=f,this.capture=!!y,this.ha=D,this.key=++Le,this.da=this.fa=!1}function re(a){a.da=!0,a.listener=null,a.proxy=null,a.src=null,a.ha=null}function ke(a){this.src=a,this.g={},this.h=0}ke.prototype.add=function(a,c,f,y,D){var M=a.toString();a=this.g[M],a||(a=this.g[M]=[],this.h++);var Q=Re(a,c,y,D);return-1<Q?(c=a[Q],f||(c.fa=!1)):(c=new we(c,this.src,M,!!y,D),c.fa=f,a.push(c)),c};function Ge(a,c){var f=c.type;if(f in a.g){var y=a.g[f],D=Array.prototype.indexOf.call(y,c,void 0),M;(M=0<=D)&&Array.prototype.splice.call(y,D,1),M&&(re(c),a.g[f].length==0&&(delete a.g[f],a.h--))}}function Re(a,c,f,y){for(var D=0;D<a.length;++D){var M=a[D];if(!M.da&&M.listener==c&&M.capture==!!f&&M.ha==y)return D}return-1}var _t="closure_lm_"+(1e6*Math.random()|0),$t={};function Wt(a,c,f,y,D){if(Array.isArray(c)){for(var M=0;M<c.length;M++)Wt(a,c[M],f,y,D);return null}return f=Go(f),a&&a[ce]?a.K(c,f,h(y)?!!y.capture:!1,D):Ht(a,c,f,!1,y,D)}function Ht(a,c,f,y,D,M){if(!c)throw Error("Invalid event type");var Q=h(D)?!!D.capture:!!D,Ce=$e(a);if(Ce||(a[_t]=Ce=new ke(a)),f=Ce.add(c,f,y,Q,M),f.proxy)return f;if(y=qt(),f.proxy=y,y.src=a,y.listener=f,a.addEventListener)Ae||(D=Q),D===void 0&&(D=!1),a.addEventListener(c.toString(),y,D);else if(a.attachEvent)a.attachEvent(kn(c.toString()),y);else if(a.addListener&&a.removeListener)a.addListener(y);else throw Error("addEventListener and attachEvent are unavailable.");return f}function qt(){function a(f){return c.call(a.src,a.listener,f)}const c=lr;return a}function Gt(a,c,f,y,D){if(Array.isArray(c))for(var M=0;M<c.length;M++)Gt(a,c[M],f,y,D);else y=h(y)?!!y.capture:!!y,f=Go(f),a&&a[ce]?(a=a.i,c=String(c).toString(),c in a.g&&(M=a.g[c],f=Re(M,f,y,D),-1<f&&(re(M[f]),Array.prototype.splice.call(M,f,1),M.length==0&&(delete a.g[c],a.h--)))):a&&(a=$e(a))&&(c=a.g[c.toString()],a=-1,c&&(a=Re(c,f,y,D)),(f=-1<a?c[a]:null)&&ar(f))}function ar(a){if(typeof a!="number"&&a&&!a.da){var c=a.src;if(c&&c[ce])Ge(c.i,a);else{var f=a.type,y=a.proxy;c.removeEventListener?c.removeEventListener(f,y,a.capture):c.detachEvent?c.detachEvent(kn(f),y):c.addListener&&c.removeListener&&c.removeListener(y),(f=$e(c))?(Ge(f,a),f.h==0&&(f.src=null,c[_t]=null)):re(a)}}}function kn(a){return a in $t?$t[a]:$t[a]="on"+a}function lr(a,c){if(a.da)a=!0;else{c=new ge(c,this);var f=a.listener,y=a.ha||a.src;a.fa&&ar(a),a=f.call(y,c)}return a}function $e(a){return a=a[_t],a instanceof ke?a:null}var fi="__closure_events_fn_"+(1e9*Math.random()>>>0);function Go(a){return typeof a=="function"?a:(a[fi]||(a[fi]=function(c){return a.handleEvent(c)}),a[fi])}function ot(){ee.call(this),this.i=new ke(this),this.M=this,this.F=null}R(ot,ee),ot.prototype[ce]=!0,ot.prototype.removeEventListener=function(a,c,f,y){Gt(this,a,c,f,y)};function tt(a,c){var f,y=a.F;if(y)for(f=[];y;y=y.F)f.push(y);if(a=a.M,y=c.type||c,typeof c=="string")c=new oe(c,a);else if(c instanceof oe)c.target=c.target||a;else{var D=c;c=new oe(y,a),S(c,D)}if(D=!0,f)for(var M=f.length-1;0<=M;M--){var Q=c.g=f[M];D=Ur(Q,y,!0,c)&&D}if(Q=c.g=a,D=Ur(Q,y,!0,c)&&D,D=Ur(Q,y,!1,c)&&D,f)for(M=0;M<f.length;M++)Q=c.g=f[M],D=Ur(Q,y,!1,c)&&D}ot.prototype.N=function(){if(ot.aa.N.call(this),this.i){var a=this.i,c;for(c in a.g){for(var f=a.g[c],y=0;y<f.length;y++)re(f[y]);delete a.g[c],a.h--}}this.F=null},ot.prototype.K=function(a,c,f,y){return this.i.add(String(a),c,!1,f,y)},ot.prototype.L=function(a,c,f,y){return this.i.add(String(a),c,!0,f,y)};function Ur(a,c,f,y){if(c=a.i.g[String(c)],!c)return!0;c=c.concat();for(var D=!0,M=0;M<c.length;++M){var Q=c[M];if(Q&&!Q.da&&Q.capture==f){var Ce=Q.listener,dt=Q.ha||Q.src;Q.fa&&Ge(a.i,Q),D=Ce.call(dt,y)!==!1&&D}}return D&&!y.defaultPrevented}function lu(a,c,f){if(typeof a=="function")f&&(a=v(a,f));else if(a&&typeof a.handleEvent=="function")a=v(a.handleEvent,a);else throw Error("Invalid listener argument");return 2147483647<Number(c)?-1:l.setTimeout(a,c||0)}function Qo(a){a.g=lu(()=>{a.g=null,a.i&&(a.i=!1,Qo(a))},a.l);const c=a.h;a.h=null,a.m.apply(null,c)}class Se extends ee{constructor(c,f){super(),this.m=c,this.l=f,this.h=null,this.i=!1,this.g=null}j(c){this.h=arguments,this.g?this.i=!0:Qo(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Rn(a){ee.call(this),this.h=a,this.g={}}R(Rn,ee);var uu=[];function pi(a){j(a.g,function(c,f){this.g.hasOwnProperty(f)&&ar(c)},a),a.g={}}Rn.prototype.N=function(){Rn.aa.N.call(this),pi(this)},Rn.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var gi=l.JSON.stringify,Ko=l.JSON.parse,mi=class{stringify(a){return l.JSON.stringify(a,void 0)}parse(a){return l.JSON.parse(a,void 0)}};function Fn(){}Fn.prototype.h=null;function ur(a){return a.h||(a.h=a.i())}function Qt(){}var gn={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function mn(){oe.call(this,"d")}R(mn,oe);function yi(){oe.call(this,"c")}R(yi,oe);var zn={},vi=null;function $r(){return vi=vi||new ot}zn.La="serverreachability";function _i(a){oe.call(this,zn.La,a)}R(_i,oe);function Bn(a){const c=$r();tt(c,new _i(c))}zn.STAT_EVENT="statevent";function xi(a,c){oe.call(this,zn.STAT_EVENT,a),this.stat=c}R(xi,oe);function We(a){const c=$r();tt(c,new xi(c,a))}zn.Ma="timingevent";function Yo(a,c){oe.call(this,zn.Ma,a),this.size=c}R(Yo,oe);function Kt(a,c){if(typeof a!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){a()},c)}function Wr(){this.g=!0}Wr.prototype.xa=function(){this.g=!1};function q(a,c,f,y,D,M){a.info(function(){if(a.g)if(M)for(var Q="",Ce=M.split("&"),dt=0;dt<Ce.length;dt++){var _e=Ce[dt].split("=");if(1<_e.length){var xt=_e[0];_e=_e[1];var wt=xt.split("_");Q=2<=wt.length&&wt[1]=="type"?Q+(xt+"="+_e+"&"):Q+(xt+"=redacted&")}}else Q=null;else Q=M;return"XMLHTTP REQ ("+y+") [attempt "+D+"]: "+c+`
`+f+`
`+Q})}function K(a,c,f,y,D,M,Q){a.info(function(){return"XMLHTTP RESP ("+y+") [ attempt "+D+"]: "+c+`
`+f+`
`+M+" "+Q})}function G(a,c,f,y){a.info(function(){return"XMLHTTP TEXT ("+c+"): "+Ie(a,f)+(y?" "+y:"")})}function ie(a,c){a.info(function(){return"TIMEOUT: "+c})}Wr.prototype.info=function(){};function Ie(a,c){if(!a.g)return c;if(!c)return null;try{var f=JSON.parse(c);if(f){for(a=0;a<f.length;a++)if(Array.isArray(f[a])){var y=f[a];if(!(2>y.length)){var D=y[1];if(Array.isArray(D)&&!(1>D.length)){var M=D[0];if(M!="noop"&&M!="stop"&&M!="close")for(var Q=1;Q<D.length;Q++)D[Q]=""}}}}return gi(f)}catch{return c}}var Oe={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},nt={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},kt;function at(){}R(at,Fn),at.prototype.g=function(){return new XMLHttpRequest},at.prototype.i=function(){return{}},kt=new at;function Ye(a,c,f,y){this.j=a,this.i=c,this.l=f,this.R=y||1,this.U=new Rn(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new ys}function ys(){this.i=null,this.g="",this.h=!1}var vs={},cr={};function Vt(a,c,f){a.L=1,a.v=ea(Un(c)),a.m=f,a.P=!0,pe(a,null)}function pe(a,c){a.F=Date.now(),Xo(a),a.A=Un(a.v);var f=a.A,y=a.R;Array.isArray(y)||(y=[String(y)]),af(f.i,"t",y),a.C=0,f=a.j.J,a.h=new ys,a.g=If(a.j,f?c:null,!a.m),0<a.O&&(a.M=new Se(v(a.Y,a,a.g),a.O)),c=a.U,f=a.g,y=a.ca;var D="readystatechange";Array.isArray(D)||(D&&(uu[0]=D.toString()),D=uu);for(var M=0;M<D.length;M++){var Q=Wt(f,D[M],y||c.handleEvent,!1,c.h||c);if(!Q)break;c.g[Q.key]=Q}c=a.H?_(a.H):{},a.m?(a.u||(a.u="POST"),c["Content-Type"]="application/x-www-form-urlencoded",a.g.ea(a.A,a.u,a.m,c)):(a.u="GET",a.g.ea(a.A,a.u,null,c)),Bn(),q(a.i,a.u,a.A,a.l,a.R,a.m)}Ye.prototype.ca=function(a){a=a.target;const c=this.M;c&&$n(a)==3?c.j():this.Y(a)},Ye.prototype.Y=function(a){try{if(a==this.g)e:{const wt=$n(this.g);var c=this.g.Ba();const ws=this.g.Z();if(!(3>wt)&&(wt!=3||this.g&&(this.h.h||this.g.oa()||pf(this.g)))){this.J||wt!=4||c==7||(c==8||0>=ws?Bn(3):Bn(2)),cu(this);var f=this.g.Z();this.X=f;t:if(Rt(this)){var y=pf(this.g);a="";var D=y.length,M=$n(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Hr(this),wi(this);var Q="";break t}this.h.i=new l.TextDecoder}for(c=0;c<D;c++)this.h.h=!0,a+=this.h.i.decode(y[c],{stream:!(M&&c==D-1)});y.length=0,this.h.g+=a,this.C=0,Q=this.h.g}else Q=this.g.oa();if(this.o=f==200,K(this.i,this.u,this.A,this.l,this.R,wt,f),this.o){if(this.T&&!this.K){t:{if(this.g){var Ce,dt=this.g;if((Ce=dt.g?dt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!I(Ce)){var _e=Ce;break t}}_e=null}if(f=_e)G(this.i,this.l,f,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,du(this,f);else{this.o=!1,this.s=3,We(12),Hr(this),wi(this);break e}}if(this.P){f=!0;let vn;for(;!this.J&&this.C<Q.length;)if(vn=yn(this,Q),vn==cr){wt==4&&(this.s=4,We(14),f=!1),G(this.i,this.l,null,"[Incomplete Response]");break}else if(vn==vs){this.s=4,We(15),G(this.i,this.l,Q,"[Invalid Chunk]"),f=!1;break}else G(this.i,this.l,vn,null),du(this,vn);if(Rt(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),wt!=4||Q.length!=0||this.h.h||(this.s=1,We(16),f=!1),this.o=this.o&&f,!f)G(this.i,this.l,Q,"[Invalid Chunked Response]"),Hr(this),wi(this);else if(0<Q.length&&!this.W){this.W=!0;var xt=this.j;xt.g==this&&xt.ba&&!xt.M&&(xt.j.info("Great, no buffering proxy detected. Bytes received: "+Q.length),yu(xt),xt.M=!0,We(11))}}else G(this.i,this.l,Q,null),du(this,Q);wt==4&&Hr(this),this.o&&!this.J&&(wt==4?wf(this.j,this):(this.o=!1,Xo(this)))}else Kv(this.g),f==400&&0<Q.indexOf("Unknown SID")?(this.s=3,We(12)):(this.s=0,We(13)),Hr(this),wi(this)}}}catch{}finally{}};function Rt(a){return a.g?a.u=="GET"&&a.L!=2&&a.j.Ca:!1}function yn(a,c){var f=a.C,y=c.indexOf(`
`,f);return y==-1?cr:(f=Number(c.substring(f,y)),isNaN(f)?vs:(y+=1,y+f>c.length?cr:(c=c.slice(y,y+f),a.C=y+f,c)))}Ye.prototype.cancel=function(){this.J=!0,Hr(this)};function Xo(a){a.S=Date.now()+a.I,Qh(a,a.I)}function Qh(a,c){if(a.B!=null)throw Error("WatchDog timer not null");a.B=Kt(v(a.ba,a),c)}function cu(a){a.B&&(l.clearTimeout(a.B),a.B=null)}Ye.prototype.ba=function(){this.B=null;const a=Date.now();0<=a-this.S?(ie(this.i,this.A),this.L!=2&&(Bn(),We(17)),Hr(this),this.s=2,wi(this)):Qh(this,this.S-a)};function wi(a){a.j.G==0||a.J||wf(a.j,a)}function Hr(a){cu(a);var c=a.M;c&&typeof c.ma=="function"&&c.ma(),a.M=null,pi(a.U),a.g&&(c=a.g,a.g=null,c.abort(),c.ma())}function du(a,c){try{var f=a.j;if(f.G!=0&&(f.g==a||hu(f.h,a))){if(!a.K&&hu(f.h,a)&&f.G==3){try{var y=f.Da.g.parse(c)}catch{y=null}if(Array.isArray(y)&&y.length==3){var D=y;if(D[0]==0){e:if(!f.u){if(f.g)if(f.g.F+3e3<a.F)oa(f),sa(f);else break e;mu(f),We(18)}}else f.za=D[1],0<f.za-f.T&&37500>D[2]&&f.F&&f.v==0&&!f.C&&(f.C=Kt(v(f.Za,f),6e3));if(1>=Xh(f.h)&&f.ca){try{f.ca()}catch{}f.ca=void 0}}else Gr(f,11)}else if((a.K||f.g==a)&&oa(f),!I(c))for(D=f.Da.g.parse(c),c=0;c<D.length;c++){let _e=D[c];if(f.T=_e[0],_e=_e[1],f.G==2)if(_e[0]=="c"){f.K=_e[1],f.ia=_e[2];const xt=_e[3];xt!=null&&(f.la=xt,f.j.info("VER="+f.la));const wt=_e[4];wt!=null&&(f.Aa=wt,f.j.info("SVER="+f.Aa));const ws=_e[5];ws!=null&&typeof ws=="number"&&0<ws&&(y=1.5*ws,f.L=y,f.j.info("backChannelRequestTimeoutMs_="+y)),y=f;const vn=a.g;if(vn){const la=vn.g?vn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(la){var M=y.h;M.g||la.indexOf("spdy")==-1&&la.indexOf("quic")==-1&&la.indexOf("h2")==-1||(M.j=M.l,M.g=new Set,M.h&&(fu(M,M.h),M.h=null))}if(y.D){const vu=vn.g?vn.g.getResponseHeader("X-HTTP-Session-Id"):null;vu&&(y.ya=vu,De(y.I,y.D,vu))}}f.G=3,f.l&&f.l.ua(),f.ba&&(f.R=Date.now()-a.F,f.j.info("Handshake RTT: "+f.R+"ms")),y=f;var Q=a;if(y.qa=Tf(y,y.J?y.ia:null,y.W),Q.K){Jh(y.h,Q);var Ce=Q,dt=y.L;dt&&(Ce.I=dt),Ce.B&&(cu(Ce),Xo(Ce)),y.g=Q}else _f(y);0<f.i.length&&ia(f)}else _e[0]!="stop"&&_e[0]!="close"||Gr(f,7);else f.G==3&&(_e[0]=="stop"||_e[0]=="close"?_e[0]=="stop"?Gr(f,7):gu(f):_e[0]!="noop"&&f.l&&f.l.ta(_e),f.v=0)}}Bn(4)}catch{}}var Nv=class{constructor(a,c){this.g=a,this.map=c}};function Kh(a){this.l=a||10,l.PerformanceNavigationTiming?(a=l.performance.getEntriesByType("navigation"),a=0<a.length&&(a[0].nextHopProtocol=="hq"||a[0].nextHopProtocol=="h2")):a=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=a?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Yh(a){return a.h?!0:a.g?a.g.size>=a.j:!1}function Xh(a){return a.h?1:a.g?a.g.size:0}function hu(a,c){return a.h?a.h==c:a.g?a.g.has(c):!1}function fu(a,c){a.g?a.g.add(c):a.h=c}function Jh(a,c){a.h&&a.h==c?a.h=null:a.g&&a.g.has(c)&&a.g.delete(c)}Kh.prototype.cancel=function(){if(this.i=Zh(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const a of this.g.values())a.cancel();this.g.clear()}};function Zh(a){if(a.h!=null)return a.i.concat(a.h.D);if(a.g!=null&&a.g.size!==0){let c=a.i;for(const f of a.g.values())c=c.concat(f.D);return c}return P(a.i)}function Mv(a){if(a.V&&typeof a.V=="function")return a.V();if(typeof Map<"u"&&a instanceof Map||typeof Set<"u"&&a instanceof Set)return Array.from(a.values());if(typeof a=="string")return a.split("");if(u(a)){for(var c=[],f=a.length,y=0;y<f;y++)c.push(a[y]);return c}c=[],f=0;for(y in a)c[f++]=a[y];return c}function Vv(a){if(a.na&&typeof a.na=="function")return a.na();if(!a.V||typeof a.V!="function"){if(typeof Map<"u"&&a instanceof Map)return Array.from(a.keys());if(!(typeof Set<"u"&&a instanceof Set)){if(u(a)||typeof a=="string"){var c=[];a=a.length;for(var f=0;f<a;f++)c.push(f);return c}c=[],f=0;for(const y in a)c[f++]=y;return c}}}function ef(a,c){if(a.forEach&&typeof a.forEach=="function")a.forEach(c,void 0);else if(u(a)||typeof a=="string")Array.prototype.forEach.call(a,c,void 0);else for(var f=Vv(a),y=Mv(a),D=y.length,M=0;M<D;M++)c.call(void 0,y[M],f&&f[M],a)}var tf=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function jv(a,c){if(a){a=a.split("&");for(var f=0;f<a.length;f++){var y=a[f].indexOf("="),D=null;if(0<=y){var M=a[f].substring(0,y);D=a[f].substring(y+1)}else M=a[f];c(M,D?decodeURIComponent(D.replace(/\+/g," ")):"")}}}function qr(a){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,a instanceof qr){this.h=a.h,Jo(this,a.j),this.o=a.o,this.g=a.g,Zo(this,a.s),this.l=a.l;var c=a.i,f=new Ti;f.i=c.i,c.g&&(f.g=new Map(c.g),f.h=c.h),nf(this,f),this.m=a.m}else a&&(c=String(a).match(tf))?(this.h=!1,Jo(this,c[1]||"",!0),this.o=Si(c[2]||""),this.g=Si(c[3]||"",!0),Zo(this,c[4]),this.l=Si(c[5]||"",!0),nf(this,c[6]||"",!0),this.m=Si(c[7]||"")):(this.h=!1,this.i=new Ti(null,this.h))}qr.prototype.toString=function(){var a=[],c=this.j;c&&a.push(Ei(c,rf,!0),":");var f=this.g;return(f||c=="file")&&(a.push("//"),(c=this.o)&&a.push(Ei(c,rf,!0),"@"),a.push(encodeURIComponent(String(f)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f=this.s,f!=null&&a.push(":",String(f))),(f=this.l)&&(this.g&&f.charAt(0)!="/"&&a.push("/"),a.push(Ei(f,f.charAt(0)=="/"?Fv:Ov,!0))),(f=this.i.toString())&&a.push("?",f),(f=this.m)&&a.push("#",Ei(f,Bv)),a.join("")};function Un(a){return new qr(a)}function Jo(a,c,f){a.j=f?Si(c,!0):c,a.j&&(a.j=a.j.replace(/:$/,""))}function Zo(a,c){if(c){if(c=Number(c),isNaN(c)||0>c)throw Error("Bad port number "+c);a.s=c}else a.s=null}function nf(a,c,f){c instanceof Ti?(a.i=c,Uv(a.i,a.h)):(f||(c=Ei(c,zv)),a.i=new Ti(c,a.h))}function De(a,c,f){a.i.set(c,f)}function ea(a){return De(a,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),a}function Si(a,c){return a?c?decodeURI(a.replace(/%25/g,"%2525")):decodeURIComponent(a):""}function Ei(a,c,f){return typeof a=="string"?(a=encodeURI(a).replace(c,Lv),f&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null}function Lv(a){return a=a.charCodeAt(0),"%"+(a>>4&15).toString(16)+(a&15).toString(16)}var rf=/[#\/\?@]/g,Ov=/[#\?:]/g,Fv=/[#\?]/g,zv=/[#\?@]/g,Bv=/#/g;function Ti(a,c){this.h=this.g=null,this.i=a||null,this.j=!!c}function dr(a){a.g||(a.g=new Map,a.h=0,a.i&&jv(a.i,function(c,f){a.add(decodeURIComponent(c.replace(/\+/g," ")),f)}))}t=Ti.prototype,t.add=function(a,c){dr(this),this.i=null,a=_s(this,a);var f=this.g.get(a);return f||this.g.set(a,f=[]),f.push(c),this.h+=1,this};function sf(a,c){dr(a),c=_s(a,c),a.g.has(c)&&(a.i=null,a.h-=a.g.get(c).length,a.g.delete(c))}function of(a,c){return dr(a),c=_s(a,c),a.g.has(c)}t.forEach=function(a,c){dr(this),this.g.forEach(function(f,y){f.forEach(function(D){a.call(c,D,y,this)},this)},this)},t.na=function(){dr(this);const a=Array.from(this.g.values()),c=Array.from(this.g.keys()),f=[];for(let y=0;y<c.length;y++){const D=a[y];for(let M=0;M<D.length;M++)f.push(c[y])}return f},t.V=function(a){dr(this);let c=[];if(typeof a=="string")of(this,a)&&(c=c.concat(this.g.get(_s(this,a))));else{a=Array.from(this.g.values());for(let f=0;f<a.length;f++)c=c.concat(a[f])}return c},t.set=function(a,c){return dr(this),this.i=null,a=_s(this,a),of(this,a)&&(this.h-=this.g.get(a).length),this.g.set(a,[c]),this.h+=1,this},t.get=function(a,c){return a?(a=this.V(a),0<a.length?String(a[0]):c):c};function af(a,c,f){sf(a,c),0<f.length&&(a.i=null,a.g.set(_s(a,c),P(f)),a.h+=f.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const a=[],c=Array.from(this.g.keys());for(var f=0;f<c.length;f++){var y=c[f];const M=encodeURIComponent(String(y)),Q=this.V(y);for(y=0;y<Q.length;y++){var D=M;Q[y]!==""&&(D+="="+encodeURIComponent(String(Q[y]))),a.push(D)}}return this.i=a.join("&")};function _s(a,c){return c=String(c),a.j&&(c=c.toLowerCase()),c}function Uv(a,c){c&&!a.j&&(dr(a),a.i=null,a.g.forEach(function(f,y){var D=y.toLowerCase();y!=D&&(sf(this,y),af(this,D,f))},a)),a.j=c}function $v(a,c){const f=new Wr;if(l.Image){const y=new Image;y.onload=k(hr,f,"TestLoadImage: loaded",!0,c,y),y.onerror=k(hr,f,"TestLoadImage: error",!1,c,y),y.onabort=k(hr,f,"TestLoadImage: abort",!1,c,y),y.ontimeout=k(hr,f,"TestLoadImage: timeout",!1,c,y),l.setTimeout(function(){y.ontimeout&&y.ontimeout()},1e4),y.src=a}else c(!1)}function Wv(a,c){const f=new Wr,y=new AbortController,D=setTimeout(()=>{y.abort(),hr(f,"TestPingServer: timeout",!1,c)},1e4);fetch(a,{signal:y.signal}).then(M=>{clearTimeout(D),M.ok?hr(f,"TestPingServer: ok",!0,c):hr(f,"TestPingServer: server error",!1,c)}).catch(()=>{clearTimeout(D),hr(f,"TestPingServer: error",!1,c)})}function hr(a,c,f,y,D){try{D&&(D.onload=null,D.onerror=null,D.onabort=null,D.ontimeout=null),y(f)}catch{}}function Hv(){this.g=new mi}function qv(a,c,f){const y=f||"";try{ef(a,function(D,M){let Q=D;h(D)&&(Q=gi(D)),c.push(y+M+"="+encodeURIComponent(Q))})}catch(D){throw c.push(y+"type="+encodeURIComponent("_badmap")),D}}function ta(a){this.l=a.Ub||null,this.j=a.eb||!1}R(ta,Fn),ta.prototype.g=function(){return new na(this.l,this.j)},ta.prototype.i=function(a){return function(){return a}}({});function na(a,c){ot.call(this),this.D=a,this.o=c,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}R(na,ot),t=na.prototype,t.open=function(a,c){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=a,this.A=c,this.readyState=1,Ai(this)},t.send=function(a){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const c={headers:this.u,method:this.B,credentials:this.m,cache:void 0};a&&(c.body=a),(this.D||l).fetch(new Request(this.A,c)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Ii(this)),this.readyState=0},t.Sa=function(a){if(this.g&&(this.l=a,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=a.headers,this.readyState=2,Ai(this)),this.g&&(this.readyState=3,Ai(this),this.g)))if(this.responseType==="arraybuffer")a.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in a){if(this.j=a.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;lf(this)}else a.text().then(this.Ra.bind(this),this.ga.bind(this))};function lf(a){a.j.read().then(a.Pa.bind(a)).catch(a.ga.bind(a))}t.Pa=function(a){if(this.g){if(this.o&&a.value)this.response.push(a.value);else if(!this.o){var c=a.value?a.value:new Uint8Array(0);(c=this.v.decode(c,{stream:!a.done}))&&(this.response=this.responseText+=c)}a.done?Ii(this):Ai(this),this.readyState==3&&lf(this)}},t.Ra=function(a){this.g&&(this.response=this.responseText=a,Ii(this))},t.Qa=function(a){this.g&&(this.response=a,Ii(this))},t.ga=function(){this.g&&Ii(this)};function Ii(a){a.readyState=4,a.l=null,a.j=null,a.v=null,Ai(a)}t.setRequestHeader=function(a,c){this.u.append(a,c)},t.getResponseHeader=function(a){return this.h&&this.h.get(a.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const a=[],c=this.h.entries();for(var f=c.next();!f.done;)f=f.value,a.push(f[0]+": "+f[1]),f=c.next();return a.join(`\r
`)};function Ai(a){a.onreadystatechange&&a.onreadystatechange.call(a)}Object.defineProperty(na.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(a){this.m=a?"include":"same-origin"}});function uf(a){let c="";return j(a,function(f,y){c+=y,c+=":",c+=f,c+=`\r
`}),c}function pu(a,c,f){e:{for(y in f){var y=!1;break e}y=!0}y||(f=uf(f),typeof a=="string"?f!=null&&encodeURIComponent(String(f)):De(a,c,f))}function He(a){ot.call(this),this.headers=new Map,this.o=a||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}R(He,ot);var Gv=/^https?$/i,Qv=["POST","PUT"];t=He.prototype,t.Ha=function(a){this.J=a},t.ea=function(a,c,f,y){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+a);c=c?c.toUpperCase():"GET",this.D=a,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():kt.g(),this.v=this.o?ur(this.o):ur(kt),this.g.onreadystatechange=v(this.Ea,this);try{this.B=!0,this.g.open(c,String(a),!0),this.B=!1}catch(M){cf(this,M);return}if(a=f||"",f=new Map(this.headers),y)if(Object.getPrototypeOf(y)===Object.prototype)for(var D in y)f.set(D,y[D]);else if(typeof y.keys=="function"&&typeof y.get=="function")for(const M of y.keys())f.set(M,y.get(M));else throw Error("Unknown input type for opt_headers: "+String(y));y=Array.from(f.keys()).find(M=>M.toLowerCase()=="content-type"),D=l.FormData&&a instanceof l.FormData,!(0<=Array.prototype.indexOf.call(Qv,c,void 0))||y||D||f.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[M,Q]of f)this.g.setRequestHeader(M,Q);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{ff(this),this.u=!0,this.g.send(a),this.u=!1}catch(M){cf(this,M)}};function cf(a,c){a.h=!1,a.g&&(a.j=!0,a.g.abort(),a.j=!1),a.l=c,a.m=5,df(a),ra(a)}function df(a){a.A||(a.A=!0,tt(a,"complete"),tt(a,"error"))}t.abort=function(a){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=a||7,tt(this,"complete"),tt(this,"abort"),ra(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ra(this,!0)),He.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?hf(this):this.bb())},t.bb=function(){hf(this)};function hf(a){if(a.h&&typeof o<"u"&&(!a.v[1]||$n(a)!=4||a.Z()!=2)){if(a.u&&$n(a)==4)lu(a.Ea,0,a);else if(tt(a,"readystatechange"),$n(a)==4){a.h=!1;try{const Q=a.Z();e:switch(Q){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var c=!0;break e;default:c=!1}var f;if(!(f=c)){var y;if(y=Q===0){var D=String(a.D).match(tf)[1]||null;!D&&l.self&&l.self.location&&(D=l.self.location.protocol.slice(0,-1)),y=!Gv.test(D?D.toLowerCase():"")}f=y}if(f)tt(a,"complete"),tt(a,"success");else{a.m=6;try{var M=2<$n(a)?a.g.statusText:""}catch{M=""}a.l=M+" ["+a.Z()+"]",df(a)}}finally{ra(a)}}}}function ra(a,c){if(a.g){ff(a);const f=a.g,y=a.v[0]?()=>{}:null;a.g=null,a.v=null,c||tt(a,"ready");try{f.onreadystatechange=y}catch{}}}function ff(a){a.I&&(l.clearTimeout(a.I),a.I=null)}t.isActive=function(){return!!this.g};function $n(a){return a.g?a.g.readyState:0}t.Z=function(){try{return 2<$n(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(a){if(this.g){var c=this.g.responseText;return a&&c.indexOf(a)==0&&(c=c.substring(a.length)),Ko(c)}};function pf(a){try{if(!a.g)return null;if("response"in a.g)return a.g.response;switch(a.H){case"":case"text":return a.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in a.g)return a.g.mozResponseArrayBuffer}return null}catch{return null}}function Kv(a){const c={};a=(a.g&&2<=$n(a)&&a.g.getAllResponseHeaders()||"").split(`\r
`);for(let y=0;y<a.length;y++){if(I(a[y]))continue;var f=E(a[y]);const D=f[0];if(f=f[1],typeof f!="string")continue;f=f.trim();const M=c[D]||[];c[D]=M,M.push(f)}T(c,function(y){return y.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ci(a,c,f){return f&&f.internalChannelParams&&f.internalChannelParams[a]||c}function gf(a){this.Aa=0,this.i=[],this.j=new Wr,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Ci("failFast",!1,a),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Ci("baseRetryDelayMs",5e3,a),this.cb=Ci("retryDelaySeedMs",1e4,a),this.Wa=Ci("forwardChannelMaxRetries",2,a),this.wa=Ci("forwardChannelRequestTimeoutMs",2e4,a),this.pa=a&&a.xmlHttpFactory||void 0,this.Xa=a&&a.Tb||void 0,this.Ca=a&&a.useFetchStreams||!1,this.L=void 0,this.J=a&&a.supportsCrossDomainXhr||!1,this.K="",this.h=new Kh(a&&a.concurrentRequestLimit),this.Da=new Hv,this.P=a&&a.fastHandshake||!1,this.O=a&&a.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=a&&a.Rb||!1,a&&a.xa&&this.j.xa(),a&&a.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&a&&a.detectBufferingProxy||!1,this.ja=void 0,a&&a.longPollingTimeout&&0<a.longPollingTimeout&&(this.ja=a.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=gf.prototype,t.la=8,t.G=1,t.connect=function(a,c,f,y){We(0),this.W=a,this.H=c||{},f&&y!==void 0&&(this.H.OSID=f,this.H.OAID=y),this.F=this.X,this.I=Tf(this,null,this.W),ia(this)};function gu(a){if(mf(a),a.G==3){var c=a.U++,f=Un(a.I);if(De(f,"SID",a.K),De(f,"RID",c),De(f,"TYPE","terminate"),ki(a,f),c=new Ye(a,a.j,c),c.L=2,c.v=ea(Un(f)),f=!1,l.navigator&&l.navigator.sendBeacon)try{f=l.navigator.sendBeacon(c.v.toString(),"")}catch{}!f&&l.Image&&(new Image().src=c.v,f=!0),f||(c.g=If(c.j,null),c.g.ea(c.v)),c.F=Date.now(),Xo(c)}Ef(a)}function sa(a){a.g&&(yu(a),a.g.cancel(),a.g=null)}function mf(a){sa(a),a.u&&(l.clearTimeout(a.u),a.u=null),oa(a),a.h.cancel(),a.s&&(typeof a.s=="number"&&l.clearTimeout(a.s),a.s=null)}function ia(a){if(!Yh(a.h)&&!a.s){a.s=!0;var c=a.Ga;U||H(),N||(U(),N=!0),F.add(c,a),a.B=0}}function Yv(a,c){return Xh(a.h)>=a.h.j-(a.s?1:0)?!1:a.s?(a.i=c.D.concat(a.i),!0):a.G==1||a.G==2||a.B>=(a.Va?0:a.Wa)?!1:(a.s=Kt(v(a.Ga,a,c),Sf(a,a.B)),a.B++,!0)}t.Ga=function(a){if(this.s)if(this.s=null,this.G==1){if(!a){this.U=Math.floor(1e5*Math.random()),a=this.U++;const D=new Ye(this,this.j,a);let M=this.o;if(this.S&&(M?(M=_(M),S(M,this.S)):M=this.S),this.m!==null||this.O||(D.H=M,M=null),this.P)e:{for(var c=0,f=0;f<this.i.length;f++){t:{var y=this.i[f];if("__data__"in y.map&&(y=y.map.__data__,typeof y=="string")){y=y.length;break t}y=void 0}if(y===void 0)break;if(c+=y,4096<c){c=f;break e}if(c===4096||f===this.i.length-1){c=f+1;break e}}c=1e3}else c=1e3;c=vf(this,D,c),f=Un(this.I),De(f,"RID",a),De(f,"CVER",22),this.D&&De(f,"X-HTTP-Session-Id",this.D),ki(this,f),M&&(this.O?c="headers="+encodeURIComponent(String(uf(M)))+"&"+c:this.m&&pu(f,this.m,M)),fu(this.h,D),this.Ua&&De(f,"TYPE","init"),this.P?(De(f,"$req",c),De(f,"SID","null"),D.T=!0,Vt(D,f,null)):Vt(D,f,c),this.G=2}}else this.G==3&&(a?yf(this,a):this.i.length==0||Yh(this.h)||yf(this))};function yf(a,c){var f;c?f=c.l:f=a.U++;const y=Un(a.I);De(y,"SID",a.K),De(y,"RID",f),De(y,"AID",a.T),ki(a,y),a.m&&a.o&&pu(y,a.m,a.o),f=new Ye(a,a.j,f,a.B+1),a.m===null&&(f.H=a.o),c&&(a.i=c.D.concat(a.i)),c=vf(a,f,1e3),f.I=Math.round(.5*a.wa)+Math.round(.5*a.wa*Math.random()),fu(a.h,f),Vt(f,y,c)}function ki(a,c){a.H&&j(a.H,function(f,y){De(c,y,f)}),a.l&&ef({},function(f,y){De(c,y,f)})}function vf(a,c,f){f=Math.min(a.i.length,f);var y=a.l?v(a.l.Na,a.l,a):null;e:{var D=a.i;let M=-1;for(;;){const Q=["count="+f];M==-1?0<f?(M=D[0].g,Q.push("ofs="+M)):M=0:Q.push("ofs="+M);let Ce=!0;for(let dt=0;dt<f;dt++){let _e=D[dt].g;const xt=D[dt].map;if(_e-=M,0>_e)M=Math.max(0,D[dt].g-100),Ce=!1;else try{qv(xt,Q,"req"+_e+"_")}catch{y&&y(xt)}}if(Ce){y=Q.join("&");break e}}}return a=a.i.splice(0,f),c.D=a,y}function _f(a){if(!a.g&&!a.u){a.Y=1;var c=a.Fa;U||H(),N||(U(),N=!0),F.add(c,a),a.v=0}}function mu(a){return a.g||a.u||3<=a.v?!1:(a.Y++,a.u=Kt(v(a.Fa,a),Sf(a,a.v)),a.v++,!0)}t.Fa=function(){if(this.u=null,xf(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var a=2*this.R;this.j.info("BP detection timer enabled: "+a),this.A=Kt(v(this.ab,this),a)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,We(10),sa(this),xf(this))};function yu(a){a.A!=null&&(l.clearTimeout(a.A),a.A=null)}function xf(a){a.g=new Ye(a,a.j,"rpc",a.Y),a.m===null&&(a.g.H=a.o),a.g.O=0;var c=Un(a.qa);De(c,"RID","rpc"),De(c,"SID",a.K),De(c,"AID",a.T),De(c,"CI",a.F?"0":"1"),!a.F&&a.ja&&De(c,"TO",a.ja),De(c,"TYPE","xmlhttp"),ki(a,c),a.m&&a.o&&pu(c,a.m,a.o),a.L&&(a.g.I=a.L);var f=a.g;a=a.ia,f.L=1,f.v=ea(Un(c)),f.m=null,f.P=!0,pe(f,a)}t.Za=function(){this.C!=null&&(this.C=null,sa(this),mu(this),We(19))};function oa(a){a.C!=null&&(l.clearTimeout(a.C),a.C=null)}function wf(a,c){var f=null;if(a.g==c){oa(a),yu(a),a.g=null;var y=2}else if(hu(a.h,c))f=c.D,Jh(a.h,c),y=1;else return;if(a.G!=0){if(c.o)if(y==1){f=c.m?c.m.length:0,c=Date.now()-c.F;var D=a.B;y=$r(),tt(y,new Yo(y,f)),ia(a)}else _f(a);else if(D=c.s,D==3||D==0&&0<c.X||!(y==1&&Yv(a,c)||y==2&&mu(a)))switch(f&&0<f.length&&(c=a.h,c.i=c.i.concat(f)),D){case 1:Gr(a,5);break;case 4:Gr(a,10);break;case 3:Gr(a,6);break;default:Gr(a,2)}}}function Sf(a,c){let f=a.Ta+Math.floor(Math.random()*a.cb);return a.isActive()||(f*=2),f*c}function Gr(a,c){if(a.j.info("Error code "+c),c==2){var f=v(a.fb,a),y=a.Xa;const D=!y;y=new qr(y||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||Jo(y,"https"),ea(y),D?$v(y.toString(),f):Wv(y.toString(),f)}else We(2);a.G=0,a.l&&a.l.sa(c),Ef(a),mf(a)}t.fb=function(a){a?(this.j.info("Successfully pinged google.com"),We(2)):(this.j.info("Failed to ping google.com"),We(1))};function Ef(a){if(a.G=0,a.ka=[],a.l){const c=Zh(a.h);(c.length!=0||a.i.length!=0)&&(O(a.ka,c),O(a.ka,a.i),a.h.i.length=0,P(a.i),a.i.length=0),a.l.ra()}}function Tf(a,c,f){var y=f instanceof qr?Un(f):new qr(f);if(y.g!="")c&&(y.g=c+"."+y.g),Zo(y,y.s);else{var D=l.location;y=D.protocol,c=c?c+"."+D.hostname:D.hostname,D=+D.port;var M=new qr(null);y&&Jo(M,y),c&&(M.g=c),D&&Zo(M,D),f&&(M.l=f),y=M}return f=a.D,c=a.ya,f&&c&&De(y,f,c),De(y,"VER",a.la),ki(a,y),y}function If(a,c,f){if(c&&!a.J)throw Error("Can't create secondary domain capable XhrIo object.");return c=a.Ca&&!a.pa?new He(new ta({eb:f})):new He(a.pa),c.Ha(a.J),c}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Af(){}t=Af.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function aa(){}aa.prototype.g=function(a,c){return new Yt(a,c)};function Yt(a,c){ot.call(this),this.g=new gf(c),this.l=a,this.h=c&&c.messageUrlParams||null,a=c&&c.messageHeaders||null,c&&c.clientProtocolHeaderRequired&&(a?a["X-Client-Protocol"]="webchannel":a={"X-Client-Protocol":"webchannel"}),this.g.o=a,a=c&&c.initMessageHeaders||null,c&&c.messageContentType&&(a?a["X-WebChannel-Content-Type"]=c.messageContentType:a={"X-WebChannel-Content-Type":c.messageContentType}),c&&c.va&&(a?a["X-WebChannel-Client-Profile"]=c.va:a={"X-WebChannel-Client-Profile":c.va}),this.g.S=a,(a=c&&c.Sb)&&!I(a)&&(this.g.m=a),this.v=c&&c.supportsCrossDomainXhr||!1,this.u=c&&c.sendRawJson||!1,(c=c&&c.httpSessionIdParam)&&!I(c)&&(this.g.D=c,a=this.h,a!==null&&c in a&&(a=this.h,c in a&&delete a[c])),this.j=new xs(this)}R(Yt,ot),Yt.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Yt.prototype.close=function(){gu(this.g)},Yt.prototype.o=function(a){var c=this.g;if(typeof a=="string"){var f={};f.__data__=a,a=f}else this.u&&(f={},f.__data__=gi(a),a=f);c.i.push(new Nv(c.Ya++,a)),c.G==3&&ia(c)},Yt.prototype.N=function(){this.g.l=null,delete this.j,gu(this.g),delete this.g,Yt.aa.N.call(this)};function Cf(a){mn.call(this),a.__headers__&&(this.headers=a.__headers__,this.statusCode=a.__status__,delete a.__headers__,delete a.__status__);var c=a.__sm__;if(c){e:{for(const f in c){a=f;break e}a=void 0}(this.i=a)&&(a=this.i,c=c!==null&&a in c?c[a]:void 0),this.data=c}else this.data=a}R(Cf,mn);function kf(){yi.call(this),this.status=1}R(kf,yi);function xs(a){this.g=a}R(xs,Af),xs.prototype.ua=function(){tt(this.g,"a")},xs.prototype.ta=function(a){tt(this.g,new Cf(a))},xs.prototype.sa=function(a){tt(this.g,new kf)},xs.prototype.ra=function(){tt(this.g,"b")},aa.prototype.createWebChannel=aa.prototype.g,Yt.prototype.send=Yt.prototype.o,Yt.prototype.open=Yt.prototype.m,Yt.prototype.close=Yt.prototype.close,p0=function(){return new aa},f0=function(){return $r()},h0=zn,Xc={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Oe.NO_ERROR=0,Oe.TIMEOUT=8,Oe.HTTP_ERROR=6,Ua=Oe,nt.COMPLETE="complete",d0=nt,Qt.EventType=gn,gn.OPEN="a",gn.CLOSE="b",gn.ERROR="c",gn.MESSAGE="d",ot.prototype.listen=ot.prototype.K,Ui=Qt,He.prototype.listenOnce=He.prototype.L,He.prototype.getLastError=He.prototype.Ka,He.prototype.getLastErrorCode=He.prototype.Ba,He.prototype.getStatus=He.prototype.Z,He.prototype.getResponseJson=He.prototype.Oa,He.prototype.getResponseText=He.prototype.oa,He.prototype.send=He.prototype.ea,He.prototype.setWithCredentials=He.prototype.Ha,c0=He}).apply(typeof Aa<"u"?Aa:typeof self<"u"?self:typeof window<"u"?window:{});const Kp="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}jt.UNAUTHENTICATED=new jt(null),jt.GOOGLE_CREDENTIALS=new jt("google-credentials-uid"),jt.FIRST_PARTY=new jt("first-party-uid"),jt.MOCK_USER=new jt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ui="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const us=new n0("@firebase/firestore");function Li(){return us.logLevel}function ne(t,...e){if(us.logLevel<=ye.DEBUG){const n=e.map(fh);us.debug(`Firestore (${ui}): ${t}`,...n)}}function sr(t,...e){if(us.logLevel<=ye.ERROR){const n=e.map(fh);us.error(`Firestore (${ui}): ${t}`,...n)}}function Ao(t,...e){if(us.logLevel<=ye.WARN){const n=e.map(fh);us.warn(`Firestore (${ui}): ${t}`,...n)}}function fh(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ae(t="Unexpected state"){const e=`FIRESTORE (${ui}) INTERNAL ASSERTION FAILED: `+t;throw sr(e),new Error(e)}function Te(t,e){t||ae()}function ue(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Y extends li{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xn{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zw{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class eS{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(jt.UNAUTHENTICATED))}shutdown(){}}class tS{constructor(e){this.t=e,this.currentUser=jt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){Te(this.o===void 0);let r=this.i;const s=u=>this.i!==r?(r=this.i,n(u)):Promise.resolve();let i=new Xn;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Xn,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const u=i;e.enqueueRetryable(async()=>{await u.promise,await s(this.currentUser)})},l=u=>{ne("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(u=>l(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?l(u):(ne("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Xn)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(ne("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Te(typeof r.accessToken=="string"),new Zw(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Te(e===null||typeof e=="string"),new jt(e)}}class nS{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=jt.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class rS{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new nS(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(jt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class sS{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class iS{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){Te(this.o===void 0);const r=i=>{i.error!=null&&ne("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.R;return this.R=i.token,ne("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{ne("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.A.getImmediate({optional:!0});i?s(i):ne("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(Te(typeof n.token=="string"),this.R=n.token,new sS(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oS(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g0{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const s=oS(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%e.length))}return r}}function xe(t,e){return t<e?-1:t>e?1:0}function Zs(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class it{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new Y(z.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new Y(z.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new Y(z.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Y(z.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return it.fromMillis(Date.now())}static fromDate(e){return it.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new it(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?xe(this.nanoseconds,e.nanoseconds):xe(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class le{constructor(e){this.timestamp=e}static fromTimestamp(e){return new le(e)}static min(){return new le(new it(0,0))}static max(){return new le(new it(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Co{constructor(e,n,r){n===void 0?n=0:n>e.length&&ae(),r===void 0?r=e.length-n:r>e.length-n&&ae(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return Co.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Co?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=e.get(s),o=n.get(s);if(i<o)return-1;if(i>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class Me extends Co{construct(e,n,r){return new Me(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new Y(z.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new Me(n)}static emptyPath(){return new Me([])}}const aS=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class pt extends Co{construct(e,n,r){return new pt(e,n,r)}static isValidIdentifier(e){return aS.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),pt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new pt(["__name__"])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new Y(z.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;s<e.length;){const l=e[s];if(l==="\\"){if(s+1===e.length)throw new Y(z.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[s+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new Y(z.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,s+=2}else l==="`"?(o=!o,s++):l!=="."||o?(r+=l,s++):(i(),s++)}if(i(),o)throw new Y(z.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new pt(n)}static emptyPath(){return new pt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class se{constructor(e){this.path=e}static fromPath(e){return new se(Me.fromString(e))}static fromName(e){return new se(Me.fromString(e).popFirst(5))}static empty(){return new se(Me.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Me.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Me.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new se(new Me(e.slice()))}}function lS(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=le.fromTimestamp(r===1e9?new it(n+1,0):new it(n,r));return new Vr(s,se.empty(),e)}function uS(t){return new Vr(t.readTime,t.key,-1)}class Vr{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new Vr(le.min(),se.empty(),-1)}static max(){return new Vr(le.max(),se.empty(),-1)}}function cS(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=se.comparator(t.documentKey,e.documentKey),n!==0?n:xe(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dS="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class hS{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Fo(t){if(t.code!==z.FAILED_PRECONDITION||t.message!==dS)throw t;ne("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&ae(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new B((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof B?n:B.resolve(n)}catch(n){return B.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):B.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):B.reject(n)}static resolve(e){return new B((n,r)=>{n(e)})}static reject(e){return new B((n,r)=>{r(e)})}static waitFor(e){return new B((n,r)=>{let s=0,i=0,o=!1;e.forEach(l=>{++s,l.next(()=>{++i,o&&i===s&&n()},u=>r(u))}),o=!0,i===s&&n()})}static or(e){let n=B.resolve(!1);for(const r of e)n=n.next(s=>s?B.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new B((r,s)=>{const i=e.length,o=new Array(i);let l=0;for(let u=0;u<i;u++){const h=u;n(e[h]).next(p=>{o[h]=p,++l,l===i&&r(o)},p=>s(p))}})}static doWhile(e,n){return new B((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}function fS(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function zo(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ph{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ie(r),this.se=r=>n.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}ph.oe=-1;function ql(t){return t==null}function xl(t){return t===0&&1/t==-1/0}function pS(t){return typeof t=="number"&&Number.isInteger(t)&&!xl(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yp(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function ps(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function m0(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ue{constructor(e,n){this.comparator=e,this.root=n||ft.EMPTY}insert(e,n){return new Ue(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,ft.BLACK,null,null))}remove(e){return new Ue(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ft.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Ca(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Ca(this.root,e,this.comparator,!1)}getReverseIterator(){return new Ca(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Ca(this.root,e,this.comparator,!0)}}class Ca{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class ft{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??ft.RED,this.left=s??ft.EMPTY,this.right=i??ft.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new ft(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return ft.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return ft.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,ft.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,ft.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw ae();const e=this.left.check();if(e!==this.right.check())throw ae();return e+(this.isRed()?0:1)}}ft.EMPTY=null,ft.RED=!0,ft.BLACK=!1;ft.EMPTY=new class{constructor(){this.size=0}get key(){throw ae()}get value(){throw ae()}get color(){throw ae()}get left(){throw ae()}get right(){throw ae()}copy(e,n,r,s,i){return this}insert(e,n,r){return new ft(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mt{constructor(e){this.comparator=e,this.data=new Ue(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new Xp(this.data.getIterator())}getIteratorFrom(e){return new Xp(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof mt)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new mt(this.comparator);return n.data=e,n}}class Xp{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zt{constructor(e){this.fields=e,e.sort(pt.comparator)}static empty(){return new Zt([])}unionWith(e){let n=new mt(pt.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new Zt(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Zs(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y0 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vt{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new y0("Invalid base64 string: "+i):i}}(e);return new vt(n)}static fromUint8Array(e){const n=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(e);return new vt(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return xe(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}vt.EMPTY_BYTE_STRING=new vt("");const gS=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function jr(t){if(Te(!!t),typeof t=="string"){let e=0;const n=gS.exec(t);if(Te(!!n),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Qe(t.seconds),nanos:Qe(t.nanos)}}function Qe(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function cs(t){return typeof t=="string"?vt.fromBase64String(t):vt.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gh(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function mh(t){const e=t.mapValue.fields.__previous_value__;return gh(e)?mh(e):e}function ko(t){const e=jr(t.mapValue.fields.__local_write_time__.timestampValue);return new it(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mS{constructor(e,n,r,s,i,o,l,u,h){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=u,this.useFetchStreams=h}}class Ro{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new Ro("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Ro&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ka={mapValue:{}};function ds(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?gh(t)?4:vS(t)?9007199254740991:yS(t)?10:11:ae()}function Ln(t,e){if(t===e)return!0;const n=ds(t);if(n!==ds(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return ko(t).isEqual(ko(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=jr(s.timestampValue),l=jr(i.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return cs(s.bytesValue).isEqual(cs(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return Qe(s.geoPointValue.latitude)===Qe(i.geoPointValue.latitude)&&Qe(s.geoPointValue.longitude)===Qe(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return Qe(s.integerValue)===Qe(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=Qe(s.doubleValue),l=Qe(i.doubleValue);return o===l?xl(o)===xl(l):isNaN(o)&&isNaN(l)}return!1}(t,e);case 9:return Zs(t.arrayValue.values||[],e.arrayValue.values||[],Ln);case 10:case 11:return function(s,i){const o=s.mapValue.fields||{},l=i.mapValue.fields||{};if(Yp(o)!==Yp(l))return!1;for(const u in o)if(o.hasOwnProperty(u)&&(l[u]===void 0||!Ln(o[u],l[u])))return!1;return!0}(t,e);default:return ae()}}function Po(t,e){return(t.values||[]).find(n=>Ln(n,e))!==void 0}function ei(t,e){if(t===e)return 0;const n=ds(t),r=ds(e);if(n!==r)return xe(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return xe(t.booleanValue,e.booleanValue);case 2:return function(i,o){const l=Qe(i.integerValue||i.doubleValue),u=Qe(o.integerValue||o.doubleValue);return l<u?-1:l>u?1:l===u?0:isNaN(l)?isNaN(u)?0:-1:1}(t,e);case 3:return Jp(t.timestampValue,e.timestampValue);case 4:return Jp(ko(t),ko(e));case 5:return xe(t.stringValue,e.stringValue);case 6:return function(i,o){const l=cs(i),u=cs(o);return l.compareTo(u)}(t.bytesValue,e.bytesValue);case 7:return function(i,o){const l=i.split("/"),u=o.split("/");for(let h=0;h<l.length&&h<u.length;h++){const p=xe(l[h],u[h]);if(p!==0)return p}return xe(l.length,u.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,o){const l=xe(Qe(i.latitude),Qe(o.latitude));return l!==0?l:xe(Qe(i.longitude),Qe(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return Zp(t.arrayValue,e.arrayValue);case 10:return function(i,o){var l,u,h,p;const g=i.fields||{},v=o.fields||{},k=(l=g.value)===null||l===void 0?void 0:l.arrayValue,R=(u=v.value)===null||u===void 0?void 0:u.arrayValue,P=xe(((h=k==null?void 0:k.values)===null||h===void 0?void 0:h.length)||0,((p=R==null?void 0:R.values)===null||p===void 0?void 0:p.length)||0);return P!==0?P:Zp(k,R)}(t.mapValue,e.mapValue);case 11:return function(i,o){if(i===ka.mapValue&&o===ka.mapValue)return 0;if(i===ka.mapValue)return 1;if(o===ka.mapValue)return-1;const l=i.fields||{},u=Object.keys(l),h=o.fields||{},p=Object.keys(h);u.sort(),p.sort();for(let g=0;g<u.length&&g<p.length;++g){const v=xe(u[g],p[g]);if(v!==0)return v;const k=ei(l[u[g]],h[p[g]]);if(k!==0)return k}return xe(u.length,p.length)}(t.mapValue,e.mapValue);default:throw ae()}}function Jp(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return xe(t,e);const n=jr(t),r=jr(e),s=xe(n.seconds,r.seconds);return s!==0?s:xe(n.nanos,r.nanos)}function Zp(t,e){const n=t.values||[],r=e.values||[];for(let s=0;s<n.length&&s<r.length;++s){const i=ei(n[s],r[s]);if(i)return i}return xe(n.length,r.length)}function ti(t){return Jc(t)}function Jc(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=jr(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return cs(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return se.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",s=!0;for(const i of n.values||[])s?s=!1:r+=",",r+=Jc(i);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",i=!0;for(const o of r)i?i=!1:s+=",",s+=`${o}:${Jc(n.fields[o])}`;return s+"}"}(t.mapValue):ae()}function eg(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Zc(t){return!!t&&"integerValue"in t}function yh(t){return!!t&&"arrayValue"in t}function tg(t){return!!t&&"nullValue"in t}function ng(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function $a(t){return!!t&&"mapValue"in t}function yS(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="__vector__"}function no(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return ps(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=no(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=no(t.arrayValue.values[n]);return e}return Object.assign({},t)}function vS(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ot{constructor(e){this.value=e}static empty(){return new Ot({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!$a(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=no(n)}setAll(e){let n=pt.emptyPath(),r={},s=[];e.forEach((o,l)=>{if(!n.isImmediateParentOf(l)){const u=this.getFieldsMap(n);this.applyChanges(u,r,s),r={},s=[],n=l.popLast()}o?r[l.lastSegment()]=no(o):s.push(l.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());$a(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Ln(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];$a(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){ps(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new Ot(no(this.value))}}function v0(t){const e=[];return ps(t.fields,(n,r)=>{const s=new pt([n]);if($a(r)){const i=v0(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new Zt(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class At{constructor(e,n,r,s,i,o,l){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=l}static newInvalidDocument(e){return new At(e,0,le.min(),le.min(),le.min(),Ot.empty(),0)}static newFoundDocument(e,n,r,s){return new At(e,1,n,le.min(),r,s,0)}static newNoDocument(e,n){return new At(e,2,n,le.min(),le.min(),Ot.empty(),0)}static newUnknownDocument(e,n){return new At(e,3,n,le.min(),le.min(),Ot.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(le.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ot.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ot.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=le.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof At&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new At(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wl{constructor(e,n){this.position=e,this.inclusive=n}}function rg(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],o=t.position[s];if(i.field.isKeyField()?r=se.comparator(se.fromName(o.referenceValue),n.key):r=ei(o,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function sg(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Ln(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sl{constructor(e,n="asc"){this.field=e,this.dir=n}}function _S(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _0{}class Ze extends _0{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new wS(e,n,r):n==="array-contains"?new TS(e,r):n==="in"?new IS(e,r):n==="not-in"?new AS(e,r):n==="array-contains-any"?new CS(e,r):new Ze(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new SS(e,r):new ES(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(ei(n,this.value)):n!==null&&ds(this.value)===ds(n)&&this.matchesComparison(ei(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ae()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Cn extends _0{constructor(e,n){super(),this.filters=e,this.op=n,this.ae=null}static create(e,n){return new Cn(e,n)}matches(e){return x0(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function x0(t){return t.op==="and"}function w0(t){return xS(t)&&x0(t)}function xS(t){for(const e of t.filters)if(e instanceof Cn)return!1;return!0}function ed(t){if(t instanceof Ze)return t.field.canonicalString()+t.op.toString()+ti(t.value);if(w0(t))return t.filters.map(e=>ed(e)).join(",");{const e=t.filters.map(n=>ed(n)).join(",");return`${t.op}(${e})`}}function S0(t,e){return t instanceof Ze?function(r,s){return s instanceof Ze&&r.op===s.op&&r.field.isEqual(s.field)&&Ln(r.value,s.value)}(t,e):t instanceof Cn?function(r,s){return s instanceof Cn&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,o,l)=>i&&S0(o,s.filters[l]),!0):!1}(t,e):void ae()}function E0(t){return t instanceof Ze?function(n){return`${n.field.canonicalString()} ${n.op} ${ti(n.value)}`}(t):t instanceof Cn?function(n){return n.op.toString()+" {"+n.getFilters().map(E0).join(" ,")+"}"}(t):"Filter"}class wS extends Ze{constructor(e,n,r){super(e,n,r),this.key=se.fromName(r.referenceValue)}matches(e){const n=se.comparator(e.key,this.key);return this.matchesComparison(n)}}class SS extends Ze{constructor(e,n){super(e,"in",n),this.keys=T0("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class ES extends Ze{constructor(e,n){super(e,"not-in",n),this.keys=T0("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function T0(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>se.fromName(r.referenceValue))}class TS extends Ze{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return yh(n)&&Po(n.arrayValue,this.value)}}class IS extends Ze{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Po(this.value.arrayValue,n)}}class AS extends Ze{constructor(e,n){super(e,"not-in",n)}matches(e){if(Po(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!Po(this.value.arrayValue,n)}}class CS extends Ze{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!yh(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Po(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kS{constructor(e,n=null,r=[],s=[],i=null,o=null,l=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=l,this.ue=null}}function ig(t,e=null,n=[],r=[],s=null,i=null,o=null){return new kS(t,e,n,r,s,i,o)}function vh(t){const e=ue(t);if(e.ue===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>ed(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),ql(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>ti(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>ti(r)).join(",")),e.ue=n}return e.ue}function _h(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!_S(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!S0(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!sg(t.startAt,e.startAt)&&sg(t.endAt,e.endAt)}function td(t){return se.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bo{constructor(e,n=null,r=[],s=[],i=null,o="F",l=null,u=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=l,this.endAt=u,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function RS(t,e,n,r,s,i,o,l){return new Bo(t,e,n,r,s,i,o,l)}function xh(t){return new Bo(t)}function og(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function I0(t){return t.collectionGroup!==null}function ro(t){const e=ue(t);if(e.ce===null){e.ce=[];const n=new Set;for(const i of e.explicitOrderBy)e.ce.push(i),n.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new mt(pt.comparator);return o.filters.forEach(u=>{u.getFlattenedFilters().forEach(h=>{h.isInequality()&&(l=l.add(h.field))})}),l})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.ce.push(new Sl(i,r))}),n.has(pt.keyField().canonicalString())||e.ce.push(new Sl(pt.keyField(),r))}return e.ce}function Vn(t){const e=ue(t);return e.le||(e.le=PS(e,ro(t))),e.le}function PS(t,e){if(t.limitType==="F")return ig(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new Sl(s.field,i)});const n=t.endAt?new wl(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new wl(t.startAt.position,t.startAt.inclusive):null;return ig(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function nd(t,e){const n=t.filters.concat([e]);return new Bo(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function rd(t,e,n){return new Bo(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Gl(t,e){return _h(Vn(t),Vn(e))&&t.limitType===e.limitType}function A0(t){return`${vh(Vn(t))}|lt:${t.limitType}`}function Es(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>E0(s)).join(", ")}]`),ql(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>ti(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>ti(s)).join(",")),`Target(${r})`}(Vn(t))}; limitType=${t.limitType})`}function Ql(t,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):se.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(t,e)&&function(r,s){for(const i of ro(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(r,s){return!(r.startAt&&!function(o,l,u){const h=rg(o,l,u);return o.inclusive?h<=0:h<0}(r.startAt,ro(r),s)||r.endAt&&!function(o,l,u){const h=rg(o,l,u);return o.inclusive?h>=0:h>0}(r.endAt,ro(r),s))}(t,e)}function bS(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function C0(t){return(e,n)=>{let r=!1;for(const s of ro(t)){const i=DS(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function DS(t,e,n){const r=t.field.isKeyField()?se.comparator(e.key,n.key):function(i,o,l){const u=o.data.field(i),h=l.data.field(i);return u!==null&&h!==null?ei(u,h):ae()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return ae()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ci{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){ps(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return m0(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NS=new Ue(se.comparator);function ir(){return NS}const k0=new Ue(se.comparator);function $i(...t){let e=k0;for(const n of t)e=e.insert(n.key,n);return e}function R0(t){let e=k0;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function es(){return so()}function P0(){return so()}function so(){return new ci(t=>t.toString(),(t,e)=>t.isEqual(e))}const MS=new Ue(se.comparator),VS=new mt(se.comparator);function fe(...t){let e=VS;for(const n of t)e=e.add(n);return e}const jS=new mt(xe);function LS(){return jS}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wh(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:xl(e)?"-0":e}}function b0(t){return{integerValue:""+t}}function OS(t,e){return pS(e)?b0(e):wh(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kl{constructor(){this._=void 0}}function FS(t,e,n){return t instanceof bo?function(s,i){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&gh(i)&&(i=mh(i)),i&&(o.fields.__previous_value__=i),{mapValue:o}}(n,e):t instanceof Do?N0(t,e):t instanceof No?M0(t,e):function(s,i){const o=D0(s,i),l=ag(o)+ag(s.Pe);return Zc(o)&&Zc(s.Pe)?b0(l):wh(s.serializer,l)}(t,e)}function zS(t,e,n){return t instanceof Do?N0(t,e):t instanceof No?M0(t,e):n}function D0(t,e){return t instanceof El?function(r){return Zc(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class bo extends Kl{}class Do extends Kl{constructor(e){super(),this.elements=e}}function N0(t,e){const n=V0(e);for(const r of t.elements)n.some(s=>Ln(s,r))||n.push(r);return{arrayValue:{values:n}}}class No extends Kl{constructor(e){super(),this.elements=e}}function M0(t,e){let n=V0(e);for(const r of t.elements)n=n.filter(s=>!Ln(s,r));return{arrayValue:{values:n}}}class El extends Kl{constructor(e,n){super(),this.serializer=e,this.Pe=n}}function ag(t){return Qe(t.integerValue||t.doubleValue)}function V0(t){return yh(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BS{constructor(e,n){this.field=e,this.transform=n}}function US(t,e){return t.field.isEqual(e.field)&&function(r,s){return r instanceof Do&&s instanceof Do||r instanceof No&&s instanceof No?Zs(r.elements,s.elements,Ln):r instanceof El&&s instanceof El?Ln(r.Pe,s.Pe):r instanceof bo&&s instanceof bo}(t.transform,e.transform)}class $S{constructor(e,n){this.version=e,this.transformResults=n}}class hn{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new hn}static exists(e){return new hn(void 0,e)}static updateTime(e){return new hn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Wa(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Yl{}function j0(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Sh(t.key,hn.none()):new Uo(t.key,t.data,hn.none());{const n=t.data,r=Ot.empty();let s=new mt(pt.comparator);for(let i of e.fields)if(!s.has(i)){let o=n.field(i);o===null&&i.length>1&&(i=i.popLast(),o=n.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new Br(t.key,r,new Zt(s.toArray()),hn.none())}}function WS(t,e,n){t instanceof Uo?function(s,i,o){const l=s.value.clone(),u=ug(s.fieldTransforms,i,o.transformResults);l.setAll(u),i.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,n):t instanceof Br?function(s,i,o){if(!Wa(s.precondition,i))return void i.convertToUnknownDocument(o.version);const l=ug(s.fieldTransforms,i,o.transformResults),u=i.data;u.setAll(L0(s)),u.setAll(l),i.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(t,e,n):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function io(t,e,n,r){return t instanceof Uo?function(i,o,l,u){if(!Wa(i.precondition,o))return l;const h=i.value.clone(),p=cg(i.fieldTransforms,u,o);return h.setAll(p),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),null}(t,e,n,r):t instanceof Br?function(i,o,l,u){if(!Wa(i.precondition,o))return l;const h=cg(i.fieldTransforms,u,o),p=o.data;return p.setAll(L0(i)),p.setAll(h),o.convertToFoundDocument(o.version,p).setHasLocalMutations(),l===null?null:l.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(g=>g.field))}(t,e,n,r):function(i,o,l){return Wa(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l}(t,e,n)}function HS(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=D0(r.transform,s||null);i!=null&&(n===null&&(n=Ot.empty()),n.set(r.field,i))}return n||null}function lg(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&Zs(r,s,(i,o)=>US(i,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Uo extends Yl{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Br extends Yl{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function L0(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function ug(t,e,n){const r=new Map;Te(t.length===n.length);for(let s=0;s<n.length;s++){const i=t[s],o=i.transform,l=e.data.field(i.field);r.set(i.field,zS(o,l,n[s]))}return r}function cg(t,e,n){const r=new Map;for(const s of t){const i=s.transform,o=n.data.field(s.field);r.set(s.field,FS(i,o,e))}return r}class Sh extends Yl{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class qS extends Yl{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GS{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&WS(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=io(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=io(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=P0();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let l=this.applyToLocalView(o,i.mutatedFields);l=n.has(s.key)?null:l;const u=j0(o,l);u!==null&&r.set(s.key,u),o.isValidDocument()||o.convertToNoDocument(le.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),fe())}isEqual(e){return this.batchId===e.batchId&&Zs(this.mutations,e.mutations,(n,r)=>lg(n,r))&&Zs(this.baseMutations,e.baseMutations,(n,r)=>lg(n,r))}}class Eh{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){Te(e.mutations.length===r.length);let s=function(){return MS}();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new Eh(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QS{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KS{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Xe,me;function YS(t){switch(t){default:return ae();case z.CANCELLED:case z.UNKNOWN:case z.DEADLINE_EXCEEDED:case z.RESOURCE_EXHAUSTED:case z.INTERNAL:case z.UNAVAILABLE:case z.UNAUTHENTICATED:return!1;case z.INVALID_ARGUMENT:case z.NOT_FOUND:case z.ALREADY_EXISTS:case z.PERMISSION_DENIED:case z.FAILED_PRECONDITION:case z.ABORTED:case z.OUT_OF_RANGE:case z.UNIMPLEMENTED:case z.DATA_LOSS:return!0}}function O0(t){if(t===void 0)return sr("GRPC error has no .code"),z.UNKNOWN;switch(t){case Xe.OK:return z.OK;case Xe.CANCELLED:return z.CANCELLED;case Xe.UNKNOWN:return z.UNKNOWN;case Xe.DEADLINE_EXCEEDED:return z.DEADLINE_EXCEEDED;case Xe.RESOURCE_EXHAUSTED:return z.RESOURCE_EXHAUSTED;case Xe.INTERNAL:return z.INTERNAL;case Xe.UNAVAILABLE:return z.UNAVAILABLE;case Xe.UNAUTHENTICATED:return z.UNAUTHENTICATED;case Xe.INVALID_ARGUMENT:return z.INVALID_ARGUMENT;case Xe.NOT_FOUND:return z.NOT_FOUND;case Xe.ALREADY_EXISTS:return z.ALREADY_EXISTS;case Xe.PERMISSION_DENIED:return z.PERMISSION_DENIED;case Xe.FAILED_PRECONDITION:return z.FAILED_PRECONDITION;case Xe.ABORTED:return z.ABORTED;case Xe.OUT_OF_RANGE:return z.OUT_OF_RANGE;case Xe.UNIMPLEMENTED:return z.UNIMPLEMENTED;case Xe.DATA_LOSS:return z.DATA_LOSS;default:return ae()}}(me=Xe||(Xe={}))[me.OK=0]="OK",me[me.CANCELLED=1]="CANCELLED",me[me.UNKNOWN=2]="UNKNOWN",me[me.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",me[me.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",me[me.NOT_FOUND=5]="NOT_FOUND",me[me.ALREADY_EXISTS=6]="ALREADY_EXISTS",me[me.PERMISSION_DENIED=7]="PERMISSION_DENIED",me[me.UNAUTHENTICATED=16]="UNAUTHENTICATED",me[me.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",me[me.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",me[me.ABORTED=10]="ABORTED",me[me.OUT_OF_RANGE=11]="OUT_OF_RANGE",me[me.UNIMPLEMENTED=12]="UNIMPLEMENTED",me[me.INTERNAL=13]="INTERNAL",me[me.UNAVAILABLE=14]="UNAVAILABLE",me[me.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XS(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JS=new rs([4294967295,4294967295],0);function dg(t){const e=XS().encode(t),n=new u0;return n.update(e),new Uint8Array(n.digest())}function hg(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new rs([n,r],0),new rs([s,i],0)]}class Th{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Wi(`Invalid padding: ${n}`);if(r<0)throw new Wi(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Wi(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new Wi(`Invalid padding when bitmap length is 0: ${n}`);this.Ie=8*e.length-n,this.Te=rs.fromNumber(this.Ie)}Ee(e,n,r){let s=e.add(n.multiply(rs.fromNumber(r)));return s.compare(JS)===1&&(s=new rs([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const n=dg(e),[r,s]=hg(n);for(let i=0;i<this.hashCount;i++){const o=this.Ee(r,s,i);if(!this.de(o))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new Th(i,s,n);return r.forEach(l=>o.insert(l)),o}insert(e){if(this.Ie===0)return;const n=dg(e),[r,s]=hg(n);for(let i=0;i<this.hashCount;i++){const o=this.Ee(r,s,i);this.Ae(o)}}Ae(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class Wi extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xl{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,$o.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new Xl(le.min(),s,new Ue(xe),ir(),fe())}}class $o{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new $o(r,n,fe(),fe(),fe())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ha{constructor(e,n,r,s){this.Re=e,this.removedTargetIds=n,this.key=r,this.Ve=s}}class F0{constructor(e,n){this.targetId=e,this.me=n}}class z0{constructor(e,n,r=vt.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class fg{constructor(){this.fe=0,this.ge=gg(),this.pe=vt.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=fe(),n=fe(),r=fe();return this.ge.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:ae()}}),new $o(this.pe,this.ye,e,n,r)}Ce(){this.we=!1,this.ge=gg()}Fe(e,n){this.we=!0,this.ge=this.ge.insert(e,n)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Te(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class ZS{constructor(e){this.Le=e,this.Be=new Map,this.ke=ir(),this.qe=pg(),this.Qe=new Ue(xe)}Ke(e){for(const n of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(n,e.Ve):this.Ue(n,e.key,e.Ve);for(const n of e.removedTargetIds)this.Ue(n,e.key,e.Ve)}We(e){this.forEachTarget(e,n=>{const r=this.Ge(n);switch(e.state){case 0:this.ze(n)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(n);break;case 3:this.ze(n)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(n)&&(this.je(n),r.De(e.resumeToken));break;default:ae()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Be.forEach((r,s)=>{this.ze(s)&&n(s)})}He(e){const n=e.targetId,r=e.me.count,s=this.Je(n);if(s){const i=s.target;if(td(i))if(r===0){const o=new se(i.path);this.Ue(n,o,At.newNoDocument(o,le.min()))}else Te(r===1);else{const o=this.Ye(n);if(o!==r){const l=this.Ze(e),u=l?this.Xe(l,e,o):1;if(u!==0){this.je(n);const h=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(n,h)}}}}}Ze(e){const n=e.me.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=n;let o,l;try{o=cs(r).toUint8Array()}catch(u){if(u instanceof y0)return Ao("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{l=new Th(o,s,i)}catch(u){return Ao(u instanceof Wi?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return l.Ie===0?null:l}Xe(e,n,r){return n.me.count===r-this.nt(e,n.targetId)?0:2}nt(e,n){const r=this.Le.getRemoteKeysForTarget(n);let s=0;return r.forEach(i=>{const o=this.Le.tt(),l=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(l)||(this.Ue(n,i,null),s++)}),s}rt(e){const n=new Map;this.Be.forEach((i,o)=>{const l=this.Je(o);if(l){if(i.current&&td(l.target)){const u=new se(l.target.path);this.ke.get(u)!==null||this.it(o,u)||this.Ue(o,u,At.newNoDocument(u,e))}i.be&&(n.set(o,i.ve()),i.Ce())}});let r=fe();this.qe.forEach((i,o)=>{let l=!0;o.forEachWhile(u=>{const h=this.Je(u);return!h||h.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(r=r.add(i))}),this.ke.forEach((i,o)=>o.setReadTime(e));const s=new Xl(e,n,this.Qe,this.ke,r);return this.ke=ir(),this.qe=pg(),this.Qe=new Ue(xe),s}$e(e,n){if(!this.ze(e))return;const r=this.it(e,n.key)?2:0;this.Ge(e).Fe(n.key,r),this.ke=this.ke.insert(n.key,n),this.qe=this.qe.insert(n.key,this.st(n.key).add(e))}Ue(e,n,r){if(!this.ze(e))return;const s=this.Ge(e);this.it(e,n)?s.Fe(n,1):s.Me(n),this.qe=this.qe.insert(n,this.st(n).delete(e)),r&&(this.ke=this.ke.insert(n,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const n=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let n=this.Be.get(e);return n||(n=new fg,this.Be.set(e,n)),n}st(e){let n=this.qe.get(e);return n||(n=new mt(xe),this.qe=this.qe.insert(e,n)),n}ze(e){const n=this.Je(e)!==null;return n||ne("WatchChangeAggregator","Detected inactive target",e),n}Je(e){const n=this.Be.get(e);return n&&n.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new fg),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.Ue(e,n,null)})}it(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}}function pg(){return new Ue(se.comparator)}function gg(){return new Ue(se.comparator)}const eE={asc:"ASCENDING",desc:"DESCENDING"},tE={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},nE={and:"AND",or:"OR"};class rE{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function sd(t,e){return t.useProto3Json||ql(e)?e:{value:e}}function Tl(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function B0(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function sE(t,e){return Tl(t,e.toTimestamp())}function jn(t){return Te(!!t),le.fromTimestamp(function(n){const r=jr(n);return new it(r.seconds,r.nanos)}(t))}function Ih(t,e){return id(t,e).canonicalString()}function id(t,e){const n=function(s){return new Me(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?n:n.child(e)}function U0(t){const e=Me.fromString(t);return Te(G0(e)),e}function od(t,e){return Ih(t.databaseId,e.path)}function Ku(t,e){const n=U0(e);if(n.get(1)!==t.databaseId.projectId)throw new Y(z.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new Y(z.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new se(W0(n))}function $0(t,e){return Ih(t.databaseId,e)}function iE(t){const e=U0(t);return e.length===4?Me.emptyPath():W0(e)}function ad(t){return new Me(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function W0(t){return Te(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function mg(t,e,n){return{name:od(t,e),fields:n.value.mapValue.fields}}function oE(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:ae()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(h,p){return h.useProto3Json?(Te(p===void 0||typeof p=="string"),vt.fromBase64String(p||"")):(Te(p===void 0||p instanceof Buffer||p instanceof Uint8Array),vt.fromUint8Array(p||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,l=o&&function(h){const p=h.code===void 0?z.UNKNOWN:O0(h.code);return new Y(p,h.message||"")}(o);n=new z0(r,s,i,l||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=Ku(t,r.document.name),i=jn(r.document.updateTime),o=r.document.createTime?jn(r.document.createTime):le.min(),l=new Ot({mapValue:{fields:r.document.fields}}),u=At.newFoundDocument(s,i,o,l),h=r.targetIds||[],p=r.removedTargetIds||[];n=new Ha(h,p,u.key,u)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=Ku(t,r.document),i=r.readTime?jn(r.readTime):le.min(),o=At.newNoDocument(s,i),l=r.removedTargetIds||[];n=new Ha([],l,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=Ku(t,r.document),i=r.removedTargetIds||[];n=new Ha([],i,s,null)}else{if(!("filter"in e))return ae();{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new KS(s,i),l=r.targetId;n=new F0(l,o)}}return n}function aE(t,e){let n;if(e instanceof Uo)n={update:mg(t,e.key,e.value)};else if(e instanceof Sh)n={delete:od(t,e.key)};else if(e instanceof Br)n={update:mg(t,e.key,e.data),updateMask:mE(e.fieldMask)};else{if(!(e instanceof qS))return ae();n={verify:od(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(i,o){const l=o.transform;if(l instanceof bo)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof Do)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof No)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof El)return{fieldPath:o.field.canonicalString(),increment:l.Pe};throw ae()}(0,r))),e.precondition.isNone||(n.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:sE(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:ae()}(t,e.precondition)),n}function lE(t,e){return t&&t.length>0?(Te(e!==void 0),t.map(n=>function(s,i){let o=s.updateTime?jn(s.updateTime):jn(i);return o.isEqual(le.min())&&(o=jn(i)),new $S(o,s.transformResults||[])}(n,e))):[]}function uE(t,e){return{documents:[$0(t,e.path)]}}function cE(t,e){const n={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=$0(t,s);const i=function(h){if(h.length!==0)return q0(Cn.create(h,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const o=function(h){if(h.length!==0)return h.map(p=>function(v){return{field:Ts(v.field),direction:fE(v.dir)}}(p))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const l=sd(t,e.limit);return l!==null&&(n.structuredQuery.limit=l),e.startAt&&(n.structuredQuery.startAt=function(h){return{before:h.inclusive,values:h.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(h){return{before:!h.inclusive,values:h.position}}(e.endAt)),{_t:n,parent:s}}function dE(t){let e=iE(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){Te(r===1);const p=n.from[0];p.allDescendants?s=p.collectionId:e=e.child(p.collectionId)}let i=[];n.where&&(i=function(g){const v=H0(g);return v instanceof Cn&&w0(v)?v.getFilters():[v]}(n.where));let o=[];n.orderBy&&(o=function(g){return g.map(v=>function(R){return new Sl(Is(R.field),function(O){switch(O){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(R.direction))}(v))}(n.orderBy));let l=null;n.limit&&(l=function(g){let v;return v=typeof g=="object"?g.value:g,ql(v)?null:v}(n.limit));let u=null;n.startAt&&(u=function(g){const v=!!g.before,k=g.values||[];return new wl(k,v)}(n.startAt));let h=null;return n.endAt&&(h=function(g){const v=!g.before,k=g.values||[];return new wl(k,v)}(n.endAt)),RS(e,s,o,i,l,"F",u,h)}function hE(t,e){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ae()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function H0(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=Is(n.unaryFilter.field);return Ze.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=Is(n.unaryFilter.field);return Ze.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Is(n.unaryFilter.field);return Ze.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Is(n.unaryFilter.field);return Ze.create(o,"!=",{nullValue:"NULL_VALUE"});default:return ae()}}(t):t.fieldFilter!==void 0?function(n){return Ze.create(Is(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return ae()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return Cn.create(n.compositeFilter.filters.map(r=>H0(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return ae()}}(n.compositeFilter.op))}(t):ae()}function fE(t){return eE[t]}function pE(t){return tE[t]}function gE(t){return nE[t]}function Ts(t){return{fieldPath:t.canonicalString()}}function Is(t){return pt.fromServerFormat(t.fieldPath)}function q0(t){return t instanceof Ze?function(n){if(n.op==="=="){if(ng(n.value))return{unaryFilter:{field:Ts(n.field),op:"IS_NAN"}};if(tg(n.value))return{unaryFilter:{field:Ts(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(ng(n.value))return{unaryFilter:{field:Ts(n.field),op:"IS_NOT_NAN"}};if(tg(n.value))return{unaryFilter:{field:Ts(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ts(n.field),op:pE(n.op),value:n.value}}}(t):t instanceof Cn?function(n){const r=n.getFilters().map(s=>q0(s));return r.length===1?r[0]:{compositeFilter:{op:gE(n.op),filters:r}}}(t):ae()}function mE(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function G0(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xr{constructor(e,n,r,s,i=le.min(),o=le.min(),l=vt.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=u}withSequenceNumber(e){return new xr(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new xr(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new xr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new xr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yE{constructor(e){this.ct=e}}function vE(t){const e=dE({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?rd(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _E{constructor(){this.un=new xE}addToCollectionParentIndex(e,n){return this.un.add(n),B.resolve()}getCollectionParents(e,n){return B.resolve(this.un.getEntries(n))}addFieldIndex(e,n){return B.resolve()}deleteFieldIndex(e,n){return B.resolve()}deleteAllFieldIndexes(e){return B.resolve()}createTargetIndexes(e,n){return B.resolve()}getDocumentsMatchingTarget(e,n){return B.resolve(null)}getIndexType(e,n){return B.resolve(0)}getFieldIndexes(e,n){return B.resolve([])}getNextCollectionGroupToUpdate(e){return B.resolve(null)}getMinOffset(e,n){return B.resolve(Vr.min())}getMinOffsetFromCollectionGroup(e,n){return B.resolve(Vr.min())}updateCollectionGroup(e,n,r){return B.resolve()}updateIndexEntries(e,n){return B.resolve()}}class xE{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new mt(Me.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new mt(Me.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ni{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new ni(0)}static kn(){return new ni(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wE{constructor(){this.changes=new ci(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,At.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?B.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SE{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EE{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&io(r.mutation,s,Zt.empty(),it.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,fe()).next(()=>r))}getLocalViewOfDocuments(e,n,r=fe()){const s=es();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let o=$i();return i.forEach((l,u)=>{o=o.insert(l,u.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=es();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,fe()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,l)=>{n.set(o,l)})})}computeViews(e,n,r,s){let i=ir();const o=so(),l=function(){return so()}();return n.forEach((u,h)=>{const p=r.get(h.key);s.has(h.key)&&(p===void 0||p.mutation instanceof Br)?i=i.insert(h.key,h):p!==void 0?(o.set(h.key,p.mutation.getFieldMask()),io(p.mutation,h,p.mutation.getFieldMask(),it.now())):o.set(h.key,Zt.empty())}),this.recalculateAndSaveOverlays(e,i).next(u=>(u.forEach((h,p)=>o.set(h,p)),n.forEach((h,p)=>{var g;return l.set(h,new SE(p,(g=o.get(h))!==null&&g!==void 0?g:null))}),l))}recalculateAndSaveOverlays(e,n){const r=so();let s=new Ue((o,l)=>o-l),i=fe();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const l of o)l.keys().forEach(u=>{const h=n.get(u);if(h===null)return;let p=r.get(u)||Zt.empty();p=l.applyToLocalView(h,p),r.set(u,p);const g=(s.get(l.batchId)||fe()).add(u);s=s.insert(l.batchId,g)})}).next(()=>{const o=[],l=s.getReverseIterator();for(;l.hasNext();){const u=l.getNext(),h=u.key,p=u.value,g=P0();p.forEach(v=>{if(!i.has(v)){const k=j0(n.get(v),r.get(v));k!==null&&g.set(v,k),i=i.add(v)}}),o.push(this.documentOverlayCache.saveOverlays(e,h,g))}return B.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,s){return function(o){return se.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):I0(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,s):this.getDocumentsMatchingCollectionQuery(e,n,r,s)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):B.resolve(es());let l=-1,u=i;return o.next(h=>B.forEach(h,(p,g)=>(l<g.largestBatchId&&(l=g.largestBatchId),i.get(p)?B.resolve():this.remoteDocumentCache.getEntry(e,p).next(v=>{u=u.insert(p,v)}))).next(()=>this.populateOverlays(e,h,i)).next(()=>this.computeViews(e,u,h,fe())).next(p=>({batchId:l,changes:R0(p)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new se(n)).next(r=>{let s=$i();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r,s){const i=n.collectionGroup;let o=$i();return this.indexManager.getCollectionParents(e,i).next(l=>B.forEach(l,u=>{const h=function(g,v){return new Bo(v,null,g.explicitOrderBy.slice(),g.filters.slice(),g.limit,g.limitType,g.startAt,g.endAt)}(n,u.child(i));return this.getDocumentsMatchingCollectionQuery(e,h,r,s).next(p=>{p.forEach((g,v)=>{o=o.insert(g,v)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,i,s))).next(o=>{i.forEach((u,h)=>{const p=h.getKey();o.get(p)===null&&(o=o.insert(p,At.newInvalidDocument(p)))});let l=$i();return o.forEach((u,h)=>{const p=i.get(u);p!==void 0&&io(p.mutation,h,Zt.empty(),it.now()),Ql(n,h)&&(l=l.insert(u,h))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TE{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,n){return B.resolve(this.hr.get(n))}saveBundleMetadata(e,n){return this.hr.set(n.id,function(s){return{id:s.id,version:s.version,createTime:jn(s.createTime)}}(n)),B.resolve()}getNamedQuery(e,n){return B.resolve(this.Pr.get(n))}saveNamedQuery(e,n){return this.Pr.set(n.name,function(s){return{name:s.name,query:vE(s.bundledQuery),readTime:jn(s.readTime)}}(n)),B.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IE{constructor(){this.overlays=new Ue(se.comparator),this.Ir=new Map}getOverlay(e,n){return B.resolve(this.overlays.get(n))}getOverlays(e,n){const r=es();return B.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.ht(e,n,i)}),B.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.Ir.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.Ir.delete(r)),B.resolve()}getOverlaysForCollection(e,n,r){const s=es(),i=n.length+1,o=new se(n.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const u=l.getNext().value,h=u.getKey();if(!n.isPrefixOf(h.path))break;h.path.length===i&&u.largestBatchId>r&&s.set(u.getKey(),u)}return B.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new Ue((h,p)=>h-p);const o=this.overlays.getIterator();for(;o.hasNext();){const h=o.getNext().value;if(h.getKey().getCollectionGroup()===n&&h.largestBatchId>r){let p=i.get(h.largestBatchId);p===null&&(p=es(),i=i.insert(h.largestBatchId,p)),p.set(h.getKey(),h)}}const l=es(),u=i.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((h,p)=>l.set(h,p)),!(l.size()>=s)););return B.resolve(l)}ht(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.Ir.get(s.largestBatchId).delete(r.key);this.Ir.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new QS(n,r));let i=this.Ir.get(n);i===void 0&&(i=fe(),this.Ir.set(n,i)),this.Ir.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AE{constructor(){this.sessionToken=vt.EMPTY_BYTE_STRING}getSessionToken(e){return B.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,B.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ah{constructor(){this.Tr=new mt(lt.Er),this.dr=new mt(lt.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,n){const r=new lt(e,n);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Vr(new lt(e,n))}mr(e,n){e.forEach(r=>this.removeReference(r,n))}gr(e){const n=new se(new Me([])),r=new lt(n,e),s=new lt(n,e+1),i=[];return this.dr.forEachInRange([r,s],o=>{this.Vr(o),i.push(o.key)}),i}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const n=new se(new Me([])),r=new lt(n,e),s=new lt(n,e+1);let i=fe();return this.dr.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const n=new lt(e,0),r=this.Tr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class lt{constructor(e,n){this.key=e,this.wr=n}static Er(e,n){return se.comparator(e.key,n.key)||xe(e.wr,n.wr)}static Ar(e,n){return xe(e.wr,n.wr)||se.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CE{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Sr=1,this.br=new mt(lt.Er)}checkEmpty(e){return B.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new GS(i,n,r,s);this.mutationQueue.push(o);for(const l of s)this.br=this.br.add(new lt(l.key,i)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return B.resolve(o)}lookupMutationBatch(e,n){return B.resolve(this.Dr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.vr(r),i=s<0?0:s;return B.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return B.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return B.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new lt(n,0),s=new lt(n,Number.POSITIVE_INFINITY),i=[];return this.br.forEachInRange([r,s],o=>{const l=this.Dr(o.wr);i.push(l)}),B.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new mt(xe);return n.forEach(s=>{const i=new lt(s,0),o=new lt(s,Number.POSITIVE_INFINITY);this.br.forEachInRange([i,o],l=>{r=r.add(l.wr)})}),B.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;se.isDocumentKey(i)||(i=i.child(""));const o=new lt(new se(i),0);let l=new mt(xe);return this.br.forEachWhile(u=>{const h=u.key.path;return!!r.isPrefixOf(h)&&(h.length===s&&(l=l.add(u.wr)),!0)},o),B.resolve(this.Cr(l))}Cr(e){const n=[];return e.forEach(r=>{const s=this.Dr(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){Te(this.Fr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return B.forEach(n.mutations,s=>{const i=new lt(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,n){const r=new lt(n,0),s=this.br.firstAfterOrEqual(r);return B.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,B.resolve()}Fr(e,n){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const n=this.vr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kE{constructor(e){this.Mr=e,this.docs=function(){return new Ue(se.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,o=this.Mr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return B.resolve(r?r.document.mutableCopy():At.newInvalidDocument(n))}getEntries(e,n){let r=ir();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():At.newInvalidDocument(s))}),B.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let i=ir();const o=n.path,l=new se(o.child("")),u=this.docs.getIteratorFrom(l);for(;u.hasNext();){const{key:h,value:{document:p}}=u.getNext();if(!o.isPrefixOf(h.path))break;h.path.length>o.length+1||cS(uS(p),r)<=0||(s.has(p.key)||Ql(n,p))&&(i=i.insert(p.key,p.mutableCopy()))}return B.resolve(i)}getAllFromCollectionGroup(e,n,r,s){ae()}Or(e,n){return B.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new RE(this)}getSize(e){return B.resolve(this.size)}}class RE extends wE{constructor(e){super(),this.cr=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.cr.addEntry(e,s)):this.cr.removeEntry(r)}),B.waitFor(n)}getFromCache(e,n){return this.cr.getEntry(e,n)}getAllFromCache(e,n){return this.cr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PE{constructor(e){this.persistence=e,this.Nr=new ci(n=>vh(n),_h),this.lastRemoteSnapshotVersion=le.min(),this.highestTargetId=0,this.Lr=0,this.Br=new Ah,this.targetCount=0,this.kr=ni.Bn()}forEachTarget(e,n){return this.Nr.forEach((r,s)=>n(s)),B.resolve()}getLastRemoteSnapshotVersion(e){return B.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return B.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),B.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Lr&&(this.Lr=n),B.resolve()}Kn(e){this.Nr.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.kr=new ni(n),this.highestTargetId=n),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,n){return this.Kn(n),this.targetCount+=1,B.resolve()}updateTargetData(e,n){return this.Kn(n),B.resolve()}removeTargetData(e,n){return this.Nr.delete(n.target),this.Br.gr(n.targetId),this.targetCount-=1,B.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.Nr.forEach((o,l)=>{l.sequenceNumber<=n&&r.get(l.targetId)===null&&(this.Nr.delete(o),i.push(this.removeMatchingKeysForTargetId(e,l.targetId)),s++)}),B.waitFor(i).next(()=>s)}getTargetCount(e){return B.resolve(this.targetCount)}getTargetData(e,n){const r=this.Nr.get(n)||null;return B.resolve(r)}addMatchingKeys(e,n,r){return this.Br.Rr(n,r),B.resolve()}removeMatchingKeys(e,n,r){this.Br.mr(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),B.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this.Br.gr(n),B.resolve()}getMatchingKeysForTargetId(e,n){const r=this.Br.yr(n);return B.resolve(r)}containsKey(e,n){return B.resolve(this.Br.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bE{constructor(e,n){this.qr={},this.overlays={},this.Qr=new ph(0),this.Kr=!1,this.Kr=!0,this.$r=new AE,this.referenceDelegate=e(this),this.Ur=new PE(this),this.indexManager=new _E,this.remoteDocumentCache=function(s){return new kE(s)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new yE(n),this.Gr=new TE(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new IE,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.qr[e.toKey()];return r||(r=new CE(n,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,n,r){ne("MemoryPersistence","Starting transaction:",e);const s=new DE(this.Qr.next());return this.referenceDelegate.zr(),r(s).next(i=>this.referenceDelegate.jr(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Hr(e,n){return B.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,n)))}}class DE extends hS{constructor(e){super(),this.currentSequenceNumber=e}}class Ch{constructor(e){this.persistence=e,this.Jr=new Ah,this.Yr=null}static Zr(e){return new Ch(e)}get Xr(){if(this.Yr)return this.Yr;throw ae()}addReference(e,n,r){return this.Jr.addReference(r,n),this.Xr.delete(r.toString()),B.resolve()}removeReference(e,n,r){return this.Jr.removeReference(r,n),this.Xr.add(r.toString()),B.resolve()}markPotentiallyOrphaned(e,n){return this.Xr.add(n.toString()),B.resolve()}removeTarget(e,n){this.Jr.gr(n.targetId).forEach(s=>this.Xr.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.Xr.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}zr(){this.Yr=new Set}jr(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return B.forEach(this.Xr,r=>{const s=se.fromPath(r);return this.ei(e,s).next(i=>{i||n.removeEntry(s,le.min())})}).next(()=>(this.Yr=null,n.apply(e)))}updateLimboDocument(e,n){return this.ei(e,n).next(r=>{r?this.Xr.delete(n.toString()):this.Xr.add(n.toString())})}Wr(e){return 0}ei(e,n){return B.or([()=>B.resolve(this.Jr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Hr(e,n)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kh{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.$i=r,this.Ui=s}static Wi(e,n){let r=fe(),s=fe();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new kh(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NE{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ME{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return jx()?8:fS(Mx())>0?6:4}()}initialize(e,n){this.Ji=e,this.indexManager=n,this.Gi=!0}getDocumentsMatchingQuery(e,n,r,s){const i={result:null};return this.Yi(e,n).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.Zi(e,n,s,r).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new NE;return this.Xi(e,n,o).next(l=>{if(i.result=l,this.zi)return this.es(e,n,o,l.size)})}).next(()=>i.result)}es(e,n,r,s){return r.documentReadCount<this.ji?(Li()<=ye.DEBUG&&ne("QueryEngine","SDK will not create cache indexes for query:",Es(n),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),B.resolve()):(Li()<=ye.DEBUG&&ne("QueryEngine","Query:",Es(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.Hi*s?(Li()<=ye.DEBUG&&ne("QueryEngine","The SDK decides to create cache indexes for query:",Es(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Vn(n))):B.resolve())}Yi(e,n){if(og(n))return B.resolve(null);let r=Vn(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=rd(n,null,"F"),r=Vn(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const o=fe(...i);return this.Ji.getDocuments(e,o).next(l=>this.indexManager.getMinOffset(e,r).next(u=>{const h=this.ts(n,l);return this.ns(n,h,o,u.readTime)?this.Yi(e,rd(n,null,"F")):this.rs(e,h,n,u)}))})))}Zi(e,n,r,s){return og(n)||s.isEqual(le.min())?B.resolve(null):this.Ji.getDocuments(e,r).next(i=>{const o=this.ts(n,i);return this.ns(n,o,r,s)?B.resolve(null):(Li()<=ye.DEBUG&&ne("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Es(n)),this.rs(e,o,n,lS(s,-1)).next(l=>l))})}ts(e,n){let r=new mt(C0(e));return n.forEach((s,i)=>{Ql(e,i)&&(r=r.add(i))}),r}ns(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Xi(e,n,r){return Li()<=ye.DEBUG&&ne("QueryEngine","Using full collection scan to execute query:",Es(n)),this.Ji.getDocumentsMatchingQuery(e,n,Vr.min(),r)}rs(e,n,r,s){return this.Ji.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VE{constructor(e,n,r,s){this.persistence=e,this.ss=n,this.serializer=s,this.os=new Ue(xe),this._s=new ci(i=>vh(i),_h),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new EE(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.os))}}function jE(t,e,n,r){return new VE(t,e,n,r)}async function Q0(t,e){const n=ue(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.ls(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],l=[];let u=fe();for(const h of s){o.push(h.batchId);for(const p of h.mutations)u=u.add(p.key)}for(const h of i){l.push(h.batchId);for(const p of h.mutations)u=u.add(p.key)}return n.localDocuments.getDocuments(r,u).next(h=>({hs:h,removedBatchIds:o,addedBatchIds:l}))})})}function LE(t,e){const n=ue(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.cs.newChangeBuffer({trackRemovals:!0});return function(l,u,h,p){const g=h.batch,v=g.keys();let k=B.resolve();return v.forEach(R=>{k=k.next(()=>p.getEntry(u,R)).next(P=>{const O=h.docVersions.get(R);Te(O!==null),P.version.compareTo(O)<0&&(g.applyToRemoteDocument(P,h),P.isValidDocument()&&(P.setReadTime(h.commitVersion),p.addEntry(P)))})}),k.next(()=>l.mutationQueue.removeMutationBatch(u,g))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(l){let u=fe();for(let h=0;h<l.mutationResults.length;++h)l.mutationResults[h].transformResults.length>0&&(u=u.add(l.batch.mutations[h].key));return u}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function K0(t){const e=ue(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Ur.getLastRemoteSnapshotVersion(n))}function OE(t,e){const n=ue(t),r=e.snapshotVersion;let s=n.os;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=n.cs.newChangeBuffer({trackRemovals:!0});s=n.os;const l=[];e.targetChanges.forEach((p,g)=>{const v=s.get(g);if(!v)return;l.push(n.Ur.removeMatchingKeys(i,p.removedDocuments,g).next(()=>n.Ur.addMatchingKeys(i,p.addedDocuments,g)));let k=v.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(g)!==null?k=k.withResumeToken(vt.EMPTY_BYTE_STRING,le.min()).withLastLimboFreeSnapshotVersion(le.min()):p.resumeToken.approximateByteSize()>0&&(k=k.withResumeToken(p.resumeToken,r)),s=s.insert(g,k),function(P,O,C){return P.resumeToken.approximateByteSize()===0||O.snapshotVersion.toMicroseconds()-P.snapshotVersion.toMicroseconds()>=3e8?!0:C.addedDocuments.size+C.modifiedDocuments.size+C.removedDocuments.size>0}(v,k,p)&&l.push(n.Ur.updateTargetData(i,k))});let u=ir(),h=fe();if(e.documentUpdates.forEach(p=>{e.resolvedLimboDocuments.has(p)&&l.push(n.persistence.referenceDelegate.updateLimboDocument(i,p))}),l.push(FE(i,o,e.documentUpdates).next(p=>{u=p.Ps,h=p.Is})),!r.isEqual(le.min())){const p=n.Ur.getLastRemoteSnapshotVersion(i).next(g=>n.Ur.setTargetsMetadata(i,i.currentSequenceNumber,r));l.push(p)}return B.waitFor(l).next(()=>o.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,u,h)).next(()=>u)}).then(i=>(n.os=s,i))}function FE(t,e,n){let r=fe(),s=fe();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let o=ir();return n.forEach((l,u)=>{const h=i.get(l);u.isFoundDocument()!==h.isFoundDocument()&&(s=s.add(l)),u.isNoDocument()&&u.version.isEqual(le.min())?(e.removeEntry(l,u.readTime),o=o.insert(l,u)):!h.isValidDocument()||u.version.compareTo(h.version)>0||u.version.compareTo(h.version)===0&&h.hasPendingWrites?(e.addEntry(u),o=o.insert(l,u)):ne("LocalStore","Ignoring outdated watch update for ",l,". Current version:",h.version," Watch version:",u.version)}),{Ps:o,Is:s}})}function zE(t,e){const n=ue(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function BE(t,e){const n=ue(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.Ur.getTargetData(r,e).next(i=>i?(s=i,B.resolve(s)):n.Ur.allocateTargetId(r).next(o=>(s=new xr(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Ur.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.os.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.os=n.os.insert(r.targetId,r),n._s.set(e,r.targetId)),r})}async function ld(t,e,n){const r=ue(t),s=r.os.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!zo(o))throw o;ne("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.os=r.os.remove(e),r._s.delete(s.target)}function yg(t,e,n){const r=ue(t);let s=le.min(),i=fe();return r.persistence.runTransaction("Execute query","readwrite",o=>function(u,h,p){const g=ue(u),v=g._s.get(p);return v!==void 0?B.resolve(g.os.get(v)):g.Ur.getTargetData(h,p)}(r,o,Vn(e)).next(l=>{if(l)return s=l.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(o,l.targetId).next(u=>{i=u})}).next(()=>r.ss.getDocumentsMatchingQuery(o,e,n?s:le.min(),n?i:fe())).next(l=>(UE(r,bS(e),l),{documents:l,Ts:i})))}function UE(t,e,n){let r=t.us.get(e)||le.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.us.set(e,r)}class vg{constructor(){this.activeTargetIds=LS()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class $E{constructor(){this.so=new vg,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,n,r){this.oo[e]=n}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new vg,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WE{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _g{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){ne("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){ne("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ra=null;function Yu(){return Ra===null?Ra=function(){return 268435456+Math.round(2147483648*Math.random())}():Ra++,"0x"+Ra.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HE={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qE{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tt="WebChannelConnection";class GE extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const r=n.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+n.host,this.vo=`projects/${s}/databases/${i}`,this.Co=this.databaseId.database==="(default)"?`project_id=${s}`:`project_id=${s}&database_id=${i}`}get Fo(){return!1}Mo(n,r,s,i,o){const l=Yu(),u=this.xo(n,r.toUriEncodedString());ne("RestConnection",`Sending RPC '${n}' ${l}:`,u,s);const h={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(h,i,o),this.No(n,u,h,s).then(p=>(ne("RestConnection",`Received RPC '${n}' ${l}: `,p),p),p=>{throw Ao("RestConnection",`RPC '${n}' ${l} failed with error: `,p,"url: ",u,"request:",s),p})}Lo(n,r,s,i,o,l){return this.Mo(n,r,s,i,o)}Oo(n,r,s){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+ui}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((i,o)=>n[o]=i),s&&s.headers.forEach((i,o)=>n[o]=i)}xo(n,r){const s=HE[n];return`${this.Do}/v1/${r}:${s}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,n,r,s){const i=Yu();return new Promise((o,l)=>{const u=new c0;u.setWithCredentials(!0),u.listenOnce(d0.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case Ua.NO_ERROR:const p=u.getResponseJson();ne(Tt,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(p)),o(p);break;case Ua.TIMEOUT:ne(Tt,`RPC '${e}' ${i} timed out`),l(new Y(z.DEADLINE_EXCEEDED,"Request time out"));break;case Ua.HTTP_ERROR:const g=u.getStatus();if(ne(Tt,`RPC '${e}' ${i} failed with status:`,g,"response text:",u.getResponseText()),g>0){let v=u.getResponseJson();Array.isArray(v)&&(v=v[0]);const k=v==null?void 0:v.error;if(k&&k.status&&k.message){const R=function(O){const C=O.toLowerCase().replace(/_/g,"-");return Object.values(z).indexOf(C)>=0?C:z.UNKNOWN}(k.status);l(new Y(R,k.message))}else l(new Y(z.UNKNOWN,"Server responded with status "+u.getStatus()))}else l(new Y(z.UNAVAILABLE,"Connection failed."));break;default:ae()}}finally{ne(Tt,`RPC '${e}' ${i} completed.`)}});const h=JSON.stringify(s);ne(Tt,`RPC '${e}' ${i} sending request:`,s),u.send(n,"POST",h,r,15)})}Bo(e,n,r){const s=Yu(),i=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=p0(),l=f0(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(u.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(u.useFetchStreams=!0),this.Oo(u.initMessageHeaders,n,r),u.encodeInitMessageHeaders=!0;const p=i.join("");ne(Tt,`Creating RPC '${e}' stream ${s}: ${p}`,u);const g=o.createWebChannel(p,u);let v=!1,k=!1;const R=new qE({Io:O=>{k?ne(Tt,`Not sending because RPC '${e}' stream ${s} is closed:`,O):(v||(ne(Tt,`Opening RPC '${e}' stream ${s} transport.`),g.open(),v=!0),ne(Tt,`RPC '${e}' stream ${s} sending:`,O),g.send(O))},To:()=>g.close()}),P=(O,C,I)=>{O.listen(C,w=>{try{I(w)}catch(b){setTimeout(()=>{throw b},0)}})};return P(g,Ui.EventType.OPEN,()=>{k||(ne(Tt,`RPC '${e}' stream ${s} transport opened.`),R.yo())}),P(g,Ui.EventType.CLOSE,()=>{k||(k=!0,ne(Tt,`RPC '${e}' stream ${s} transport closed`),R.So())}),P(g,Ui.EventType.ERROR,O=>{k||(k=!0,Ao(Tt,`RPC '${e}' stream ${s} transport errored:`,O),R.So(new Y(z.UNAVAILABLE,"The operation could not be completed")))}),P(g,Ui.EventType.MESSAGE,O=>{var C;if(!k){const I=O.data[0];Te(!!I);const w=I,b=w.error||((C=w[0])===null||C===void 0?void 0:C.error);if(b){ne(Tt,`RPC '${e}' stream ${s} received error:`,b);const V=b.status;let j=function(m){const S=Xe[m];if(S!==void 0)return O0(S)}(V),T=b.message;j===void 0&&(j=z.INTERNAL,T="Unknown error status: "+V+" with message "+b.message),k=!0,R.So(new Y(j,T)),g.close()}else ne(Tt,`RPC '${e}' stream ${s} received:`,I),R.bo(I)}}),P(l,h0.STAT_EVENT,O=>{O.stat===Xc.PROXY?ne(Tt,`RPC '${e}' stream ${s} detected buffering proxy`):O.stat===Xc.NOPROXY&&ne(Tt,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{R.wo()},0),R}}function Xu(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jl(t){return new rE(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y0{constructor(e,n,r=1e3,s=1.5,i=6e4){this.ui=e,this.timerId=n,this.ko=r,this.qo=s,this.Qo=i,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const n=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),s=Math.max(0,n-r);s>0&&ne("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Ko} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,s,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X0{constructor(e,n,r,s,i,o,l,u){this.ui=e,this.Ho=r,this.Jo=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=u,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new Y0(e,n)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,n){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():n&&n.code===z.RESOURCE_EXHAUSTED?(sr(n.toString()),sr("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):n&&n.code===z.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(n)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),n=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.Yo===n&&this.P_(r,s)},r=>{e(()=>{const s=new Y(z.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(s)})})}P_(e,n){const r=this.h_(this.Yo);this.stream=this.T_(e,n),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(s=>{r(()=>this.I_(s))}),this.stream.onMessage(s=>{r(()=>++this.e_==1?this.E_(s):this.onNext(s))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return ne("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return n=>{this.ui.enqueueAndForget(()=>this.Yo===e?n():(ne("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class QE extends X0{constructor(e,n,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}T_(e,n){return this.connection.Bo("Listen",e,n)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const n=oE(this.serializer,e),r=function(i){if(!("targetChange"in i))return le.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?le.min():o.readTime?jn(o.readTime):le.min()}(e);return this.listener.d_(n,r)}A_(e){const n={};n.database=ad(this.serializer),n.addTarget=function(i,o){let l;const u=o.target;if(l=td(u)?{documents:uE(i,u)}:{query:cE(i,u)._t},l.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){l.resumeToken=B0(i,o.resumeToken);const h=sd(i,o.expectedCount);h!==null&&(l.expectedCount=h)}else if(o.snapshotVersion.compareTo(le.min())>0){l.readTime=Tl(i,o.snapshotVersion.toTimestamp());const h=sd(i,o.expectedCount);h!==null&&(l.expectedCount=h)}return l}(this.serializer,e);const r=hE(this.serializer,e);r&&(n.labels=r),this.a_(n)}R_(e){const n={};n.database=ad(this.serializer),n.removeTarget=e,this.a_(n)}}class KE extends X0{constructor(e,n,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,n){return this.connection.Bo("Write",e,n)}E_(e){return Te(!!e.streamToken),this.lastStreamToken=e.streamToken,Te(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){Te(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const n=lE(e.writeResults,e.commitTime),r=jn(e.commitTime);return this.listener.g_(r,n)}p_(){const e={};e.database=ad(this.serializer),this.a_(e)}m_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>aE(this.serializer,r))};this.a_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YE extends class{}{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.y_=!1}w_(){if(this.y_)throw new Y(z.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,n,r,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Mo(e,id(n,r),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===z.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new Y(z.UNKNOWN,i.toString())})}Lo(e,n,r,s,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,l])=>this.connection.Lo(e,id(n,r),s,o,l,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===z.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Y(z.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class XE{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(sr(n),this.D_=!1):ne("OnlineStateTracker",n)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JE{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=i,this.k_._o(o=>{r.enqueueAndForget(async()=>{gs(this)&&(ne("RemoteStore","Restarting streams for network reachability change."),await async function(u){const h=ue(u);h.L_.add(4),await Wo(h),h.q_.set("Unknown"),h.L_.delete(4),await Zl(h)}(this))})}),this.q_=new XE(r,s)}}async function Zl(t){if(gs(t))for(const e of t.B_)await e(!0)}async function Wo(t){for(const e of t.B_)await e(!1)}function J0(t,e){const n=ue(t);n.N_.has(e.targetId)||(n.N_.set(e.targetId,e),Dh(n)?bh(n):di(n).r_()&&Ph(n,e))}function Rh(t,e){const n=ue(t),r=di(n);n.N_.delete(e),r.r_()&&Z0(n,e),n.N_.size===0&&(r.r_()?r.o_():gs(n)&&n.q_.set("Unknown"))}function Ph(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(le.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}di(t).A_(e)}function Z0(t,e){t.Q_.xe(e),di(t).R_(e)}function bh(t){t.Q_=new ZS({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),di(t).start(),t.q_.v_()}function Dh(t){return gs(t)&&!di(t).n_()&&t.N_.size>0}function gs(t){return ue(t).L_.size===0}function ev(t){t.Q_=void 0}async function ZE(t){t.q_.set("Online")}async function eT(t){t.N_.forEach((e,n)=>{Ph(t,e)})}async function tT(t,e){ev(t),Dh(t)?(t.q_.M_(e),bh(t)):t.q_.set("Unknown")}async function nT(t,e,n){if(t.q_.set("Online"),e instanceof z0&&e.state===2&&e.cause)try{await async function(s,i){const o=i.cause;for(const l of i.targetIds)s.N_.has(l)&&(await s.remoteSyncer.rejectListen(l,o),s.N_.delete(l),s.Q_.removeTarget(l))}(t,e)}catch(r){ne("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Il(t,r)}else if(e instanceof Ha?t.Q_.Ke(e):e instanceof F0?t.Q_.He(e):t.Q_.We(e),!n.isEqual(le.min()))try{const r=await K0(t.localStore);n.compareTo(r)>=0&&await function(i,o){const l=i.Q_.rt(o);return l.targetChanges.forEach((u,h)=>{if(u.resumeToken.approximateByteSize()>0){const p=i.N_.get(h);p&&i.N_.set(h,p.withResumeToken(u.resumeToken,o))}}),l.targetMismatches.forEach((u,h)=>{const p=i.N_.get(u);if(!p)return;i.N_.set(u,p.withResumeToken(vt.EMPTY_BYTE_STRING,p.snapshotVersion)),Z0(i,u);const g=new xr(p.target,u,h,p.sequenceNumber);Ph(i,g)}),i.remoteSyncer.applyRemoteEvent(l)}(t,n)}catch(r){ne("RemoteStore","Failed to raise snapshot:",r),await Il(t,r)}}async function Il(t,e,n){if(!zo(e))throw e;t.L_.add(1),await Wo(t),t.q_.set("Offline"),n||(n=()=>K0(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{ne("RemoteStore","Retrying IndexedDB access"),await n(),t.L_.delete(1),await Zl(t)})}function tv(t,e){return e().catch(n=>Il(t,n,e))}async function eu(t){const e=ue(t),n=Lr(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;rT(e);)try{const s=await zE(e.localStore,r);if(s===null){e.O_.length===0&&n.o_();break}r=s.batchId,sT(e,s)}catch(s){await Il(e,s)}nv(e)&&rv(e)}function rT(t){return gs(t)&&t.O_.length<10}function sT(t,e){t.O_.push(e);const n=Lr(t);n.r_()&&n.V_&&n.m_(e.mutations)}function nv(t){return gs(t)&&!Lr(t).n_()&&t.O_.length>0}function rv(t){Lr(t).start()}async function iT(t){Lr(t).p_()}async function oT(t){const e=Lr(t);for(const n of t.O_)e.m_(n.mutations)}async function aT(t,e,n){const r=t.O_.shift(),s=Eh.from(r,e,n);await tv(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await eu(t)}async function lT(t,e){e&&Lr(t).V_&&await async function(r,s){if(function(o){return YS(o)&&o!==z.ABORTED}(s.code)){const i=r.O_.shift();Lr(r).s_(),await tv(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await eu(r)}}(t,e),nv(t)&&rv(t)}async function xg(t,e){const n=ue(t);n.asyncQueue.verifyOperationInProgress(),ne("RemoteStore","RemoteStore received new credentials");const r=gs(n);n.L_.add(3),await Wo(n),r&&n.q_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.L_.delete(3),await Zl(n)}async function uT(t,e){const n=ue(t);e?(n.L_.delete(2),await Zl(n)):e||(n.L_.add(2),await Wo(n),n.q_.set("Unknown"))}function di(t){return t.K_||(t.K_=function(n,r,s){const i=ue(n);return i.w_(),new QE(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:ZE.bind(null,t),Ro:eT.bind(null,t),mo:tT.bind(null,t),d_:nT.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),Dh(t)?bh(t):t.q_.set("Unknown")):(await t.K_.stop(),ev(t))})),t.K_}function Lr(t){return t.U_||(t.U_=function(n,r,s){const i=ue(n);return i.w_(),new KE(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:iT.bind(null,t),mo:lT.bind(null,t),f_:oT.bind(null,t),g_:aT.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await eu(t)):(await t.U_.stop(),t.O_.length>0&&(ne("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nh{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new Xn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,s,i){const o=Date.now()+r,l=new Nh(e,n,o,s,i);return l.start(r),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Y(z.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Mh(t,e){if(sr("AsyncQueue",`${e}: ${t}`),zo(t))return new Y(z.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ws{constructor(e){this.comparator=e?(n,r)=>e(n,r)||se.comparator(n.key,r.key):(n,r)=>se.comparator(n.key,r.key),this.keyedMap=$i(),this.sortedSet=new Ue(this.comparator)}static emptySet(e){return new Ws(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Ws)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new Ws;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wg{constructor(){this.W_=new Ue(se.comparator)}track(e){const n=e.doc.key,r=this.W_.get(n);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(n,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(n):e.type===1&&r.type===2?this.W_=this.W_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):ae():this.W_=this.W_.insert(n,e)}G_(){const e=[];return this.W_.inorderTraversal((n,r)=>{e.push(r)}),e}}class ri{constructor(e,n,r,s,i,o,l,u,h){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=l,this.excludesMetadataChanges=u,this.hasCachedResults=h}static fromInitialDocuments(e,n,r,s,i){const o=[];return n.forEach(l=>{o.push({type:0,doc:l})}),new ri(e,n,Ws.emptySet(n),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Gl(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cT{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class dT{constructor(){this.queries=Sg(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(n,r){const s=ue(n),i=s.queries;s.queries=Sg(),i.forEach((o,l)=>{for(const u of l.j_)u.onError(r)})})(this,new Y(z.ABORTED,"Firestore shutting down"))}}function Sg(){return new ci(t=>A0(t),Gl)}async function sv(t,e){const n=ue(t);let r=3;const s=e.query;let i=n.queries.get(s);i?!i.H_()&&e.J_()&&(r=2):(i=new cT,r=e.J_()?0:1);try{switch(r){case 0:i.z_=await n.onListen(s,!0);break;case 1:i.z_=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(o){const l=Mh(o,`Initialization of query '${Es(e.query)}' failed`);return void e.onError(l)}n.queries.set(s,i),i.j_.push(e),e.Z_(n.onlineState),i.z_&&e.X_(i.z_)&&Vh(n)}async function iv(t,e){const n=ue(t),r=e.query;let s=3;const i=n.queries.get(r);if(i){const o=i.j_.indexOf(e);o>=0&&(i.j_.splice(o,1),i.j_.length===0?s=e.J_()?0:1:!i.H_()&&e.J_()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function hT(t,e){const n=ue(t);let r=!1;for(const s of e){const i=s.query,o=n.queries.get(i);if(o){for(const l of o.j_)l.X_(s)&&(r=!0);o.z_=s}}r&&Vh(n)}function fT(t,e,n){const r=ue(t),s=r.queries.get(e);if(s)for(const i of s.j_)i.onError(n);r.queries.delete(e)}function Vh(t){t.Y_.forEach(e=>{e.next()})}var ud,Eg;(Eg=ud||(ud={})).ea="default",Eg.Cache="cache";class ov{constructor(e,n,r){this.query=e,this.ta=n,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new ri(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.na?this.ia(e)&&(this.ta.next(e),n=!0):this.sa(e,this.onlineState)&&(this.oa(e),n=!0),this.ra=e,n}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let n=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),n=!0),n}sa(e,n){if(!e.fromCache||!this.J_())return!0;const r=n!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const n=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}oa(e){e=ri.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==ud.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class av{constructor(e){this.key=e}}class lv{constructor(e){this.key=e}}class pT{constructor(e,n){this.query=e,this.Ta=n,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=fe(),this.mutatedKeys=fe(),this.Aa=C0(e),this.Ra=new Ws(this.Aa)}get Va(){return this.Ta}ma(e,n){const r=n?n.fa:new wg,s=n?n.Ra:this.Ra;let i=n?n.mutatedKeys:this.mutatedKeys,o=s,l=!1;const u=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,h=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((p,g)=>{const v=s.get(p),k=Ql(this.query,g)?g:null,R=!!v&&this.mutatedKeys.has(v.key),P=!!k&&(k.hasLocalMutations||this.mutatedKeys.has(k.key)&&k.hasCommittedMutations);let O=!1;v&&k?v.data.isEqual(k.data)?R!==P&&(r.track({type:3,doc:k}),O=!0):this.ga(v,k)||(r.track({type:2,doc:k}),O=!0,(u&&this.Aa(k,u)>0||h&&this.Aa(k,h)<0)&&(l=!0)):!v&&k?(r.track({type:0,doc:k}),O=!0):v&&!k&&(r.track({type:1,doc:v}),O=!0,(u||h)&&(l=!0)),O&&(k?(o=o.add(k),i=P?i.add(p):i.delete(p)):(o=o.delete(p),i=i.delete(p)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const p=this.query.limitType==="F"?o.last():o.first();o=o.delete(p.key),i=i.delete(p.key),r.track({type:1,doc:p})}return{Ra:o,fa:r,ns:l,mutatedKeys:i}}ga(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,s){const i=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const o=e.fa.G_();o.sort((p,g)=>function(k,R){const P=O=>{switch(O){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ae()}};return P(k)-P(R)}(p.type,g.type)||this.Aa(p.doc,g.doc)),this.pa(r),s=s!=null&&s;const l=n&&!s?this.ya():[],u=this.da.size===0&&this.current&&!s?1:0,h=u!==this.Ea;return this.Ea=u,o.length!==0||h?{snapshot:new ri(this.query,e.Ra,i,o,e.mutatedKeys,u===0,h,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:l}:{wa:l}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new wg,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(n=>this.Ta=this.Ta.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ta=this.Ta.delete(n)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=fe(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const n=[];return e.forEach(r=>{this.da.has(r)||n.push(new lv(r))}),this.da.forEach(r=>{e.has(r)||n.push(new av(r))}),n}ba(e){this.Ta=e.Ts,this.da=fe();const n=this.ma(e.documents);return this.applyChanges(n,!0)}Da(){return ri.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class gT{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class mT{constructor(e){this.key=e,this.va=!1}}class yT{constructor(e,n,r,s,i,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new ci(l=>A0(l),Gl),this.Ma=new Map,this.xa=new Set,this.Oa=new Ue(se.comparator),this.Na=new Map,this.La=new Ah,this.Ba={},this.ka=new Map,this.qa=ni.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function vT(t,e,n=!0){const r=pv(t);let s;const i=r.Fa.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.Da()):s=await uv(r,e,n,!0),s}async function _T(t,e){const n=pv(t);await uv(n,e,!0,!1)}async function uv(t,e,n,r){const s=await BE(t.localStore,Vn(e)),i=s.targetId,o=t.sharedClientState.addLocalQueryTarget(i,n);let l;return r&&(l=await xT(t,e,i,o==="current",s.resumeToken)),t.isPrimaryClient&&n&&J0(t.remoteStore,s),l}async function xT(t,e,n,r,s){t.Ka=(g,v,k)=>async function(P,O,C,I){let w=O.view.ma(C);w.ns&&(w=await yg(P.localStore,O.query,!1).then(({documents:T})=>O.view.ma(T,w)));const b=I&&I.targetChanges.get(O.targetId),V=I&&I.targetMismatches.get(O.targetId)!=null,j=O.view.applyChanges(w,P.isPrimaryClient,b,V);return Ig(P,O.targetId,j.wa),j.snapshot}(t,g,v,k);const i=await yg(t.localStore,e,!0),o=new pT(e,i.Ts),l=o.ma(i.documents),u=$o.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),h=o.applyChanges(l,t.isPrimaryClient,u);Ig(t,n,h.wa);const p=new gT(e,n,o);return t.Fa.set(e,p),t.Ma.has(n)?t.Ma.get(n).push(e):t.Ma.set(n,[e]),h.snapshot}async function wT(t,e,n){const r=ue(t),s=r.Fa.get(e),i=r.Ma.get(s.targetId);if(i.length>1)return r.Ma.set(s.targetId,i.filter(o=>!Gl(o,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await ld(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&Rh(r.remoteStore,s.targetId),cd(r,s.targetId)}).catch(Fo)):(cd(r,s.targetId),await ld(r.localStore,s.targetId,!0))}async function ST(t,e){const n=ue(t),r=n.Fa.get(e),s=n.Ma.get(r.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Rh(n.remoteStore,r.targetId))}async function ET(t,e,n){const r=PT(t);try{const s=await function(o,l){const u=ue(o),h=it.now(),p=l.reduce((k,R)=>k.add(R.key),fe());let g,v;return u.persistence.runTransaction("Locally write mutations","readwrite",k=>{let R=ir(),P=fe();return u.cs.getEntries(k,p).next(O=>{R=O,R.forEach((C,I)=>{I.isValidDocument()||(P=P.add(C))})}).next(()=>u.localDocuments.getOverlayedDocuments(k,R)).next(O=>{g=O;const C=[];for(const I of l){const w=HS(I,g.get(I.key).overlayedDocument);w!=null&&C.push(new Br(I.key,w,v0(w.value.mapValue),hn.exists(!0)))}return u.mutationQueue.addMutationBatch(k,h,C,l)}).next(O=>{v=O;const C=O.applyToLocalDocumentSet(g,P);return u.documentOverlayCache.saveOverlays(k,O.batchId,C)})}).then(()=>({batchId:v.batchId,changes:R0(g)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(o,l,u){let h=o.Ba[o.currentUser.toKey()];h||(h=new Ue(xe)),h=h.insert(l,u),o.Ba[o.currentUser.toKey()]=h}(r,s.batchId,n),await Ho(r,s.changes),await eu(r.remoteStore)}catch(s){const i=Mh(s,"Failed to persist write");n.reject(i)}}async function cv(t,e){const n=ue(t);try{const r=await OE(n.localStore,e);e.targetChanges.forEach((s,i)=>{const o=n.Na.get(i);o&&(Te(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?o.va=!0:s.modifiedDocuments.size>0?Te(o.va):s.removedDocuments.size>0&&(Te(o.va),o.va=!1))}),await Ho(n,r,e)}catch(r){await Fo(r)}}function Tg(t,e,n){const r=ue(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.Fa.forEach((i,o)=>{const l=o.view.Z_(e);l.snapshot&&s.push(l.snapshot)}),function(o,l){const u=ue(o);u.onlineState=l;let h=!1;u.queries.forEach((p,g)=>{for(const v of g.j_)v.Z_(l)&&(h=!0)}),h&&Vh(u)}(r.eventManager,e),s.length&&r.Ca.d_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function TT(t,e,n){const r=ue(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.Na.get(e),i=s&&s.key;if(i){let o=new Ue(se.comparator);o=o.insert(i,At.newNoDocument(i,le.min()));const l=fe().add(i),u=new Xl(le.min(),new Map,new Ue(xe),o,l);await cv(r,u),r.Oa=r.Oa.remove(i),r.Na.delete(e),jh(r)}else await ld(r.localStore,e,!1).then(()=>cd(r,e,n)).catch(Fo)}async function IT(t,e){const n=ue(t),r=e.batch.batchId;try{const s=await LE(n.localStore,e);hv(n,r,null),dv(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Ho(n,s)}catch(s){await Fo(s)}}async function AT(t,e,n){const r=ue(t);try{const s=await function(o,l){const u=ue(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",h=>{let p;return u.mutationQueue.lookupMutationBatch(h,l).next(g=>(Te(g!==null),p=g.keys(),u.mutationQueue.removeMutationBatch(h,g))).next(()=>u.mutationQueue.performConsistencyCheck(h)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(h,p,l)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,p)).next(()=>u.localDocuments.getDocuments(h,p))})}(r.localStore,e);hv(r,e,n),dv(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await Ho(r,s)}catch(s){await Fo(s)}}function dv(t,e){(t.ka.get(e)||[]).forEach(n=>{n.resolve()}),t.ka.delete(e)}function hv(t,e,n){const r=ue(t);let s=r.Ba[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.Ba[r.currentUser.toKey()]=s}}function cd(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Ma.get(e))t.Fa.delete(r),n&&t.Ca.$a(r,n);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(r=>{t.La.containsKey(r)||fv(t,r)})}function fv(t,e){t.xa.delete(e.path.canonicalString());const n=t.Oa.get(e);n!==null&&(Rh(t.remoteStore,n),t.Oa=t.Oa.remove(e),t.Na.delete(n),jh(t))}function Ig(t,e,n){for(const r of n)r instanceof av?(t.La.addReference(r.key,e),CT(t,r)):r instanceof lv?(ne("SyncEngine","Document no longer in limbo: "+r.key),t.La.removeReference(r.key,e),t.La.containsKey(r.key)||fv(t,r.key)):ae()}function CT(t,e){const n=e.key,r=n.path.canonicalString();t.Oa.get(n)||t.xa.has(r)||(ne("SyncEngine","New document in limbo: "+n),t.xa.add(r),jh(t))}function jh(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const n=new se(Me.fromString(e)),r=t.qa.next();t.Na.set(r,new mT(n)),t.Oa=t.Oa.insert(n,r),J0(t.remoteStore,new xr(Vn(xh(n.path)),r,"TargetPurposeLimboResolution",ph.oe))}}async function Ho(t,e,n){const r=ue(t),s=[],i=[],o=[];r.Fa.isEmpty()||(r.Fa.forEach((l,u)=>{o.push(r.Ka(u,e,n).then(h=>{var p;if((h||n)&&r.isPrimaryClient){const g=h?!h.fromCache:(p=n==null?void 0:n.targetChanges.get(u.targetId))===null||p===void 0?void 0:p.current;r.sharedClientState.updateQueryState(u.targetId,g?"current":"not-current")}if(h){s.push(h);const g=kh.Wi(u.targetId,h);i.push(g)}}))}),await Promise.all(o),r.Ca.d_(s),await async function(u,h){const p=ue(u);try{await p.persistence.runTransaction("notifyLocalViewChanges","readwrite",g=>B.forEach(h,v=>B.forEach(v.$i,k=>p.persistence.referenceDelegate.addReference(g,v.targetId,k)).next(()=>B.forEach(v.Ui,k=>p.persistence.referenceDelegate.removeReference(g,v.targetId,k)))))}catch(g){if(!zo(g))throw g;ne("LocalStore","Failed to update sequence numbers: "+g)}for(const g of h){const v=g.targetId;if(!g.fromCache){const k=p.os.get(v),R=k.snapshotVersion,P=k.withLastLimboFreeSnapshotVersion(R);p.os=p.os.insert(v,P)}}}(r.localStore,i))}async function kT(t,e){const n=ue(t);if(!n.currentUser.isEqual(e)){ne("SyncEngine","User change. New user:",e.toKey());const r=await Q0(n.localStore,e);n.currentUser=e,function(i,o){i.ka.forEach(l=>{l.forEach(u=>{u.reject(new Y(z.CANCELLED,o))})}),i.ka.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Ho(n,r.hs)}}function RT(t,e){const n=ue(t),r=n.Na.get(e);if(r&&r.va)return fe().add(r.key);{let s=fe();const i=n.Ma.get(e);if(!i)return s;for(const o of i){const l=n.Fa.get(o);s=s.unionWith(l.view.Va)}return s}}function pv(t){const e=ue(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=cv.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=RT.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=TT.bind(null,e),e.Ca.d_=hT.bind(null,e.eventManager),e.Ca.$a=fT.bind(null,e.eventManager),e}function PT(t){const e=ue(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=IT.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=AT.bind(null,e),e}class Al{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Jl(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,n){return null}Ha(e,n){return null}za(e){return jE(this.persistence,new ME,e.initialUser,this.serializer)}Ga(e){return new bE(Ch.Zr,this.serializer)}Wa(e){return new $E}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Al.provider={build:()=>new Al};class dd{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Tg(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=kT.bind(null,this.syncEngine),await uT(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new dT}()}createDatastore(e){const n=Jl(e.databaseInfo.databaseId),r=function(i){return new GE(i)}(e.databaseInfo);return function(i,o,l,u){return new YE(i,o,l,u)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,s,i,o,l){return new JE(r,s,i,o,l)}(this.localStore,this.datastore,e.asyncQueue,n=>Tg(this.syncEngine,n,0),function(){return _g.D()?new _g:new WE}())}createSyncEngine(e,n){return function(s,i,o,l,u,h,p){const g=new yT(s,i,o,l,u,h);return p&&(g.Qa=!0),g}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(s){const i=ue(s);ne("RemoteStore","RemoteStore shutting down."),i.L_.add(5),await Wo(i),i.k_.shutdown(),i.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}dd.provider={build:()=>new dd};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gv{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):sr("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bT{constructor(e,n,r,s,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=jt.UNAUTHENTICATED,this.clientId=g0.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async o=>{ne("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(ne("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Xn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=Mh(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Ju(t,e){t.asyncQueue.verifyOperationInProgress(),ne("FirestoreClient","Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await Q0(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function Ag(t,e){t.asyncQueue.verifyOperationInProgress();const n=await DT(t);ne("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>xg(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,s)=>xg(e.remoteStore,s)),t._onlineComponents=e}async function DT(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){ne("FirestoreClient","Using user provided OfflineComponentProvider");try{await Ju(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(s){return s.name==="FirebaseError"?s.code===z.FAILED_PRECONDITION||s.code===z.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(n))throw n;Ao("Error using user provided cache. Falling back to memory cache: "+n),await Ju(t,new Al)}}else ne("FirestoreClient","Using default OfflineComponentProvider"),await Ju(t,new Al);return t._offlineComponents}async function mv(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(ne("FirestoreClient","Using user provided OnlineComponentProvider"),await Ag(t,t._uninitializedComponentsProvider._online)):(ne("FirestoreClient","Using default OnlineComponentProvider"),await Ag(t,new dd))),t._onlineComponents}function NT(t){return mv(t).then(e=>e.syncEngine)}async function yv(t){const e=await mv(t),n=e.eventManager;return n.onListen=vT.bind(null,e.syncEngine),n.onUnlisten=wT.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=_T.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=ST.bind(null,e.syncEngine),n}function MT(t,e,n={}){const r=new Xn;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,l,u,h){const p=new gv({next:v=>{p.Za(),o.enqueueAndForget(()=>iv(i,g));const k=v.docs.has(l);!k&&v.fromCache?h.reject(new Y(z.UNAVAILABLE,"Failed to get document because the client is offline.")):k&&v.fromCache&&u&&u.source==="server"?h.reject(new Y(z.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):h.resolve(v)},error:v=>h.reject(v)}),g=new ov(xh(l.path),p,{includeMetadataChanges:!0,_a:!0});return sv(i,g)}(await yv(t),t.asyncQueue,e,n,r)),r.promise}function VT(t,e,n={}){const r=new Xn;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,l,u,h){const p=new gv({next:v=>{p.Za(),o.enqueueAndForget(()=>iv(i,g)),v.fromCache&&u.source==="server"?h.reject(new Y(z.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):h.resolve(v)},error:v=>h.reject(v)}),g=new ov(l,p,{includeMetadataChanges:!0,_a:!0});return sv(i,g)}(await yv(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vv(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cg=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _v(t,e,n){if(!n)throw new Y(z.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function jT(t,e,n,r){if(e===!0&&r===!0)throw new Y(z.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function kg(t){if(!se.isDocumentKey(t))throw new Y(z.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Rg(t){if(se.isDocumentKey(t))throw new Y(z.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function tu(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":ae()}function On(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Y(z.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=tu(t);throw new Y(z.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pg{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new Y(z.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new Y(z.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}jT("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=vv((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new Y(z.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new Y(z.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new Y(z.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Lh{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Pg({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Y(z.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Y(z.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Pg(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new eS;switch(r.type){case"firstParty":return new rS(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new Y(z.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=Cg.get(n);r&&(ne("ComponentProvider","Removing Datastore"),Cg.delete(n),r.terminate())}(this),Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hi{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new hi(this.firestore,e,this._query)}}class Dt{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Dr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Dt(this.firestore,e,this._key)}}class Dr extends hi{constructor(e,n,r){super(e,n,xh(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Dt(this.firestore,null,new se(e))}withConverter(e){return new Dr(this.firestore,e,this._path)}}function qn(t,e,...n){if(t=An(t),_v("collection","path",e),t instanceof Lh){const r=Me.fromString(e,...n);return Rg(r),new Dr(t,null,r)}{if(!(t instanceof Dt||t instanceof Dr))throw new Y(z.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Me.fromString(e,...n));return Rg(r),new Dr(t.firestore,null,r)}}function un(t,e,...n){if(t=An(t),arguments.length===1&&(e=g0.newId()),_v("doc","path",e),t instanceof Lh){const r=Me.fromString(e,...n);return kg(r),new Dt(t,null,new se(r))}{if(!(t instanceof Dt||t instanceof Dr))throw new Y(z.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Me.fromString(e,...n));return kg(r),new Dt(t.firestore,t instanceof Dr?t.converter:null,new se(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bg{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new Y0(this,"async_queue_retry"),this.Vu=()=>{const r=Xu();r&&ne("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;const n=Xu();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const n=Xu();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const n=new Xn;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!zo(e))throw e;ne("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const n=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;const s=function(o){let l=o.message||"";return o.stack&&(l=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),l}(r);throw sr("INTERNAL UNHANDLED ERROR: ",s),r}).then(r=>(this.du=!1,r))));return this.mu=n,n}enqueueAfterDelay(e,n,r){this.fu(),this.Ru.indexOf(e)>-1&&(n=0);const s=Nh.createAndSchedule(this,e,n,r,i=>this.yu(i));return this.Tu.push(s),s}fu(){this.Eu&&ae()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const n of this.Tu)if(n.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.Tu)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const n=this.Tu.indexOf(e);this.Tu.splice(n,1)}}class ms extends Lh{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new bg,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new bg(e),this._firestoreClient=void 0,await e}}}function LT(t,e,n){n||(n="(default)");const r=i0(t,"firestore");if(r.isInitialized(n)){const s=r.getImmediate({identifier:n}),i=r.getOptions(n);if(vl(i,e))return s;throw new Y(z.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(e.cacheSizeBytes!==void 0&&e.localCache!==void 0)throw new Y(z.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(e.cacheSizeBytes!==void 0&&e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new Y(z.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return r.initialize({options:e,instanceIdentifier:n})}function Oh(t){if(t._terminated)throw new Y(z.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||OT(t),t._firestoreClient}function OT(t){var e,n,r;const s=t._freezeSettings(),i=function(l,u,h,p){return new mS(l,u,h,p.host,p.ssl,p.experimentalForceLongPolling,p.experimentalAutoDetectLongPolling,vv(p.experimentalLongPollingOptions),p.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,s);t._componentsProvider||!((n=s.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=s.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),t._firestoreClient=new bT(t._authCredentials,t._appCheckCredentials,t._queue,i,t._componentsProvider&&function(l){const u=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(u),_online:u}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class si{constructor(e){this._byteString=e}static fromBase64String(e){try{return new si(vt.fromBase64String(e))}catch(n){throw new Y(z.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new si(vt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nu{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new Y(z.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new pt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ru{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fh{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new Y(z.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new Y(z.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return xe(this._lat,e._lat)||xe(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zh{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FT=/^__.*__$/;class zT{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new Br(e,this.data,this.fieldMask,n,this.fieldTransforms):new Uo(e,this.data,n,this.fieldTransforms)}}class xv{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new Br(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function wv(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ae()}}class Bh{constructor(e,n,r,s,i,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.vu(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new Bh(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Fu({path:r,xu:!1});return s.Ou(e),s}Nu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Fu({path:r,xu:!1});return s.vu(),s}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return Cl(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(wv(this.Cu)&&FT.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class BT{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Jl(e)}Qu(e,n,r,s=!1){return new Bh({Cu:e,methodName:n,qu:r,path:pt.emptyPath(),xu:!1,ku:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function su(t){const e=t._freezeSettings(),n=Jl(t._databaseId);return new BT(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Sv(t,e,n,r,s,i={}){const o=t.Qu(i.merge||i.mergeFields?2:0,e,n,s);$h("Data must be an object, but it was:",o,r);const l=Ev(r,o);let u,h;if(i.merge)u=new Zt(o.fieldMask),h=o.fieldTransforms;else if(i.mergeFields){const p=[];for(const g of i.mergeFields){const v=hd(e,g,n);if(!o.contains(v))throw new Y(z.INVALID_ARGUMENT,`Field '${v}' is specified in your field mask but missing from your input data.`);Iv(p,v)||p.push(v)}u=new Zt(p),h=o.fieldTransforms.filter(g=>u.covers(g.field))}else u=null,h=o.fieldTransforms;return new zT(new Ot(l),u,h)}class iu extends ru{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof iu}}class Uh extends ru{_toFieldTransform(e){return new BS(e.path,new bo)}isEqual(e){return e instanceof Uh}}function UT(t,e,n,r){const s=t.Qu(1,e,n);$h("Data must be an object, but it was:",s,r);const i=[],o=Ot.empty();ps(r,(u,h)=>{const p=Wh(e,u,n);h=An(h);const g=s.Nu(p);if(h instanceof iu)i.push(p);else{const v=qo(h,g);v!=null&&(i.push(p),o.set(p,v))}});const l=new Zt(i);return new xv(o,l,s.fieldTransforms)}function $T(t,e,n,r,s,i){const o=t.Qu(1,e,n),l=[hd(e,r,n)],u=[s];if(i.length%2!=0)throw new Y(z.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let v=0;v<i.length;v+=2)l.push(hd(e,i[v])),u.push(i[v+1]);const h=[],p=Ot.empty();for(let v=l.length-1;v>=0;--v)if(!Iv(h,l[v])){const k=l[v];let R=u[v];R=An(R);const P=o.Nu(k);if(R instanceof iu)h.push(k);else{const O=qo(R,P);O!=null&&(h.push(k),p.set(k,O))}}const g=new Zt(h);return new xv(p,g,o.fieldTransforms)}function WT(t,e,n,r=!1){return qo(n,t.Qu(r?4:3,e))}function qo(t,e){if(Tv(t=An(t)))return $h("Unsupported field value:",e,t),Ev(t,e);if(t instanceof ru)return function(r,s){if(!wv(s.Cu))throw s.Bu(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Bu(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,s){const i=[];let o=0;for(const l of r){let u=qo(l,s.Lu(o));u==null&&(u={nullValue:"NULL_VALUE"}),i.push(u),o++}return{arrayValue:{values:i}}}(t,e)}return function(r,s){if((r=An(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return OS(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=it.fromDate(r);return{timestampValue:Tl(s.serializer,i)}}if(r instanceof it){const i=new it(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Tl(s.serializer,i)}}if(r instanceof Fh)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof si)return{bytesValue:B0(s.serializer,r._byteString)};if(r instanceof Dt){const i=s.databaseId,o=r.firestore._databaseId;if(!o.isEqual(i))throw s.Bu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:Ih(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof zh)return function(o,l){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(u=>{if(typeof u!="number")throw l.Bu("VectorValues must only contain numeric values.");return wh(l.serializer,u)})}}}}}}(r,s);throw s.Bu(`Unsupported field value: ${tu(r)}`)}(t,e)}function Ev(t,e){const n={};return m0(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ps(t,(r,s)=>{const i=qo(s,e.Mu(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function Tv(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof it||t instanceof Fh||t instanceof si||t instanceof Dt||t instanceof ru||t instanceof zh)}function $h(t,e,n){if(!Tv(n)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(n)){const r=tu(n);throw r==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+r)}}function hd(t,e,n){if((e=An(e))instanceof nu)return e._internalPath;if(typeof e=="string")return Wh(t,e);throw Cl("Field path arguments must be of type string or ",t,!1,void 0,n)}const HT=new RegExp("[~\\*/\\[\\]]");function Wh(t,e,n){if(e.search(HT)>=0)throw Cl(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new nu(...e.split("."))._internalPath}catch{throw Cl(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Cl(t,e,n,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let l=`Function ${e}() called with invalid data`;n&&(l+=" (via `toFirestore()`)"),l+=". ";let u="";return(i||o)&&(u+=" (found",i&&(u+=` in field ${r}`),o&&(u+=` in document ${s}`),u+=")"),new Y(z.INVALID_ARGUMENT,l+t+u)}function Iv(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Av{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Dt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new qT(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(Hh("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class qT extends Av{data(){return super.data()}}function Hh(t,e){return typeof e=="string"?Wh(t,e):e instanceof nu?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GT(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new Y(z.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class qh{}class QT extends qh{}function qa(t,e,...n){let r=[];e instanceof qh&&r.push(e),r=r.concat(n),function(i){const o=i.filter(u=>u instanceof Gh).length,l=i.filter(u=>u instanceof ou).length;if(o>1||o>0&&l>0)throw new Y(z.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)t=s._apply(t);return t}class ou extends QT{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new ou(e,n,r)}_apply(e){const n=this._parse(e);return Cv(e._query,n),new hi(e.firestore,e.converter,nd(e._query,n))}_parse(e){const n=su(e.firestore);return function(i,o,l,u,h,p,g){let v;if(h.isKeyField()){if(p==="array-contains"||p==="array-contains-any")throw new Y(z.INVALID_ARGUMENT,`Invalid Query. You can't perform '${p}' queries on documentId().`);if(p==="in"||p==="not-in"){Mg(g,p);const k=[];for(const R of g)k.push(Ng(u,i,R));v={arrayValue:{values:k}}}else v=Ng(u,i,g)}else p!=="in"&&p!=="not-in"&&p!=="array-contains-any"||Mg(g,p),v=WT(l,o,g,p==="in"||p==="not-in");return Ze.create(h,p,v)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function Dg(t,e,n){const r=e,s=Hh("where",t);return ou._create(s,r,n)}class Gh extends qh{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new Gh(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:Cn.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(s,i){let o=s;const l=i.getFlattenedFilters();for(const u of l)Cv(o,u),o=nd(o,u)}(e._query,n),new hi(e.firestore,e.converter,nd(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function Ng(t,e,n){if(typeof(n=An(n))=="string"){if(n==="")throw new Y(z.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!I0(e)&&n.indexOf("/")!==-1)throw new Y(z.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(Me.fromString(n));if(!se.isDocumentKey(r))throw new Y(z.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return eg(t,new se(r))}if(n instanceof Dt)return eg(t,n._key);throw new Y(z.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${tu(n)}.`)}function Mg(t,e){if(!Array.isArray(t)||t.length===0)throw new Y(z.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Cv(t,e){const n=function(s,i){for(const o of s)for(const l of o.getFlattenedFilters())if(i.indexOf(l.op)>=0)return l.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new Y(z.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Y(z.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class KT{convertValue(e,n="none"){switch(ds(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Qe(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(cs(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw ae()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return ps(e,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertVectorValue(e){var n,r,s;const i=(s=(r=(n=e.fields)===null||n===void 0?void 0:n.value.arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.map(o=>Qe(o.doubleValue));return new zh(i)}convertGeoPoint(e){return new Fh(Qe(e.latitude),Qe(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=mh(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(ko(e));default:return null}}convertTimestamp(e){const n=jr(e);return new it(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=Me.fromString(e);Te(G0(r));const s=new Ro(r.get(1),r.get(3)),i=new se(r.popFirst(5));return s.isEqual(n)||sr(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kv(t,e,n){let r;return r=t?t.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hi{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Rv extends Av{constructor(e,n,r,s,i,o){super(e,n,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new Ga(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(Hh("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class Ga extends Rv{data(e={}){return super.data(e)}}class YT{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new Hi(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new Ga(this._firestore,this._userDataWriter,r.key,r,new Hi(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new Y(z.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(l=>{const u=new Ga(s._firestore,s._userDataWriter,l.doc.key,l.doc,new Hi(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);return l.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(l=>i||l.type!==3).map(l=>{const u=new Ga(s._firestore,s._userDataWriter,l.doc.key,l.doc,new Hi(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);let h=-1,p=-1;return l.type!==0&&(h=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),p=o.indexOf(l.doc.key)),{type:XT(l.type),doc:u,oldIndex:h,newIndex:p}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function XT(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ae()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JT(t){t=On(t,Dt);const e=On(t.firestore,ms);return MT(Oh(e),t._key).then(n=>eI(e,t,n))}class Pv extends KT{constructor(e){super(),this.firestore=e}convertBytes(e){return new si(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Dt(this.firestore,null,n)}}function qi(t){t=On(t,hi);const e=On(t.firestore,ms),n=Oh(e),r=new Pv(e);return GT(t._query),VT(n,t._query).then(s=>new YT(e,r,t,s))}function ZT(t,e,n){t=On(t,Dt);const r=On(t.firestore,ms),s=kv(t.converter,e);return au(r,[Sv(su(r),"setDoc",t._key,s,t.converter!==null,n).toMutation(t._key,hn.none())])}function Gn(t,e,n,...r){t=On(t,Dt);const s=On(t.firestore,ms),i=su(s);let o;return o=typeof(e=An(e))=="string"||e instanceof nu?$T(i,"updateDoc",t._key,e,n,r):UT(i,"updateDoc",t._key,e),au(s,[o.toMutation(t._key,hn.exists(!0))])}function Zu(t){return au(On(t.firestore,ms),[new Sh(t._key,hn.none())])}function kl(t,e){const n=On(t.firestore,ms),r=un(t),s=kv(t.converter,e);return au(n,[Sv(su(t.firestore),"addDoc",r._key,s,t.converter!==null,{}).toMutation(r._key,hn.exists(!1))]).then(()=>r)}function au(t,e){return function(r,s){const i=new Xn;return r.asyncQueue.enqueueAndForget(async()=>ET(await NT(r),s,i)),i.promise}(Oh(t),e)}function eI(t,e,n){const r=n.docs.get(e._key),s=new Pv(t);return new Rv(t,s,e._key,r,new Hi(n.hasPendingWrites,n.fromCache),e.converter)}function en(){return new Uh("serverTimestamp")}(function(e,n=!0){(function(s){ui=s})(zw),To(new Js("firestore",(r,{instanceIdentifier:s,options:i})=>{const o=r.getProvider("app").getImmediate(),l=new ms(new tS(r.getProvider("auth-internal")),new iS(r.getProvider("app-check-internal")),function(h,p){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new Y(z.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ro(h.options.projectId,p)}(o,s),o);return i=Object.assign({useFetchStreams:n},i),l._setSettings(i),l},"PUBLIC").setMultipleInstances(!0)),br(Kp,"4.7.3",e),br(Kp,"4.7.3","esm2017")})();/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bv="functions";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tI{constructor(e,n,r){this.auth=null,this.messaging=null,this.appCheck=null,this.auth=e.getImmediate({optional:!0}),this.messaging=n.getImmediate({optional:!0}),this.auth||e.get().then(s=>this.auth=s,()=>{}),this.messaging||n.get().then(s=>this.messaging=s,()=>{}),this.appCheck||r.get().then(s=>this.appCheck=s,()=>{})}async getAuthToken(){if(this.auth)try{const e=await this.auth.getToken();return e==null?void 0:e.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.appCheck){const n=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return n.error?null:n.token}return null}async getContext(e){const n=await this.getAuthToken(),r=await this.getMessagingToken(),s=await this.getAppCheckToken(e);return{authToken:n,messagingToken:r,appCheckToken:s}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fd="us-central1";class nI{constructor(e,n,r,s,i=fd,o){this.app=e,this.fetchImpl=o,this.emulatorOrigin=null,this.contextProvider=new tI(n,r,s),this.cancelAllRequests=new Promise(l=>{this.deleteService=()=>Promise.resolve(l())});try{const l=new URL(i);this.customDomain=l.origin+(l.pathname==="/"?"":l.pathname),this.region=fd}catch{this.customDomain=null,this.region=i}}_delete(){return this.deleteService()}_url(e){const n=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${n}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${n}.cloudfunctions.net/${e}`}}function rI(t,e,n){t.emulatorOrigin=`http://${e}:${n}`}const Vg="@firebase/functions",jg="0.11.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sI="auth-internal",iI="app-check-internal",oI="messaging-internal";function aI(t,e){const n=(r,{instanceIdentifier:s})=>{const i=r.getProvider("app").getImmediate(),o=r.getProvider(sI),l=r.getProvider(oI),u=r.getProvider(iI);return new nI(i,o,l,u,s,t)};To(new Js(bv,n,"PUBLIC").setMultipleInstances(!0)),br(Vg,jg,e),br(Vg,jg,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lI(t=Bw(),e=fd){const r=i0(An(t),bv).getImmediate({identifier:e}),s=Dx("functions");return s&&uI(r,...s),r}function uI(t,e,n){rI(An(t),e,n)}aI(fetch.bind(self));const cI={apiKey:'"AIzaSyDRdl4zhwoZumVtphmJ19orZ8HoR0WQQZM",',authDomain:'"qualtrics-game-backend.firebaseapp.com",',projectId:'"qualtrics-game-backend",',storageBucket:'"qualtrics-game-backend.firebasestorage.app",',messagingSenderId:'"441267092549",',appId:"1:441267092549:web:6ce075f5f3ea7cf958772c"},Dv=o0(cI),et=LT(Dv,{experimentalForceLongPolling:!1,useFetchStreams:!1});lI(Dv);const Pe={async logEvent(t,e){const n=localStorage.getItem("sessionId"),r=parseInt(localStorage.getItem("sessionStartTime")||Date.now()),s=Date.now(),i=s-r,o=Math.floor(i/6e4),l=Math.floor(i%6e4/1e3),u=`${o}:${l.toString().padStart(2,"0")}`,h={sessionId:n,type:t,timestamp:en(),clientTimestamp:s,timeElapsed:i,readableTime:u,semesterTime:this.getSemesterTime(),...e,userAgent:navigator.userAgent,screenResolution:`${window.screen.width}x${window.screen.height}`};try{await kl(qn(et,"events"),h)}catch(p){console.error("Failed to log event:",p),this.storeOfflineEvent(h)}},storeOfflineEvent(t){const e=JSON.parse(localStorage.getItem("offlineEvents")||"[]");e.push(t),localStorage.setItem("offlineEvents",JSON.stringify(e))},async syncOfflineEvents(){const t=JSON.parse(localStorage.getItem("offlineEvents")||"[]");if(t.length>0){for(const e of t)try{await kl(qn(et,"events"),e)}catch(n){console.error("Failed to sync offline event:",n)}localStorage.removeItem("offlineEvents")}},async trackPageSwitch(t,e,n=!1){const r=this.getTimeOnCurrentPage(t),s=this.getSwitchContext(t,e);return this.logEvent("page_switch",{from:t,to:e,isAutoAdvance:n,switchType:n?"auto":"manual",timeOnPreviousPage:r,gameFrom:t?t.substring(0,2):null,gameTo:e?e.substring(0,2):null,switchReason:n?"task_completed":"user_initiated",...s})},async trackTaskAttempt(t,e,n,r,s,i){const o=this.calculateAccuracy(t,s,i),l=t.substring(0,2),u=t[3],h=this.getAttemptHistory(t);h.push({attempt:e,accuracy:o,timeTaken:r,answer:s,expected:i,timestamp:Date.now()}),this.saveAttemptHistory(t,h);const p=this.categorizeError(t,s,i);return this.updateMistakeTracking(t,p),this.logEvent("task_attempt",{taskId:t,game:l,taskNum:u,attempt:e,isCorrect:n,timeTaken:r,answer:s,expected:i,accuracy:o,accuracyProgression:h.map(g=>g.accuracy),mistakeType:p,timeProgression:h.map(g=>g.timeTaken),averageTime:h.reduce((g,v)=>g+v.timeTaken,0)/h.length,bestAccuracy:Math.max(...h.map(g=>g.accuracy)),worstAccuracy:Math.min(...h.map(g=>g.accuracy)),improvementTrend:this.calculateImprovementTrend(h)})},async trackAITaskHelp(t,e,n,r,s){const i=Date.now(),o=t.startsWith("g1")?"research":t.startsWith("g2")?"materials":"engagement";return this.logEvent("ai_task_help",{taskId:t,taskCategory:o,helpType:e,aiSuggestion:n,wasCorrect:r,attemptNumber:s,helpRequestTime:i,aiAccuracy:r?"correct":"incorrect",context:this.getCurrentContext()})},async trackAIHelpResponse(t,e,n,r,s,i){return this.logEvent("ai_help_response",{taskId:t,helpType:e,aiSuggestion:n,playerAction:r,playerAnswer:s,aiAnswerUsed:n===s,timeBetweenHelpAndSubmit:i,playerModification:n!==s?{original:n,modified:s,difference:this.calculateDifference(n,s,e)}:null})},async trackChatInteraction(t,e,n,r){const s=Date.now(),i=r?r.substring(0,2):"none",o=this.analyzeQuery(t),l=this.getTaskProgress(r);return this.logEvent("chat_interaction",{fullInquiry:{query:t,queryTime:s,queryLength:t.length,queryWords:t.split(/\s+/).length,queryType:this.categorizeQuery(t),...o},response:e.text,responseId:e.id,responseLevel:e.level,responseType:e.type,matchedTriggers:e.triggers,responseScore:e.score,responseLength:e.text.length,promptNumber:n,currentTask:r,gameContext:i,taskPhase:this.getTaskPhase(r),promptsRemaining:this.getPromptsRemaining(n),action:"chat_query",actionContext:{beforeTask:r,taskAttempts:this.getAttemptHistory(r).length,currentAccuracy:this.getCurrentAccuracy(r),timeOnTask:this.getTimeOnCurrentPage(r),...l},queryEffectiveness:{relevanceToTask:this.assessQueryRelevance(t,r),specificity:o.specificity,helpSeeking:o.isHelpSeeking}})},async trackTaskComplete(t,e,n,r){const s=this.getAttemptHistory(t),i=this.getMistakesByType(t),o=this.calculatePerformanceMetrics(t,s,n);return this.logEvent("task_complete",{taskId:t,game:t.substring(0,2),taskNum:t[3],attempts:e,totalTime:n,finalAccuracy:r,accuracyProgression:s.map(l=>l.accuracy),timePerAttempt:s.map(l=>l.timeTaken),averageAccuracy:s.reduce((l,u)=>l+u.accuracy,0)/s.length,improvementRate:this.calculateImprovementRate(s),mistakesByType:i,performance:{speed:n/e,consistency:this.calculateConsistency(s),difficulty:this.assessDifficulty(t,e,n),efficiency:o.efficiency,learningCurve:o.learningCurve},insights:{struggledWith:this.identifyStrugglePoints(s,i),timeDistribution:this.analyzeTimeDistribution(s),accuracyTrend:o.accuracyTrend}})},async trackUserAction(t,e={}){return this.logEvent("user_action",{action:t,...e,timestamp:Date.now(),context:this.getCurrentContext()})},async trackGameStart(t){const e={practiceCompleted:t,browserInfo:this.getBrowserInfo(),deviceInfo:this.getDeviceInfo(),connectionQuality:await this.assessConnectionQuality()};return this.logEvent("game_start",e)},async trackGameComplete(t,e,n,r,s,i){const o=this.calculateGameStats();return this.logEvent("game_complete",{totalTime:t,totalSwitches:e,completedTasks:n,gameFlow:{averageTimePerTask:t/n,switchesPerTask:e/n,taskCompletionOrder:this.getTaskCompletionOrder(),dependenciesActivated:this.getDependenciesActivated()},performanceSummary:{overallAccuracy:o.overallAccuracy,bestTask:o.bestTask,worstTask:o.worstTask,mostAttempts:o.mostAttempts,leastAttempts:o.leastAttempts},chatUsage:{totalPrompts:s,promptsUsed:i,promptEfficiency:i/s,chatInteractions:this.getChatInteractionSummary()},finalContext:{practiceCompleted:r==="yes",totalFocusLosses:this.getFocusLossCount(),totalIdleWarnings:this.getIdleWarningCount(),sessionDuration:t}})},categorizeError(t,e,n){if(t.startsWith("g1")){const r=Math.abs(e-n),s=n>0?r/n*100:100;return r===0?"none":r===1?"off_by_one":r<=3?"minor_miscount":s<=10?"close_miscount":s<=25?"moderate_miscount":"major_miscount"}else if(t.startsWith("g2")){const r=Math.abs(e-n);return r===0?"none":r<.05?"extremely_close":r<.1?"very_close":r<.5?"close":r<1?"moderate":r<2?"far":"very_far"}else if(t.startsWith("g3")){if(e===n)return"none";const r=[];e.toLowerCase()===n.toLowerCase()&&r.push("case_only"),e.length!==n.length&&(e.length<n.length?r.push("missing_chars"):r.push("extra_chars"));const s=this.categorizeCharacters(e),i=this.categorizeCharacters(n);return s.symbols!==i.symbols&&r.push("symbol_error"),s.numbers!==i.numbers&&r.push("number_error"),s.spaces!==i.spaces&&r.push("space_error"),this.analyzePositionErrors(e,n).transposition&&r.push("transposition"),r.length>0?r.join(","):"general_mismatch"}return"unknown"},analyzeQuery(t){const e=t.toLowerCase().split(/\s+/),n=["what","how","why","when","where","which","who"],r=["help","stuck","cant","difficult","hard","struggling"];return{hasQuestion:n.some(s=>e.includes(s)),isHelpSeeking:r.some(s=>e.includes(s)),specificity:this.calculateSpecificity(t),sentiment:this.analyzeSentiment(t),urgency:this.assessUrgency(t)}},categorizeQuery(t){const e=t.toLowerCase();return e.includes("help")||e.includes("stuck")||e.includes("cant")?"help_request":e.includes("how")&&(e.includes("do")||e.includes("work"))?"how_to":e.includes("what")||e.includes("explain")?"explanation":e.includes("strategy")||e.includes("tip")||e.includes("trick")?"strategy":e.includes("rule")||e.includes("requirement")?"rules":e.includes("count")||e.includes("slider")||e.includes("typ")?"task_specific":e.includes("order")||e.includes("sequence")||e.includes("which first")?"task_order":e.includes("prompt")||e.includes("question")?"prompt_related":e.includes("accuracy")||e.includes("score")?"performance":"general"},getTaskPhase(t){if(!t)return"none";const e=this.getAttemptHistory(t).length,n=this.getCurrentAccuracy(t);return e===0?"not_started":e===1?"first_attempt":e<=3&&n>=70?"early_success":e<=3?"early_attempts":e<=5&&n>=80?"improving":e>5&&n<50?"struggling_badly":e>5?"struggling":"in_progress"},calculateAccuracy(t,e,n){if(t.startsWith("g1")){if(e===n)return 100;const r=Math.abs(e-n),s=Math.max(n*.1,1);if(r<=s)return Math.round(90*(1-r/s)+90);{const i=r-s,o=Math.max(n,20),l=Math.max(0,90*(1-i/o));return Math.round(l)}}else if(t.startsWith("g2")){const r=Math.abs(e-n),s=parseInt(t[3]),i=[.5,.05,.005][s-1];return r<=i?100:r<=i*2?Math.round(90+10*(1-(r-i)/i)):Math.max(0,Math.round(90*(1-r/10)))}else if(t.startsWith("g3")){if(e===n)return 100;const r=Math.max(e.length,n.length);if(r===0)return 0;let s=0;const i=Math.min(e.length,n.length);for(let l=0;l<i;l++)e[l]===n[l]?s+=1:n.includes(e[l])&&(s+=.5);const o=Math.abs(e.length-n.length)*.5;return s=Math.max(0,s-o),Math.round(s/r*100)}return 0},getAttemptHistory(t){const e=localStorage.getItem(`attemptHistory_${t}`);return e?JSON.parse(e):[]},saveAttemptHistory(t,e){localStorage.setItem(`attemptHistory_${t}`,JSON.stringify(e))},getCurrentAccuracy(t){const e=this.getAttemptHistory(t);return e.length>0?e[e.length-1].accuracy:null},getMistakesByType(t){const e=localStorage.getItem(`mistakes_${t}`);return e?JSON.parse(e):{}},updateMistakeTracking(t,e){const n=this.getMistakesByType(t);n[e]=(n[e]||0)+1,localStorage.setItem(`mistakes_${t}`,JSON.stringify(n))},calculateImprovementRate(t){if(t.length<2)return 0;const e=t[0].accuracy,r=t[t.length-1].accuracy-e,s=Math.floor(t.length/2),i=t.slice(0,s).reduce((u,h)=>u+h.accuracy,0)/s,l=t.slice(s).reduce((u,h)=>u+h.accuracy,0)/(t.length-s)-i;return{overall:r,trend:l,isImproving:l>0}},calculateConsistency(t){if(t.length<2)return 100;const e=t.map(i=>i.accuracy),n=e.reduce((i,o)=>i+o)/e.length,r=e.reduce((i,o)=>i+Math.pow(o-n,2),0)/e.length,s=Math.sqrt(r);return Math.max(0,Math.round(100-s))},assessDifficulty(t,e,n){const r=parseInt(t[3]),s=["easy","medium","hard"][r-1];return e===1&&n<1e4?s+"_mastered":e===1&&n<2e4?s+"_quick":e<=2&&n<3e4?s+"_smooth":e<=3?s+"_normal":e<=5?s+"_challenging":e>5&&n>12e4?s+"_very_challenging":s+"_struggled"},getTimeOnCurrentPage(t){const e=localStorage.getItem(`pageStartTime_${t}`);return e?Date.now()-parseInt(e):0},setPageStartTime(t){localStorage.setItem(`pageStartTime_${t}`,Date.now().toString())},calculatePerformanceMetrics(t,e,n){const r=e.map(i=>i.accuracy),s=e.map(i=>i.timeTaken);return{efficiency:this.calculateEfficiency(r,s),learningCurve:this.analyzeLearningCurve(e),accuracyTrend:this.calculateTrend(r),speedTrend:this.calculateTrend(s),plateauPoint:this.findPlateauPoint(r)}},calculateEfficiency(t,e){const n=t.reduce((s,i)=>s+i,0)/t.length,r=e.reduce((s,i)=>s+i,0)/e.length;return n/(r/1e3)},analyzeLearningCurve(t){if(t.length<3)return"insufficient_data";const e=t.map(i=>i.accuracy),n=[];for(let i=1;i<e.length;i++)n.push(e[i]-e[i-1]);const r=n.reduce((i,o)=>i+o,0)/n.length,s=n.slice(-3).reduce((i,o)=>i+o,0)/3;return r>10?"steep_improvement":r>5?"steady_improvement":r>0?"gradual_improvement":s<-5?"declining":"plateau"},calculateTrend(t){if(t.length<2)return 0;const e=t.length,n=t.reduce((l,u,h)=>l+h,0),r=t.reduce((l,u)=>l+u,0),s=t.reduce((l,u,h)=>l+h*u,0),i=t.reduce((l,u,h)=>l+h*h,0);return(e*s-n*r)/(e*i-n*n)},findPlateauPoint(t){if(t.length<4)return null;for(let e=3;e<t.length;e++){const n=t.slice(e-3,e+1);if(this.calculateVariance(n)<5&&n[n.length-1]>=85)return e-2}return null},calculateVariance(t){const e=t.reduce((n,r)=>n+r,0)/t.length;return t.reduce((n,r)=>n+Math.pow(r-e,2),0)/t.length},categorizeCharacters(t){return{letters:(t.match(/[a-zA-Z]/g)||[]).length,numbers:(t.match(/[0-9]/g)||[]).length,symbols:(t.match(/[^a-zA-Z0-9\s]/g)||[]).length,spaces:(t.match(/\s/g)||[]).length,uppercase:(t.match(/[A-Z]/g)||[]).length,lowercase:(t.match(/[a-z]/g)||[]).length}},analyzePositionErrors(t,e){const n={transposition:!1,insertion:!1,deletion:!1,substitution:!1};for(let r=0;r<t.length-1;r++)r<e.length-1&&t[r]===e[r+1]&&t[r+1]===e[r]&&(n.transposition=!0);return t.length>e.length&&(n.insertion=!0),t.length<e.length&&(n.deletion=!0),t.length===e.length&&t!==e&&(n.substitution=!0),n},getCurrentContext(){return{currentTask:localStorage.getItem("currentTask"),gameMode:localStorage.getItem("gameMode"),totalCompleted:this.getCompletedTaskCount(),currentStreak:this.getCurrentStreak(),sessionDuration:this.getSessionDuration()}},getCompletedTaskCount(){return["g1t1","g1t2","g1t3","g2t1","g2t2","g2t3","g3t1","g3t2","g3t3"].filter(e=>this.getAttemptHistory(e).some(r=>r.accuracy>=90)).length},getCurrentStreak(){return parseInt(localStorage.getItem("currentStreak")||"0")},updateStreak(t){const e=this.getCurrentStreak();t?localStorage.setItem("currentStreak",(e+1).toString()):localStorage.setItem("currentStreak","0")},getSessionDuration(){const t=localStorage.getItem("sessionStartTime");return t?Date.now()-parseInt(t):0},getTaskProgress(t){if(!t)return{};const e=this.getAttemptHistory(t),n=this.getCurrentAccuracy(t);return{attempts:e.length,currentAccuracy:n,bestAccuracy:e.length>0?Math.max(...e.map(r=>r.accuracy)):0,averageTime:e.length>0?e.reduce((r,s)=>r+s.timeTaken,0)/e.length:0,isImproving:e.length>=2?e[e.length-1].accuracy>e[e.length-2].accuracy:!1}},assessQueryRelevance(t,e){if(!e)return"no_task";const n=t.toLowerCase(),r=e.substring(0,2);return r==="g1"&&(n.includes("count")||n.includes("word")||n.includes("letter"))||r==="g2"&&(n.includes("slider")||n.includes("slide")||n.includes("target"))||r==="g3"&&(n.includes("type")||n.includes("typing")||n.includes("pattern"))?"highly_relevant":n.includes("task")||n.includes("help")||n.includes("how")?"relevant":n.includes("order")||n.includes("strategy")||n.includes("which")?"somewhat_relevant":"not_relevant"},analyzeSentiment(t){const e=["cant","wont","stuck","hard","difficult","impossible","wrong","bad"],n=["good","great","easy","got","understand","thanks","helpful"],r=["ugh","argh","damn","frustrat","annoying","stupid"],s=t.toLowerCase(),i=e.filter(u=>s.includes(u)).length,o=n.filter(u=>s.includes(u)).length;return r.filter(u=>s.includes(u)).length>0?"frustrated":i>o?"negative":o>i?"positive":"neutral"},assessUrgency(t){const e=["help","please","need","stuck","cant","now","!","??"],n=t.toLowerCase(),r=e.filter(s=>n.includes(s)).length;return r>=3?"high":r>=1?"medium":"low"},calculateSpecificity(t){const e=t.split(/\s+/),n=["count","slider","typing","word","letter","target","pattern","accuracy","decimal","case","symbol","highlight","enhanced"];return e.filter(s=>n.includes(s.toLowerCase())).length/e.length},identifyStrugglePoints(t,e){const n=[];t.reduce((o,l)=>o+l.accuracy,0)/t.length<50&&n.push("low_overall_accuracy");const s=this.calculateImprovementRate(t);s.overall<0&&n.push("declining_performance"),!s.isImproving&&t.length>3&&n.push("plateau");const i=Object.entries(e).sort(([,o],[,l])=>l-o)[0];return i&&i[1]>t.length/2&&n.push(`repeated_${i[0]}`),n},analyzeTimeDistribution(t){const e=t.map(n=>n.timeTaken);return{min:Math.min(...e),max:Math.max(...e),average:e.reduce((n,r)=>n+r,0)/e.length,median:this.calculateMedian(e),trend:this.calculateTrend(e),consistency:this.calculateConsistency(e)}},calculateMedian(t){const e=[...t].sort((r,s)=>r-s),n=Math.floor(e.length/2);return e.length%2===0?(e[n-1]+e[n])/2:e[n]},calculateGameStats(){const n=["g1t1","g1t2","g1t3","g2t1","g2t2","g2t3","g3t1","g3t2","g3t3"].map(r=>{const s=this.getAttemptHistory(r),i=s.length>0?Math.max(...s.map(o=>o.accuracy)):0;return{task:r,attempts:s.length,bestAccuracy:i,avgTime:s.length>0?s.reduce((o,l)=>o+l.timeTaken,0)/s.length:0}}).filter(r=>r.attempts>0);return{overallAccuracy:n.length>0?n.reduce((r,s)=>r+s.bestAccuracy,0)/n.length:0,bestTask:n.sort((r,s)=>s.bestAccuracy-r.bestAccuracy)[0],worstTask:n.sort((r,s)=>r.bestAccuracy-s.bestAccuracy)[0],mostAttempts:n.sort((r,s)=>s.attempts-r.attempts)[0],leastAttempts:n.sort((r,s)=>r.attempts-s.attempts)[0]}},getTaskCompletionOrder(){return JSON.parse(localStorage.getItem("taskCompletionOrder")||"[]")},updateTaskCompletionOrder(t){const e=this.getTaskCompletionOrder();e.includes(t)||(e.push(t),localStorage.setItem("taskCompletionOrder",JSON.stringify(e)))},getDependenciesActivated(){return JSON.parse(localStorage.getItem("dependenciesActivated")||"[]")},getChatInteractionSummary(){const t=JSON.parse(localStorage.getItem("chatInteractions")||"[]");return{total:t.length,byType:this.groupBy(t,"queryType"),averageResponseTime:t.length>0?t.reduce((e,n)=>e+(n.responseTime||0),0)/t.length:0,helpRequests:t.filter(e=>e.queryType==="help_request").length}},groupBy(t,e){return t.reduce((n,r)=>{const s=r[e];return n[s]||(n[s]=0),n[s]++,n},{})},getFocusLossCount(){return parseInt(localStorage.getItem("focusLossCount")||"0")},incrementFocusLoss(){const t=this.getFocusLossCount();localStorage.setItem("focusLossCount",(t+1).toString())},getIdleWarningCount(){return parseInt(localStorage.getItem("idleWarningCount")||"0")},incrementIdleWarning(){const t=this.getIdleWarningCount();localStorage.setItem("idleWarningCount",(t+1).toString())},getSwitchContext(t,e){const n=t?this.getAttemptHistory(t):[],r=e?this.getAttemptHistory(e):[];return{fromTaskStatus:{completed:n.some(s=>s.accuracy>=90),attempts:n.length,lastAccuracy:n.length>0?n[n.length-1].accuracy:0},toTaskStatus:{previousAttempts:r.length,bestAccuracy:r.length>0?Math.max(...r.map(s=>s.accuracy)):0},switchPattern:this.analyzeSwitchPattern(t,e)}},analyzeSwitchPattern(t,e){if(!t||!e)return"initial";const n=t.substring(0,2),r=e.substring(0,2),s=parseInt(t[3]),i=parseInt(e[3]);return n===r?i===s+1?"sequential_same_game":i<s?"backtrack_same_game":"skip_same_game":i===1?"new_game_start":"cross_game_jump"},getBrowserInfo(){const t=navigator.userAgent;let e="Unknown";return t.includes("Chrome")?e="Chrome":t.includes("Firefox")?e="Firefox":t.includes("Safari")?e="Safari":t.includes("Edge")&&(e="Edge"),{browser:e,userAgent:t,language:navigator.language,platform:navigator.platform,cookiesEnabled:navigator.cookieEnabled}},getDeviceInfo(){return{screenResolution:`${window.screen.width}x${window.screen.height}`,windowSize:`${window.innerWidth}x${window.innerHeight}`,devicePixelRatio:window.devicePixelRatio,touchSupport:"ontouchstart"in window,deviceMemory:navigator.deviceMemory||"unknown",hardwareConcurrency:navigator.hardwareConcurrency||"unknown"}},async assessConnectionQuality(){return navigator.connection?{effectiveType:navigator.connection.effectiveType,downlink:navigator.connection.downlink,rtt:navigator.connection.rtt,saveData:navigator.connection.saveData}:"unknown"},getPromptsRemaining(t){return 3+this.getCompletedTaskCount()-t},calculateImprovementTrend(t){if(t.length<3)return"insufficient_data";const n=t.slice(-5).map(s=>s.accuracy),r=this.calculateTrend(n);return r>5?"rapid_improvement":r>2?"steady_improvement":r>0?"slight_improvement":r>-2?"stable":r>-5?"slight_decline":"rapid_decline"},getSemesterTime(){const t=parseInt(localStorage.getItem("semesterStartTime")||Date.now()),e=Date.now()-t,n=Math.floor(e/6e4),r=Math.floor(e%6e4/1e3);return{elapsed:e,readable:`${n}:${r.toString().padStart(2,"0")}`,minutes:n,seconds:r}},calculateDifference(t,e,n){return n==="slider"?{type:"numerical",difference:Math.abs(t-e),percentDiff:Math.abs(t-e)/10*100}:n==="counting"?{type:"numerical",difference:Math.abs(t-e),percentDiff:t>0?Math.abs(t-e)/t*100:100}:n==="typing"?{type:"textual",levenshteinDistance:this.calculateLevenshteinDistance(t,e),charDifference:Math.abs(t.length-e.length),exactMatch:t===e}:null},calculateLevenshteinDistance(t,e){const n=t.length,r=e.length,s=Array(n+1).fill(null).map(()=>Array(r+1).fill(0));for(let i=0;i<=n;i++)s[i][0]=i;for(let i=0;i<=r;i++)s[0][i]=i;for(let i=1;i<=n;i++)for(let o=1;o<=r;o++)t[i-1]===e[o-1]?s[i][o]=s[i-1][o-1]:s[i][o]=Math.min(s[i-1][o]+1,s[i][o-1]+1,s[i-1][o-1]+1);return s[n][r]},trackClick(t,e){var r;const n={tagName:t.tagName,className:t.className,id:t.id,text:(r=t.textContent)==null?void 0:r.substring(0,50),dataAttributes:this.extractDataAttributes(t)};return this.logEvent("user_click",{element:n,context:e,coordinates:{pageX:event.pageX,pageY:event.pageY,clientX:event.clientX,clientY:event.clientY}})},extractDataAttributes(t){const e={};for(let n of t.attributes)n.name.startsWith("data-")&&(e[n.name]=n.value);return e}},Jn={seedRandom:null,currentSeed:null,initializeSeed(t){this.currentSeed=t;let e=t;this.seedRandom=function(){return e=(e*9301+49297)%233280,e/233280}},getRandom(){return this.seedRandom?this.seedRandom():Math.random()},generateCountingPattern(t){const e=t<=10?"easy":t<=25?"medium":"hard";let n;e==="easy"?n=(t-1)%5+1:e==="medium"?n=(t-11)%5+6:n=(t-26)%5+11;const s={easy:{1:{target:"the",type:"word"},2:{target:"and",type:"word"},3:{target:"of",type:"word"},4:{target:"a",type:"word"},5:{target:"in",type:"word"}},medium:{6:{target:"e",type:"letter"},7:{target:"a",type:"letter"},8:{target:"i",type:"letter"},9:{target:"o",type:"letter"},10:{target:"s",type:"letter"}},hard:{11:{targets:["a","e"],type:"multi-letter"},12:{targets:["i","o"],type:"multi-letter"},13:{targets:["s","t"],type:"multi-letter"},14:{targets:["n","r"],type:"multi-letter"},15:{targets:["l","d"],type:"multi-letter"}}}[e][n];let i="";return s.type==="word"?i=`Count how many times the word "${s.target}" appears:`:s.type==="letter"?i=`Count how many times the letter "${s.target}" appears (case-insensitive):`:i=`Count how many times the letters "${s.targets[0]}" and "${s.targets[1]}" appear in total:`,{...s,instruction:i,difficulty:e,difficultyLabel:e.charAt(0).toUpperCase()+e.slice(1)}},generateSliderPattern(t){const e=t<=10?"easy":t<=25?"medium":"hard";let n,r,s;return e==="easy"?(n=Math.floor(this.getRandom()*11),r=1,s=!0):e==="medium"?(n=Math.round(this.getRandom()*10*10)/10,r=.1,s=!0):(n=Math.round(this.getRandom()*10*100)/100,r=.01,s=(t-26)%5!==0),{target:n,step:r,showValue:s,difficulty:e,difficultyLabel:e.charAt(0).toUpperCase()+e.slice(1),precision:e==="easy"?0:e==="medium"?1:2}},generateTypingPattern(t){const e=t<=10?"easy":t<=25?"medium":"hard",n={easy:["hello world","quick test","type this","easy mode","simple text","good job","keep going","nice work","almost done","level up"],medium:["HeLLo WoRLd","QuIcK tEsT","TyPe ThIs","MeDiUm MoDe","MiXeD cAsE","KeEp GoInG","NiCe WoRk","AlMoSt DoNe","LeVeL uP","ChAlLeNgE","TeSt RuN","NeXt LeVeL","TrY aGaIn","GoOd LuCk","FiNaL tEsT"],hard:["Test@123","Go4It!Now","X9%Y8&Z7*","P6!Q5?R4+","Z1@Y2#X3$","M7&N8*O9!","J4%K5^L6&","D1!E2@F3#","A7$B8%C9^","V3*W4+X5=","Q2#R3$S4%","H5^I6&J7*","K8(L9)M0!","N1@O2#P3$","T4%U5^V6&","W7*X8(Y9)","C0!D1@E2#","F3$G4%H5^","I6&J7*K8(","L9)M0!N1@","O2#P3$Q4%","R5^S6&T7*","U8(V9)W0!","X1@Y2#Z3$","A4%B5^C6&"]};let r;if(e==="easy"){const s=(t-1)%n.easy.length;r=n.easy[s]}else if(e==="medium"){const s=(t-11)%n.medium.length;r=n.medium[s]}else{const s=(t-26)%n.hard.length;r=n.hard[s]}return{pattern:r,difficulty:e,difficultyLabel:e.charAt(0).toUpperCase()+e.slice(1)}},textPassages:["The University of California, Berkeley (UC Berkeley, Berkeley, Cal, or California) is a public land-grant research university in Berkeley, California, United States. Founded in 1868 and named after the Anglo-Irish philosopher George Berkeley, it is the state's first land-grant university and is the founding campus of the University of California system.","Berkeley has an enrollment of more than 45,000 students. The university is organized around fifteen schools of study on the same campus, including the College of Chemistry, the College of Engineering, College of Letters and Science, and the Haas School of Business.",'The Berkeley campus encompasses approximately 1,232 acres, though the "central campus" occupies only the low-lying western 178 acres. The campus contains numerous wooded areas, including the Eucalyptus Grove and Strawberry Creek, which runs through the center of campus.',"Oski the Bear (Oski) is the official mascot of the University of California, Berkeley, representing the California Golden Bears. Named after the Oski Yell, he made his debut at a freshman rally in the Greek Theatre on September 25, 1941.","Berkeley faculty, alumni, and researchers have won 111 Nobel laureates, 25 Turing Award winners, and 19 Academy Award winners. The university has produced many notable alumni in various fields including science, politics, business, and entertainment.","The university's athletic teams compete as the California Golden Bears and are members of the Atlantic Coast Conference for most sports. Berkeley teams have won 107 national championships, including 45 NCAA national championships.","Research at Berkeley is conducted within departments, organized research units, and interdisciplinary research centers. Berkeley operates Lawrence Berkeley National Laboratory, manages Los Alamos National Laboratory, and is a founding partner of the Space Sciences Laboratory.","The Berkeley campus offers over 350 degree programs through its 14 colleges and schools. Popular majors include Computer Science, Economics, Political Science, and Business Administration. The student-faculty ratio is 17:1.","Berkeley's libraries contain more than 13 million volumes and maintain special collections including the Mark Twain Papers, the Oral History Center, and the Bancroft Library, which houses the largest collection of materials on California history.","The campus is home to several museums including the Berkeley Art Museum and Pacific Film Archive, the Lawrence Hall of Science, and the UC Botanical Garden. These facilities serve both educational and public outreach purposes.","Notable Berkeley inventions and discoveries include the cyclotron, the atomic bomb, the flu vaccine, and vitamin E. Berkeley researchers discovered 16 chemical elements of the periodic table, more than any other university.","The Free Speech Movement, which took place during the 1964-65 academic year, was a pivotal moment in the history of civil liberties in the United States. It began when students protested a ban on political activities on campus.","Berkeley's Campanile, known as Sather Tower, is the third-tallest clock tower in the world at 307 feet. It was completed in 1914 and is visible for miles, serving as a symbol of the university.","The university operates on a semester system, with fall semester beginning in late August and spring semester beginning in mid-January. Berkeley offers over 5,000 courses each semester across all disciplines.",`Cal Bears have won at least one team national title in 13 different sports. The university's traditional rival is Stanford University, with the annual football game known as "The Big Game" dating back to 1892.`],getTextPassage(t){if(this.seedRandom){const e=Math.floor(this.getRandom()*this.textPassages.length),n=(t-1+e)%this.textPassages.length;return this.textPassages[n]}else{const e=(t-1)%this.textPassages.length;return this.textPassages[e]}}};function pd({taskNum:t,onComplete:e,isPractice:n=!1,currentTaskId:r}){const[s,i]=L.useState(""),[o,l]=L.useState(""),[u,h]=L.useState(null),[p,g]=L.useState(""),[v,k]=L.useState(null),[R,P]=L.useState(""),[O,C]=L.useState(""),[I]=L.useState(Date.now()),[w,b]=L.useState(""),[V,j]=L.useState(!1),[T,_]=L.useState(new Set),m=L.useRef(0);L.useRef(null);const S=(X,te=null,U=null)=>{const N=document.createElement("canvas"),F=N.getContext("2d");N.width=900,N.height=400,F.fillStyle="#fafafa",F.fillRect(0,0,N.width,N.height),F.strokeStyle="#e0e0e0",F.lineWidth=2,F.strokeRect(0,0,N.width,N.height),F.font="24px monospace",F.fillStyle="#333";const H=36,Z=25,ee=N.width-Z*2;return((ge,de)=>{const ce=ge.split(" "),Le=[];let we="";for(let re of ce){const ke=we+(we?" ":"")+re;F.measureText(ke).width>de&&we?(Le.push(we),we=re):we=ke}return we&&Le.push(we),Le})(X,ee).forEach((ge,de)=>{const ce=Z+(de+1)*H;let Le=Z;if(t<=5){const we=ge.split(" ");let re=0;we.forEach(ke=>{const Ge=U&&U.has(re),Re=te&&te.some(_t=>ke.toLowerCase()===_t.toLowerCase());if(Ge){const _t=F.measureText(ke).width;F.fillStyle="yellow",F.fillRect(Le-2,ce-18,_t+4,24)}else if(Re){const _t=F.measureText(ke).width;F.fillStyle="rgba(255, 215, 0, 0.4)",F.fillRect(Le-2,ce-18,_t+4,24)}F.fillStyle="#333",F.fillText(ke,Le,ce),Le+=F.measureText(ke+" ").width,re++})}else for(let we=0;we<ge.length;we++){const re=ge[we],ke=F.measureText(re).width;te&&te.some(Re=>re.toLowerCase()===Re.toLowerCase())&&(F.fillStyle="rgba(255, 215, 0, 0.4)",F.fillRect(Le-1,ce-18,ke+2,24)),F.fillStyle="#333",F.fillText(re,Le,ce),Le+=ke}}),N.toDataURL()};L.useEffect(()=>{g(0),k(null),m.current=0},[t]),L.useEffect(()=>{const X=async(U,N)=>{const F=document.createElement("canvas"),H=F.getContext("2d");F.width=900,F.height=350,H.fillStyle="#fafafa",H.fillRect(0,0,F.width,F.height),H.strokeStyle="#e0e0e0",H.lineWidth=2,H.strokeRect(0,0,F.width,F.height),H.font="24px monospace";const Z=36,ee=20,oe=F.width-ee*2,ge=((de,ce)=>{const Le=de.split(" "),we=[];let re="";for(let ke of Le){const Ge=re+(re?" ":"")+ke;H.measureText(Ge).width>ce&&re?(we.push(re),re=ke):re=Ge}return re&&we.push(re),we})(R,oe);for(let de=0;de<U.length;de++)U[de],ge.forEach((ce,Le)=>{const we=ee+(Le+1)*Z;let re=ee;for(let ke=0;ke<ce.length;ke++){const Ge=ce[ke],Re=H.measureText(Ge).width;U.some($t=>Ge.toLowerCase()===$t.toLowerCase())&&(H.fillStyle="rgba(255, 255, 0, 0.6)",H.fillRect(re-1,we-20,Re+2,26)),H.fillStyle="#333",H.fillText(Ge,re,we),re+=Re}}),b(F.toDataURL()),await new Promise(ce=>setTimeout(ce,300));setTimeout(()=>{g(N.toString())},300)},te=async U=>{const{action:N,highlightWords:F,suggestedCount:H,animate:Z,isMultiLetter:ee,targetLetters:oe}=U.detail||{};if(N==="highlightAndCount"){if(ee&&Array.isArray(oe)){Z&&await X(oe,H);return}if(Array.isArray(F)&&Z){R.split(" ");let Ae=[];for(let ge=0;ge<F.length;ge++){Ae.push(F[ge]);const de=document.createElement("canvas"),ce=de.getContext("2d");de.width=900,de.height=350,ce.fillStyle="#fafafa",ce.fillRect(0,0,de.width,de.height),ce.strokeStyle="#e0e0e0",ce.lineWidth=2,ce.strokeRect(0,0,de.width,de.height),ce.font="24px monospace";const Le=36,we=20,re=de.width-we*2;((Re,_t)=>{const $t=Re.split(" "),Wt=[];let Ht="";for(let qt of $t){const Gt=Ht+(Ht?" ":"")+qt;ce.measureText(Gt).width>_t&&Ht?(Wt.push(Ht),Ht=qt):Ht=Gt}return Ht&&Wt.push(Ht),Wt})(R,re).forEach((Re,_t)=>{const $t=we+(_t+1)*Le;let Wt=we;Re.split(" ").forEach(qt=>{const Gt=ce.measureText(qt).width;Ae.some(kn=>{const lr=qt.replace(/[.,;!?]/g,"").toLowerCase(),$e=kn.replace(/[.,;!?]/g,"").toLowerCase();return lr===$e})&&(ce.fillStyle="rgba(255, 255, 0, 0.5)",ce.fillRect(Wt-2,$t-18,Gt+4,24)),ce.fillStyle="#333",ce.fillText(qt,Wt,$t),Wt+=ce.measureText(qt+" ").width})}),b(de.toDataURL()),await new Promise(Re=>setTimeout(Re,200))}setTimeout(()=>{g(H.toString())},300)}}};return window.addEventListener("aiCountingHelp",te),()=>window.removeEventListener("aiCountingHelp",te)},[R,t]),L.useEffect(()=>{var F;const X=Jn.generateCountingPattern(t),te=Jn.getTextPassage(t);P(te),i(X.target||((F=X.targets)==null?void 0:F.join(", "))),l(X.instruction);let U=0;if(X.type==="word"){const H=new RegExp(`\\b${X.target}\\b`,"gi"),Z=te.match(H);U=Z?Z.length:0}else if(X.type==="letter"){const H=new RegExp(X.target,"gi"),Z=te.match(H);U=Z?Z.length:0}else X.type==="multi-letter"&&X.targets.forEach(H=>{const Z=new RegExp(H,"gi"),ee=te.match(Z);U+=ee?ee.length:0});h(U);const N=S(te,null);b(N)},[t]);const E=async()=>{const X=Date.now()-I,te=parseInt(p,10)||0,U=u??0,N=Math.abs(te-U),F=`g1t${t}`,H=localStorage.getItem(`lastAIHelp_${F}`);if(H){const oe=JSON.parse(H),Ae=Date.now()-oe.timestamp,ge=te===oe.suggestion?"accepted":"modified";await Pe.trackAIHelpResponse(F,oe.type,oe.suggestion,ge,te,Ae),localStorage.removeItem(`lastAIHelp_${F}`)}let Z=0;N===0?Z=2:N<=1?Z=1:Z=0,m.current+=1,await Pe.trackTaskAttempt(F,m.current,!0,X,te,U);const ee=localStorage.getItem("sessionId");if(ee&&!ee.startsWith("offline-"))try{await Gn(un(et,"sessions",ee),{[`taskAccuracies.g1t${t}`]:Z===2?100:Z===1?70:0,[`taskTimes.g1t${t}`]:X,[`taskPoints.g1t${t}`]:Z,lastActivity:en()})}catch(oe){console.error("Error storing accuracy:",oe)}k(Z===2?" Perfect! 2 points earned!":Z===1?` Off by ${N} - 1 point earned!`:` Off by ${N} - 0 points earned.`),setTimeout(()=>{e==null||e(`g1t${t}`,{attempts:m.current,totalTime:X,accuracy:Z===2?100:Z===1?70:0,userAnswer:te,correctAnswer:U,points:Z})},800)},x=Jn.generateCountingPattern(t).difficultyLabel,W=t<=5?"easy":t<=10?"medium":"hard";return d.jsxs("div",{className:"task counting",children:[d.jsxs("h3",{children:["Research Content - Level ",t]}),d.jsx("div",{className:`difficulty-badge ${W}`,children:x}),d.jsxs("p",{className:"instruction",children:[d.jsx("strong",{children:o}),d.jsx("br",{}),d.jsx("span",{className:"hint",children:"(Case-insensitive)"})]}),d.jsxs("div",{className:"text-display text-to-count","data-counting-text":R,children:[d.jsx("div",{className:"count-target","data-pattern":s,style:{display:"none"},children:s}),w?d.jsx("img",{src:w,alt:"Text passage for counting",style:{width:"100%",maxWidth:"900px",height:"auto",maxHeight:"350px",objectFit:"contain",border:"none",userSelect:"none",pointerEvents:"none"},onContextMenu:X=>X.preventDefault(),draggable:!1}):d.jsx("div",{dangerouslySetInnerHTML:{__html:O}})]}),d.jsxs("div",{className:"input-section",children:[d.jsx("label",{children:"Your answer:"}),d.jsx("input",{type:"number",min:"0",max:"999",value:p,onChange:X=>g(X.target.value),placeholder:"Enter count"})]}),d.jsx("button",{onClick:E,className:"submit-btn",style:{display:"block",margin:"20px auto 0"},children:"Submit"}),v&&d.jsx("div",{className:`feedback ${v.includes("2 points")?"correct":v.includes("0 points")?"incorrect":"partial"}`,children:v})]})}function gd({taskNum:t,onComplete:e,isPractice:n=!1,currentTaskId:r}){const[s,i]=L.useState(5),[o,l]=L.useState(0),[u,h]=L.useState(null),[p]=L.useState(Date.now()),[g,v]=L.useState(1),[k,R]=L.useState(!0),[P,O]=L.useState(!1),[C,I]=L.useState(!1),[w,b]=L.useState(!1),[V,j]=L.useState(!1),T=L.useRef(null),_=L.useRef(0);L.useEffect(()=>{if(n)i(3),v(.01),R(!0);else{const U=Jn.generateSliderPattern(t);i(U.target),v(U.step),R(U.showValue)}l(0),h(null),_.current=0},[t,n]),L.useEffect(()=>{const U=N=>{const{action:F,value:H,animate:Z}=N.detail;if(F==="moveSlider")if(I(!0),Z){const ee=parseFloat(o),oe=parseFloat(H),Ae=1e3,ge=30;let de=0;const ce=setInterval(()=>{de++;const Le=de/ge,we=1-Math.pow(1-Le,3),re=ee+(oe-ee)*we;l(parseFloat(re.toFixed(2))),de>=ge&&(clearInterval(ce),I(!1),l(parseFloat(oe.toFixed(2))))},Ae/ge)}else l(parseFloat(H.toFixed(2))),I(!1)};return window.addEventListener("aiSliderHelp",U),()=>window.removeEventListener("aiSliderHelp",U)},[o]);const m=U=>{if(C)return;const N=T.current;if(!N)return;U.preventDefault();const F=N.getBoundingClientRect(),H=o/10,Z=F.left+F.width*H,ee=U.clientX||U.touches&&U.touches[0].clientX;Math.abs(ee-Z)<30&&(b(!0),j(!0))},S=U=>{if(!w||C)return;const N=T.current;if(!N)return;const F=N.getBoundingClientRect(),H=U.clientX||U.touches&&U.touches[0].clientX,ee=Math.max(0,Math.min(1,(H-F.left)/F.width))*10,oe=Math.round(ee/g)*g;l(parseFloat(oe.toFixed(2)))},E=()=>{b(!1)};L.useEffect(()=>{if(w){const U=F=>S(F),N=()=>E();return document.addEventListener("mousemove",U),document.addEventListener("mouseup",N),document.addEventListener("touchmove",U),document.addEventListener("touchend",N),()=>{document.removeEventListener("mousemove",U),document.removeEventListener("mouseup",N),document.removeEventListener("touchmove",U),document.removeEventListener("touchend",N)}}},[w,g,C]);const A=async()=>{const U=Date.now()-p,N=parseFloat(o),F=Math.abs(N-s),H=`g2t${t}`,Z=localStorage.getItem(`lastAIHelp_${H}`);if(Z){const Ae=JSON.parse(Z),ge=Date.now()-Ae.timestamp,de=N===Ae.suggestion?"accepted":"modified";await Pe.trackAIHelpResponse(H,Ae.type,Ae.suggestion,de,N,ge),localStorage.removeItem(`lastAIHelp_${H}`)}let ee=0;F===0?ee=2:F<=1?ee=1:ee=0,_.current+=1,await Pe.trackTaskAttempt(H,_.current,!0,U,N,s);const oe=localStorage.getItem("sessionId");if(oe&&!oe.startsWith("offline-"))try{await Gn(un(et,"sessions",oe),{[`taskDifferences.g2t${t}`]:F,[`taskTimes.g2t${t}`]:U,[`taskPoints.g2t${t}`]:ee,lastActivity:en()})}catch(Ae){console.error("Error storing difference:",Ae)}h(ee===2?" Perfect! 2 points earned!":ee===1?` Off by ${F.toFixed(2)} - 1 point earned!`:` Off by ${F.toFixed(2)} - 0 points earned.`),setTimeout(()=>{e(`g2t${t}`,{attempts:_.current,totalTime:U,accuracy:ee===2?100:ee===1?70:0,userAnswer:N,correctAnswer:s,points:ee})},800)},x=Jn.generateSliderPattern(t),W=x.difficultyLabel,X=x.difficulty,te=()=>{const U=[];for(let N=0;N<=10;N++)U.push(d.jsxs("div",{style:{position:"absolute",left:`${N*10}%`,transform:"translateX(-50%)",textAlign:"center"},children:[d.jsx("div",{style:{width:"2px",height:"12px",background:"#666",margin:"0 auto"}}),d.jsx("div",{style:{fontSize:"12px",color:"#666",marginTop:"2px"},children:N})]},N));return U};return d.jsxs("div",{className:`task slider ${C?"ai-controlled":""}`,children:[d.jsxs("h3",{children:["Material Creation - Level ",t]}),d.jsx("div",{className:`difficulty-badge ${X}`,children:W}),d.jsxs("p",{className:"instruction",children:["Move the slider to:"," ",d.jsx("strong",{className:"target-value","data-target-value":s,children:s}),d.jsx("br",{}),d.jsx("span",{style:{fontSize:"14px",color:"#666",fontStyle:"italic"},children:!V&&"Hold and drag the slider handle to move it"})]}),d.jsxs("div",{className:"slider-container",children:[d.jsxs("div",{className:"range-labels",children:[d.jsx("span",{children:"0"}),d.jsx("span",{children:"10"})]}),d.jsxs("div",{style:{position:"relative",padding:"20px 0 30px 0"},children:[d.jsx("div",{style:{position:"absolute",width:"100%",height:"20px",top:"0"},children:te()}),d.jsx("div",{style:{position:"relative",marginTop:"20px"},children:d.jsx("input",{ref:T,type:"range",min:"0",max:"10",step:g,value:o,onChange:U=>{!w&&!C&&(l(parseFloat(U.target.value)),j(!0))},className:"slider-input",style:{width:"100%",cursor:w?"grabbing":"grab"},onMouseDown:m,onTouchStart:m})})]}),d.jsx("div",{className:"current-value",children:k?parseFloat(o).toFixed(x.precision):"??"})]}),d.jsx("button",{onClick:A,className:"submit-btn",disabled:C,style:{display:"block",margin:"20px auto 0"},children:"Submit"}),u&&d.jsx("div",{className:`feedback ${u.includes("2 points")?"correct":u.includes("0 points")?"incorrect":"partial"}`,children:u})]})}function md({taskNum:t,onComplete:e,isPractice:n=!1,currentTaskId:r}){const[s,i]=L.useState(""),[o,l]=L.useState(""),[u,h]=L.useState(null),[p]=L.useState(Date.now()),[g,v]=L.useState(""),[k,R]=L.useState(!1),P=L.useRef(0),O=V=>{const j=document.createElement("canvas"),T=j.getContext("2d");return j.width=600,j.height=150,T.fillStyle="#f5f5f5",T.fillRect(0,0,j.width,j.height),T.font='bold 40px "Courier New", monospace',T.fillStyle="#333",T.textAlign="center",T.textBaseline="middle",T.fillText(V,j.width/2,j.height/2),j.toDataURL()};L.useEffect(()=>{const j=Jn.generateTypingPattern(t).pattern;i(j);const T=O(j);v(T)},[t]),L.useEffect(()=>{l(""),h(null),P.current=0},[t]),L.useEffect(()=>{const V=j=>{const{action:T,text:_,typeSpeed:m}=j.detail;if(T==="autoType"&&_){R(!0),l("");let S="",E=0;const A=setInterval(()=>{E<_.length?(S+=_[E],l(S),E++):(clearInterval(A),R(!1))},m||50);return()=>clearInterval(A)}};return window.addEventListener("aiTypingHelp",V),()=>window.removeEventListener("aiTypingHelp",V)},[]);const C=async()=>{const V=Date.now()-p,j=`g3t${t}`,T=localStorage.getItem(`lastAIHelp_${j}`);if(T){const A=JSON.parse(T),x=Date.now()-A.timestamp,W=o===A.suggestion?"accepted":"modified";await Pe.trackAIHelpResponse(j,A.type,A.suggestion,W,o,x),localStorage.removeItem(`lastAIHelp_${j}`)}const m=((A,x)=>{const W=A.length,X=x.length,te=Array(W+1).fill(null).map(()=>Array(X+1).fill(0));for(let U=0;U<=W;U++)te[U][0]=U;for(let U=0;U<=X;U++)te[0][U]=U;for(let U=1;U<=W;U++)for(let N=1;N<=X;N++)A[U-1]===x[N-1]?te[U][N]=te[U-1][N-1]:te[U][N]=Math.min(te[U-1][N]+1,te[U][N-1]+1,te[U-1][N-1]+1);return te[W][X]})(o,s);let S=0;m===0?S=2:m===1?S=1:S=0,P.current+=1,await Pe.trackTaskAttempt(j,P.current,!0,V,o,s);const E=localStorage.getItem("sessionId");if(E&&!E.startsWith("offline-"))try{await Gn(un(et,"sessions",E),{[`taskAccuracies.g3t${t}`]:S===2?100:S===1?70:0,[`taskTimes.g3t${t}`]:V,[`taskPoints.g3t${t}`]:S,lastActivity:en()})}catch(A){console.error("Error storing accuracy:",A)}h(S===2?" Perfect! 2 points earned!":S===1?" 1 typo - 1 point earned!":` ${m} errors - 0 points earned.`),setTimeout(()=>{e(`g3t${t}`,{attempts:P.current,totalTime:V,accuracy:S===2?100:S===1?70:0,userAnswer:o,correctAnswer:s,points:S})},800)},I=Jn.generateTypingPattern(t),w=I.difficultyLabel,b=I.difficulty;return d.jsxs("div",{className:"task typing",style:{maxWidth:"100%"},children:[d.jsxs("h3",{children:["Student Engagement - Level ",t]}),d.jsx("div",{className:`difficulty-badge ${b}`,children:w}),d.jsx("p",{className:"instruction",children:"Type this pattern exactly:"}),d.jsxs("div",{className:"pattern-display",children:[d.jsx("div",{className:"typing-pattern","data-typing-pattern":s,style:{display:"none"},children:s}),g?d.jsx("img",{src:g,alt:"Pattern to type",style:{width:"100%",maxWidth:"600px",height:"auto",userSelect:"none",pointerEvents:"none"},onContextMenu:V=>V.preventDefault(),draggable:!1}):d.jsx("span",{className:"pattern-text",children:s})]}),d.jsx("div",{className:"input-section",style:{width:"90%",maxWidth:"900px",margin:"20px auto 0"},children:d.jsx("input",{type:"text",inputMode:"text",autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:!1,value:o,onChange:V=>!k&&l(V.target.value),placeholder:"Type here...",className:"typing-input",disabled:k,style:{backgroundColor:k?"#e3f2fd":"white",transition:"background-color 0.3s",width:"100%",maxWidth:"100%",fontFamily:'"Courier New", monospace',fontSize:"28px",padding:"12px 14px",border:"2px solid #e0e0e0",borderRadius:"8px",boxSizing:"border-box"}})}),d.jsx("button",{onClick:C,className:"submit-btn",disabled:k,style:{display:"block",margin:"20px auto 0"},children:"Submit"}),u&&d.jsx("div",{className:`feedback ${u.includes("2 points")?"correct":u.includes("0 points")?"incorrect":"partial"}`,children:u})]})}function dI({current:t,completed:e,onSwitch:n,limitMode:r,taskPoints:s={},categoryMultipliers:i={},starGoals:o={},categoryPoints:l={},timeRemaining:u=null}){const h=()=>{const w=l.materials||0,b=1+(l.research||0)*.15,V=parseFloat(localStorage.getItem("engagementInterest")||"0")||0;return w*b+V},p=parseFloat(localStorage.getItem("engagementInterest")||"0")||0,g=1+(l.research||0)*.15,v=[];for(let w=1;w<=3;w++)for(let b=1;b<=50;b++){const V=["Research","Materials","Engage"][w-1];v.push({id:`g${w}t${b}`,label:`${V} ${b}`,game:w})}const k=w=>{const b=w.id[1],V=parseInt(w.id.substring(3));if(V===1)return!0;const j=`g${b}t${V-1}`;return e[j]===!0},R={2:v.filter(w=>w.game===2),1:v.filter(w=>w.game===1),3:v.filter(w=>w.game===3)},P={1:"#9C27B0",2:"#4CAF50",3:"#f44336"},O={1:"",2:"",3:""},C={1:"Research",2:"Materials",3:"Engagement"},I={1:"research",2:"materials",3:"engagement"};return d.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"25px",boxShadow:"0 2px 10px rgba(0,0,0,0.1)",marginBottom:"20px"},children:[d.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"20px",marginBottom:"25px"},children:[2,1,3].map(w=>{const b=R[w],V=b.filter(E=>e[E.id]).length,j=I[w],T=V+1,_=w==="1"?(l.research||0)*.15:0,m=w==="3"?(l.engagement||0)*.0015:0,S=_>0||m>0;return d.jsxs("div",{style:{background:`linear-gradient(135deg, ${P[w]}10 0%, ${P[w]}05 100%)`,borderRadius:"12px",border:`2px solid ${P[w]}20`,padding:"20px",position:"relative",overflow:"hidden",boxShadow:S?`0 0 20px ${P[w]}20`:"none",transition:"all 0.3s ease"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"15px"},children:[d.jsx("span",{style:{fontSize:"28px"},children:O[w]}),d.jsxs("div",{style:{flex:1},children:[d.jsx("h3",{style:{margin:0,color:P[w],fontSize:"18px",fontWeight:"bold"},children:C[w]}),d.jsxs("div",{style:{fontSize:"12px",color:"#666",marginTop:"2px"},children:["Level ",Math.min(T,15)]})]}),l&&l[j]>0&&d.jsxs("div",{style:{background:P[w],color:"white",padding:"6px 12px",borderRadius:"20px",fontSize:"14px",fontWeight:"bold"},children:[l[j]," pts"]})]}),w==="1"&&(l.research||0)>0&&d.jsxs("div",{style:{position:"absolute",top:"10px",right:"10px",background:"#fff3cd",color:"#856404",padding:"4px 8px",borderRadius:"12px",fontSize:"11px",fontWeight:"bold",border:"1px solid #ffc107"},children:["+",(l.research*15).toFixed(0),"%"]}),w==="3"&&(l.engagement||0)>0&&d.jsxs("div",{style:{position:"absolute",top:"10px",right:"10px",background:"#fff3cd",color:"#856404",padding:"4px 8px",borderRadius:"12px",fontSize:"11px",fontWeight:"bold",border:"1px solid #ffc107"},children:["+",((l.engagement||0)*.15).toFixed(1),"% interest/task"]}),d.jsx("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap"},children:b.filter(E=>parseInt(E.id.substring(3))<=T).map(E=>{const A=k(E),x=e[E.id],W=t===E.id,X=parseInt(E.id.substring(3)),te=s[E.id]||0;return d.jsxs("button",{disabled:!A||x,onClick:()=>A&&!x&&n(E.id),style:{position:"relative",width:"40px",height:"40px",padding:"0",fontSize:"14px",fontWeight:W?"bold":"500",border:`2px solid ${W?P[w]:x?`${P[w]}40`:"#e0e0e0"}`,borderRadius:"8px",background:W?P[w]:x?`${P[w]}10`:"white",color:W?"white":x?P[w]:"#333",cursor:A&&!x?"pointer":"not-allowed",transition:"all 0.2s ease",opacity:x?.7:1,boxShadow:W?`0 2px 8px ${P[w]}40`:"none"},onMouseEnter:U=>{A&&!W&&!x&&(U.currentTarget.style.transform="translateY(-2px)",U.currentTarget.style.boxShadow=`0 4px 12px ${P[w]}30`)},onMouseLeave:U=>{A&&!W&&!x&&(U.currentTarget.style.transform="translateY(0)",U.currentTarget.style.boxShadow="none")},title:x?`Level ${X} completed (${te} pts)`:A?`Start Level ${X}`:`Complete Level ${X-1} first`,children:[X,x&&d.jsx("span",{style:{position:"absolute",top:"-4px",right:"-4px",background:P[w],color:"white",width:"16px",height:"16px",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"10px",fontWeight:"bold"},children:""}),x&&te>0&&d.jsx("div",{style:{position:"absolute",bottom:"2px",left:"50%",transform:"translateX(-50%)",display:"flex",gap:"2px"},children:[...Array(te)].map((U,N)=>d.jsx("div",{style:{width:"4px",height:"4px",borderRadius:"50%",background:P[w]}},N))})]},E.id)})})]},w)})}),d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"20px",background:"#f8f9fa",borderRadius:"8px",flexWrap:"wrap",gap:"20px"},children:[u!==null&&d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[d.jsx("span",{style:{fontSize:"24px"},children:""}),d.jsxs("div",{children:[d.jsxs("div",{style:{fontSize:"24px",fontWeight:"bold",color:u<60?"#f44336":"#333"},children:[Math.floor(u/60),":",(u%60).toString().padStart(2,"0")]}),u<180&&u>0&&d.jsx("div",{style:{fontSize:"11px",color:"#ff9800"},children:"Hurry up!"})]})]}),d.jsxs("div",{style:{textAlign:"center"},children:[d.jsx("div",{style:{fontSize:"12px",color:"#666",marginBottom:"2px"},children:"Tasks Completed"}),d.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#333"},children:Object.keys(e).length})]}),d.jsxs("div",{style:{textAlign:"center"},children:[d.jsx("div",{style:{fontSize:"12px",color:"#666",marginBottom:"2px"},children:"Student Learning"}),d.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#2196F3"},children:Math.round(h())}),d.jsxs("div",{style:{fontSize:"10px",color:"#999"},children:["Multiplier = ",g.toFixed(2),", Interest ="," ",p.toFixed(2)]})]}),t&&d.jsxs("div",{style:{padding:"8px 16px",background:t.startsWith("g1")?"#9C27B0":t.startsWith("g2")?"#4CAF50":"#f44336",color:"white",borderRadius:"20px",fontSize:"14px",fontWeight:"bold"},children:["Current:"," ",t.replace("g1t","Research ").replace("g2t","Materials ").replace("g3t","Engage ")]})]})]})}function hI({practiceCompleted:t={},onPracticeComplete:e,onStartMainGame:n,onSelectPractice:r,isAdmin:s=!1}){const[i,o]=L.useState(null),l=(v,k)=>{if(k&&k.points===2){typeof e=="function"&&e(v,k);const R=document.createElement("div");R.className="notification-enter",R.style.cssText="position: fixed; bottom: 20px; left: 20px; background: #4CAF50; color: white; padding: 15px 20px; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); z-index: 10000; max-width: 400px;",R.textContent="Perfect! Practice task completed. Returning to menu...",document.body.appendChild(R),setTimeout(()=>{o(null),document.body.contains(R)&&document.body.removeChild(R)},1500)}else{const R=(k==null?void 0:k.points)||0,P=document.createElement("div");P.className="notification-enter",P.style.cssText="position: fixed; bottom: 20px; left: 20px; background: #ff9800; color: white; padding: 15px 20px; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); z-index: 10000; max-width: 400px;",P.textContent=`Practice requires 100% accuracy. You scored ${R===1?"50%":"0%"}. Try again!`,document.body.appendChild(P),setTimeout(()=>{document.body.contains(P)&&document.body.removeChild(P)},3e3)}},u=t.g2t1&&t.g1t1&&t.g3t1,h=()=>d.jsxs("div",{className:"practice-menu",children:[d.jsxs("h2",{children:["Practice Mode ",!s&&"(Required)"]}),!s&&d.jsxs("div",{style:{background:"linear-gradient(135deg, #fff3cd 0%, #ffebee 100%)",borderRadius:"12px",padding:"16px",marginBottom:"25px",border:"2px solid #f57c00",boxShadow:"0 4px 6px rgba(245, 124, 0, 0.1)",textAlign:"center"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",marginBottom:"8px"},children:[d.jsx("span",{style:{fontSize:"20px"},children:""}),d.jsx("strong",{style:{color:"#e65100",fontSize:"18px"},children:"100% PERFECT ACCURACY REQUIRED"})]}),d.jsxs("div",{style:{color:"#e65100",fontSize:"14px"},children:["You must score 2/2 points (exact answer) on all three practice tasks to proceed.",d.jsx("br",{}),d.jsx("strong",{children:"No partial credit in practice mode!"})]}),d.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"center",marginTop:"12px"},children:[d.jsxs("span",{style:{padding:"4px 12px",background:t.g2t1?"#e8f5e9":"white",borderRadius:"20px",fontSize:"13px",color:t.g2t1?"#4CAF50":"#f57c00",fontWeight:"600",border:`1px solid ${t.g2t1?"#4CAF50":"#ffb74d"}`},children:["Materials ",t.g2t1?"":"Required"]}),d.jsxs("span",{style:{padding:"4px 12px",background:t.g1t1?"#e8f5e9":"white",borderRadius:"20px",fontSize:"13px",color:t.g1t1?"#4CAF50":"#f57c00",fontWeight:"600",border:`1px solid ${t.g1t1?"#4CAF50":"#ffb74d"}`},children:["Research ",t.g1t1?"":"Required"]}),d.jsxs("span",{style:{padding:"4px 12px",background:t.g3t1?"#e8f5e9":"white",borderRadius:"20px",fontSize:"13px",color:t.g3t1?"#4CAF50":"#f57c00",fontWeight:"600",border:`1px solid ${t.g3t1?"#4CAF50":"#ffb74d"}`},children:["Engagement ",t.g3t1?"":"Required"]})]})]}),d.jsx("p",{className:"practice-hint",style:{textAlign:"center",fontSize:"16px",color:"#666",marginBottom:"30px"},children:"Try each task type before starting the main challenge. No time pressure!"}),d.jsxs("div",{className:"practice-cards",children:[d.jsxs("div",{className:"practice-card materials",children:[d.jsx("h3",{children:" Materials"}),d.jsx("p",{children:"Hold and drag slider to match target values"}),d.jsx("p",{style:{fontSize:"13px",color:"#666",marginTop:"10px"},children:"Base points - directly added to score"}),d.jsx("div",{className:"practice-buttons",children:d.jsx("button",{onClick:()=>{o("g2t1"),r&&r("g2t1")},className:t.g2t1?"completed":"",disabled:!1,children:t.g2t1?" Completed":"Try Materials"})})]}),d.jsxs("div",{className:"practice-card research",children:[d.jsx("h3",{children:" Research"}),d.jsx("p",{children:"Count words or letters in text passages"}),d.jsx("p",{style:{fontSize:"13px",color:"#666",marginTop:"10px"},children:"Worth 15% multiplier per point in main game"}),d.jsx("div",{className:"practice-buttons",children:d.jsx("button",{onClick:()=>{o("g1t1"),r&&r("g1t1")},className:t.g1t1?"completed":"",disabled:!1,children:t.g1t1?" Completed":"Try Research"})})]}),d.jsxs("div",{className:"practice-card engagement",children:[d.jsx("h3",{children:" Engagement"}),d.jsx("p",{children:"Type patterns exactly as shown"}),d.jsx("p",{style:{fontSize:"13px",color:"#666",marginTop:"10px"},children:"Worth 0.15% compound interest per point"}),d.jsx("div",{className:"practice-buttons",children:d.jsx("button",{onClick:()=>{o("g3t1"),r&&r("g3t1")},className:t.g3t1?"completed":"",disabled:!1,children:t.g3t1?" Completed":"Try Engagement"})})]})]}),d.jsxs("div",{style:{marginTop:"25px",padding:"15px",background:"#f5f5f5",borderRadius:"8px",textAlign:"center"},children:[d.jsx("h4",{style:{margin:"0 0 10px 0",color:"#333",fontSize:"16px"},children:"Practice Progress:"}),d.jsxs("div",{style:{display:"flex",gap:"10px",justifyContent:"center"},children:[d.jsxs("div",{style:{padding:"8px 15px",background:t.g2t1?"#4CAF50":"#e0e0e0",color:t.g2t1?"white":"#666",borderRadius:"20px",fontSize:"14px"},children:["Materials ",t.g2t1&&""]}),d.jsxs("div",{style:{padding:"8px 15px",background:t.g1t1?"#9C27B0":"#e0e0e0",color:t.g1t1?"white":"#666",borderRadius:"20px",fontSize:"14px"},children:["Research ",t.g1t1&&""]}),d.jsxs("div",{style:{padding:"8px 15px",background:t.g3t1?"#f44336":"#e0e0e0",color:t.g3t1?"white":"#666",borderRadius:"20px",fontSize:"14px"},children:["Engagement ",t.g3t1&&""]})]}),d.jsxs("div",{style:{marginTop:"12px",fontSize:"13px",color:"#666"},children:[d.jsx("strong",{children:"100% accuracy required"})," to complete each practice task"]})]}),d.jsx("div",{style:{textAlign:"center",marginTop:"30px"},children:d.jsx("button",{className:"start-main-game-btn",onClick:n,style:{opacity:!s&&!u?.5:1,cursor:!s&&!u?"not-allowed":"pointer"},disabled:!s&&!u,children:s?"Start Main Game (Admin)":u?"Start Main Game - You're Ready! ":"Complete Practice First"})})]});if(!i)return h();const p=i[1],g=1;return d.jsxs("div",{className:"practice-container",children:[d.jsx("button",{className:"back-to-menu",onClick:()=>o(null),children:" Back to Practice Menu"}),d.jsxs("div",{style:{textAlign:"center",padding:"10px",background:"#fff3cd",borderRadius:"6px",margin:"10px 0",fontSize:"14px",color:"#856404"},children:[d.jsx("strong",{children:"Practice Mode:"})," 100% accuracy required. Will auto-return after completion."]}),d.jsxs("div",{className:"practice-task-wrapper",children:[p==="1"&&d.jsx(pd,{taskNum:g,onComplete:l,isPractice:!0,currentTaskId:i}),p==="2"&&d.jsx(gd,{taskNum:g,onComplete:l,isPractice:!0,currentTaskId:i}),p==="3"&&d.jsx(md,{taskNum:g,onComplete:l,isPractice:!0,currentTaskId:i})]})]})}class fI{constructor(){this.totalAIUsage=0,this.usageCount={materials:0,research:0,engagement:0},this.taskUsageCount={}}getUniversalAttemptNumber(){return this.totalAIUsage}shouldAIBeCorrect(e){let n;return e===1||e===2||e===4||e===5?n=!0:e===3?n=!1:n=Math.random()<.75,n}getTaskUsageCount(e){return this.taskUsageCount[e]||(this.taskUsageCount[e]=0),this.taskUsageCount[e]}incrementTaskUsage(e,n){this.totalAIUsage++,this.usageCount[n]++,this.taskUsageCount[e]||(this.taskUsageCount[e]=0),this.taskUsageCount[e]++}helpWithSlider(e,n){this.incrementTaskUsage(n,"materials");const r=this.getUniversalAttemptNumber();let s;if(this.shouldAIBeCorrect(r))s=e;else if(r===3){const i=Math.random()<.5?-1:1;s=Math.max(0,Math.min(10,e+i))}else if(Math.random()<.5){const i=Math.random()<.5?-1:1;s=Math.max(0,Math.min(10,e+i))}else{const i=(Math.random()<.5?-1:1)*(2+Math.random()*2);s=Math.max(0,Math.min(10,e+i))}return{action:"moveSlider",value:s,animate:!0}}helpWithCounting(e,n,r){this.incrementTaskUsage(r,"research");const s=this.getUniversalAttemptNumber(),i=this.shouldAIBeCorrect(s);return n.length===1||n.includes(" and ")||n.includes(",")?this.helpWithLetterCounting(e,n,s,i):this.helpWithWordCounting(e,n,s,i)}helpWithLetterCounting(e,n,r,s){let i=[];n.includes(" and ")||n.includes(",")?i=n.match(/[a-z]/gi)||[]:i=[n];let o=0;i.forEach(h=>{const p=new RegExp(h,"gi"),g=e.match(p);o+=g?g.length:0});let l=o,u=[...i];if(!s){r===3||Math.random()<.5?l=o+1:l=o+Math.floor(Math.random()*3)+2,l=Math.max(0,l);const p="abcdefghijklmnopqrstuvwxyz".split("").filter(v=>!i.includes(v.toLowerCase())),g=Math.floor(Math.random()*2)+1;for(let v=0;v<g&&p.length>0;v++){const k=Math.floor(Math.random()*p.length);u.push(p[k]),p.splice(k,1)}}return{action:"highlightAndCount",highlightWords:[],suggestedCount:l,animate:!0,isMultiLetter:!0,targetLetters:u}}helpWithWordCounting(e,n,r,s){const i=e.split(/\s+/),o=[];let l=0,u=0;if(i.forEach(h=>{h.replace(/[.,;!?]/g,"").toLowerCase()===n.toLowerCase()&&u++}),s)i.forEach(h=>{h.replace(/[.,;!?]/g,"").toLowerCase()===n.toLowerCase()&&(o.push(h),l++)});else if(r===3){l=u+1,l=Math.max(0,l),i.forEach(p=>{p.replace(/[.,;!?]/g,"").toLowerCase()===n.toLowerCase()&&o.push(p)});const h=i.filter(p=>p.replace(/[.,;!?]/g,"").toLowerCase()!==n.toLowerCase());if(h.length>0&&o.length<l){const p=h[Math.floor(Math.random()*h.length)];o.push(p)}}else{Math.random()<.5?l=u+1:l=u+Math.floor(Math.random()*3)+2,l=Math.max(0,l),i.forEach(p=>{p.replace(/[.,;!?]/g,"").toLowerCase()===n.toLowerCase()&&o.push(p)});const h=i.filter(p=>p.replace(/[.,;!?]/g,"").toLowerCase()!==n.toLowerCase());for(;o.length<l&&h.length>0;){const p=Math.floor(Math.random()*h.length),g=h[p];o.includes(g)||o.push(g),h.splice(p,1)}}return{action:"highlightAndCount",highlightWords:o,suggestedCount:l,animate:!0}}helpWithTyping(e,n){this.incrementTaskUsage(n,"engagement");const r=this.getUniversalAttemptNumber();let s=e;const i={0:["o","O"],o:["0"],O:["0"],1:["l","I","i"],l:["1","I","i"],I:["1","l","i"],i:["1","l","I"],e:["3"],3:["e"],a:["@"],"@":["a"],s:["5","$"],S:["5","$"],5:["s","S"],$:["s","S"],g:["9"],9:["g"],b:["6"],6:["b"],z:["2"],2:["z"],B:["8"],8:["B"]},o=l=>{const u=l.split(""),h=u.map((p,g)=>i[p]?g:-1).filter(p=>p!==-1);if(h.length>0){const p=h[Math.floor(Math.random()*h.length)],g=u[p],v=i[g];v&&v.length>0&&(u[p]=v[Math.floor(Math.random()*v.length)])}else{const p=["transpose","duplicate","missing"],g=p[Math.floor(Math.random()*p.length)],v=Math.floor(Math.random()*u.length);switch(g){case"transpose":v<u.length-1&&([u[v],u[v+1]]=[u[v+1],u[v]]);break;case"duplicate":u.splice(v,0,u[v]);break;case"missing":u.splice(v,1);break}}return u.join("")};if(this.shouldAIBeCorrect(r))s=e;else if(r===3)s=o(e);else if(Math.random()<.5)s=o(e);else{let l=e;const u=Math.floor(Math.random()*3)+2;for(let h=0;h<u;h++)l=o(l);s=l}return{action:"autoType",text:s,typeSpeed:50,perfect:this.shouldAIBeCorrect(r)}}}const on=new fI;function pI({bonusPrompts:t=0,currentTask:e="",categoryPoints:n=null,timeRemaining:r=null,calculateStudentLearning:s=()=>0}){const[i,o]=L.useState(!0),[l,u]=L.useState(0);L.useEffect(()=>{const E=JSON.parse(sessionStorage.getItem("gameConfig")||"{}");o(E.hasAI!==!1)},[]);const[h,p]=L.useState([{sender:"bot",text:i?"Hello! I'm your AI teaching assistant. Click the help buttons below for task assistance!":"Hello! This is the chat interface. AI assistance is not available for this session."}]),[g,v]=L.useState(""),[k,R]=L.useState(!1),[P,O]=L.useState({materials:0,research:0,engagement:0}),C=L.useRef(null),I=()=>{var E;(E=C.current)==null||E.scrollIntoView({behavior:"smooth"})};L.useEffect(()=>{I()},[h]);const w=()=>e?e.startsWith("g1")?"research":e.startsWith("g2")?"materials":e.startsWith("g3")?"engagement":null:null,b=(E=null)=>{const A=E||w();if(!A){p(W=>[...W,{sender:"bot",text:"Please start a task first, then I can help you!"}]);return}const x=Date.now();if(x-P[A]<3e3){p(W=>[...W,{sender:"bot",text:"Please wait a moment before requesting help again!"}]);return}switch(O(W=>({...W,[A]:x})),A){case"materials":V();break;case"research":j();break;case"engagement":_();break;default:p(W=>[...W,{sender:"bot",text:"I'm not sure which task you're on. Please try again!"}])}},V=()=>{var X,te;const E=((X=document.querySelector("[data-target-value]"))==null?void 0:X.getAttribute("data-target-value"))||((te=document.querySelector(".target-value"))==null?void 0:te.textContent)||5,A=on.helpWithSlider(parseFloat(E),e),x=on.getUniversalAttemptNumber(),W=on.shouldAIBeCorrect(x);Pe.trackAITaskHelp(e,"slider",A.value,W,x),localStorage.setItem(`lastAIHelp_${e}`,JSON.stringify({type:"slider",suggestion:A.value,timestamp:Date.now(),wasCorrect:W})),window.dispatchEvent(new CustomEvent("aiSliderHelp",{detail:A})),u(on.totalAIUsage),p(U=>[...U,{sender:"bot",text:` Helping with materials...
Suggested value: ${A.value.toFixed(2)}`}])},j=()=>{var x;const E=document.querySelector(".text-to-count"),A=document.querySelector(".count-target");if(E&&A){const W=E.getAttribute("data-counting-text")||"";let X=((x=A.getAttribute("data-pattern"))==null?void 0:x.replace(/['"]/g,"").trim())||"";const te=on.helpWithCounting(W,X,e),U=te.suggestedCount;window.dispatchEvent(new CustomEvent("aiCountingHelp",{detail:te}));const N=on.getUniversalAttemptNumber(),F=on.shouldAIBeCorrect(N);Pe.trackAITaskHelp(e,"counting",U,F,N),localStorage.setItem(`lastAIHelp_${e}`,JSON.stringify({type:"counting",suggestion:U,timestamp:Date.now(),wasCorrect:F,highlightedWords:te.highlightWords||[],targetLetters:te.targetLetters||[]})),u(on.totalAIUsage);const H=te.isMultiLetter?"letters/characters":"words";p(Z=>[...Z,{sender:"bot",text:` Helping with research...
Found ${U} ${H}`}])}},T=()=>{const E=[" Strategic Order: Start with Research tasks for the 15% multiplier per point, then do Engagement for compound interest that builds over time, finally complete Materials for maximum base points!"," Pro Strategy: Research  Engagement  Materials. Build your multipliers first, then let interest compound, and maximize base points at the end!"," Optimal Workflow: 1) Research multiplies everything (1.15 per point), 2) Engagement adds 0.15% interest after EVERY task, 3) Materials are pure points - save them for last when multipliers are active!"," Best Practice: Complete Research early (multiplier effect), then Engagement (compounds over time), finally Materials. Each Research point makes ALL your Materials worth 15% more!"," Planning Tip: Think of it as investing - Research is your growth multiplier, Engagement is compound interest, Materials are your principal. Build multipliers before collecting points!"],A=E[Math.floor(Math.random()*E.length)];p(x=>[...x,{sender:"bot",text:A}]),Pe.trackUserAction("planning_help_requested",{response:A,currentTask:e,timestamp:Date.now()})},_=()=>{const E=document.querySelector("[data-typing-pattern]");if(E){const A=E.getAttribute("data-typing-pattern");if(A){const x=on.helpWithTyping(A,e),W=on.getUniversalAttemptNumber(),X=x.perfect;Pe.trackAITaskHelp(e,"typing",x.text,X,W),localStorage.setItem(`lastAIHelp_${e}`,JSON.stringify({type:"typing",suggestion:x.text,timestamp:Date.now(),wasCorrect:X,originalPattern:A})),window.dispatchEvent(new CustomEvent("aiTypingHelp",{detail:x})),u(on.totalAIUsage),p(te=>[...te,{sender:"bot",text:` Helping with engagement...
Typing: "${x.text.substring(0,30)}${x.text.length>30?"...":""}"`}])}}else p(A=>[...A,{sender:"bot",text:"Please navigate to the engagement tab first!"}])},m=()=>{if(!g.trim())return;if(!i){p(x=>[...x,{sender:"user",text:g},{sender:"bot",text:"AI assistance is not available for this session."}]),v("");return}const E=g.toLowerCase().trim(),A=g;p(x=>[...x,{sender:"user",text:g}]),v(""),R(!0),setTimeout(()=>{let x="",W="general";if(E.includes("help"))if(W="help_request",E.includes("material")||E.includes("slider")){b("materials"),R(!1);return}else if(E.includes("research")||E.includes("count")){b("research"),R(!1);return}else if(E.includes("engagement")||E.includes("typ")){b("engagement"),R(!1);return}else x="Click the help buttons below for task assistance!";else if(E.includes("strategy")||E.includes("plan")||E.includes("order")){W="strategy";const X=[" Strategic Order: Start with Research tasks for the 15% multiplier per point, then do Engagement for compound interest that builds over time, finally complete Materials for maximum base points!"," Pro Strategy: Research  Engagement  Materials. Build your multipliers first, then let interest compound, and maximize base points at the end!"," Optimal Workflow: 1) Research multiplies everything (1.15 per point), 2) Engagement adds 0.15% interest after EVERY task, 3) Materials are pure points - save them for last when multipliers are active!"," Best Practice: Complete Research early (multiplier effect), then Engagement (compounds over time), finally Materials. Each Research point makes ALL your Materials worth 15% more!"," Planning Tip: Think of it as investing - Research is your growth multiplier, Engagement is compound interest, Materials are your principal. Build multipliers before collecting points!"];x=X[Math.floor(Math.random()*X.length)]}else if(E.includes("tip")||E.includes("advice"))W="advice",x="Strategic tip: Do Research tasks first for the multiplier effect, then Materials for base points, finally Engagement for compound interest!";else{const X=["Keep pushing! You're doing great!","Remember: Materials  Research  Engagement = Success!","Focus on accuracy for those 2-point rewards!","The checkpoint at minute 10 can give huge bonuses!","Try the help buttons below for task assistance!"];x=X[Math.floor(Math.random()*X.length)]}Pe.trackUserAction("chat_message",{query:A,queryType:W,response:x,currentTask:e,categoryPoints:n,studentLearning:s(),aiUsageCount:on.totalAIUsage}),p(X=>[...X,{sender:"bot",text:x}]),R(!1)},800)},S=w();return d.jsxs("div",{className:"chat-container-sidebar",style:{height:"100%",display:"flex",flexDirection:"column"},children:[d.jsxs("div",{className:"chat-header",children:[d.jsx("h3",{children:i?"AI Teaching Assistant":"Chat Interface"}),d.jsx("div",{style:{fontSize:"11px",color:"#888",marginTop:"2px"},children:i?"Unlimited help (reliability varies by task)":"AI assistance disabled for this session"}),d.jsxs("div",{style:{marginTop:"10px",padding:"8px",background:"#e3f2fd",borderRadius:"6px",border:"1px solid #2196F3"},children:[d.jsxs("div",{style:{fontSize:"12px",color:"#1976d2",fontWeight:"bold"},children:["Student Learning: ",Math.round(s())," pts"]}),d.jsxs("div",{style:{fontSize:"10px",color:"#666",marginTop:"2px"},children:[n.materials||0," "," ",(1+(n.research||0)*.15).toFixed(2)," + Interest"]})]})]}),d.jsxs("div",{className:"messages-sidebar",children:[h.map((E,A)=>d.jsxs("div",{className:`message ${E.sender}`,children:[d.jsxs("div",{className:"message-sender",children:[E.sender==="user"?"You":i?"AI":"System",":"]}),d.jsx("div",{className:"message-text",children:E.text})]},A)),k&&i&&d.jsxs("div",{className:"message bot",children:[d.jsx("div",{className:"message-sender",children:"AI:"}),d.jsx("div",{className:"message-text typing",children:"..."})]}),d.jsx("div",{ref:C})]}),d.jsxs("div",{className:"chat-input-sidebar",children:[d.jsx("input",{type:"text",placeholder:i?"Ask about strategy and tips here...":"Chat disabled - no AI available",value:g,onChange:E=>v(E.target.value),onKeyPress:E=>E.key==="Enter"&&m(),disabled:!i}),d.jsx("button",{onClick:m,disabled:!g.trim()||!i,children:"Send"})]}),i&&d.jsxs("div",{style:{padding:"15px",borderTop:"1px solid #e0e0e0",background:"#f8f9fa"},children:[d.jsxs("div",{style:{fontSize:"11px",color:"#666",textAlign:"center",marginBottom:"8px",padding:"4px",background:"white",borderRadius:"4px"},children:["AI Usage: ",l," total attempts"]}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"8px",marginBottom:"10px"},children:[d.jsxs("div",{style:{gridColumn:"1 / -1",display:"grid",gridTemplateColumns:"1fr 1fr",gap:"8px"},children:[d.jsxs("button",{onClick:()=>b(),disabled:!S,style:{padding:"12px",background:S?"#2196F3":"#ccc",color:"white",border:"none",borderRadius:"8px",cursor:S?"pointer":"not-allowed",fontWeight:"bold",fontSize:"14px",transition:"all 0.2s",display:"flex",alignItems:"center",justifyContent:"center",gap:"6px"},children:[d.jsx("span",{style:{fontSize:"18px"},children:""}),S?"Help Task":"Start task first"]}),d.jsxs("button",{onClick:T,style:{padding:"12px",background:"#FF9800",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontWeight:"bold",fontSize:"14px",transition:"all 0.2s",display:"flex",alignItems:"center",justifyContent:"center",gap:"6px"},children:[d.jsx("span",{style:{fontSize:"18px"},children:""}),"Help Plan"]})]}),d.jsx("button",{onClick:()=>b("research"),disabled:!e.startsWith("g1"),style:{padding:"10px",background:e.startsWith("g1")?"#9C27B0":"#e0e0e0",color:e.startsWith("g1")?"white":"#999",border:"none",borderRadius:"6px",cursor:e.startsWith("g1")?"pointer":"not-allowed",fontWeight:"bold",fontSize:"12px"},children:" Research"}),d.jsx("button",{onClick:()=>b("materials"),disabled:!e.startsWith("g2"),style:{padding:"10px",background:e.startsWith("g2")?"#4CAF50":"#e0e0e0",color:e.startsWith("g2")?"white":"#999",border:"none",borderRadius:"6px",cursor:e.startsWith("g2")?"pointer":"not-allowed",fontWeight:"bold",fontSize:"12px"},children:" Materials"}),d.jsx("button",{onClick:()=>b("engagement"),disabled:!e.startsWith("g3"),style:{padding:"10px",background:e.startsWith("g3")?"#f44336":"#e0e0e0",color:e.startsWith("g3")?"white":"#999",border:"none",borderRadius:"6px",cursor:e.startsWith("g3")?"pointer":"not-allowed",fontWeight:"bold",fontSize:"12px"},children:" Engage"})]}),d.jsx("div",{style:{fontSize:"11px",color:"#666",textAlign:"center",marginBottom:"8px",padding:"4px",background:"white",borderRadius:"4px"},children:S?d.jsx("span",{style:{color:"#4CAF50"},children:" AI ready to help"}):d.jsx("span",{style:{color:"#999"},children:" Navigate to a task to enable AI help"})})]}),!i&&d.jsxs("div",{style:{padding:"15px",borderTop:"1px solid #e0e0e0",background:"#f5f5f5",textAlign:"center",color:"#666",fontSize:"14px"},children:[d.jsx("div",{style:{marginBottom:"5px"},children:" No AI Assistant"}),d.jsx("div",{style:{fontSize:"12px"},children:"Complete tasks using your own judgment"})]})]})}const Rl={generateCode(){const t=Date.now().toString(36),e=Math.random().toString(36).substring(2,8);return`${t}-${e}`.toUpperCase()},async createCode(t={}){return{success:!0,code:this.generateCode(),data:t}},async markCodeAsUsed(t,e){if(!t)return{success:!1,error:"No code provided"};try{const n={code:t,status:"used",usedAt:en(),sessionId:e,createdAt:en()};return await ZT(un(et,"accessCodes",t),n),{success:!0}}catch(n){return console.error("Error marking code as used:",n),{success:!1,error:n.message}}},async checkCodeUsage(t){if(!t)return{used:!1};try{const e=await JT(un(et,"accessCodes",t));if(e.exists()){const n=e.data();return{used:n.status==="used",sessionId:n.sessionId,usedAt:n.usedAt}}return{used:!1}}catch(e){return console.error("Error checking code usage:",e),{used:!1,error:e.message}}},getCodeFromURL(){const t=new URLSearchParams(window.location.search);return t.get("code")||t.get("c")||null},async verifyQualtricsCode(t){return{valid:!1,reason:"Qualtrics codes not yet supported"}}};function gI({onLoginSuccess:t}){const[e,n]=L.useState(""),[r,s]=L.useState(!1),[i,o]=L.useState(""),[l,u]=L.useState(!1),h={legacy8:/^\d{8}$/,legacy10:/^\d{10}$/,standard:/^30\d{8}$/},p={"ADMIN-MASTER":{role:"master_admin",name:"Master Administrator",hasAI:!1,isMasterInterface:!0},"ADMIN-REGULAR":{role:"admin",semesterDuration:72e4,name:"Admin Regular Mode",hasAI:!0,checkpointSemester2:!0},"ADMIN-FAST":{role:"admin",semesterDuration:12e4,name:"Admin Fast Mode",hasAI:!0,checkpointSemester2:!0},"ADMIN-1-CP":{role:"admin",semesterDuration:12e4,name:"Admin Section 1 WITH Checkpoint",hasAI:!1,checkpointSemester2:!0},"ADMIN-1-NCP":{role:"admin",semesterDuration:12e4,name:"Admin Section 1 NO Checkpoint",hasAI:!1,checkpointSemester2:!1},"ADMIN-2-CP":{role:"admin",semesterDuration:12e4,name:"Admin Section 2 WITH Checkpoint",hasAI:!0,checkpointSemester2:!0},"ADMIN-2-NCP":{role:"admin",semesterDuration:12e4,name:"Admin Section 2 NO Checkpoint",hasAI:!0,checkpointSemester2:!1}},g=["3040748714","3040729812","3040859968","3040852909","3040869211","3040849958","3039838870","15177695","3040849997","3039845630","3040682661","26416809","3039850622","3040869510","3031977170","3040806629","3040848528","3039840443","3040848749","3040849893","3039850830","3039850713"],v=["3040850023","22900589","3039850570","3040882302","3040815651","3040701758","3040852077","3036343361","3040869458","3040705047","3040702343","3039842887","3040848593","3040702603","3039840222","3039840209","3040861190","18565110","3040869302","3040814338","3039754031"],k=["3040705476","3040697715","3039753992","3040729513","3040681595","3040850010","3032682772","3039842484","3040869445","3040814455","3039840781","3040696831","3040705125","3034184066","3039843004","3039842835","3040860072","3040871018","3039839026","3040814429","3040869094","3040748064","3040875945","3040701589","3040682193","3040729422","3040836165","21798975","3038626424","3039753017","3039840287","3040806382"],R=["25958106","3040814351","3040848697","3040684039","3040869289","22971551","3040837218","3040864570","3040705099","3034288430","3040848541","3040864531","3040869237","3032342054","3040682479","3039840170","3032397447","3039850856","3039840118","3040729552","3040683181","3040861073","3031968434","3040882575","3035320237","3040823815","3039842575","24261697","23420611","3032000089","3040882341"],P=[...g,...v,...k,...R],O=w=>{const b=g.includes(w)||v.includes(w),V=k.includes(w)||R.includes(w),j=g.includes(w)||k.includes(w);return{section:b?"01A":V?"02A":"unknown",hasAI:V,checkpointSemester2:j,displayName:`Student ${w} (${b?"01A":"02A"}-${j?"CP":"NCP"})`}},C=w=>{if(p[w])return{valid:!0,type:"master",data:p[w]};for(const[b,V]of Object.entries(h))if(V.test(w)){if(P.includes(w)){const j=O(w);return{valid:!0,type:"student",format:b,condition:j}}return{valid:!1,error:"Student ID not found in registry"}}return{valid:!1,error:"Invalid ID format. Must be 8-10 digit Student ID"}},I=async w=>{if(w.preventDefault(),!e.trim()){o("Please enter your Student ID");return}s(!0),o("");try{const b=C(e.trim());if(!b.valid){o(b.error||"Invalid Student ID"),s(!1);return}let V={timestamp:new Date().toISOString()};if(b.type==="master"){if(V={...V,studentIdentifier:e,role:b.data.role,semesterDuration:b.data.semesterDuration,displayName:b.data.name,hasAI:b.data.hasAI,checkpointSemester2:b.data.checkpointSemester2,isMasterCode:!0,isMasterInterface:b.data.isMasterInterface||!1},b.data.isMasterInterface){sessionStorage.setItem("gameConfig",JSON.stringify({role:"master_admin",displayName:b.data.name,section:"master_admin",hasAI:!0,checkpointSemester2:!0})),window.location.href=`${window.location.origin}?master=true`;return}}else{const T=b.condition;V={...V,studentIdentifier:e,role:"student",semesterDuration:72e4,displayName:T.displayName,section:T.section,hasAI:T.hasAI,checkpointSemester2:T.checkpointSemester2,isMasterCode:!1}}const j=await Rl.createCode(V);j.success?(sessionStorage.setItem("gameConfig",JSON.stringify({semesterDuration:V.semesterDuration,role:V.role,studentId:e,displayName:V.displayName,section:V.section,hasAI:V.hasAI,checkpointSemester2:V.checkpointSemester2})),window.location.href=`${window.location.origin}?code=${j.code}`):o("Failed to generate access code. Please try again.")}catch(b){console.error("Login error:",b),o("System error. Please try again.")}finally{s(!1)}};return d.jsxs("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"#f5f5f5",padding:"20px"},children:[d.jsxs("div",{style:{background:"white",padding:"48px",borderRadius:"16px",boxShadow:"0 20px 40px rgba(0,0,0,0.15)",maxWidth:"480px",width:"100%"},children:[d.jsxs("div",{style:{textAlign:"center",marginBottom:"40px"},children:[d.jsxs("h1",{style:{fontSize:"32px",fontWeight:"700",color:"#1a202c",marginBottom:"8px",lineHeight:"1.2"},children:["Scheduling Challenge:",d.jsx("br",{}),"Can you beat Park?"]}),d.jsx("p",{style:{fontSize:"16px",color:"#718096",marginTop:"12px"},children:"Enter your Student ID to access the game"})]}),d.jsxs("form",{onSubmit:I,children:[d.jsxs("div",{style:{marginBottom:"24px"},children:[d.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#2d3748",fontWeight:"600",fontSize:"14px",textTransform:"uppercase",letterSpacing:"0.025em"},children:"Berkeley Student ID:"}),d.jsx("input",{type:"text",value:e,onChange:w=>n(w.target.value),disabled:r,style:{width:"100%",padding:"14px 16px",fontSize:"16px",border:"2px solid #e2e8f0",borderRadius:"8px",boxSizing:"border-box",fontFamily:"'SF Mono', Monaco, 'Courier New', monospace",transition:"all 0.2s ease",background:"#f7fafc",outline:"none"},onFocus:w=>{w.target.style.borderColor="#2196F3",w.target.style.background="white",w.target.style.boxShadow="0 0 0 3px rgba(33, 150, 243, 0.1)"},onBlur:w=>{w.target.style.borderColor="#e2e8f0",w.target.style.background="#f7fafc",w.target.style.boxShadow="none"}}),d.jsx("div",{style:{marginTop:"8px",fontSize:"13px",color:"#a0aec0",lineHeight:"1.4"},children:"Valid formats: 8 digits or 10 digits (303xxxxxxx)"})]}),i&&d.jsxs("div",{style:{background:"#fed7d7",color:"#c53030",padding:"12px 16px",borderRadius:"8px",marginBottom:"24px",fontSize:"14px",display:"flex",alignItems:"center",border:"1px solid #fc8181"},children:[d.jsx("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"currentColor",style:{marginRight:"8px",flexShrink:0},children:d.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),i]}),d.jsx("button",{type:"submit",disabled:r,style:{width:"100%",padding:"14px 24px",fontSize:"16px",fontWeight:"600",background:r?"#cbd5e0":"#2196F3",color:"white",border:"none",borderRadius:"8px",cursor:r?"not-allowed":"pointer",transition:"all 0.2s ease",boxShadow:r?"none":"0 4px 6px rgba(33, 150, 243, 0.25)",transform:r?"none":"translateY(0)"},onMouseDown:w=>{r||(w.target.style.transform="translateY(2px)",w.target.style.boxShadow="0 2px 4px rgba(33, 150, 243, 0.25)")},onMouseUp:w=>{r||(w.target.style.transform="translateY(0)",w.target.style.boxShadow="0 4px 6px rgba(33, 150, 243, 0.25)")},onMouseOver:w=>{r||(w.target.style.background="#1976D2")},onMouseOut:w=>{r||(w.target.style.background="#2196F3")},children:r?d.jsxs("span",{style:{display:"flex",alignItems:"center",justifyContent:"center"},children:[d.jsxs("svg",{className:"animate-spin",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",style:{marginRight:"8px",animation:"spin 1s linear infinite"},children:[d.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",strokeOpacity:"0.25"}),d.jsx("path",{d:"M4 12a8 8 0 018-8",stroke:"currentColor",strokeWidth:"4",strokeLinecap:"round"})]}),"Verifying Student ID..."]}):"Access Game"})]}),d.jsxs("div",{style:{marginTop:"32px",paddingTop:"24px",borderTop:"1px solid #e2e8f0",textAlign:"center"},children:[d.jsx("p",{style:{fontSize:"14px",color:"#718096",marginBottom:"12px"},children:"Having trouble? Contact your instructor:"}),d.jsxs("p",{style:{fontSize:"16px",color:"#2196F3",fontWeight:"500"},children:["Park Sinchaisri",d.jsx("br",{}),d.jsx("a",{href:"mailto:parksinchaisri@haas.berkeley.edu",style:{color:"#2196F3",textDecoration:"none",borderBottom:"1px solid #2196F3",fontSize:"15px"},children:"parksinchaisri@haas.berkeley.edu"})]}),l&&d.jsxs("div",{style:{marginTop:"12px",padding:"12px",background:"#f7fafc",borderRadius:"8px",fontSize:"11px",color:"#4a5568",lineHeight:"1.8"},children:[d.jsx("strong",{children:"Test Codes:"}),d.jsxs("div",{style:{marginTop:"8px",fontFamily:"monospace"},children:[d.jsx("div",{children:"ADMIN-1-CP (No AI, With Checkpoint)"}),d.jsx("div",{children:"ADMIN-1-NCP (No AI, No Checkpoint)"}),d.jsx("div",{children:"ADMIN-2-CP (AI, With Checkpoint)"}),d.jsx("div",{children:"ADMIN-2-NCP (AI, No Checkpoint)"}),d.jsx("div",{children:"ADMIN-REGULAR (Original)"}),d.jsx("div",{children:"ADMIN-FAST (2 min test)"})]})]})]})]}),d.jsx("style",{children:`
          @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
          }
        `})]})}const Lg={async checkDailyLimit(t){var r;if(!t)return{allowed:!0};const e=new Date,n=new Date(e.getFullYear(),e.getMonth(),e.getDate(),0,0,0,0);try{const s=qn(et,"sessions"),i=qa(s,Dg("studentId","==",t),Dg("startTime",">=",n)),o=await qi(i);if(!o.empty){const l=o.docs[0].data(),u=(r=l.startTime)!=null&&r.toDate?l.startTime.toDate():new Date(l.clientStartTime);return{allowed:!1,reason:"daily_limit",existingSession:l,nextAvailable:new Date(n.getTime()+24*60*60*1e3)}}return{allowed:!0}}catch(s){console.error("Error checking daily limit:",s);const i=`played_${t}_${n.toISOString().split("T")[0]}`;return localStorage.getItem(i)?{allowed:!1,reason:"daily_limit",nextAvailable:new Date(n.getTime()+24*60*60*1e3)}:{allowed:!0}}},async markDailyPlay(t){const e=new Date,n=new Date(e.getFullYear(),e.getMonth(),e.getDate(),0,0,0,0),r=`played_${t}_${n.toISOString().split("T")[0]}`;localStorage.setItem(r,"true");const s=new Date(Date.now()-7*24*60*60*1e3);for(let i=0;i<localStorage.length;i++){const o=localStorage.key(i);if(o&&o.startsWith("played_")){const l=o.split("_")[2];l&&new Date(l)<s&&localStorage.removeItem(o)}}},async checkAccess(){try{const t=Rl.getCodeFromURL();if(!t)return{allowed:!1,reason:"Please login with your student ID",requiresCode:!0};const e=JSON.parse(sessionStorage.getItem("gameConfig")||"{}"),n=e.role==="admin";if(!n&&e.studentId){const r=await this.checkDailyLimit(e.studentId);if(!r.allowed&&!r.refreshGranted){const i=r.nextAvailable;return{allowed:!1,reason:`You have already completed today's session. Please come back in ${Math.ceil((i-Date.now())/(1e3*60*60))} hours (after midnight).`,dailyLimitReached:!0,nextAvailable:i}}if(sessionStorage.getItem("activeSessionId"))return{allowed:!1,reason:"Page refresh is not allowed during the game. Your session has been terminated.",refreshAttempt:!0}}return e.studentId?(n||await this.markDailyPlay(e.studentId),{allowed:!0,newSession:!0,code:t,codeData:{status:"new",metadata:e},isAdmin:n}):{allowed:!1,reason:"Please login with your Berkeley student ID",requiresCode:!0}}catch(t){console.error("Error in checkAccess:",t);const e=JSON.parse(sessionStorage.getItem("gameConfig")||"{}");return e.role==="admin"?{allowed:!0,newSession:!0,code:Rl.getCodeFromURL(),codeData:{status:"error_bypass",metadata:e},isAdmin:!0}:{allowed:!1,reason:"System error. Please try again.",requiresCode:!0}}},async createSession(t=null,e=null,n=!1){try{const r=JSON.parse(sessionStorage.getItem("gameConfig")||"{}"),s=r.role==="admin",i={id:crypto.randomUUID(),accessCode:t,studentId:r.studentId||null,role:r.role||"student",semesterDuration:r.semesterDuration||72e4,displayName:r.displayName||"Student",startTime:en(),clientStartTime:new Date().toISOString(),status:"active",completedTasks:{},isPractice:n,isAdminSession:s,userAgent:navigator.userAgent,screenResolution:`${window.screen.width}x${window.screen.height}`,section:r.section,hasAI:r.hasAI,checkpointSemester2:r.checkpointSemester2},l=(await kl(qn(et,"sessions"),i)).id;return localStorage.setItem("sessionId",l),sessionStorage.setItem("activeSessionId",l),s||(window.addEventListener("beforeunload",u=>{u.preventDefault(),u.returnValue="Your progress will be lost if you leave this page.",this.handleSessionAbandonment()}),document.addEventListener("visibilitychange",()=>{!s&&document.hidden&&eventTracker.logEvent("tab_switch",{sessionId:l,timestamp:Date.now(),hidden:!0})})),l}catch(r){console.error("Error creating session:",r);const s=JSON.parse(sessionStorage.getItem("gameConfig")||"{}");if(s.role==="admin"){const i="offline-"+Date.now();localStorage.setItem("sessionId",i),sessionStorage.setItem("activeSessionId",i);const o={id:i,accessCode:t,startTime:Date.now(),status:"active",isOffline:!0,studentId:s.studentId||null,role:s.role||"admin"};return localStorage.setItem("offlineSession",JSON.stringify(o)),i}throw r}},async handleSessionAbandonment(){const t=localStorage.getItem("sessionId");if(t&&!t.startsWith("offline-"))try{await Gn(un(et,"sessions",t),{status:"abandoned",abandonedAt:en(),abandonReason:"page_unload"})}catch(e){console.error("Error marking session as abandoned:",e)}sessionStorage.removeItem("activeSessionId"),sessionStorage.removeItem("gameConfig")}};function mI(){const[t,e]=L.useState(""),[n,r]=L.useState(!1),[s,i]=L.useState(""),[o,l]=L.useState(!1),u=async()=>{r(!0),i(""),l(!1);try{const p=await Rl.createCode({createdBy:"admin",timestamp:new Date().toISOString()});p.success?e(p.code):i("Failed to generate code: "+p.error)}catch(p){i("Error: "+p.message)}finally{r(!1)}},h=()=>{const p=`${window.location.origin}?code=${t}`;navigator.clipboard.writeText(p),l(!0),setTimeout(()=>l(!1),2e3)};return d.jsxs("div",{style:{padding:"40px",maxWidth:"800px",margin:"0 auto",fontFamily:"system-ui, -apple-system, sans-serif"},children:[d.jsx("h1",{style:{color:"#333",marginBottom:"10px"},children:"Admin Dashboard"}),d.jsx("p",{style:{color:"#666",marginBottom:"30px"},children:"Generate access codes for participants"}),d.jsxs("div",{style:{background:"#f8f9fa",padding:"30px",borderRadius:"8px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:[d.jsx("button",{onClick:u,disabled:n,style:{padding:"12px 30px",fontSize:"16px",background:n?"#ccc":"#4CAF50",color:"white",border:"none",borderRadius:"6px",cursor:n?"not-allowed":"pointer",fontWeight:"bold"},children:n?"Generating...":"Generate New Access Code"}),t&&d.jsxs("div",{style:{marginTop:"30px",padding:"20px",background:"white",borderRadius:"6px",border:"1px solid #e0e0e0"},children:[d.jsx("h3",{style:{margin:"0 0 15px 0",color:"#333"},children:"Generated Code"}),d.jsxs("div",{style:{marginBottom:"20px"},children:[d.jsx("label",{style:{display:"block",marginBottom:"5px",color:"#666",fontSize:"14px"},children:"Access Code:"}),d.jsx("div",{style:{display:"flex",alignItems:"center",gap:"10px",padding:"10px",background:"#f5f5f5",borderRadius:"4px",fontFamily:"monospace",fontSize:"18px",fontWeight:"bold"},children:t})]}),d.jsxs("div",{children:[d.jsx("label",{style:{display:"block",marginBottom:"5px",color:"#666",fontSize:"14px"},children:"Full URL:"}),d.jsxs("div",{style:{display:"flex",gap:"10px",alignItems:"stretch"},children:[d.jsx("input",{type:"text",value:`${window.location.origin}?code=${t}`,readOnly:!0,style:{flex:1,padding:"10px",border:"1px solid #ddd",borderRadius:"4px",fontFamily:"monospace",fontSize:"14px",background:"#f9f9f9"}}),d.jsx("button",{onClick:h,style:{padding:"10px 20px",background:o?"#4CAF50":"#2196F3",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:"bold",whiteSpace:"nowrap"},children:o?" Copied!":"Copy URL"})]})]}),d.jsxs("div",{style:{marginTop:"20px",padding:"15px",background:"#e3f2fd",borderRadius:"4px",fontSize:"14px",color:"#1976d2"},children:[d.jsx("strong",{children:"Note:"})," This code is valid for 24 hours and can only be used once."]})]}),s&&d.jsx("div",{style:{marginTop:"20px",padding:"15px",background:"#ffebee",color:"#c62828",borderRadius:"4px"},children:s})]}),d.jsxs("div",{style:{marginTop:"40px",padding:"20px",background:"#f5f5f5",borderRadius:"6px",fontSize:"14px",color:"#666"},children:[d.jsx("h3",{style:{margin:"0 0 10px 0",color:"#333"},children:"How to use:"}),d.jsxs("ol",{style:{margin:"10px 0",paddingLeft:"20px"},children:[d.jsx("li",{children:"Generate a code using the button above"}),d.jsx("li",{children:"Copy the full URL"}),d.jsx("li",{children:"Share the URL with participants"}),d.jsx("li",{children:"Each participant can use their unique code once"})]})]})]})}function yI({sessionId:t,completedLevels:e,totalTime:n,gameMode:r}){const[s,i]=L.useState(""),[o,l]=L.useState(!1);L.useEffect(()=>{u()},[]);const u=()=>{const p=Date.now().toString(36).toUpperCase(),g=e.toString().padStart(2,"0"),v=r.limit==="time"?"T":"A",k=r.accuracy==="strict"?"S":"L";Math.floor(n/60).toString().padStart(2,"0");const O=`GAME-${`${t}-${g}-${n}`.split("").reduce((C,I)=>C+I.charCodeAt(0),0).toString(36).toUpperCase().slice(-3)}-${g}-${v}${k}-${p}`;i(O)},h=()=>{navigator.clipboard.writeText(s),l(!0),setTimeout(()=>l(!1),3e3)};return d.jsxs("div",{style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",borderRadius:"12px",padding:"30px",marginTop:"30px",color:"white",textAlign:"center",boxShadow:"0 10px 30px rgba(0,0,0,0.2)"},children:[d.jsx("h2",{style:{marginBottom:"20px",fontSize:"24px"},children:" Your Completion Code"}),d.jsx("p",{style:{marginBottom:"20px",opacity:.9,fontSize:"16px"},children:"Copy this code and paste it into the Qualtrics survey to verify your completion:"}),d.jsxs("div",{style:{background:"rgba(255,255,255,0.2)",borderRadius:"8px",padding:"20px",marginBottom:"20px",backdropFilter:"blur(10px)"},children:[d.jsx("div",{style:{fontFamily:"monospace",fontSize:"28px",fontWeight:"bold",letterSpacing:"2px",marginBottom:"15px",wordBreak:"break-all",textShadow:"2px 2px 4px rgba(0,0,0,0.2)"},children:s}),d.jsx("button",{onClick:h,style:{padding:"12px 30px",fontSize:"16px",fontWeight:"bold",background:o?"#4CAF50":"white",color:o?"white":"#764ba2",border:"none",borderRadius:"6px",cursor:"pointer",transition:"all 0.3s",boxShadow:"0 4px 15px rgba(0,0,0,0.2)"},children:o?" Copied!":" Copy Code"})]}),d.jsxs("div",{style:{background:"rgba(255,255,255,0.1)",borderRadius:"6px",padding:"15px",fontSize:"14px",lineHeight:"1.5"},children:[d.jsx("strong",{children:" Important:"})," This code is your proof of completion. Make sure to copy it before closing this window!"]}),d.jsxs("details",{style:{marginTop:"20px",textAlign:"left"},children:[d.jsx("summary",{style:{cursor:"pointer",opacity:.8,fontSize:"12px",marginBottom:"10px"},children:"Code Details "}),d.jsxs("div",{style:{fontSize:"12px",opacity:.7,background:"rgba(0,0,0,0.2)",padding:"10px",borderRadius:"4px",fontFamily:"monospace"},children:[d.jsxs("div",{children:["Levels Completed: ",e,"/45"]}),d.jsxs("div",{children:["Game Mode: ",r.limit==="time"?"Time Challenge":"Task Attempts"]}),d.jsxs("div",{children:["Accuracy Mode: ",r.accuracy==="strict"?"Strict (100%)":"Lenient"]}),d.jsxs("div",{children:["Total Time: ",Math.floor(n/60),"m ",n%60,"s"]}),d.jsxs("div",{children:["Generated: ",new Date().toLocaleString()]})]})]})]})}function vI(){const[t,e]=L.useState([]),[n,r]=L.useState(!0),[s,i]=L.useState(null),[o,l]=L.useState(!1),[u,h]=L.useState(""),p=["3040748714","3040729812","3040859968","3040852909","3040869211","3040849958","3039838870","15177695","3040849997","3039845630","3040682661","26416809","3039850622","3040869510","3031977170","3040806629","3040848528","3039840443","3040848749","3040849893","3039850830","3039850713"],g=["3040850023","22900589","3039850570","3040882302","3040815651","3040701758","3040852077","3036343361","3040869458","3040705047","3040702343","3039842887","3040848593","3040702603","3039840222","3039840209","3040861190","18565110","3040869302","3040814338","3039754031"],v=["3040705476","3040697715","3039753992","3040729513","3040681595","3040850010","3032682772","3039842484","3040869445","3040814455","3039840781","3040696831","3040705125","3034184066","3039843004","3039842835","3040860072","3040871018","3039839026","3040814429","3040869094","3040748064","3040875945","3040701589","3040682193","3040729422","3040836165","21798975","3038626424","3039753017","3039840287","3040806382"],k=["25958106","3040814351","3040848697","3040684039","3040869289","22971551","3040837218","3040864570","3040705099","3034288430","3040848541","3040864531","3040869237","3032342054","3040682479","3039840170","3032397447","3039850856","3039840118","3040729552","3040683181","3040861073","3031968434","3040882575","3035320237","3040823815","3039842575","24261697","23420611","3032000089","3040882341"],R=m=>p.includes(m)?{section:"01A-Checkpoint",hasCheckpoint:!0}:g.includes(m)?{section:"01A-No Checkpoint",hasCheckpoint:!1}:v.includes(m)?{section:"02A-Checkpoint",hasCheckpoint:!0}:k.includes(m)?{section:"02A-No Checkpoint",hasCheckpoint:!1}:m.includes("ADMIN")||m.includes("admin")?{section:"ADMIN",hasCheckpoint:!1}:{section:"Unknown",hasCheckpoint:!1};L.useEffect(()=>{P()},[]);const P=async()=>{r(!0);try{const m=await qi(qn(et,"sessions")),S={};m.forEach(x=>{var X;const W=x.data();if(!(W.role==="admin"||W.role==="master_admin")&&W.studentId){const te=R(W.studentId);S[W.studentId]||(S[W.studentId]={studentId:W.studentId,sessions:[],latestAccess:null,totalAccesses:0,displayName:`Student ${W.studentId}`,section:te.section,hasCheckpoint:te.hasCheckpoint,hasPlayed:!0}),S[W.studentId].sessions.push({id:x.id,timestamp:(X=W.startTime)!=null&&X.toDate?W.startTime.toDate():new Date(W.clientStartTime),status:W.status,completedTasks:Object.keys(W.completedTasks||{}).length,finalScore:W.finalScore||0,currentSemester:W.currentSemester||1})}}),Object.values(S).forEach(x=>{var W;x.sessions.sort((X,te)=>te.timestamp-X.timestamp),x.latestAccess=((W=x.sessions[0])==null?void 0:W.timestamp)||null,x.totalAccesses=x.sessions.length});const E=[];[...p,...g,...v,...k].forEach(x=>{if(S[x])E.push(S[x]);else{const W=R(x);E.push({studentId:x,sessions:[],latestAccess:null,totalAccesses:0,displayName:`Student ${x}`,section:W.section,hasCheckpoint:W.hasCheckpoint,hasPlayed:!1})}}),E.sort((x,W)=>x.hasPlayed&&!W.hasPlayed?-1:!x.hasPlayed&&W.hasPlayed?1:x.latestAccess&&W.latestAccess?W.latestAccess-x.latestAccess:x.studentId.localeCompare(W.studentId)),e(E)}catch(m){console.error("Error loading student data:",m)}finally{r(!1)}},O=async m=>{l(!0);try{const E=new Date().toISOString().split("T")[0],A=`played_${m}_${E}`;localStorage.removeItem(A),await kl(qn(et,"accessRefreshes"),{studentId:m,refreshedBy:"MASTER_ADMIN",refreshedAt:en(),reason:"Manual refresh by admin"}),alert(`Access refreshed for student ${m}. They can now play again today.`),await P()}catch(S){console.error("Error refreshing access:",S),alert(`Failed to refresh access: ${S.message}`)}finally{l(!1)}},C=async()=>{if(confirm(` DANGER: This will permanently delete ALL student sessions, events, and access data.

This action cannot be undone. Are you absolutely sure?`)){l(!0);try{const m=qa(qn(et,"sessions")),S=await qi(m),E=S.docs.map(N=>Zu(N.ref)),A=qa(qn(et,"events")),x=await qi(A),W=x.docs.map(N=>Zu(N.ref)),X=qa(qn(et,"accessRefreshes")),te=await qi(X),U=te.docs.map(N=>Zu(N.ref));Object.keys(localStorage).forEach(N=>{N.startsWith("played_")&&localStorage.removeItem(N)}),await Promise.all([...E,...W,...U]),alert(` All data reset complete!

Deleted:
- ${S.size} sessions
- ${x.size} events
- ${te.size} access refreshes
- All localStorage data`),await P()}catch(m){console.error("Error resetting all data:",m),alert("Failed to reset data. Please check console for details.")}finally{l(!1)}}},I=t.filter(m=>m.studentId.toLowerCase().includes(u.toLowerCase())),w=m=>m?new Intl.DateTimeFormat("en-US",{month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit",hour12:!0}).format(m):"Never",b=m=>!m.sessions||m.sessions.length===0?0:Math.max(...m.sessions.map(S=>S.finalScore||0)),V=t.filter(m=>!m.section.includes("ADMIN")).length,j=t.filter(m=>!m.section.includes("ADMIN")&&m.hasPlayed).length,T=t.filter(m=>!m.section.includes("ADMIN")).reduce((m,S)=>m+S.totalAccesses,0);t.filter(m=>!m.section.includes("ADMIN")&&m.hasPlayed).reduce((m,S)=>m+b(S),0)/(j||1);const _=t.filter(m=>!m.section.includes("ADMIN")&&!m.hasPlayed).length;return d.jsxs("div",{style:{padding:"20px",maxWidth:"1400px",margin:"0 auto"},children:[d.jsx("div",{style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",padding:"30px",borderRadius:"12px",marginBottom:"30px",color:"white"},children:d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[d.jsxs("div",{children:[d.jsx("h1",{style:{margin:"0 0 10px 0"},children:" Master Admin Dashboard"}),d.jsx("p",{style:{margin:0,opacity:.9},children:"Manage student access and view activity logs"})]}),d.jsx("button",{onClick:C,disabled:o,style:{padding:"12px 20px",background:"#f44336",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontWeight:"bold",fontSize:"14px",opacity:o?.6:1},children:o?"Processing...":" Reset All Data"})]})}),d.jsxs("div",{style:{background:"white",padding:"20px",borderRadius:"12px",marginBottom:"20px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[d.jsxs("div",{style:{display:"flex",gap:"15px",alignItems:"center"},children:[d.jsx("input",{type:"text",placeholder:"Search by Student ID...",value:u,onChange:m=>h(m.target.value),style:{flex:1,padding:"10px 15px",border:"2px solid #e0e0e0",borderRadius:"8px",fontSize:"14px"}}),d.jsx("button",{onClick:P,disabled:n,style:{padding:"10px 20px",background:"#2196F3",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontWeight:"bold"},children:" Refresh Data"})]}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(5, 1fr)",gap:"15px",marginTop:"20px"},children:[d.jsxs("div",{style:{padding:"15px",background:"#e3f2fd",borderRadius:"8px",textAlign:"center"},children:[d.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#2196F3"},children:V}),d.jsx("div",{style:{fontSize:"12px",color:"#666"},children:"Total Students"})]}),d.jsxs("div",{style:{padding:"15px",background:"#e8f5e9",borderRadius:"8px",textAlign:"center"},children:[d.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#4CAF50"},children:j}),d.jsx("div",{style:{fontSize:"12px",color:"#666"},children:"Have Played"})]}),d.jsxs("div",{style:{padding:"15px",background:"#fff3e0",borderRadius:"8px",textAlign:"center"},children:[d.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#ff9800"},children:T}),d.jsx("div",{style:{fontSize:"12px",color:"#666"},children:"Total Sessions"})]}),d.jsxs("div",{style:{padding:"15px",background:"#fce4ec",borderRadius:"8px",textAlign:"center"},children:[d.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#e91e63"},children:_}),d.jsx("div",{style:{fontSize:"12px",color:"#666"},children:"Never Played"})]}),d.jsxs("div",{style:{padding:"15px",background:"#f3e5f5",borderRadius:"8px",textAlign:"center"},children:[d.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#9c27b0"},children:_}),d.jsx("div",{style:{fontSize:"12px",color:"#666"},children:"Never Played"})]})]})]}),d.jsx("div",{style:{background:"white",borderRadius:"12px",overflow:"hidden",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:d.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[d.jsx("thead",{children:d.jsxs("tr",{style:{background:"#f5f5f5"},children:[d.jsx("th",{style:{padding:"15px",textAlign:"left",fontWeight:"600"},children:"Student ID"}),d.jsx("th",{style:{padding:"15px",textAlign:"left",fontWeight:"600"},children:"Section"}),d.jsx("th",{style:{padding:"15px",textAlign:"center",fontWeight:"600"},children:"Status"}),d.jsx("th",{style:{padding:"15px",textAlign:"center",fontWeight:"600"},children:"Latest Access"}),d.jsx("th",{style:{padding:"15px",textAlign:"center",fontWeight:"600"},children:"Highest Score"}),d.jsx("th",{style:{padding:"15px",textAlign:"center",fontWeight:"600"},children:"Total"}),d.jsx("th",{style:{padding:"15px",textAlign:"center",fontWeight:"600"},children:"Actions"})]})}),d.jsx("tbody",{children:n?d.jsx("tr",{children:d.jsx("td",{colSpan:"7",style:{padding:"40px",textAlign:"center"},children:"Loading student data..."})}):I.length===0?d.jsx("tr",{children:d.jsx("td",{colSpan:"7",style:{padding:"40px",textAlign:"center"},children:"No students found"})}):I.map(m=>{const S=b(m),E=m.section==="ADMIN";return d.jsxs("tr",{style:{borderBottom:"1px solid #e0e0e0",background:s===m.studentId?"#f0f8ff":m.hasPlayed?E?"#fff9c4":"white":"#fafafa"},children:[d.jsx("td",{style:{padding:"15px",fontFamily:"monospace"},children:m.studentId}),d.jsx("td",{style:{padding:"15px"},children:d.jsx("span",{style:{padding:"4px 8px",background:E?"#ffeb3b":m.section.includes("01A")?"#e3f2fd":m.section.includes("02A")?"#f3e5f5":"#f5f5f5",borderRadius:"4px",fontSize:"12px",fontWeight:E?"bold":"normal",color:E?"#333":"inherit"},children:m.section})}),d.jsx("td",{style:{padding:"15px",textAlign:"center"},children:m.hasPlayed?E?d.jsx("span",{style:{padding:"4px 8px",background:"#ffeb3b",color:"#333",borderRadius:"12px",fontSize:"12px",fontWeight:"bold"},children:"Admin Test"}):d.jsx("span",{style:{padding:"4px 8px",background:"#e8f5e9",color:"#2e7d32",borderRadius:"12px",fontSize:"12px"},children:"Active"}):d.jsx("span",{style:{padding:"4px 8px",background:"#e0e0e0",color:"#666",borderRadius:"12px",fontSize:"12px"},children:"Never Played"})}),d.jsx("td",{style:{padding:"15px",textAlign:"center"},children:w(m.latestAccess)}),d.jsx("td",{style:{padding:"15px",textAlign:"center"},children:d.jsx("span",{style:{padding:"4px 8px",background:S>=1e3?"#e8f5e9":S>0?"#fff3e0":"#f5f5f5",color:S>=1e3?"#2e7d32":S>0?"#f57c00":"#999",borderRadius:"12px",fontSize:"12px",fontWeight:"bold"},children:S})}),d.jsx("td",{style:{padding:"15px",textAlign:"center",fontWeight:"bold"},children:m.totalAccesses}),d.jsx("td",{style:{padding:"15px",textAlign:"center"},children:!E&&d.jsx("button",{onClick:()=>{i(m.studentId),confirm(`Reset access for Student ${m.studentId} (${m.section})?

This will allow them to play again today.`)&&O(m.studentId)},disabled:o,style:{padding:"6px 12px",background:"#2196F3",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"12px",fontWeight:"bold"},children:" Reset"})})]},m.studentId)})})]})}),d.jsxs("div",{style:{marginTop:"20px",padding:"15px",background:"#f5f5f5",borderRadius:"8px",fontSize:"12px",color:"#666",textAlign:"center"},children:["Access automatically resets at midnight PST. Use refresh button to manually grant access.",d.jsx("br",{}),"Total roster: ",V," students across 4 conditions (01A-Checkpoint, 01A-No Checkpoint, 02A-Checkpoint, 02A-No Checkpoint)"]})]})}function _I(t,e){const n=t.length,r=e.length,s=Array(n+1).fill(null).map(()=>Array(r+1).fill(0));for(let i=0;i<=n;i++)s[i][0]=i;for(let i=0;i<=r;i++)s[0][i]=i;for(let i=1;i<=n;i++)for(let o=1;o<=r;o++)t[i-1]===e[o-1]?s[i][o]=s[i-1][o-1]:s[i][o]=Math.min(s[i-1][o]+1,s[i][o-1]+1,s[i-1][o-1]+1);return s[n][r]}function xI(){if(window.location.search.includes("master=true")&&JSON.parse(sessionStorage.getItem("gameConfig")||"{}").role==="master_admin")return d.jsx(vI,{});if(window.location.search.includes("admin=true"))return d.jsx(mI,{});const e=new URLSearchParams(window.location.search).get("admin")==="berkeley2024",[n,r]=L.useState("landing"),[s,i]=L.useState(null),[o,l]=L.useState(null),[u,h]=L.useState("g2t1"),[p,g]=L.useState({}),[v,k]=L.useState(0),[R,P]=L.useState(null),[O,C]=L.useState(!1),[I,w]=L.useState(""),[b,V]=L.useState(!0),[j,T]=L.useState(0),[_,m]=L.useState({}),[S,E]=L.useState(0),[A,x]=L.useState(0),[W,X]=L.useState(!1),[te,U]=L.useState(null),[N,F]=L.useState(!1),[H,Z]=L.useState(30),[ee,oe]=L.useState(!1),[Ae,ge]=L.useState(5),[de,ce]=L.useState(!1),[Le,we]=L.useState(0),[re,ke]=L.useState(1),[Ge]=L.useState(2),[Re,_t]=L.useState([]),[$t,Wt]=L.useState(null),[Ht,qt]=L.useState(!1),[Gt,ar]=L.useState(0),[kn,lr]=L.useState(null),[$e,fi]=L.useState({g2t1:!1,g1t1:!1,g3t1:!1}),[Go,ot]=L.useState(1200),[tt,Ur]=L.useState(1200),[lu,Qo]=L.useState(0),[Se,Rn]=L.useState({materials:0,research:0,engagement:0,bonus:0}),[uu,pi]=L.useState({}),[gi,Ko]=L.useState({}),mi=L.useRef(Date.now()),Fn=L.useRef(null);L.useRef(null);const ur=L.useRef(null),Qt=L.useRef(null),gn=L.useRef(Date.now());L.useRef(1200),L.useRef(1200),L.useEffect(()=>{yi()},[]),L.useEffect(()=>{const q=JSON.parse(sessionStorage.getItem("gameConfig")||"{}"),K=q.role==="admin";if(K)return;const G=()=>{N&&(F(!1),Z(30),ur.current&&(clearInterval(ur.current),ur.current=null))},ie=()=>{},Ie=()=>{gn.current=Date.now(),ee&&(oe(!1),ge(5),Qt.current&&(clearInterval(Qt.current),Qt.current=null))};let Oe;K||(Oe=setInterval(()=>{if(n==="challenge"&&!K&&Date.now()-gn.current>6e4&&!ee){oe(!0);let at=5;Qt.current=setInterval(()=>{if(at--,ge(at),at<=0){ce(!0),clearInterval(Qt.current),Pe.logEvent("game_blocked",{reason:"idle",timestamp:Date.now(),studentId:q.studentId,section:q.section});const Ye=localStorage.getItem("sessionId");Ye&&!Ye.startsWith("offline-")&&Gn(un(et,"sessions",Ye),{status:"blocked",blockedAt:en(),blockReason:"idle"})}},1e3)}},3e4));const nt=kt=>{!K&&n==="challenge"&&(kt.preventDefault(),kt.returnValue=" WARNING: If you leave this page, you CANNOT return to complete your session. Your progress will be permanently lost.",Pe.logEvent("refresh_attempt",{timestamp:Date.now(),studentId:q.studentId,currentMode:n}))};return window.addEventListener("focus",G),window.addEventListener("blur",ie),window.addEventListener("mousemove",Ie),window.addEventListener("keypress",Ie),window.addEventListener("click",Ie),window.addEventListener("beforeunload",nt),()=>{window.removeEventListener("focus",G),window.removeEventListener("blur",ie),window.removeEventListener("mousemove",Ie),window.removeEventListener("keypress",Ie),window.removeEventListener("click",Ie),window.removeEventListener("beforeunload",nt),Oe&&clearInterval(Oe),ur.current&&clearInterval(ur.current),Qt.current&&clearInterval(Qt.current)}},[n]);const mn=(q=Se)=>{const K=q.materials||0,G=q.research||0;q.engagement;const ie=1+G*.15,Ie=K*ie,Oe=parseFloat(localStorage.getItem("engagementInterest")||"0")||0,nt=Ie+Oe;return console.log(` STUDENT LEARNING: ${nt.toFixed(1)} pts | Formula: ${K}  ${ie.toFixed(2)} + ${Oe.toFixed(1)} = ${nt.toFixed(1)}`),isNaN(nt)?0:nt},yi=async()=>{try{const q=new URLSearchParams(window.location.search),K=q.has("code")||q.has("c");if(e&&!sessionStorage.getItem("gameConfig")&&sessionStorage.setItem("gameConfig",JSON.stringify({role:"admin",section:"admin",hasAI:!0,checkpointSemester2:!0,displayName:"Admin User"})),!K){r("studentLogin"),V(!1);return}const{allowed:G,reason:ie,resumeSession:Ie,newSession:Oe,code:nt,codeData:kt}=await Lg.checkAccess();if(!G){C(!0),w(ie),V(!1);return}if(Ie)P(Ie),localStorage.setItem("sessionId",Ie);else if(Oe){const at=await Lg.createSession(nt,kt);P(at)}await Pe.syncOfflineEvents(),V(!1)}catch{V(!1)}},zn=()=>{const q=JSON.parse(sessionStorage.getItem("gameConfig")||"{}");if(!(re===2&&q.checkpointSemester2))return;qt(!0),mn()>=50?(ar(300),Rn(Ie=>({...Ie,bonus:(Ie.bonus||0)+300}))):ar(0),X(!0),U("checkpoint")},vi=()=>{const q=JSON.parse(sessionStorage.getItem("gameConfig")||"{}"),K=q.semesterDuration||12e5,G=Math.floor(K/1e3);ot(G),Ur(G),mi.current=Date.now(),Fn.current=setInterval(()=>{const Ie=Date.now()-mi.current,Oe=Math.floor(Ie/1e3);T(Oe);const nt=Math.max(0,G-Oe);if(Ur(nt),re===2&&q.checkpointSemester2){const at=q.role==="admin"&&q.semesterDuration===12e4?60:360;Oe===at&&!Ht&&zn()}nt<=0&&(clearInterval(Fn.current),Fn.current=null,Yo("semester_complete"))},1e3)},$r=q=>{const G=JSON.parse(sessionStorage.getItem("gameConfig")||"{}").role==="admin",ie=$e.g2t1&&$e.g1t1&&$e.g3t1;l(q),Pe.trackUserAction("practice_choice",{choice:q,timestamp:Date.now()}),q==="no"?!G&&!ie?(We("You must complete all three practice tasks first!"),r("practice")):_i():r("practice")},_i=()=>{if(!$t){const q=Math.floor(Math.random()*1e6);Wt(q),Jn.initializeSeed(q),R&&!R.startsWith("offline-")&&Gn(un(et,"sessions",R),{randomSeed:q,[`semesterSeeds.semester${re}`]:q})}localStorage.setItem("engagementInterest","0"),Rn({materials:0,research:0,engagement:0,bonus:0}),r("challenge"),g({}),k(0),E(0),x(0),h("g2t1"),qt(!1),pi({}),Ko({}),vi(),m({g2t1:Date.now()}),Pe.setPageStartTime("g2t1"),Pe.logEvent("game_start",{practiceCompleted:o==="yes",timestamp:Date.now(),gameMode:s,currentSemester:re,totalSemesters:Ge,isAdminMode:e})},Bn=async(q,K)=>{gn.current=Date.now();let G=0;const ie=q.startsWith("g1")?"research":q.startsWith("g2")?"materials":"engagement";if(ie==="materials"){const pe=parseFloat(K.userValue||0),Rt=parseFloat(K.targetValue||0),yn=Math.abs(pe-Rt);yn===0?G=2:yn<=1?G=1:G=0}else if(ie==="research"){const pe=parseInt(K.userAnswer||0),Rt=parseInt(K.correctAnswer||0),yn=Math.abs(pe-Rt);yn===0?G=2:yn<=1?G=1:G=0}else if(ie==="engagement"){const pe=K.userAnswer||"",Rt=K.correctAnswer||"";pe===Rt?G=2:_I(pe,Rt)===1?G=1:G=0}Rn(pe=>{const Rt={...pe,[ie]:pe[ie]+G};return console.log(` Updated ${ie}: +${G} (total: ${Rt[ie]})`),Rt});const Oe=.0015*(ie==="engagement"?Se.engagement+G:Se.engagement),nt=ie==="materials"?Se.materials+G:Se.materials,kt=1+(ie==="research"?Se.research+G:Se.research)*.15,at=nt*kt,ys=parseFloat(localStorage.getItem("engagementInterest")||"0")+Oe*at;localStorage.setItem("engagementInterest",ys.toString()),Ko(pe=>({...pe,[q]:G})),pi(pe=>({...pe,[q]:(pe[q]||0)+1}));const vs={...Se,[ie]:Se[ie]+G},cr=mn(vs);Qo(cr);let Vt="";if(ie==="materials"){const pe=Math.abs((K.userValue||0)-(K.targetValue||0));pe===0?Vt="Perfect materials!":pe<=1?Vt=`Off by ${pe.toFixed(2)}`:Vt=`Off by ${pe.toFixed(2)}`}else if(ie==="research"){const pe=Math.abs((K.userAnswer||0)-(K.correctAnswer||0));pe===0?Vt="Perfect research!":pe<=1?Vt=`Off by ${pe}`:Vt=`Off by ${pe}`}else ie==="engagement"&&(G===2?Vt="Perfect engagement!":G===1?Vt="One typo":Vt="Multiple errors");We(`${Vt} | +${G} ${ie} pts | Goal: ${Math.round(cr)} pts`),g(pe=>({...pe,[q]:!0})),k(pe=>pe+1),x(pe=>pe+1),await Pe.trackTaskComplete(q,K.attempts,K.totalTime,K.accuracy||K.difference||0),await Pe.logEvent("task_complete",{taskId:q,...K,pointsEarned:G,categoryPoints:vs,studentLearningScore:cr,engagementInterest:ys,completionContext:{totalTasksCompleted:Object.keys(p).length+1,currentGameTime:j,switchesBeforeCompletion:S,bonusPromptsEarned:A+1,timeRemaining:tt}}),R&&!R.startsWith("offline-")&&await Gn(un(et,"sessions",R),{[`completedTasks.${q}`]:!0,[`taskPoints.${q}`]:G,categoryPoints:vs,studentLearningScore:cr,engagementInterest:ys,bonusPrompts:A+1,lastActivity:en()}),setTimeout(()=>{if(u!==q)return;const pe=q[1],Rt=parseInt(q.substring(3));if(Rt<50){const yn=`g${pe}t${Rt+1}`;p[yn]||xi(yn,!0)}},800)},xi=async(q,K=!1)=>{if(!W){if(p[q]&&!K){We("Task already completed! Choose a different task.");return}if(K||await Pe.trackUserAction("manual_tab_switch",{from:u,to:q,reason:"user_clicked"}),gn.current=Date.now(),ee&&(oe(!1),ge(5),Qt.current&&(clearInterval(Qt.current),Qt.current=null)),u!==q&&!K&&E(G=>G+1),await Pe.trackPageSwitch(u,q,K),_[u]){const G=Date.now()-_[u];await Pe.logEvent("task_time",{taskId:u,timeSpent:G,completed:p[u]||!1,leftForTask:q})}h(q),m(G=>({...G,[q]:Date.now()})),Pe.setPageStartTime(q)}},We=q=>{const K=document.createElement("div");K.className="notification-enter",K.style.cssText="position: fixed; bottom: 20px; left: 20px; background: #2196F3; color: white; padding: 15px 20px; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); z-index: 10000; max-width: 400px;",K.textContent=q,document.body.appendChild(K),setTimeout(()=>{K.className="notification-exit",setTimeout(()=>{document.body.contains(K)&&document.body.removeChild(K)},500)},3e3)},Yo=async(q="semester_complete")=>{Fn.current&&clearInterval(Fn.current);const K=Math.floor((Date.now()-mi.current-Le)/1e3),G=mn(),ie=Se.bonus||0,Ie=Math.round(G)+ie;await Pe.logEvent("game_complete",{totalTime:K,totalSwitches:S,completedTasks:Object.keys(p).length,completedLevels:v,completionReason:q,gameMode:s,currentSemester:re,categoryPoints:Se,studentLearningScore:G,totalBonus:ie,finalScore:Ie,finalContext:{practiceCompleted:o==="yes",totalPrompts:3+A,isAdminMode:e}}),R&&!R.startsWith("offline-")&&await Gn(un(et,"sessions",R),{status:"completed",completedAt:en(),finalTime:K,totalSwitches:S,completionReason:q,currentSemester:re,finalScore:Ie,studentLearningScore:G}),r("complete")},Kt=(q,K)=>{if(K&&K.points&&K.points===2)fi(G=>({...G,[q]:!0})),We("Perfect! Practice task completed."),setTimeout(()=>{lr(null)},1500);else{const G=(K==null?void 0:K.points)||0;We(`Practice requires 100% accuracy. You scored ${G===1?"50%":"0%"}. Try again!`),setTimeout(()=>{lr(null)},2e3)}},Wr=()=>{const q=u[1],K=parseInt(u.substring(3)),G=n==="practice";return q==="1"?d.jsx(pd,{taskNum:K,onComplete:G?Kt:Bn,currentTaskId:u,isPractice:G}):q==="2"?d.jsx(gd,{taskNum:K,onComplete:G?Kt:Bn,currentTaskId:u,isPractice:G}):d.jsx(md,{taskNum:K,onComplete:G?Kt:Bn,currentTaskId:u,isPractice:G})};if(b)return d.jsx("div",{className:"app",style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:d.jsx("h2",{children:"Loading..."})});if(n==="studentLogin")return d.jsx(gI,{onLoginSuccess:q=>{window.location.href=`${window.location.origin}?code=${q}`}});if(O)return d.jsx("div",{className:"app",children:d.jsxs("div",{style:{maxWidth:"600px",margin:"50px auto",padding:"30px",background:"white",borderRadius:"12px",boxShadow:"0 4px 6px rgba(0,0,0,0.1)"},children:[d.jsx("h2",{style:{color:"#f44336",marginBottom:"20px"},children:"Access Denied"}),d.jsx("p",{style:{fontSize:"18px",marginBottom:"20px"},children:I}),d.jsx("div",{style:{padding:"15px",background:"#ffebee",borderRadius:"8px",border:"1px solid #f44336"},children:d.jsx("p",{style:{color:"#c62828",margin:0},children:"If you believe this is an error, please contact your instructor."})})]})});if(n==="semesterBreak"){const q=JSON.parse(sessionStorage.getItem("gameConfig")||"{}"),K=re===2&&q.checkpointSemester2;return d.jsx("div",{className:"app",children:d.jsxs("div",{style:{maxWidth:"700px",margin:"50px auto",padding:"40px",background:"white",borderRadius:"12px",boxShadow:"0 4px 20px rgba(0,0,0,0.1)",textAlign:"center"},children:[d.jsxs("h1",{style:{color:"#2196F3",marginBottom:"30px"},children:[" Semester ",re-1," Complete!"]}),d.jsxs("div",{style:{background:"#e3f2fd",padding:"20px",borderRadius:"8px",marginBottom:"30px",border:"2px solid #2196F3"},children:[d.jsx("h3",{style:{color:"#1976d2",marginBottom:"10px"},children:"Take a Break!"}),d.jsxs("p",{style:{fontSize:"16px",color:"#666",marginBottom:"0"},children:["Great job completing Semester ",re-1,"! Take a moment to rest your eyes, stretch, or grab some water before continuing."]})]}),K&&d.jsxs("div",{style:{background:"linear-gradient(135deg, #fff3cd 0%, #ffebee 100%)",padding:"25px",borderRadius:"8px",marginBottom:"30px",border:"2px solid #ff9800"},children:[d.jsx("h3",{style:{color:"#f57c00",marginBottom:"15px"},children:" Midterm Checkpoint Coming!"}),d.jsxs("div",{style:{fontSize:"16px",color:"#666",textAlign:"left"},children:[d.jsx("p",{style:{marginBottom:"10px"},children:d.jsx("strong",{children:"Semester 2 includes a midterm exam at the 6-minute mark!"})}),d.jsxs("ul",{style:{marginLeft:"20px",marginBottom:"10px"},children:[d.jsx("li",{children:"Your students will be tested at the midpoint"}),d.jsxs("li",{children:["If student learning  50 points:"," ",d.jsx("strong",{children:"+300 bonus points!"})]}),d.jsx("li",{children:"Build up your teaching effectiveness early to maximize the bonus"})]}),d.jsx("p",{style:{background:"white",padding:"10px",borderRadius:"4px",textAlign:"center",fontWeight:"bold",color:"#f57c00"},children:"Goal: Reach 50+ Student Learning by minute 10"})]})]}),Re.length>0&&d.jsxs("div",{style:{background:"#f5f5f5",padding:"20px",borderRadius:"8px",marginBottom:"30px"},children:[d.jsx("h4",{style:{color:"#666",marginBottom:"10px"},children:"Your Performance So Far:"}),Re.map((G,ie)=>d.jsxs("div",{style:{marginBottom:"8px",fontSize:"16px"},children:["Semester ",ie+1,":"," ",d.jsxs("strong",{children:[G.finalScore," points"]})]},ie))]}),d.jsxs("div",{style:{marginTop:"30px"},children:[d.jsxs("button",{onClick:()=>{r("challenge"),vi(),m({g2t1:Date.now()}),Pe.setPageStartTime("g2t1"),Pe.logEvent("semester_start",{semester:re,timestamp:Date.now(),hasCheckpoint:K})},style:{padding:"15px 40px",background:"#4CAF50",color:"white",border:"none",borderRadius:"8px",fontSize:"18px",fontWeight:"bold",cursor:"pointer",boxShadow:"0 4px 6px rgba(0,0,0,0.1)",transition:"all 0.3s"},onMouseOver:G=>{G.currentTarget.style.transform="translateY(-2px)",G.currentTarget.style.boxShadow="0 6px 12px rgba(0,0,0,0.15)"},onMouseOut:G=>{G.currentTarget.style.transform="translateY(0)",G.currentTarget.style.boxShadow="0 4px 6px rgba(0,0,0,0.1)"},children:["I'm Ready - Start Semester ",re]}),d.jsx("p",{style:{marginTop:"15px",fontSize:"14px",color:"#999"},children:"Click when you're ready to continue. The timer will start immediately."})]})]})})}if(n==="landing"){s||i({accuracy:"lenient",limit:"time"});const q=JSON.parse(sessionStorage.getItem("gameConfig")||"{}"),K=q.role==="admin";return d.jsx("div",{className:"app",children:d.jsx("div",{className:"landing-container",children:d.jsxs("div",{className:"landing-card",style:{padding:"40px",maxWidth:"900px"},children:[d.jsxs("h1",{style:{color:"#333",marginBottom:"30px",fontSize:"32px",textAlign:"left"},children:["Can you beat Park? - Semester ",re,"/",Ge]}),d.jsxs("div",{className:"game-info",style:{textAlign:"left"},children:[d.jsxs("div",{style:{marginBottom:"35px",textAlign:"left"},children:[d.jsxs("h3",{style:{color:"#4CAF50",fontSize:"20px",marginBottom:"12px",display:"flex",alignItems:"center",gap:"10px"},children:[d.jsx("span",{style:{fontSize:"24px"},children:""})," Materials"]}),d.jsx("p",{style:{marginLeft:"34px",fontSize:"16px",lineHeight:"1.6",color:"#555"},children:"Create teaching materials - each point directly contributes to your goal points!"})]}),d.jsxs("div",{style:{marginBottom:"35px",textAlign:"left"},children:[d.jsxs("h3",{style:{color:"#9C27B0",fontSize:"20px",marginBottom:"12px",display:"flex",alignItems:"center",gap:"10px"},children:[d.jsx("span",{style:{fontSize:"24px"},children:""})," Research"]}),d.jsx("p",{style:{marginLeft:"34px",fontSize:"16px",lineHeight:"1.6",color:"#555"},children:"Research amplifies your materials! Each point adds +15% multiplier to all materials points."})]}),d.jsxs("div",{style:{marginBottom:"35px",textAlign:"left"},children:[d.jsxs("h3",{style:{color:"#f44336",fontSize:"20px",marginBottom:"12px",display:"flex",alignItems:"center",gap:"10px"},children:[d.jsx("span",{style:{fontSize:"24px"},children:""})," Engagement"]}),d.jsx("p",{style:{marginLeft:"34px",fontSize:"16px",lineHeight:"1.6",color:"#555"},children:"Build interest that compounds! Each point adds 0.15% interest after every task completion."})]}),d.jsxs("div",{style:{background:"#f0f8ff",borderRadius:"8px",padding:"25px",marginBottom:"30px",border:"2px solid #2196F3"},children:[d.jsxs("h3",{style:{color:"#2196F3",fontSize:"20px",marginBottom:"20px",display:"flex",alignItems:"center",gap:"10px"},children:[d.jsx("span",{style:{fontSize:"24px"},children:""})," Student Learning Formula"]}),d.jsxs("div",{style:{background:"white",padding:"18px",borderRadius:"6px",fontFamily:"monospace",fontSize:"18px",textAlign:"center",marginBottom:"20px",border:"1px solid #e0e0e0",lineHeight:"1.8"},children:["Goal = ",d.jsx("strong",{children:"Materials"}),d.jsx("br",{})," (1 + 0.15 ",d.jsx("strong",{children:"Research"})," )",d.jsx("br",{}),"+"," ",d.jsx("strong",{children:"Engagement"})," Interest"]}),d.jsxs("ul",{style:{color:"#333",lineHeight:"2",margin:"0",paddingLeft:"25px",fontSize:"15px",textAlign:"left"},children:[d.jsx("li",{children:"Exact answer = 2 points, Within 1 = 1 point, Otherwise = 0 points"}),d.jsx("li",{children:"Strategic timing matters - early multipliers compound!"}),d.jsx("li",{children:"Maximize student learning through strategic teaching!"}),re===2&&d.jsxs("li",{children:["At minute ",K?"1":"10",": Exam checkpoint with bonus opportunity (50+ Student Learning = 300 bonus)"]})]})]}),q.hasAI&&d.jsxs("div",{style:{background:"#fff3cd",borderRadius:"6px",padding:"15px",marginBottom:"20px",border:"1px solid #ffc107"},children:[d.jsx("h3",{style:{color:"#856404",fontSize:"16px",marginBottom:"10px"},children:"AI Assistant Available:"}),d.jsxs("ul",{style:{color:"#856404",lineHeight:"1.6",margin:"0",paddingLeft:"20px",fontSize:"14px"},children:[d.jsx("li",{children:"Click the help buttons below each task for AI assistance"}),d.jsx("li",{children:"Unlimited use but reliability varies"}),d.jsx("li",{children:'Type "strategy" or "order" in chat for strategic advice!'})]})]}),re===2&&d.jsxs("div",{style:{background:"#fff3cd",borderRadius:"6px",padding:"15px",marginBottom:"20px",border:"2px solid #ffc107"},children:[d.jsx("h3",{style:{color:"#856404",fontSize:"16px",marginBottom:"10px"},children:" Semester 2: Midterm Checkpoint!"}),d.jsx("p",{style:{color:"#856404",fontSize:"14px",margin:0},children:"At the 10-minute mark, if you have 50+ student learning points, you'll earn a 300-point bonus!"})]})]}),!K&&d.jsxs("div",{style:{background:"linear-gradient(135deg, #ffebee 0%, #ffcdd2 100%)",borderRadius:"12px",padding:"20px",marginTop:"20px",marginBottom:"20px",border:"2px solid #d32f2f",boxShadow:"0 4px 6px rgba(211, 47, 47, 0.1)"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"10px",marginBottom:"12px"},children:[d.jsx("span",{style:{fontSize:"24px"},children:""}),d.jsx("h3",{style:{color:"#b71c1c",margin:0,fontSize:"18px",fontWeight:"600"},children:"ONE ATTEMPT ONLY - NO RESTART"})]}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px",marginBottom:"12px"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[d.jsx("span",{style:{color:"#d32f2f",fontSize:"18px"},children:""}),d.jsxs("span",{style:{fontSize:"14px",color:"#c62828"},children:[d.jsx("strong",{children:"No refresh/close"})," - Session ends"]})]}),d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[d.jsx("span",{style:{color:"#d32f2f",fontSize:"18px"},children:""}),d.jsxs("span",{style:{fontSize:"14px",color:"#c62828"},children:[d.jsx("strong",{children:"No tab switching"})," - 30s warning"]})]})]}),d.jsx("div",{style:{background:"white",padding:"10px",borderRadius:"6px",textAlign:"center",fontSize:"14px",color:"#b71c1c",fontWeight:"600"},children:" Ensure 40 minutes uninterrupted before starting"})]}),d.jsxs("button",{className:"start-button",onClick:()=>r("practiceChoice"),children:["Start Semester ",re]}),e&&d.jsxs("div",{style:{marginTop:"20px",padding:"10px",background:"#ffcccb",borderRadius:"6px",border:"2px solid #ff0000",fontWeight:"bold",color:"#d00"},children:["ADMIN MODE: ",Go/60," minute timer, checkpoint at 1 minute"]}),Re.length>0&&d.jsxs("div",{style:{marginTop:"20px",padding:"15px",background:"#e3f2fd",borderRadius:"6px",fontSize:"14px"},children:[d.jsx("strong",{children:"Previous Semesters:"}),Re.map((G,ie)=>d.jsxs("div",{style:{marginTop:"5px"},children:["Semester ",ie+1,": ",G.finalScore," points"]},ie))]})]})})})}if(n==="practiceChoice"){const K=JSON.parse(sessionStorage.getItem("gameConfig")||"{}").role==="admin";return d.jsx("div",{className:"app",children:d.jsx("div",{className:"landing-container",children:d.jsxs("div",{className:"landing-card",children:[d.jsx("h2",{style:{color:"#333",marginBottom:"20px"},children:K?"Practice Mode (Optional for Admin)":"Practice Mode (Required)"}),d.jsx("p",{style:{color:"#666",marginBottom:"20px"},children:K?"As an admin, you can skip practice or try it first.":"You must complete all three practice tasks before starting the main game."}),d.jsx("p",{style:{color:"#888",fontSize:"14px",marginBottom:"30px",fontStyle:"italic"},children:"Practice lets you try each teaching task without time pressure."}),!K&&d.jsxs("div",{style:{background:"linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%)",borderRadius:"12px",padding:"20px",marginBottom:"20px",border:"2px solid #1976d2",boxShadow:"0 4px 6px rgba(25, 118, 210, 0.1)"},children:[d.jsxs("h4",{style:{color:"#0d47a1",margin:"0 0 16px 0",fontSize:"18px",fontWeight:"600",display:"flex",alignItems:"center",gap:"8px"},children:[d.jsx("span",{style:{fontSize:"20px"},children:""}),"Required Practice Tasks (100% accuracy needed):"]}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",padding:"12px 16px",background:$e.g2t1?"#e8f5e9":"white",borderRadius:"8px",border:`1px solid ${$e.g2t1?"#4CAF50":"#e0e0e0"}`},children:[d.jsx("span",{style:{fontSize:"24px",marginRight:"12px"},children:""}),d.jsx("span",{style:{flex:1,fontSize:"15px",color:"#424242"},children:d.jsx("strong",{children:"Materials"})}),$e.g2t1?d.jsx("span",{style:{color:"#4CAF50",fontSize:"20px",fontWeight:"bold"},children:""}):d.jsx("span",{style:{background:"#fff3cd",color:"#f57c00",padding:"4px 12px",borderRadius:"12px",fontSize:"12px",fontWeight:"600"},children:"PENDING"})]}),d.jsxs("div",{style:{display:"flex",alignItems:"center",padding:"12px 16px",background:$e.g1t1?"#e8f5e9":"white",borderRadius:"8px",border:`1px solid ${$e.g1t1?"#4CAF50":"#e0e0e0"}`},children:[d.jsx("span",{style:{fontSize:"24px",marginRight:"12px"},children:""}),d.jsx("span",{style:{flex:1,fontSize:"15px",color:"#424242"},children:d.jsx("strong",{children:"Research"})}),$e.g1t1?d.jsx("span",{style:{color:"#4CAF50",fontSize:"20px",fontWeight:"bold"},children:""}):d.jsx("span",{style:{background:"#fff3cd",color:"#f57c00",padding:"4px 12px",borderRadius:"12px",fontSize:"12px",fontWeight:"600"},children:"PENDING"})]}),d.jsxs("div",{style:{display:"flex",alignItems:"center",padding:"12px 16px",background:$e.g3t1?"#e8f5e9":"white",borderRadius:"8px",border:`1px solid ${$e.g3t1?"#4CAF50":"#e0e0e0"}`},children:[d.jsx("span",{style:{fontSize:"24px",marginRight:"12px"},children:""}),d.jsx("span",{style:{flex:1,fontSize:"15px",color:"#424242"},children:d.jsx("strong",{children:"Engagement"})}),$e.g3t1?d.jsx("span",{style:{color:"#4CAF50",fontSize:"20px",fontWeight:"bold"},children:""}):d.jsx("span",{style:{background:"#fff3cd",color:"#f57c00",padding:"4px 12px",borderRadius:"12px",fontSize:"12px",fontWeight:"600"},children:"PENDING"})]})]}),d.jsx("div",{style:{marginTop:"16px",padding:"8px 12px",background:"rgba(255, 255, 255, 0.8)",borderRadius:"6px",fontSize:"13px",color:"#0d47a1",textAlign:"center",fontStyle:"italic"},children:" Each task must be completed perfectly to proceed"})]}),d.jsxs("div",{style:{display:"flex",gap:"20px",justifyContent:"center"},children:[d.jsx("button",{onClick:()=>$r("yes"),style:{padding:"15px 30px",background:"#4CAF50",color:"white",border:"none",borderRadius:"6px",fontSize:"16px",cursor:"pointer"},children:K?"Try Practice Mode":"Start Required Practice"}),K&&d.jsx("button",{onClick:()=>$r("no"),style:{padding:"15px 30px",background:"#2196F3",color:"white",border:"none",borderRadius:"6px",fontSize:"16px",cursor:"pointer"},children:"Skip Practice (Admin)"})]})]})})})}if(n==="practice"){const K=JSON.parse(sessionStorage.getItem("gameConfig")||"{}").role==="admin";if(!kn)return d.jsxs("div",{className:"app",children:[d.jsx("h1",{children:"Teaching Simulation - Practice Mode"}),d.jsx(hI,{practiceCompleted:$e,onPracticeComplete:Kt,onSelectPractice:lr,onStartMainGame:()=>{const Ie=$e.g2t1&&$e.g1t1&&$e.g3t1;!K&&!Ie?We("You must complete all three practice tasks first!"):_i()},isAdmin:K})]});const G=kn[1],ie=1;return d.jsx("div",{className:"app",children:d.jsxs("div",{style:{padding:"20px",maxWidth:"1200px",margin:"0 auto"},children:[d.jsx("button",{onClick:()=>lr(null),style:{marginBottom:"20px",padding:"10px 20px",background:"#666",color:"white",border:"none",borderRadius:"6px",cursor:"pointer"},children:" Back to Practice Menu"}),d.jsxs("div",{style:{textAlign:"center",padding:"10px",background:"#fff3cd",borderRadius:"6px",margin:"10px 0",fontSize:"14px",color:"#856404"},children:[d.jsx("strong",{children:"Practice Mode:"})," 100% accuracy required. Will auto-return after completion."]}),G==="1"&&d.jsx(pd,{taskNum:ie,onComplete:Kt,currentTaskId:kn,isPractice:!0}),G==="2"&&d.jsx(gd,{taskNum:ie,onComplete:Kt,currentTaskId:kn,isPractice:!0}),G==="3"&&d.jsx(md,{taskNum:ie,onComplete:Kt,currentTaskId:kn,isPractice:!0})]})})}if(n==="complete"){const q=Math.floor(j/60),K=j%60,G=Math.round(mn()),ie=Se.bonus||0,Ie=G+ie,Oe={semester:re,totalTime:j,completedLevels:v,categoryPoints:Se,switches:S,gameMode:s,randomSeed:$t,studentLearningScore:G,finalScore:Ie},nt=async()=>{const at=[...Re,Oe];_t(at),localStorage.setItem("engagementInterest","0"),Rn({materials:0,research:0,engagement:0,bonus:0}),R&&!R.startsWith("offline-")&&await Gn(un(et,"sessions",R),{[`semesterHistory.semester${re}`]:Oe,currentSemester:re+1,lastActivity:en()}),ke(re+1),r("semesterBreak"),g({}),k(0),E(0),x(0),T(0),we(0),h("g2t1"),qt(!1);const Ye=Math.floor(Math.random()*1e6);Wt(Ye),Jn.initializeSeed(Ye)},kt=re>=Ge;return d.jsxs("div",{className:"app",children:[d.jsxs("div",{style:{maxWidth:"800px",margin:"0 auto",padding:"20px"},children:[d.jsx("div",{style:{textAlign:"center",marginBottom:"20px",padding:"15px",background:"#e3f2fd",borderRadius:"8px",border:"2px solid #2196F3"},children:d.jsxs("h2",{style:{color:"#2196F3",margin:0},children:["Semester ",re," of ",Ge," Complete!"]})}),kt&&d.jsx(yI,{sessionId:R,completedLevels:v,totalTime:j,gameMode:s}),d.jsxs("div",{style:{textAlign:"center",padding:"40px",background:"white",borderRadius:"12px",boxShadow:"0 2px 10px rgba(0,0,0,0.1)",marginTop:"20px"},children:[d.jsxs("h2",{style:{color:"#333",marginBottom:"20px"},children:[" Semester ",re," Performance"]}),d.jsxs("div",{style:{fontSize:"36px",fontWeight:"bold",color:"#2196F3",marginBottom:"30px"},children:["Final Score: ",Ie," points"]}),d.jsxs("div",{style:{background:"#e3f2fd",padding:"20px",borderRadius:"8px",marginBottom:"30px",border:"2px solid #2196F3"},children:[d.jsxs("h3",{style:{margin:"0 0 15px 0",color:"#1976d2"},children:["Student Learning Score: ",G]}),d.jsxs("div",{style:{fontSize:"16px",color:"#666"},children:["= ",Se.materials||0," (Materials) "," ",(1+(Se.research||0)*.15).toFixed(2)," ","(Research)",parseFloat(localStorage.getItem("engagementInterest")||"0")>0&&` + ${parseFloat(localStorage.getItem("engagementInterest")||"0").toFixed(2)} (Interest)`]}),ie>0&&d.jsxs("div",{style:{marginTop:"10px",fontSize:"16px",color:"#1976d2"},children:["+ ",ie," Checkpoint Bonus"]})]}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(150px, 1fr))",gap:"15px",marginBottom:"30px"},children:[d.jsxs("div",{style:{background:"#f8f9fa",padding:"20px",borderRadius:"8px",border:"2px solid #e0e0e0"},children:[d.jsx("div",{style:{fontSize:"14px",color:"#666",marginBottom:"5px"},children:"Total Time"}),d.jsxs("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#333"},children:[q,"m ",K,"s"]})]}),d.jsxs("div",{style:{background:"#f8f9fa",padding:"20px",borderRadius:"8px",border:"2px solid #e0e0e0"},children:[d.jsx("div",{style:{fontSize:"14px",color:"#666",marginBottom:"5px"},children:"Student Learning"}),d.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#333"},children:G})]}),(re===2||ie>0)&&d.jsxs("div",{style:{background:"#f8f9fa",padding:"20px",borderRadius:"8px",border:"2px solid #e0e0e0"},children:[d.jsx("div",{style:{fontSize:"14px",color:"#666",marginBottom:"5px"},children:"Checkpoint Bonus"}),d.jsxs("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#333"},children:["+",ie]})]}),d.jsxs("div",{style:{background:"#f8f9fa",padding:"20px",borderRadius:"8px",border:"2px solid #e0e0e0"},children:[d.jsx("div",{style:{fontSize:"14px",color:"#666",marginBottom:"5px"},children:"Tasks Completed"}),d.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#333"},children:v})]})]}),d.jsx("h3",{style:{color:"#666",marginBottom:"15px"},children:"Teaching Performance by Category"}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"15px",marginBottom:"30px"},children:[d.jsxs("div",{style:{background:"#f0f8f0",padding:"15px",borderRadius:"6px",border:"2px solid #4CAF5020"},children:[d.jsx("div",{style:{color:"#4CAF50",fontWeight:"bold",marginBottom:"5px"},children:" Materials"}),d.jsx("div",{style:{fontSize:"20px",fontWeight:"bold"},children:Se.materials||0}),d.jsx("div",{style:{fontSize:"12px",color:"#666"},children:"Base points"})]}),d.jsxs("div",{style:{background:"#f8f0ff",padding:"15px",borderRadius:"6px",border:"2px solid #9C27B020"},children:[d.jsx("div",{style:{color:"#9C27B0",fontWeight:"bold",marginBottom:"5px"},children:" Research"}),d.jsx("div",{style:{fontSize:"20px",fontWeight:"bold"},children:Se.research||0}),d.jsxs("div",{style:{fontSize:"12px",color:"#666"},children:["+",(Se.research||0)*15,"% multiplier"]})]}),d.jsxs("div",{style:{background:"#fff0f0",padding:"15px",borderRadius:"6px",border:"2px solid #f4433620"},children:[d.jsx("div",{style:{color:"#f44336",fontWeight:"bold",marginBottom:"5px"},children:" Engagement"}),d.jsx("div",{style:{fontSize:"20px",fontWeight:"bold"},children:Se.engagement||0}),d.jsxs("div",{style:{fontSize:"12px",color:"#666"},children:["+",((Se.engagement||0)*.15).toFixed(1),"% interest/task"]})]})]})]}),re===2&&Se.bonus>0&&d.jsxs("div",{style:{marginBottom:"20px",padding:"15px",background:"#fff3cd",borderRadius:"6px",border:"1px solid #ffc107"},children:[d.jsxs("strong",{style:{color:"#856404"},children:[" Exam Season Bonus:"," "]}),d.jsxs("span",{style:{fontSize:"18px",fontWeight:"bold",color:"#856404"},children:["+",Se.bonus," points"]})]}),Re.length>0&&d.jsxs("div",{style:{marginTop:"30px",padding:"20px",background:"#f8f9fa",borderRadius:"8px"},children:[d.jsx("h4",{style:{color:"#666",marginBottom:"15px"},children:"Progress Over Semesters"}),d.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(100px, 1fr))",gap:"10px"},children:[...Re,Oe].map((at,Ye)=>d.jsxs("div",{style:{padding:"10px",background:Ye===Re.length?"#e3f2fd":"white",borderRadius:"6px",border:"1px solid #e0e0e0",textAlign:"center"},children:[d.jsxs("div",{style:{fontSize:"12px",color:"#666"},children:["Semester ",Ye+1]}),d.jsx("div",{style:{fontSize:"18px",fontWeight:"bold",color:"#333"},children:at.finalScore})]},Ye))})]})]}),d.jsx("div",{style:{marginTop:"30px",textAlign:"center"},children:kt?d.jsxs("div",{style:{padding:"20px",background:"#fff3cd",border:"2px solid #ffc107",borderRadius:"8px",textAlign:"center"},children:[d.jsx("h3",{style:{color:"#856404",marginBottom:"10px"},children:" All semesters complete!"}),d.jsx("p",{style:{color:"#856404",marginBottom:"0"},children:"Return to the Qualtrics survey and enter your completion code to finish the study."})]}):d.jsxs("button",{onClick:nt,style:{padding:"15px 40px",background:"#4CAF50",color:"white",border:"none",borderRadius:"8px",fontSize:"18px",fontWeight:"bold",cursor:"pointer",boxShadow:"0 4px 6px rgba(0,0,0,0.1)"},children:["Start Semester ",re+1," "]})})]})}return d.jsxs("div",{className:"app",children:[W&&te==="checkpoint"&&d.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",background:"rgba(0, 0, 0, 0.8)",zIndex:999999,display:"flex",alignItems:"center",justifyContent:"center"},children:d.jsxs("div",{style:{background:"white",padding:"40px",borderRadius:"12px",textAlign:"center",maxWidth:"700px",width:"90%",maxHeight:"90vh",overflow:"auto"},children:[d.jsx("h2",{style:{color:"#4CAF50",marginBottom:"25px",fontSize:"28px"},children:" Midterm Exam Results!"}),d.jsxs("div",{style:{fontSize:"18px",marginBottom:"25px",padding:"20px",background:"#f8f9fa",borderRadius:"8px"},children:[d.jsx("p",{style:{marginBottom:"15px"},children:"The midterm exam has arrived! Let's see how your students performed..."}),d.jsxs("div",{style:{fontSize:"20px",fontWeight:"bold",color:"#1976d2",padding:"15px",background:"white",borderRadius:"6px",margin:"15px 0"},children:["Student Learning Score: ",Math.round(mn())," ","pts"]})]}),d.jsxs("div",{style:{marginBottom:"25px",padding:"20px",background:"#e3f2fd",borderRadius:"8px",textAlign:"left"},children:[d.jsx("h3",{style:{marginBottom:"15px",textAlign:"center"},children:"Your Teaching Performance:"}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"10px"},children:[d.jsxs("div",{style:{padding:"10px",background:"white",borderRadius:"6px",textAlign:"center"},children:[d.jsx("div",{style:{color:"#4CAF50",fontWeight:"bold"},children:"Materials"}),d.jsxs("div",{style:{fontSize:"20px"},children:[Se.materials," pts"]})]}),d.jsxs("div",{style:{padding:"10px",background:"white",borderRadius:"6px",textAlign:"center"},children:[d.jsx("div",{style:{color:"#9C27B0",fontWeight:"bold"},children:"Research"}),d.jsxs("div",{style:{fontSize:"20px"},children:[Se.research," pts"]}),d.jsxs("div",{style:{fontSize:"12px",color:"#666"},children:["",(1+Se.research*.15).toFixed(2)]})]}),d.jsxs("div",{style:{padding:"10px",background:"white",borderRadius:"6px",textAlign:"center"},children:[d.jsx("div",{style:{color:"#f44336",fontWeight:"bold"},children:"Engagement"}),d.jsxs("div",{style:{fontSize:"20px"},children:[Se.engagement," pts"]}),d.jsxs("div",{style:{fontSize:"12px",color:"#666"},children:["+",(Se.engagement*.15).toFixed(1),"% interest"]})]})]})]}),d.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",padding:"20px",borderRadius:"8px",marginBottom:"25px",background:Gt>0?"linear-gradient(135deg, #c8e6c9 0%, #a5d6a7 100%)":"linear-gradient(135deg, #fff3cd 0%, #ffe082 100%)",border:`2px solid ${Gt>0?"#4CAF50":"#ff9800"}`,color:Gt>0?"#2e7d32":"#f57c00"},children:re===2?Gt>0?d.jsxs(d.Fragment,{children:[" Excellent Teaching! +",Gt," bonus points earned!"]}):d.jsxs(d.Fragment,{children:[" Goal was 50+ points (you had"," ",Math.round(mn()),"). Keep teaching!"]}):d.jsx(d.Fragment,{children:"Checkpoint reached! Keep going!"})}),d.jsxs("div",{style:{marginBottom:"20px",padding:"15px",background:"#f5f5f5",borderRadius:"6px",fontSize:"14px",color:"#666",textAlign:"left"},children:[d.jsx("strong",{children:"Tips for the rest of the semester:"}),d.jsxs("ul",{style:{margin:"10px 0 0 20px",lineHeight:"1.6"},children:[d.jsx("li",{children:"You have about 6 minutes remaining"}),d.jsx("li",{children:"Focus on accuracy - every point counts!"}),d.jsx("li",{children:"Research multiplies everything, Engagement compounds over time"}),d.jsx("li",{children:"Materials give direct points - use them strategically"})]})]}),d.jsx("button",{onClick:()=>{X(!1),U(null)},style:{padding:"12px 35px",background:"#2196F3",color:"white",border:"none",borderRadius:"6px",fontSize:"16px",fontWeight:"bold",cursor:"pointer",boxShadow:"0 3px 6px rgba(0,0,0,0.15)",transition:"all 0.3s"},onMouseOver:q=>{q.currentTarget.style.transform="translateY(-2px)",q.currentTarget.style.boxShadow="0 5px 10px rgba(0,0,0,0.2)"},onMouseOut:q=>{q.currentTarget.style.transform="translateY(0)",q.currentTarget.style.boxShadow="0 3px 6px rgba(0,0,0,0.15)"},children:"Continue Teaching "}),d.jsx("p",{style:{marginTop:"10px",color:"#999",fontSize:"12px"},children:"The timer is paused. Click to continue when ready."})]})}),de&&d.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",background:"rgba(0, 0, 0, 0.9)",zIndex:999999,display:"flex",alignItems:"center",justifyContent:"center"},children:d.jsxs("div",{style:{background:"white",padding:"40px",borderRadius:"10px",textAlign:"center",maxWidth:"500px"},children:[d.jsx("h2",{style:{color:"#f44336",marginBottom:"20px"},children:"Session Ended"}),d.jsx("p",{style:{marginBottom:"30px"},children:"Your session has been terminated due to inactivity or switching away from the game."}),d.jsx("p",{style:{color:"#c62828",fontWeight:"bold"},children:"You cannot restart. This was your only attempt."})]})}),N&&d.jsxs("div",{style:{position:"fixed",top:"20px",right:"20px",background:"#ff9800",color:"white",padding:"15px 20px",borderRadius:"8px",zIndex:1e4,boxShadow:"0 4px 6px rgba(0,0,0,0.1)"},children:[d.jsx("strong",{children:" Focus Warning"}),d.jsx("br",{}),"Game will be blocked in ",H," seconds"]}),ee&&d.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",background:"rgba(0, 0, 0, 0.7)",zIndex:1e4,display:"flex",alignItems:"center",justifyContent:"center"},children:d.jsxs("div",{style:{background:"white",padding:"30px",borderRadius:"10px",textAlign:"center",maxWidth:"400px"},children:[d.jsx("h3",{style:{color:"#ff9800",marginBottom:"15px"},children:"Are you still there?"}),d.jsxs("p",{style:{marginBottom:"20px"},children:["Auto-closing in ",Ae," seconds due to inactivity"]}),d.jsx("button",{onClick:()=>{oe(!1),ge(5),gn.current=Date.now()},style:{padding:"10px 20px",background:"#4CAF50",color:"white",border:"none",borderRadius:"6px",cursor:"pointer"},children:"Continue Playing"})]})}),d.jsxs("div",{style:{padding:"20px",maxWidth:"1400px",margin:"0 auto"},children:[d.jsxs("h1",{style:{marginBottom:"30px",textAlign:"center"},children:["Can you beat Park? - Semester ",re,"/",Ge]}),d.jsx(dI,{current:u,completed:p,onSwitch:xi,limitMode:"time",taskPoints:gi,categoryMultipliers:{},starGoals:{},categoryPoints:Se,timeRemaining:tt}),d.jsxs("div",{style:{display:"flex",gap:"20px",alignItems:"stretch",marginTop:"20px",minHeight:"650px",width:"100%"},children:[d.jsx("div",{style:{flex:"0 0 66.666%",minHeight:"650px",display:"flex",alignItems:"center",justifyContent:"center",background:"white",borderRadius:"8px",border:"1px solid #e0e0e0",overflow:"visible"},children:d.jsx("div",{className:"task-container",style:{width:"100%",minHeight:"650px",padding:"20px",display:"flex",alignItems:"center",justifyContent:"center",overflow:"visible"},children:Wr()})}),d.jsx("div",{style:{flex:"0 0 33.333%",background:"white",borderRadius:"8px",border:"1px solid #e0e0e0",overflow:"visible",height:"680px",display:"flex",flexDirection:"column"},children:d.jsx(pI,{bonusPrompts:A,currentTask:u,categoryPoints:Se,categoryMultipliers:{},starGoals:{},timeRemaining:tt,calculateStudentLearning:mn,onAIHelp:q=>{window.dispatchEvent(new CustomEvent("aiHelp",{detail:q}))}})})]})]})]})}Yy(document.getElementById("root")).render(d.jsx(L.StrictMode,{children:d.jsx(xI,{})}));
//# sourceMappingURL=index-DKuWBkiA.js.map
