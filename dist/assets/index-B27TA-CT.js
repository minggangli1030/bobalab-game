(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();var Om={exports:{}},Rl={},Fm={exports:{}},fe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jo=Symbol.for("react.element"),Xv=Symbol.for("react.portal"),Jv=Symbol.for("react.fragment"),Zv=Symbol.for("react.strict_mode"),e_=Symbol.for("react.profiler"),t_=Symbol.for("react.provider"),n_=Symbol.for("react.context"),r_=Symbol.for("react.forward_ref"),s_=Symbol.for("react.suspense"),i_=Symbol.for("react.memo"),o_=Symbol.for("react.lazy"),Rf=Symbol.iterator;function a_(t){return t===null||typeof t!="object"?null:(t=Rf&&t[Rf]||t["@@iterator"],typeof t=="function"?t:null)}var zm={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Bm=Object.assign,Um={};function ui(t,e,n){this.props=t,this.context=e,this.refs=Um,this.updater=n||zm}ui.prototype.isReactComponent={};ui.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};ui.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function $m(){}$m.prototype=ui.prototype;function yd(t,e,n){this.props=t,this.context=e,this.refs=Um,this.updater=n||zm}var vd=yd.prototype=new $m;vd.constructor=yd;Bm(vd,ui.prototype);vd.isPureReactComponent=!0;var Pf=Array.isArray,Wm=Object.prototype.hasOwnProperty,_d={current:null},Hm={key:!0,ref:!0,__self:!0,__source:!0};function qm(t,e,n){var r,s={},i=null,a=null;if(e!=null)for(r in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(i=""+e.key),e)Wm.call(e,r)&&!Hm.hasOwnProperty(r)&&(s[r]=e[r]);var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){for(var u=Array(l),h=0;h<l;h++)u[h]=arguments[h+2];s.children=u}if(t&&t.defaultProps)for(r in l=t.defaultProps,l)s[r]===void 0&&(s[r]=l[r]);return{$$typeof:jo,type:t,key:i,ref:a,props:s,_owner:_d.current}}function l_(t,e){return{$$typeof:jo,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function xd(t){return typeof t=="object"&&t!==null&&t.$$typeof===jo}function u_(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var bf=/\/+/g;function _u(t,e){return typeof t=="object"&&t!==null&&t.key!=null?u_(""+t.key):e.toString(36)}function Pa(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(i){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case jo:case Xv:a=!0}}if(a)return a=t,s=s(a),t=r===""?"."+_u(a,0):r,Pf(s)?(n="",t!=null&&(n=t.replace(bf,"$&/")+"/"),Pa(s,e,n,"",function(h){return h})):s!=null&&(xd(s)&&(s=l_(s,n+(!s.key||a&&a.key===s.key?"":(""+s.key).replace(bf,"$&/")+"/")+t)),e.push(s)),1;if(a=0,r=r===""?".":r+":",Pf(t))for(var l=0;l<t.length;l++){i=t[l];var u=r+_u(i,l);a+=Pa(i,e,n,u,s)}else if(u=a_(t),typeof u=="function")for(t=u.call(t),l=0;!(i=t.next()).done;)i=i.value,u=r+_u(i,l++),a+=Pa(i,e,n,u,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function ua(t,e,n){if(t==null)return t;var r=[],s=0;return Pa(t,r,"","",function(i){return e.call(n,i,s++)}),r}function c_(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Vt={current:null},ba={transition:null},d_={ReactCurrentDispatcher:Vt,ReactCurrentBatchConfig:ba,ReactCurrentOwner:_d};function Gm(){throw Error("act(...) is not supported in production builds of React.")}fe.Children={map:ua,forEach:function(t,e,n){ua(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return ua(t,function(){e++}),e},toArray:function(t){return ua(t,function(e){return e})||[]},only:function(t){if(!xd(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};fe.Component=ui;fe.Fragment=Jv;fe.Profiler=e_;fe.PureComponent=yd;fe.StrictMode=Zv;fe.Suspense=s_;fe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=d_;fe.act=Gm;fe.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=Bm({},t.props),s=t.key,i=t.ref,a=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,a=_d.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(u in e)Wm.call(e,u)&&!Hm.hasOwnProperty(u)&&(r[u]=e[u]===void 0&&l!==void 0?l[u]:e[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){l=Array(u);for(var h=0;h<u;h++)l[h]=arguments[h+2];r.children=l}return{$$typeof:jo,type:t.type,key:s,ref:i,props:r,_owner:a}};fe.createContext=function(t){return t={$$typeof:n_,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:t_,_context:t},t.Consumer=t};fe.createElement=qm;fe.createFactory=function(t){var e=qm.bind(null,t);return e.type=t,e};fe.createRef=function(){return{current:null}};fe.forwardRef=function(t){return{$$typeof:r_,render:t}};fe.isValidElement=xd;fe.lazy=function(t){return{$$typeof:o_,_payload:{_status:-1,_result:t},_init:c_}};fe.memo=function(t,e){return{$$typeof:i_,type:t,compare:e===void 0?null:e}};fe.startTransition=function(t){var e=ba.transition;ba.transition={};try{t()}finally{ba.transition=e}};fe.unstable_act=Gm;fe.useCallback=function(t,e){return Vt.current.useCallback(t,e)};fe.useContext=function(t){return Vt.current.useContext(t)};fe.useDebugValue=function(){};fe.useDeferredValue=function(t){return Vt.current.useDeferredValue(t)};fe.useEffect=function(t,e){return Vt.current.useEffect(t,e)};fe.useId=function(){return Vt.current.useId()};fe.useImperativeHandle=function(t,e,n){return Vt.current.useImperativeHandle(t,e,n)};fe.useInsertionEffect=function(t,e){return Vt.current.useInsertionEffect(t,e)};fe.useLayoutEffect=function(t,e){return Vt.current.useLayoutEffect(t,e)};fe.useMemo=function(t,e){return Vt.current.useMemo(t,e)};fe.useReducer=function(t,e,n){return Vt.current.useReducer(t,e,n)};fe.useRef=function(t){return Vt.current.useRef(t)};fe.useState=function(t){return Vt.current.useState(t)};fe.useSyncExternalStore=function(t,e,n){return Vt.current.useSyncExternalStore(t,e,n)};fe.useTransition=function(){return Vt.current.useTransition()};fe.version="18.3.1";Fm.exports=fe;var L=Fm.exports;/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var h_=L,f_=Symbol.for("react.element"),p_=Symbol.for("react.fragment"),m_=Object.prototype.hasOwnProperty,g_=h_.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,y_={key:!0,ref:!0,__self:!0,__source:!0};function Qm(t,e,n){var r,s={},i=null,a=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(a=e.ref);for(r in e)m_.call(e,r)&&!y_.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:f_,type:t,key:i,ref:a,props:s,_owner:g_.current}}Rl.Fragment=p_;Rl.jsx=Qm;Rl.jsxs=Qm;Om.exports=Rl;var d=Om.exports,Km={exports:{}},sn={},Ym={exports:{}},Xm={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(N,F){var W=N.length;N.push(F);e:for(;0<W;){var te=W-1>>>1,Z=N[te];if(0<s(Z,F))N[te]=F,N[W]=Z,W=te;else break e}}function n(N){return N.length===0?null:N[0]}function r(N){if(N.length===0)return null;var F=N[0],W=N.pop();if(W!==F){N[0]=W;e:for(var te=0,Z=N.length,oe=Z>>>1;te<oe;){var Ae=2*(te+1)-1,me=N[Ae],he=Ae+1,de=N[he];if(0>s(me,W))he<Z&&0>s(de,me)?(N[te]=de,N[he]=W,te=he):(N[te]=me,N[Ae]=W,te=Ae);else if(he<Z&&0>s(de,W))N[te]=de,N[he]=W,te=he;else break e}}return F}function s(N,F){var W=N.sortIndex-F.sortIndex;return W!==0?W:N.id-F.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var a=Date,l=a.now();t.unstable_now=function(){return a.now()-l}}var u=[],h=[],p=1,y=null,m=3,C=!1,R=!1,P=!1,O=typeof setTimeout=="function"?setTimeout:null,k=typeof clearTimeout=="function"?clearTimeout:null,A=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(N){for(var F=n(h);F!==null;){if(F.callback===null)r(h);else if(F.startTime<=N)r(h),F.sortIndex=F.expirationTime,e(u,F);else break;F=n(h)}}function b(N){if(P=!1,w(N),!R)if(n(u)!==null)R=!0,U(j);else{var F=n(h);F!==null&&B(b,F.startTime-N)}}function j(N,F){R=!1,P&&(P=!1,k(v),v=-1),C=!0;var W=m;try{for(w(F),y=n(u);y!==null&&(!(y.expirationTime>F)||N&&!_());){var te=y.callback;if(typeof te=="function"){y.callback=null,m=y.priorityLevel;var Z=te(y.expirationTime<=F);F=t.unstable_now(),typeof Z=="function"?y.callback=Z:y===n(u)&&r(u),w(F)}else r(u);y=n(u)}if(y!==null)var oe=!0;else{var Ae=n(h);Ae!==null&&B(b,Ae.startTime-F),oe=!1}return oe}finally{y=null,m=W,C=!1}}var M=!1,S=null,v=-1,T=5,I=-1;function _(){return!(t.unstable_now()-I<T)}function E(){if(S!==null){var N=t.unstable_now();I=N;var F=!0;try{F=S(!0,N)}finally{F?x():(M=!1,S=null)}}else M=!1}var x;if(typeof A=="function")x=function(){A(E)};else if(typeof MessageChannel<"u"){var X=new MessageChannel,G=X.port2;X.port1.onmessage=E,x=function(){G.postMessage(null)}}else x=function(){O(E,0)};function U(N){S=N,M||(M=!0,x())}function B(N,F){v=O(function(){N(t.unstable_now())},F)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(N){N.callback=null},t.unstable_continueExecution=function(){R||C||(R=!0,U(j))},t.unstable_forceFrameRate=function(N){0>N||125<N?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<N?Math.floor(1e3/N):5},t.unstable_getCurrentPriorityLevel=function(){return m},t.unstable_getFirstCallbackNode=function(){return n(u)},t.unstable_next=function(N){switch(m){case 1:case 2:case 3:var F=3;break;default:F=m}var W=m;m=F;try{return N()}finally{m=W}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(N,F){switch(N){case 1:case 2:case 3:case 4:case 5:break;default:N=3}var W=m;m=N;try{return F()}finally{m=W}},t.unstable_scheduleCallback=function(N,F,W){var te=t.unstable_now();switch(typeof W=="object"&&W!==null?(W=W.delay,W=typeof W=="number"&&0<W?te+W:te):W=te,N){case 1:var Z=-1;break;case 2:Z=250;break;case 5:Z=1073741823;break;case 4:Z=1e4;break;default:Z=5e3}return Z=W+Z,N={id:p++,callback:F,priorityLevel:N,startTime:W,expirationTime:Z,sortIndex:-1},W>te?(N.sortIndex=W,e(h,N),n(u)===null&&N===n(h)&&(P?(k(v),v=-1):P=!0,B(b,W-te))):(N.sortIndex=Z,e(u,N),R||C||(R=!0,U(j))),N},t.unstable_shouldYield=_,t.unstable_wrapCallback=function(N){var F=m;return function(){var W=m;m=F;try{return N.apply(this,arguments)}finally{m=W}}}})(Xm);Ym.exports=Xm;var v_=Ym.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var __=L,rn=v_;function H(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Jm=new Set,oo={};function fs(t,e){Ks(t,e),Ks(t+"Capture",e)}function Ks(t,e){for(oo[t]=e,t=0;t<e.length;t++)Jm.add(e[t])}var Zn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ec=Object.prototype.hasOwnProperty,x_=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Df={},Nf={};function w_(t){return ec.call(Nf,t)?!0:ec.call(Df,t)?!1:x_.test(t)?Nf[t]=!0:(Df[t]=!0,!1)}function S_(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function E_(t,e,n,r){if(e===null||typeof e>"u"||S_(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Mt(t,e,n,r,s,i,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=a}var vt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){vt[t]=new Mt(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];vt[e]=new Mt(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){vt[t]=new Mt(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){vt[t]=new Mt(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){vt[t]=new Mt(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){vt[t]=new Mt(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){vt[t]=new Mt(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){vt[t]=new Mt(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){vt[t]=new Mt(t,5,!1,t.toLowerCase(),null,!1,!1)});var wd=/[\-:]([a-z])/g;function Sd(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(wd,Sd);vt[e]=new Mt(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(wd,Sd);vt[e]=new Mt(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(wd,Sd);vt[e]=new Mt(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){vt[t]=new Mt(t,1,!1,t.toLowerCase(),null,!1,!1)});vt.xlinkHref=new Mt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){vt[t]=new Mt(t,1,!1,t.toLowerCase(),null,!0,!0)});function Ed(t,e,n,r){var s=vt.hasOwnProperty(e)?vt[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(E_(e,n,s,r)&&(n=null),r||s===null?w_(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var or=__.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ca=Symbol.for("react.element"),Ps=Symbol.for("react.portal"),bs=Symbol.for("react.fragment"),Td=Symbol.for("react.strict_mode"),tc=Symbol.for("react.profiler"),Zm=Symbol.for("react.provider"),eg=Symbol.for("react.context"),Id=Symbol.for("react.forward_ref"),nc=Symbol.for("react.suspense"),rc=Symbol.for("react.suspense_list"),Ad=Symbol.for("react.memo"),pr=Symbol.for("react.lazy"),tg=Symbol.for("react.offscreen"),jf=Symbol.iterator;function Ri(t){return t===null||typeof t!="object"?null:(t=jf&&t[jf]||t["@@iterator"],typeof t=="function"?t:null)}var Be=Object.assign,xu;function Oi(t){if(xu===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);xu=e&&e[1]||""}return`
`+xu+t}var wu=!1;function Su(t,e){if(!t||wu)return"";wu=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(h){var r=h}Reflect.construct(t,[],e)}else{try{e.call()}catch(h){r=h}t.call(e.prototype)}else{try{throw Error()}catch(h){r=h}t()}}catch(h){if(h&&r&&typeof h.stack=="string"){for(var s=h.stack.split(`
`),i=r.stack.split(`
`),a=s.length-1,l=i.length-1;1<=a&&0<=l&&s[a]!==i[l];)l--;for(;1<=a&&0<=l;a--,l--)if(s[a]!==i[l]){if(a!==1||l!==1)do if(a--,l--,0>l||s[a]!==i[l]){var u=`
`+s[a].replace(" at new "," at ");return t.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",t.displayName)),u}while(1<=a&&0<=l);break}}}finally{wu=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Oi(t):""}function T_(t){switch(t.tag){case 5:return Oi(t.type);case 16:return Oi("Lazy");case 13:return Oi("Suspense");case 19:return Oi("SuspenseList");case 0:case 2:case 15:return t=Su(t.type,!1),t;case 11:return t=Su(t.type.render,!1),t;case 1:return t=Su(t.type,!0),t;default:return""}}function sc(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case bs:return"Fragment";case Ps:return"Portal";case tc:return"Profiler";case Td:return"StrictMode";case nc:return"Suspense";case rc:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case eg:return(t.displayName||"Context")+".Consumer";case Zm:return(t._context.displayName||"Context")+".Provider";case Id:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Ad:return e=t.displayName||null,e!==null?e:sc(t.type)||"Memo";case pr:e=t._payload,t=t._init;try{return sc(t(e))}catch{}}return null}function I_(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return sc(e);case 8:return e===Td?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function jr(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function ng(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function A_(t){var e=ng(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(a){r=""+a,i.call(this,a)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(a){r=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function da(t){t._valueTracker||(t._valueTracker=A_(t))}function rg(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=ng(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Qa(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function ic(t,e){var n=e.checked;return Be({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Vf(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=jr(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function sg(t,e){e=e.checked,e!=null&&Ed(t,"checked",e,!1)}function oc(t,e){sg(t,e);var n=jr(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?ac(t,e.type,n):e.hasOwnProperty("defaultValue")&&ac(t,e.type,jr(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Mf(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function ac(t,e,n){(e!=="number"||Qa(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Fi=Array.isArray;function Us(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+jr(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function lc(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(H(91));return Be({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Lf(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(H(92));if(Fi(n)){if(1<n.length)throw Error(H(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:jr(n)}}function ig(t,e){var n=jr(e.value),r=jr(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function Of(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function og(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function uc(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?og(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var ha,ag=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(ha=ha||document.createElement("div"),ha.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=ha.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function ao(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Gi={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},C_=["Webkit","ms","Moz","O"];Object.keys(Gi).forEach(function(t){C_.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Gi[e]=Gi[t]})});function lg(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Gi.hasOwnProperty(t)&&Gi[t]?(""+e).trim():e+"px"}function ug(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=lg(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var k_=Be({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function cc(t,e){if(e){if(k_[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(H(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(H(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(H(61))}if(e.style!=null&&typeof e.style!="object")throw Error(H(62))}}function dc(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var hc=null;function Cd(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var fc=null,$s=null,Ws=null;function Ff(t){if(t=Lo(t)){if(typeof fc!="function")throw Error(H(280));var e=t.stateNode;e&&(e=jl(e),fc(t.stateNode,t.type,e))}}function cg(t){$s?Ws?Ws.push(t):Ws=[t]:$s=t}function dg(){if($s){var t=$s,e=Ws;if(Ws=$s=null,Ff(t),e)for(t=0;t<e.length;t++)Ff(e[t])}}function hg(t,e){return t(e)}function fg(){}var Eu=!1;function pg(t,e,n){if(Eu)return t(e,n);Eu=!0;try{return hg(t,e,n)}finally{Eu=!1,($s!==null||Ws!==null)&&(fg(),dg())}}function lo(t,e){var n=t.stateNode;if(n===null)return null;var r=jl(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(H(231,e,typeof n));return n}var pc=!1;if(Zn)try{var Pi={};Object.defineProperty(Pi,"passive",{get:function(){pc=!0}}),window.addEventListener("test",Pi,Pi),window.removeEventListener("test",Pi,Pi)}catch{pc=!1}function R_(t,e,n,r,s,i,a,l,u){var h=Array.prototype.slice.call(arguments,3);try{e.apply(n,h)}catch(p){this.onError(p)}}var Qi=!1,Ka=null,Ya=!1,mc=null,P_={onError:function(t){Qi=!0,Ka=t}};function b_(t,e,n,r,s,i,a,l,u){Qi=!1,Ka=null,R_.apply(P_,arguments)}function D_(t,e,n,r,s,i,a,l,u){if(b_.apply(this,arguments),Qi){if(Qi){var h=Ka;Qi=!1,Ka=null}else throw Error(H(198));Ya||(Ya=!0,mc=h)}}function ps(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function mg(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function zf(t){if(ps(t)!==t)throw Error(H(188))}function N_(t){var e=t.alternate;if(!e){if(e=ps(t),e===null)throw Error(H(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return zf(s),t;if(i===r)return zf(s),e;i=i.sibling}throw Error(H(188))}if(n.return!==r.return)n=s,r=i;else{for(var a=!1,l=s.child;l;){if(l===n){a=!0,n=s,r=i;break}if(l===r){a=!0,r=s,n=i;break}l=l.sibling}if(!a){for(l=i.child;l;){if(l===n){a=!0,n=i,r=s;break}if(l===r){a=!0,r=i,n=s;break}l=l.sibling}if(!a)throw Error(H(189))}}if(n.alternate!==r)throw Error(H(190))}if(n.tag!==3)throw Error(H(188));return n.stateNode.current===n?t:e}function gg(t){return t=N_(t),t!==null?yg(t):null}function yg(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=yg(t);if(e!==null)return e;t=t.sibling}return null}var vg=rn.unstable_scheduleCallback,Bf=rn.unstable_cancelCallback,j_=rn.unstable_shouldYield,V_=rn.unstable_requestPaint,Ke=rn.unstable_now,M_=rn.unstable_getCurrentPriorityLevel,kd=rn.unstable_ImmediatePriority,_g=rn.unstable_UserBlockingPriority,Xa=rn.unstable_NormalPriority,L_=rn.unstable_LowPriority,xg=rn.unstable_IdlePriority,Pl=null,Nn=null;function O_(t){if(Nn&&typeof Nn.onCommitFiberRoot=="function")try{Nn.onCommitFiberRoot(Pl,t,void 0,(t.current.flags&128)===128)}catch{}}var En=Math.clz32?Math.clz32:B_,F_=Math.log,z_=Math.LN2;function B_(t){return t>>>=0,t===0?32:31-(F_(t)/z_|0)|0}var fa=64,pa=4194304;function zi(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Ja(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,a=n&268435455;if(a!==0){var l=a&~s;l!==0?r=zi(l):(i&=a,i!==0&&(r=zi(i)))}else a=n&~s,a!==0?r=zi(a):i!==0&&(r=zi(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-En(e),s=1<<n,r|=t[n],e&=~s;return r}function U_(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function $_(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var a=31-En(i),l=1<<a,u=s[a];u===-1?(!(l&n)||l&r)&&(s[a]=U_(l,e)):u<=e&&(t.expiredLanes|=l),i&=~l}}function gc(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function wg(){var t=fa;return fa<<=1,!(fa&4194240)&&(fa=64),t}function Tu(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Vo(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-En(e),t[e]=n}function W_(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-En(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function Rd(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-En(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var Te=0;function Sg(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Eg,Pd,Tg,Ig,Ag,yc=!1,ma=[],Sr=null,Er=null,Tr=null,uo=new Map,co=new Map,gr=[],H_="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Uf(t,e){switch(t){case"focusin":case"focusout":Sr=null;break;case"dragenter":case"dragleave":Er=null;break;case"mouseover":case"mouseout":Tr=null;break;case"pointerover":case"pointerout":uo.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":co.delete(e.pointerId)}}function bi(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=Lo(e),e!==null&&Pd(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function q_(t,e,n,r,s){switch(e){case"focusin":return Sr=bi(Sr,t,e,n,r,s),!0;case"dragenter":return Er=bi(Er,t,e,n,r,s),!0;case"mouseover":return Tr=bi(Tr,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return uo.set(i,bi(uo.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,co.set(i,bi(co.get(i)||null,t,e,n,r,s)),!0}return!1}function Cg(t){var e=Jr(t.target);if(e!==null){var n=ps(e);if(n!==null){if(e=n.tag,e===13){if(e=mg(n),e!==null){t.blockedOn=e,Ag(t.priority,function(){Tg(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Da(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=vc(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);hc=r,n.target.dispatchEvent(r),hc=null}else return e=Lo(n),e!==null&&Pd(e),t.blockedOn=n,!1;e.shift()}return!0}function $f(t,e,n){Da(t)&&n.delete(e)}function G_(){yc=!1,Sr!==null&&Da(Sr)&&(Sr=null),Er!==null&&Da(Er)&&(Er=null),Tr!==null&&Da(Tr)&&(Tr=null),uo.forEach($f),co.forEach($f)}function Di(t,e){t.blockedOn===e&&(t.blockedOn=null,yc||(yc=!0,rn.unstable_scheduleCallback(rn.unstable_NormalPriority,G_)))}function ho(t){function e(s){return Di(s,t)}if(0<ma.length){Di(ma[0],t);for(var n=1;n<ma.length;n++){var r=ma[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Sr!==null&&Di(Sr,t),Er!==null&&Di(Er,t),Tr!==null&&Di(Tr,t),uo.forEach(e),co.forEach(e),n=0;n<gr.length;n++)r=gr[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<gr.length&&(n=gr[0],n.blockedOn===null);)Cg(n),n.blockedOn===null&&gr.shift()}var Hs=or.ReactCurrentBatchConfig,Za=!0;function Q_(t,e,n,r){var s=Te,i=Hs.transition;Hs.transition=null;try{Te=1,bd(t,e,n,r)}finally{Te=s,Hs.transition=i}}function K_(t,e,n,r){var s=Te,i=Hs.transition;Hs.transition=null;try{Te=4,bd(t,e,n,r)}finally{Te=s,Hs.transition=i}}function bd(t,e,n,r){if(Za){var s=vc(t,e,n,r);if(s===null)ju(t,e,r,el,n),Uf(t,r);else if(q_(s,t,e,n,r))r.stopPropagation();else if(Uf(t,r),e&4&&-1<H_.indexOf(t)){for(;s!==null;){var i=Lo(s);if(i!==null&&Eg(i),i=vc(t,e,n,r),i===null&&ju(t,e,r,el,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else ju(t,e,r,null,n)}}var el=null;function vc(t,e,n,r){if(el=null,t=Cd(r),t=Jr(t),t!==null)if(e=ps(t),e===null)t=null;else if(n=e.tag,n===13){if(t=mg(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return el=t,null}function kg(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(M_()){case kd:return 1;case _g:return 4;case Xa:case L_:return 16;case xg:return 536870912;default:return 16}default:return 16}}var _r=null,Dd=null,Na=null;function Rg(){if(Na)return Na;var t,e=Dd,n=e.length,r,s="value"in _r?_r.value:_r.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var a=n-t;for(r=1;r<=a&&e[n-r]===s[i-r];r++);return Na=s.slice(t,1<r?1-r:void 0)}function ja(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function ga(){return!0}function Wf(){return!1}function on(t){function e(n,r,s,i,a){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=a,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?ga:Wf,this.isPropagationStopped=Wf,this}return Be(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=ga)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=ga)},persist:function(){},isPersistent:ga}),e}var ci={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Nd=on(ci),Mo=Be({},ci,{view:0,detail:0}),Y_=on(Mo),Iu,Au,Ni,bl=Be({},Mo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:jd,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Ni&&(Ni&&t.type==="mousemove"?(Iu=t.screenX-Ni.screenX,Au=t.screenY-Ni.screenY):Au=Iu=0,Ni=t),Iu)},movementY:function(t){return"movementY"in t?t.movementY:Au}}),Hf=on(bl),X_=Be({},bl,{dataTransfer:0}),J_=on(X_),Z_=Be({},Mo,{relatedTarget:0}),Cu=on(Z_),ex=Be({},ci,{animationName:0,elapsedTime:0,pseudoElement:0}),tx=on(ex),nx=Be({},ci,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),rx=on(nx),sx=Be({},ci,{data:0}),qf=on(sx),ix={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ox={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ax={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function lx(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=ax[t])?!!e[t]:!1}function jd(){return lx}var ux=Be({},Mo,{key:function(t){if(t.key){var e=ix[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=ja(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?ox[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:jd,charCode:function(t){return t.type==="keypress"?ja(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?ja(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),cx=on(ux),dx=Be({},bl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Gf=on(dx),hx=Be({},Mo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:jd}),fx=on(hx),px=Be({},ci,{propertyName:0,elapsedTime:0,pseudoElement:0}),mx=on(px),gx=Be({},bl,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),yx=on(gx),vx=[9,13,27,32],Vd=Zn&&"CompositionEvent"in window,Ki=null;Zn&&"documentMode"in document&&(Ki=document.documentMode);var _x=Zn&&"TextEvent"in window&&!Ki,Pg=Zn&&(!Vd||Ki&&8<Ki&&11>=Ki),Qf=" ",Kf=!1;function bg(t,e){switch(t){case"keyup":return vx.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Dg(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Ds=!1;function xx(t,e){switch(t){case"compositionend":return Dg(e);case"keypress":return e.which!==32?null:(Kf=!0,Qf);case"textInput":return t=e.data,t===Qf&&Kf?null:t;default:return null}}function wx(t,e){if(Ds)return t==="compositionend"||!Vd&&bg(t,e)?(t=Rg(),Na=Dd=_r=null,Ds=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Pg&&e.locale!=="ko"?null:e.data;default:return null}}var Sx={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Yf(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!Sx[t.type]:e==="textarea"}function Ng(t,e,n,r){cg(r),e=tl(e,"onChange"),0<e.length&&(n=new Nd("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Yi=null,fo=null;function Ex(t){Wg(t,0)}function Dl(t){var e=Vs(t);if(rg(e))return t}function Tx(t,e){if(t==="change")return e}var jg=!1;if(Zn){var ku;if(Zn){var Ru="oninput"in document;if(!Ru){var Xf=document.createElement("div");Xf.setAttribute("oninput","return;"),Ru=typeof Xf.oninput=="function"}ku=Ru}else ku=!1;jg=ku&&(!document.documentMode||9<document.documentMode)}function Jf(){Yi&&(Yi.detachEvent("onpropertychange",Vg),fo=Yi=null)}function Vg(t){if(t.propertyName==="value"&&Dl(fo)){var e=[];Ng(e,fo,t,Cd(t)),pg(Ex,e)}}function Ix(t,e,n){t==="focusin"?(Jf(),Yi=e,fo=n,Yi.attachEvent("onpropertychange",Vg)):t==="focusout"&&Jf()}function Ax(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Dl(fo)}function Cx(t,e){if(t==="click")return Dl(e)}function kx(t,e){if(t==="input"||t==="change")return Dl(e)}function Rx(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var In=typeof Object.is=="function"?Object.is:Rx;function po(t,e){if(In(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!ec.call(e,s)||!In(t[s],e[s]))return!1}return!0}function Zf(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function ep(t,e){var n=Zf(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Zf(n)}}function Mg(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Mg(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Lg(){for(var t=window,e=Qa();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Qa(t.document)}return e}function Md(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function Px(t){var e=Lg(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&Mg(n.ownerDocument.documentElement,n)){if(r!==null&&Md(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=ep(n,i);var a=ep(n,r);s&&a&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var bx=Zn&&"documentMode"in document&&11>=document.documentMode,Ns=null,_c=null,Xi=null,xc=!1;function tp(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;xc||Ns==null||Ns!==Qa(r)||(r=Ns,"selectionStart"in r&&Md(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Xi&&po(Xi,r)||(Xi=r,r=tl(_c,"onSelect"),0<r.length&&(e=new Nd("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Ns)))}function ya(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var js={animationend:ya("Animation","AnimationEnd"),animationiteration:ya("Animation","AnimationIteration"),animationstart:ya("Animation","AnimationStart"),transitionend:ya("Transition","TransitionEnd")},Pu={},Og={};Zn&&(Og=document.createElement("div").style,"AnimationEvent"in window||(delete js.animationend.animation,delete js.animationiteration.animation,delete js.animationstart.animation),"TransitionEvent"in window||delete js.transitionend.transition);function Nl(t){if(Pu[t])return Pu[t];if(!js[t])return t;var e=js[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in Og)return Pu[t]=e[n];return t}var Fg=Nl("animationend"),zg=Nl("animationiteration"),Bg=Nl("animationstart"),Ug=Nl("transitionend"),$g=new Map,np="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Fr(t,e){$g.set(t,e),fs(e,[t])}for(var bu=0;bu<np.length;bu++){var Du=np[bu],Dx=Du.toLowerCase(),Nx=Du[0].toUpperCase()+Du.slice(1);Fr(Dx,"on"+Nx)}Fr(Fg,"onAnimationEnd");Fr(zg,"onAnimationIteration");Fr(Bg,"onAnimationStart");Fr("dblclick","onDoubleClick");Fr("focusin","onFocus");Fr("focusout","onBlur");Fr(Ug,"onTransitionEnd");Ks("onMouseEnter",["mouseout","mouseover"]);Ks("onMouseLeave",["mouseout","mouseover"]);Ks("onPointerEnter",["pointerout","pointerover"]);Ks("onPointerLeave",["pointerout","pointerover"]);fs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));fs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));fs("onBeforeInput",["compositionend","keypress","textInput","paste"]);fs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));fs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));fs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Bi="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),jx=new Set("cancel close invalid load scroll toggle".split(" ").concat(Bi));function rp(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,D_(r,e,void 0,t),t.currentTarget=null}function Wg(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var a=r.length-1;0<=a;a--){var l=r[a],u=l.instance,h=l.currentTarget;if(l=l.listener,u!==i&&s.isPropagationStopped())break e;rp(s,l,h),i=u}else for(a=0;a<r.length;a++){if(l=r[a],u=l.instance,h=l.currentTarget,l=l.listener,u!==i&&s.isPropagationStopped())break e;rp(s,l,h),i=u}}}if(Ya)throw t=mc,Ya=!1,mc=null,t}function Ne(t,e){var n=e[Ic];n===void 0&&(n=e[Ic]=new Set);var r=t+"__bubble";n.has(r)||(Hg(e,t,2,!1),n.add(r))}function Nu(t,e,n){var r=0;e&&(r|=4),Hg(n,t,r,e)}var va="_reactListening"+Math.random().toString(36).slice(2);function mo(t){if(!t[va]){t[va]=!0,Jm.forEach(function(n){n!=="selectionchange"&&(jx.has(n)||Nu(n,!1,t),Nu(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[va]||(e[va]=!0,Nu("selectionchange",!1,e))}}function Hg(t,e,n,r){switch(kg(e)){case 1:var s=Q_;break;case 4:s=K_;break;default:s=bd}n=s.bind(null,e,n,t),s=void 0,!pc||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function ju(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var a=r.tag;if(a===3||a===4){var l=r.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(a===4)for(a=r.return;a!==null;){var u=a.tag;if((u===3||u===4)&&(u=a.stateNode.containerInfo,u===s||u.nodeType===8&&u.parentNode===s))return;a=a.return}for(;l!==null;){if(a=Jr(l),a===null)return;if(u=a.tag,u===5||u===6){r=i=a;continue e}l=l.parentNode}}r=r.return}pg(function(){var h=i,p=Cd(n),y=[];e:{var m=$g.get(t);if(m!==void 0){var C=Nd,R=t;switch(t){case"keypress":if(ja(n)===0)break e;case"keydown":case"keyup":C=cx;break;case"focusin":R="focus",C=Cu;break;case"focusout":R="blur",C=Cu;break;case"beforeblur":case"afterblur":C=Cu;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":C=Hf;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":C=J_;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":C=fx;break;case Fg:case zg:case Bg:C=tx;break;case Ug:C=mx;break;case"scroll":C=Y_;break;case"wheel":C=yx;break;case"copy":case"cut":case"paste":C=rx;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":C=Gf}var P=(e&4)!==0,O=!P&&t==="scroll",k=P?m!==null?m+"Capture":null:m;P=[];for(var A=h,w;A!==null;){w=A;var b=w.stateNode;if(w.tag===5&&b!==null&&(w=b,k!==null&&(b=lo(A,k),b!=null&&P.push(go(A,b,w)))),O)break;A=A.return}0<P.length&&(m=new C(m,R,null,n,p),y.push({event:m,listeners:P}))}}if(!(e&7)){e:{if(m=t==="mouseover"||t==="pointerover",C=t==="mouseout"||t==="pointerout",m&&n!==hc&&(R=n.relatedTarget||n.fromElement)&&(Jr(R)||R[er]))break e;if((C||m)&&(m=p.window===p?p:(m=p.ownerDocument)?m.defaultView||m.parentWindow:window,C?(R=n.relatedTarget||n.toElement,C=h,R=R?Jr(R):null,R!==null&&(O=ps(R),R!==O||R.tag!==5&&R.tag!==6)&&(R=null)):(C=null,R=h),C!==R)){if(P=Hf,b="onMouseLeave",k="onMouseEnter",A="mouse",(t==="pointerout"||t==="pointerover")&&(P=Gf,b="onPointerLeave",k="onPointerEnter",A="pointer"),O=C==null?m:Vs(C),w=R==null?m:Vs(R),m=new P(b,A+"leave",C,n,p),m.target=O,m.relatedTarget=w,b=null,Jr(p)===h&&(P=new P(k,A+"enter",R,n,p),P.target=w,P.relatedTarget=O,b=P),O=b,C&&R)t:{for(P=C,k=R,A=0,w=P;w;w=As(w))A++;for(w=0,b=k;b;b=As(b))w++;for(;0<A-w;)P=As(P),A--;for(;0<w-A;)k=As(k),w--;for(;A--;){if(P===k||k!==null&&P===k.alternate)break t;P=As(P),k=As(k)}P=null}else P=null;C!==null&&sp(y,m,C,P,!1),R!==null&&O!==null&&sp(y,O,R,P,!0)}}e:{if(m=h?Vs(h):window,C=m.nodeName&&m.nodeName.toLowerCase(),C==="select"||C==="input"&&m.type==="file")var j=Tx;else if(Yf(m))if(jg)j=kx;else{j=Ax;var M=Ix}else(C=m.nodeName)&&C.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(j=Cx);if(j&&(j=j(t,h))){Ng(y,j,n,p);break e}M&&M(t,m,h),t==="focusout"&&(M=m._wrapperState)&&M.controlled&&m.type==="number"&&ac(m,"number",m.value)}switch(M=h?Vs(h):window,t){case"focusin":(Yf(M)||M.contentEditable==="true")&&(Ns=M,_c=h,Xi=null);break;case"focusout":Xi=_c=Ns=null;break;case"mousedown":xc=!0;break;case"contextmenu":case"mouseup":case"dragend":xc=!1,tp(y,n,p);break;case"selectionchange":if(bx)break;case"keydown":case"keyup":tp(y,n,p)}var S;if(Vd)e:{switch(t){case"compositionstart":var v="onCompositionStart";break e;case"compositionend":v="onCompositionEnd";break e;case"compositionupdate":v="onCompositionUpdate";break e}v=void 0}else Ds?bg(t,n)&&(v="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(v="onCompositionStart");v&&(Pg&&n.locale!=="ko"&&(Ds||v!=="onCompositionStart"?v==="onCompositionEnd"&&Ds&&(S=Rg()):(_r=p,Dd="value"in _r?_r.value:_r.textContent,Ds=!0)),M=tl(h,v),0<M.length&&(v=new qf(v,t,null,n,p),y.push({event:v,listeners:M}),S?v.data=S:(S=Dg(n),S!==null&&(v.data=S)))),(S=_x?xx(t,n):wx(t,n))&&(h=tl(h,"onBeforeInput"),0<h.length&&(p=new qf("onBeforeInput","beforeinput",null,n,p),y.push({event:p,listeners:h}),p.data=S))}Wg(y,e)})}function go(t,e,n){return{instance:t,listener:e,currentTarget:n}}function tl(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=lo(t,n),i!=null&&r.unshift(go(t,i,s)),i=lo(t,e),i!=null&&r.push(go(t,i,s))),t=t.return}return r}function As(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function sp(t,e,n,r,s){for(var i=e._reactName,a=[];n!==null&&n!==r;){var l=n,u=l.alternate,h=l.stateNode;if(u!==null&&u===r)break;l.tag===5&&h!==null&&(l=h,s?(u=lo(n,i),u!=null&&a.unshift(go(n,u,l))):s||(u=lo(n,i),u!=null&&a.push(go(n,u,l)))),n=n.return}a.length!==0&&t.push({event:e,listeners:a})}var Vx=/\r\n?/g,Mx=/\u0000|\uFFFD/g;function ip(t){return(typeof t=="string"?t:""+t).replace(Vx,`
`).replace(Mx,"")}function _a(t,e,n){if(e=ip(e),ip(t)!==e&&n)throw Error(H(425))}function nl(){}var wc=null,Sc=null;function Ec(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Tc=typeof setTimeout=="function"?setTimeout:void 0,Lx=typeof clearTimeout=="function"?clearTimeout:void 0,op=typeof Promise=="function"?Promise:void 0,Ox=typeof queueMicrotask=="function"?queueMicrotask:typeof op<"u"?function(t){return op.resolve(null).then(t).catch(Fx)}:Tc;function Fx(t){setTimeout(function(){throw t})}function Vu(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),ho(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);ho(e)}function Ir(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function ap(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var di=Math.random().toString(36).slice(2),Dn="__reactFiber$"+di,yo="__reactProps$"+di,er="__reactContainer$"+di,Ic="__reactEvents$"+di,zx="__reactListeners$"+di,Bx="__reactHandles$"+di;function Jr(t){var e=t[Dn];if(e)return e;for(var n=t.parentNode;n;){if(e=n[er]||n[Dn]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=ap(t);t!==null;){if(n=t[Dn])return n;t=ap(t)}return e}t=n,n=t.parentNode}return null}function Lo(t){return t=t[Dn]||t[er],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Vs(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(H(33))}function jl(t){return t[yo]||null}var Ac=[],Ms=-1;function zr(t){return{current:t}}function Ve(t){0>Ms||(t.current=Ac[Ms],Ac[Ms]=null,Ms--)}function be(t,e){Ms++,Ac[Ms]=t.current,t.current=e}var Vr={},kt=zr(Vr),$t=zr(!1),is=Vr;function Ys(t,e){var n=t.type.contextTypes;if(!n)return Vr;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function Wt(t){return t=t.childContextTypes,t!=null}function rl(){Ve($t),Ve(kt)}function lp(t,e,n){if(kt.current!==Vr)throw Error(H(168));be(kt,e),be($t,n)}function qg(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(H(108,I_(t)||"Unknown",s));return Be({},n,r)}function sl(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Vr,is=kt.current,be(kt,t),be($t,$t.current),!0}function up(t,e,n){var r=t.stateNode;if(!r)throw Error(H(169));n?(t=qg(t,e,is),r.__reactInternalMemoizedMergedChildContext=t,Ve($t),Ve(kt),be(kt,t)):Ve($t),be($t,n)}var qn=null,Vl=!1,Mu=!1;function Gg(t){qn===null?qn=[t]:qn.push(t)}function Ux(t){Vl=!0,Gg(t)}function Br(){if(!Mu&&qn!==null){Mu=!0;var t=0,e=Te;try{var n=qn;for(Te=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}qn=null,Vl=!1}catch(s){throw qn!==null&&(qn=qn.slice(t+1)),vg(kd,Br),s}finally{Te=e,Mu=!1}}return null}var Ls=[],Os=0,il=null,ol=0,ln=[],un=0,os=null,Qn=1,Kn="";function Kr(t,e){Ls[Os++]=ol,Ls[Os++]=il,il=t,ol=e}function Qg(t,e,n){ln[un++]=Qn,ln[un++]=Kn,ln[un++]=os,os=t;var r=Qn;t=Kn;var s=32-En(r)-1;r&=~(1<<s),n+=1;var i=32-En(e)+s;if(30<i){var a=s-s%5;i=(r&(1<<a)-1).toString(32),r>>=a,s-=a,Qn=1<<32-En(e)+s|n<<s|r,Kn=i+t}else Qn=1<<i|n<<s|r,Kn=t}function Ld(t){t.return!==null&&(Kr(t,1),Qg(t,1,0))}function Od(t){for(;t===il;)il=Ls[--Os],Ls[Os]=null,ol=Ls[--Os],Ls[Os]=null;for(;t===os;)os=ln[--un],ln[un]=null,Kn=ln[--un],ln[un]=null,Qn=ln[--un],ln[un]=null}var nn=null,en=null,Le=!1,Sn=null;function Kg(t,e){var n=dn(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function cp(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,nn=t,en=Ir(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,nn=t,en=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=os!==null?{id:Qn,overflow:Kn}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=dn(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,nn=t,en=null,!0):!1;default:return!1}}function Cc(t){return(t.mode&1)!==0&&(t.flags&128)===0}function kc(t){if(Le){var e=en;if(e){var n=e;if(!cp(t,e)){if(Cc(t))throw Error(H(418));e=Ir(n.nextSibling);var r=nn;e&&cp(t,e)?Kg(r,n):(t.flags=t.flags&-4097|2,Le=!1,nn=t)}}else{if(Cc(t))throw Error(H(418));t.flags=t.flags&-4097|2,Le=!1,nn=t}}}function dp(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;nn=t}function xa(t){if(t!==nn)return!1;if(!Le)return dp(t),Le=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Ec(t.type,t.memoizedProps)),e&&(e=en)){if(Cc(t))throw Yg(),Error(H(418));for(;e;)Kg(t,e),e=Ir(e.nextSibling)}if(dp(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(H(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){en=Ir(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}en=null}}else en=nn?Ir(t.stateNode.nextSibling):null;return!0}function Yg(){for(var t=en;t;)t=Ir(t.nextSibling)}function Xs(){en=nn=null,Le=!1}function Fd(t){Sn===null?Sn=[t]:Sn.push(t)}var $x=or.ReactCurrentBatchConfig;function ji(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(H(309));var r=n.stateNode}if(!r)throw Error(H(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(a){var l=s.refs;a===null?delete l[i]:l[i]=a},e._stringRef=i,e)}if(typeof t!="string")throw Error(H(284));if(!n._owner)throw Error(H(290,t))}return t}function wa(t,e){throw t=Object.prototype.toString.call(e),Error(H(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function hp(t){var e=t._init;return e(t._payload)}function Xg(t){function e(k,A){if(t){var w=k.deletions;w===null?(k.deletions=[A],k.flags|=16):w.push(A)}}function n(k,A){if(!t)return null;for(;A!==null;)e(k,A),A=A.sibling;return null}function r(k,A){for(k=new Map;A!==null;)A.key!==null?k.set(A.key,A):k.set(A.index,A),A=A.sibling;return k}function s(k,A){return k=Rr(k,A),k.index=0,k.sibling=null,k}function i(k,A,w){return k.index=w,t?(w=k.alternate,w!==null?(w=w.index,w<A?(k.flags|=2,A):w):(k.flags|=2,A)):(k.flags|=1048576,A)}function a(k){return t&&k.alternate===null&&(k.flags|=2),k}function l(k,A,w,b){return A===null||A.tag!==6?(A=$u(w,k.mode,b),A.return=k,A):(A=s(A,w),A.return=k,A)}function u(k,A,w,b){var j=w.type;return j===bs?p(k,A,w.props.children,b,w.key):A!==null&&(A.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===pr&&hp(j)===A.type)?(b=s(A,w.props),b.ref=ji(k,A,w),b.return=k,b):(b=Ba(w.type,w.key,w.props,null,k.mode,b),b.ref=ji(k,A,w),b.return=k,b)}function h(k,A,w,b){return A===null||A.tag!==4||A.stateNode.containerInfo!==w.containerInfo||A.stateNode.implementation!==w.implementation?(A=Wu(w,k.mode,b),A.return=k,A):(A=s(A,w.children||[]),A.return=k,A)}function p(k,A,w,b,j){return A===null||A.tag!==7?(A=rs(w,k.mode,b,j),A.return=k,A):(A=s(A,w),A.return=k,A)}function y(k,A,w){if(typeof A=="string"&&A!==""||typeof A=="number")return A=$u(""+A,k.mode,w),A.return=k,A;if(typeof A=="object"&&A!==null){switch(A.$$typeof){case ca:return w=Ba(A.type,A.key,A.props,null,k.mode,w),w.ref=ji(k,null,A),w.return=k,w;case Ps:return A=Wu(A,k.mode,w),A.return=k,A;case pr:var b=A._init;return y(k,b(A._payload),w)}if(Fi(A)||Ri(A))return A=rs(A,k.mode,w,null),A.return=k,A;wa(k,A)}return null}function m(k,A,w,b){var j=A!==null?A.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return j!==null?null:l(k,A,""+w,b);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case ca:return w.key===j?u(k,A,w,b):null;case Ps:return w.key===j?h(k,A,w,b):null;case pr:return j=w._init,m(k,A,j(w._payload),b)}if(Fi(w)||Ri(w))return j!==null?null:p(k,A,w,b,null);wa(k,w)}return null}function C(k,A,w,b,j){if(typeof b=="string"&&b!==""||typeof b=="number")return k=k.get(w)||null,l(A,k,""+b,j);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case ca:return k=k.get(b.key===null?w:b.key)||null,u(A,k,b,j);case Ps:return k=k.get(b.key===null?w:b.key)||null,h(A,k,b,j);case pr:var M=b._init;return C(k,A,w,M(b._payload),j)}if(Fi(b)||Ri(b))return k=k.get(w)||null,p(A,k,b,j,null);wa(A,b)}return null}function R(k,A,w,b){for(var j=null,M=null,S=A,v=A=0,T=null;S!==null&&v<w.length;v++){S.index>v?(T=S,S=null):T=S.sibling;var I=m(k,S,w[v],b);if(I===null){S===null&&(S=T);break}t&&S&&I.alternate===null&&e(k,S),A=i(I,A,v),M===null?j=I:M.sibling=I,M=I,S=T}if(v===w.length)return n(k,S),Le&&Kr(k,v),j;if(S===null){for(;v<w.length;v++)S=y(k,w[v],b),S!==null&&(A=i(S,A,v),M===null?j=S:M.sibling=S,M=S);return Le&&Kr(k,v),j}for(S=r(k,S);v<w.length;v++)T=C(S,k,v,w[v],b),T!==null&&(t&&T.alternate!==null&&S.delete(T.key===null?v:T.key),A=i(T,A,v),M===null?j=T:M.sibling=T,M=T);return t&&S.forEach(function(_){return e(k,_)}),Le&&Kr(k,v),j}function P(k,A,w,b){var j=Ri(w);if(typeof j!="function")throw Error(H(150));if(w=j.call(w),w==null)throw Error(H(151));for(var M=j=null,S=A,v=A=0,T=null,I=w.next();S!==null&&!I.done;v++,I=w.next()){S.index>v?(T=S,S=null):T=S.sibling;var _=m(k,S,I.value,b);if(_===null){S===null&&(S=T);break}t&&S&&_.alternate===null&&e(k,S),A=i(_,A,v),M===null?j=_:M.sibling=_,M=_,S=T}if(I.done)return n(k,S),Le&&Kr(k,v),j;if(S===null){for(;!I.done;v++,I=w.next())I=y(k,I.value,b),I!==null&&(A=i(I,A,v),M===null?j=I:M.sibling=I,M=I);return Le&&Kr(k,v),j}for(S=r(k,S);!I.done;v++,I=w.next())I=C(S,k,v,I.value,b),I!==null&&(t&&I.alternate!==null&&S.delete(I.key===null?v:I.key),A=i(I,A,v),M===null?j=I:M.sibling=I,M=I);return t&&S.forEach(function(E){return e(k,E)}),Le&&Kr(k,v),j}function O(k,A,w,b){if(typeof w=="object"&&w!==null&&w.type===bs&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case ca:e:{for(var j=w.key,M=A;M!==null;){if(M.key===j){if(j=w.type,j===bs){if(M.tag===7){n(k,M.sibling),A=s(M,w.props.children),A.return=k,k=A;break e}}else if(M.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===pr&&hp(j)===M.type){n(k,M.sibling),A=s(M,w.props),A.ref=ji(k,M,w),A.return=k,k=A;break e}n(k,M);break}else e(k,M);M=M.sibling}w.type===bs?(A=rs(w.props.children,k.mode,b,w.key),A.return=k,k=A):(b=Ba(w.type,w.key,w.props,null,k.mode,b),b.ref=ji(k,A,w),b.return=k,k=b)}return a(k);case Ps:e:{for(M=w.key;A!==null;){if(A.key===M)if(A.tag===4&&A.stateNode.containerInfo===w.containerInfo&&A.stateNode.implementation===w.implementation){n(k,A.sibling),A=s(A,w.children||[]),A.return=k,k=A;break e}else{n(k,A);break}else e(k,A);A=A.sibling}A=Wu(w,k.mode,b),A.return=k,k=A}return a(k);case pr:return M=w._init,O(k,A,M(w._payload),b)}if(Fi(w))return R(k,A,w,b);if(Ri(w))return P(k,A,w,b);wa(k,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,A!==null&&A.tag===6?(n(k,A.sibling),A=s(A,w),A.return=k,k=A):(n(k,A),A=$u(w,k.mode,b),A.return=k,k=A),a(k)):n(k,A)}return O}var Js=Xg(!0),Jg=Xg(!1),al=zr(null),ll=null,Fs=null,zd=null;function Bd(){zd=Fs=ll=null}function Ud(t){var e=al.current;Ve(al),t._currentValue=e}function Rc(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function qs(t,e){ll=t,zd=Fs=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Ut=!0),t.firstContext=null)}function mn(t){var e=t._currentValue;if(zd!==t)if(t={context:t,memoizedValue:e,next:null},Fs===null){if(ll===null)throw Error(H(308));Fs=t,ll.dependencies={lanes:0,firstContext:t}}else Fs=Fs.next=t;return e}var Zr=null;function $d(t){Zr===null?Zr=[t]:Zr.push(t)}function Zg(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,$d(e)):(n.next=s.next,s.next=n),e.interleaved=n,tr(t,r)}function tr(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var mr=!1;function Wd(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function ey(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Yn(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Ar(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,ve&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,tr(t,n)}return s=r.interleaved,s===null?(e.next=e,$d(r)):(e.next=s.next,s.next=e),r.interleaved=e,tr(t,n)}function Va(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Rd(t,n)}}function fp(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=a:i=i.next=a,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function ul(t,e,n,r){var s=t.updateQueue;mr=!1;var i=s.firstBaseUpdate,a=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var u=l,h=u.next;u.next=null,a===null?i=h:a.next=h,a=u;var p=t.alternate;p!==null&&(p=p.updateQueue,l=p.lastBaseUpdate,l!==a&&(l===null?p.firstBaseUpdate=h:l.next=h,p.lastBaseUpdate=u))}if(i!==null){var y=s.baseState;a=0,p=h=u=null,l=i;do{var m=l.lane,C=l.eventTime;if((r&m)===m){p!==null&&(p=p.next={eventTime:C,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var R=t,P=l;switch(m=e,C=n,P.tag){case 1:if(R=P.payload,typeof R=="function"){y=R.call(C,y,m);break e}y=R;break e;case 3:R.flags=R.flags&-65537|128;case 0:if(R=P.payload,m=typeof R=="function"?R.call(C,y,m):R,m==null)break e;y=Be({},y,m);break e;case 2:mr=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,m=s.effects,m===null?s.effects=[l]:m.push(l))}else C={eventTime:C,lane:m,tag:l.tag,payload:l.payload,callback:l.callback,next:null},p===null?(h=p=C,u=y):p=p.next=C,a|=m;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;m=l,l=m.next,m.next=null,s.lastBaseUpdate=m,s.shared.pending=null}}while(!0);if(p===null&&(u=y),s.baseState=u,s.firstBaseUpdate=h,s.lastBaseUpdate=p,e=s.shared.interleaved,e!==null){s=e;do a|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);ls|=a,t.lanes=a,t.memoizedState=y}}function pp(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(H(191,s));s.call(r)}}}var Oo={},jn=zr(Oo),vo=zr(Oo),_o=zr(Oo);function es(t){if(t===Oo)throw Error(H(174));return t}function Hd(t,e){switch(be(_o,e),be(vo,t),be(jn,Oo),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:uc(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=uc(e,t)}Ve(jn),be(jn,e)}function Zs(){Ve(jn),Ve(vo),Ve(_o)}function ty(t){es(_o.current);var e=es(jn.current),n=uc(e,t.type);e!==n&&(be(vo,t),be(jn,n))}function qd(t){vo.current===t&&(Ve(jn),Ve(vo))}var Fe=zr(0);function cl(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Lu=[];function Gd(){for(var t=0;t<Lu.length;t++)Lu[t]._workInProgressVersionPrimary=null;Lu.length=0}var Ma=or.ReactCurrentDispatcher,Ou=or.ReactCurrentBatchConfig,as=0,ze=null,st=null,ct=null,dl=!1,Ji=!1,xo=0,Wx=0;function Et(){throw Error(H(321))}function Qd(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!In(t[n],e[n]))return!1;return!0}function Kd(t,e,n,r,s,i){if(as=i,ze=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Ma.current=t===null||t.memoizedState===null?Qx:Kx,t=n(r,s),Ji){i=0;do{if(Ji=!1,xo=0,25<=i)throw Error(H(301));i+=1,ct=st=null,e.updateQueue=null,Ma.current=Yx,t=n(r,s)}while(Ji)}if(Ma.current=hl,e=st!==null&&st.next!==null,as=0,ct=st=ze=null,dl=!1,e)throw Error(H(300));return t}function Yd(){var t=xo!==0;return xo=0,t}function bn(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ct===null?ze.memoizedState=ct=t:ct=ct.next=t,ct}function gn(){if(st===null){var t=ze.alternate;t=t!==null?t.memoizedState:null}else t=st.next;var e=ct===null?ze.memoizedState:ct.next;if(e!==null)ct=e,st=t;else{if(t===null)throw Error(H(310));st=t,t={memoizedState:st.memoizedState,baseState:st.baseState,baseQueue:st.baseQueue,queue:st.queue,next:null},ct===null?ze.memoizedState=ct=t:ct=ct.next=t}return ct}function wo(t,e){return typeof e=="function"?e(t):e}function Fu(t){var e=gn(),n=e.queue;if(n===null)throw Error(H(311));n.lastRenderedReducer=t;var r=st,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var a=s.next;s.next=i.next,i.next=a}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var l=a=null,u=null,h=i;do{var p=h.lane;if((as&p)===p)u!==null&&(u=u.next={lane:0,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null}),r=h.hasEagerState?h.eagerState:t(r,h.action);else{var y={lane:p,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null};u===null?(l=u=y,a=r):u=u.next=y,ze.lanes|=p,ls|=p}h=h.next}while(h!==null&&h!==i);u===null?a=r:u.next=l,In(r,e.memoizedState)||(Ut=!0),e.memoizedState=r,e.baseState=a,e.baseQueue=u,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,ze.lanes|=i,ls|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function zu(t){var e=gn(),n=e.queue;if(n===null)throw Error(H(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var a=s=s.next;do i=t(i,a.action),a=a.next;while(a!==s);In(i,e.memoizedState)||(Ut=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function ny(){}function ry(t,e){var n=ze,r=gn(),s=e(),i=!In(r.memoizedState,s);if(i&&(r.memoizedState=s,Ut=!0),r=r.queue,Xd(oy.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||ct!==null&&ct.memoizedState.tag&1){if(n.flags|=2048,So(9,iy.bind(null,n,r,s,e),void 0,null),dt===null)throw Error(H(349));as&30||sy(n,e,s)}return s}function sy(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=ze.updateQueue,e===null?(e={lastEffect:null,stores:null},ze.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function iy(t,e,n,r){e.value=n,e.getSnapshot=r,ay(e)&&ly(t)}function oy(t,e,n){return n(function(){ay(e)&&ly(t)})}function ay(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!In(t,n)}catch{return!0}}function ly(t){var e=tr(t,1);e!==null&&Tn(e,t,1,-1)}function mp(t){var e=bn();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:wo,lastRenderedState:t},e.queue=t,t=t.dispatch=Gx.bind(null,ze,t),[e.memoizedState,t]}function So(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=ze.updateQueue,e===null?(e={lastEffect:null,stores:null},ze.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function uy(){return gn().memoizedState}function La(t,e,n,r){var s=bn();ze.flags|=t,s.memoizedState=So(1|e,n,void 0,r===void 0?null:r)}function Ml(t,e,n,r){var s=gn();r=r===void 0?null:r;var i=void 0;if(st!==null){var a=st.memoizedState;if(i=a.destroy,r!==null&&Qd(r,a.deps)){s.memoizedState=So(e,n,i,r);return}}ze.flags|=t,s.memoizedState=So(1|e,n,i,r)}function gp(t,e){return La(8390656,8,t,e)}function Xd(t,e){return Ml(2048,8,t,e)}function cy(t,e){return Ml(4,2,t,e)}function dy(t,e){return Ml(4,4,t,e)}function hy(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function fy(t,e,n){return n=n!=null?n.concat([t]):null,Ml(4,4,hy.bind(null,e,t),n)}function Jd(){}function py(t,e){var n=gn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Qd(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function my(t,e){var n=gn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Qd(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function gy(t,e,n){return as&21?(In(n,e)||(n=wg(),ze.lanes|=n,ls|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Ut=!0),t.memoizedState=n)}function Hx(t,e){var n=Te;Te=n!==0&&4>n?n:4,t(!0);var r=Ou.transition;Ou.transition={};try{t(!1),e()}finally{Te=n,Ou.transition=r}}function yy(){return gn().memoizedState}function qx(t,e,n){var r=kr(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},vy(t))_y(e,n);else if(n=Zg(t,e,n,r),n!==null){var s=Nt();Tn(n,t,r,s),xy(n,e,r)}}function Gx(t,e,n){var r=kr(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(vy(t))_y(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var a=e.lastRenderedState,l=i(a,n);if(s.hasEagerState=!0,s.eagerState=l,In(l,a)){var u=e.interleaved;u===null?(s.next=s,$d(e)):(s.next=u.next,u.next=s),e.interleaved=s;return}}catch{}finally{}n=Zg(t,e,s,r),n!==null&&(s=Nt(),Tn(n,t,r,s),xy(n,e,r))}}function vy(t){var e=t.alternate;return t===ze||e!==null&&e===ze}function _y(t,e){Ji=dl=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function xy(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Rd(t,n)}}var hl={readContext:mn,useCallback:Et,useContext:Et,useEffect:Et,useImperativeHandle:Et,useInsertionEffect:Et,useLayoutEffect:Et,useMemo:Et,useReducer:Et,useRef:Et,useState:Et,useDebugValue:Et,useDeferredValue:Et,useTransition:Et,useMutableSource:Et,useSyncExternalStore:Et,useId:Et,unstable_isNewReconciler:!1},Qx={readContext:mn,useCallback:function(t,e){return bn().memoizedState=[t,e===void 0?null:e],t},useContext:mn,useEffect:gp,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,La(4194308,4,hy.bind(null,e,t),n)},useLayoutEffect:function(t,e){return La(4194308,4,t,e)},useInsertionEffect:function(t,e){return La(4,2,t,e)},useMemo:function(t,e){var n=bn();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=bn();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=qx.bind(null,ze,t),[r.memoizedState,t]},useRef:function(t){var e=bn();return t={current:t},e.memoizedState=t},useState:mp,useDebugValue:Jd,useDeferredValue:function(t){return bn().memoizedState=t},useTransition:function(){var t=mp(!1),e=t[0];return t=Hx.bind(null,t[1]),bn().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=ze,s=bn();if(Le){if(n===void 0)throw Error(H(407));n=n()}else{if(n=e(),dt===null)throw Error(H(349));as&30||sy(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,gp(oy.bind(null,r,i,t),[t]),r.flags|=2048,So(9,iy.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=bn(),e=dt.identifierPrefix;if(Le){var n=Kn,r=Qn;n=(r&~(1<<32-En(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=xo++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=Wx++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},Kx={readContext:mn,useCallback:py,useContext:mn,useEffect:Xd,useImperativeHandle:fy,useInsertionEffect:cy,useLayoutEffect:dy,useMemo:my,useReducer:Fu,useRef:uy,useState:function(){return Fu(wo)},useDebugValue:Jd,useDeferredValue:function(t){var e=gn();return gy(e,st.memoizedState,t)},useTransition:function(){var t=Fu(wo)[0],e=gn().memoizedState;return[t,e]},useMutableSource:ny,useSyncExternalStore:ry,useId:yy,unstable_isNewReconciler:!1},Yx={readContext:mn,useCallback:py,useContext:mn,useEffect:Xd,useImperativeHandle:fy,useInsertionEffect:cy,useLayoutEffect:dy,useMemo:my,useReducer:zu,useRef:uy,useState:function(){return zu(wo)},useDebugValue:Jd,useDeferredValue:function(t){var e=gn();return st===null?e.memoizedState=t:gy(e,st.memoizedState,t)},useTransition:function(){var t=zu(wo)[0],e=gn().memoizedState;return[t,e]},useMutableSource:ny,useSyncExternalStore:ry,useId:yy,unstable_isNewReconciler:!1};function xn(t,e){if(t&&t.defaultProps){e=Be({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Pc(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Be({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Ll={isMounted:function(t){return(t=t._reactInternals)?ps(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Nt(),s=kr(t),i=Yn(r,s);i.payload=e,n!=null&&(i.callback=n),e=Ar(t,i,s),e!==null&&(Tn(e,t,s,r),Va(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Nt(),s=kr(t),i=Yn(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=Ar(t,i,s),e!==null&&(Tn(e,t,s,r),Va(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Nt(),r=kr(t),s=Yn(n,r);s.tag=2,e!=null&&(s.callback=e),e=Ar(t,s,r),e!==null&&(Tn(e,t,r,n),Va(e,t,r))}};function yp(t,e,n,r,s,i,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,a):e.prototype&&e.prototype.isPureReactComponent?!po(n,r)||!po(s,i):!0}function wy(t,e,n){var r=!1,s=Vr,i=e.contextType;return typeof i=="object"&&i!==null?i=mn(i):(s=Wt(e)?is:kt.current,r=e.contextTypes,i=(r=r!=null)?Ys(t,s):Vr),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Ll,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function vp(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Ll.enqueueReplaceState(e,e.state,null)}function bc(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},Wd(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=mn(i):(i=Wt(e)?is:kt.current,s.context=Ys(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(Pc(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&Ll.enqueueReplaceState(s,s.state,null),ul(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function ei(t,e){try{var n="",r=e;do n+=T_(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function Bu(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Dc(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var Xx=typeof WeakMap=="function"?WeakMap:Map;function Sy(t,e,n){n=Yn(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){pl||(pl=!0,Uc=r),Dc(t,e)},n}function Ey(t,e,n){n=Yn(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){Dc(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){Dc(t,e),typeof r!="function"&&(Cr===null?Cr=new Set([this]):Cr.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),n}function _p(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new Xx;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=d1.bind(null,t,e,n),e.then(t,t))}function xp(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function wp(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Yn(-1,1),e.tag=2,Ar(n,e,1))),n.lanes|=1),t)}var Jx=or.ReactCurrentOwner,Ut=!1;function Dt(t,e,n,r){e.child=t===null?Jg(e,null,n,r):Js(e,t.child,n,r)}function Sp(t,e,n,r,s){n=n.render;var i=e.ref;return qs(e,s),r=Kd(t,e,n,r,i,s),n=Yd(),t!==null&&!Ut?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,nr(t,e,s)):(Le&&n&&Ld(e),e.flags|=1,Dt(t,e,r,s),e.child)}function Ep(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!oh(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,Ty(t,e,i,r,s)):(t=Ba(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var a=i.memoizedProps;if(n=n.compare,n=n!==null?n:po,n(a,r)&&t.ref===e.ref)return nr(t,e,s)}return e.flags|=1,t=Rr(i,r),t.ref=e.ref,t.return=e,e.child=t}function Ty(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(po(i,r)&&t.ref===e.ref)if(Ut=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(Ut=!0);else return e.lanes=t.lanes,nr(t,e,s)}return Nc(t,e,n,r,s)}function Iy(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},be(Bs,Zt),Zt|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,be(Bs,Zt),Zt|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,be(Bs,Zt),Zt|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,be(Bs,Zt),Zt|=r;return Dt(t,e,s,n),e.child}function Ay(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Nc(t,e,n,r,s){var i=Wt(n)?is:kt.current;return i=Ys(e,i),qs(e,s),n=Kd(t,e,n,r,i,s),r=Yd(),t!==null&&!Ut?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,nr(t,e,s)):(Le&&r&&Ld(e),e.flags|=1,Dt(t,e,n,s),e.child)}function Tp(t,e,n,r,s){if(Wt(n)){var i=!0;sl(e)}else i=!1;if(qs(e,s),e.stateNode===null)Oa(t,e),wy(e,n,r),bc(e,n,r,s),r=!0;else if(t===null){var a=e.stateNode,l=e.memoizedProps;a.props=l;var u=a.context,h=n.contextType;typeof h=="object"&&h!==null?h=mn(h):(h=Wt(n)?is:kt.current,h=Ys(e,h));var p=n.getDerivedStateFromProps,y=typeof p=="function"||typeof a.getSnapshotBeforeUpdate=="function";y||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==r||u!==h)&&vp(e,a,r,h),mr=!1;var m=e.memoizedState;a.state=m,ul(e,r,a,s),u=e.memoizedState,l!==r||m!==u||$t.current||mr?(typeof p=="function"&&(Pc(e,n,p,r),u=e.memoizedState),(l=mr||yp(e,n,l,r,m,u,h))?(y||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=u),a.props=r,a.state=u,a.context=h,r=l):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{a=e.stateNode,ey(t,e),l=e.memoizedProps,h=e.type===e.elementType?l:xn(e.type,l),a.props=h,y=e.pendingProps,m=a.context,u=n.contextType,typeof u=="object"&&u!==null?u=mn(u):(u=Wt(n)?is:kt.current,u=Ys(e,u));var C=n.getDerivedStateFromProps;(p=typeof C=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==y||m!==u)&&vp(e,a,r,u),mr=!1,m=e.memoizedState,a.state=m,ul(e,r,a,s);var R=e.memoizedState;l!==y||m!==R||$t.current||mr?(typeof C=="function"&&(Pc(e,n,C,r),R=e.memoizedState),(h=mr||yp(e,n,h,r,m,R,u)||!1)?(p||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(r,R,u),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(r,R,u)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||l===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=R),a.props=r,a.state=R,a.context=u,r=h):(typeof a.componentDidUpdate!="function"||l===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),r=!1)}return jc(t,e,n,r,i,s)}function jc(t,e,n,r,s,i){Ay(t,e);var a=(e.flags&128)!==0;if(!r&&!a)return s&&up(e,n,!1),nr(t,e,i);r=e.stateNode,Jx.current=e;var l=a&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&a?(e.child=Js(e,t.child,null,i),e.child=Js(e,null,l,i)):Dt(t,e,l,i),e.memoizedState=r.state,s&&up(e,n,!0),e.child}function Cy(t){var e=t.stateNode;e.pendingContext?lp(t,e.pendingContext,e.pendingContext!==e.context):e.context&&lp(t,e.context,!1),Hd(t,e.containerInfo)}function Ip(t,e,n,r,s){return Xs(),Fd(s),e.flags|=256,Dt(t,e,n,r),e.child}var Vc={dehydrated:null,treeContext:null,retryLane:0};function Mc(t){return{baseLanes:t,cachePool:null,transitions:null}}function ky(t,e,n){var r=e.pendingProps,s=Fe.current,i=!1,a=(e.flags&128)!==0,l;if((l=a)||(l=t!==null&&t.memoizedState===null?!1:(s&2)!==0),l?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),be(Fe,s&1),t===null)return kc(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=r.children,t=r.fallback,i?(r=e.mode,i=e.child,a={mode:"hidden",children:a},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=a):i=zl(a,r,0,null),t=rs(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=Mc(n),e.memoizedState=Vc,t):Zd(e,a));if(s=t.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return Zx(t,e,a,r,l,s,n);if(i){i=r.fallback,a=e.mode,s=t.child,l=s.sibling;var u={mode:"hidden",children:r.children};return!(a&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=u,e.deletions=null):(r=Rr(s,u),r.subtreeFlags=s.subtreeFlags&14680064),l!==null?i=Rr(l,i):(i=rs(i,a,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,a=t.child.memoizedState,a=a===null?Mc(n):{baseLanes:a.baseLanes|n,cachePool:null,transitions:a.transitions},i.memoizedState=a,i.childLanes=t.childLanes&~n,e.memoizedState=Vc,r}return i=t.child,t=i.sibling,r=Rr(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Zd(t,e){return e=zl({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Sa(t,e,n,r){return r!==null&&Fd(r),Js(e,t.child,null,n),t=Zd(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function Zx(t,e,n,r,s,i,a){if(n)return e.flags&256?(e.flags&=-257,r=Bu(Error(H(422))),Sa(t,e,a,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=zl({mode:"visible",children:r.children},s,0,null),i=rs(i,s,a,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&Js(e,t.child,null,a),e.child.memoizedState=Mc(a),e.memoizedState=Vc,i);if(!(e.mode&1))return Sa(t,e,a,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var l=r.dgst;return r=l,i=Error(H(419)),r=Bu(i,r,void 0),Sa(t,e,a,r)}if(l=(a&t.childLanes)!==0,Ut||l){if(r=dt,r!==null){switch(a&-a){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|a)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,tr(t,s),Tn(r,t,s,-1))}return ih(),r=Bu(Error(H(421))),Sa(t,e,a,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=h1.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,en=Ir(s.nextSibling),nn=e,Le=!0,Sn=null,t!==null&&(ln[un++]=Qn,ln[un++]=Kn,ln[un++]=os,Qn=t.id,Kn=t.overflow,os=e),e=Zd(e,r.children),e.flags|=4096,e)}function Ap(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Rc(t.return,e,n)}function Uu(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function Ry(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(Dt(t,e,r.children,n),r=Fe.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Ap(t,n,e);else if(t.tag===19)Ap(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(be(Fe,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&cl(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),Uu(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&cl(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}Uu(e,!0,n,null,i);break;case"together":Uu(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Oa(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function nr(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),ls|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(H(153));if(e.child!==null){for(t=e.child,n=Rr(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Rr(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function e1(t,e,n){switch(e.tag){case 3:Cy(e),Xs();break;case 5:ty(e);break;case 1:Wt(e.type)&&sl(e);break;case 4:Hd(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;be(al,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(be(Fe,Fe.current&1),e.flags|=128,null):n&e.child.childLanes?ky(t,e,n):(be(Fe,Fe.current&1),t=nr(t,e,n),t!==null?t.sibling:null);be(Fe,Fe.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return Ry(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),be(Fe,Fe.current),r)break;return null;case 22:case 23:return e.lanes=0,Iy(t,e,n)}return nr(t,e,n)}var Py,Lc,by,Dy;Py=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Lc=function(){};by=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,es(jn.current);var i=null;switch(n){case"input":s=ic(t,s),r=ic(t,r),i=[];break;case"select":s=Be({},s,{value:void 0}),r=Be({},r,{value:void 0}),i=[];break;case"textarea":s=lc(t,s),r=lc(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=nl)}cc(n,r);var a;n=null;for(h in s)if(!r.hasOwnProperty(h)&&s.hasOwnProperty(h)&&s[h]!=null)if(h==="style"){var l=s[h];for(a in l)l.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else h!=="dangerouslySetInnerHTML"&&h!=="children"&&h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&h!=="autoFocus"&&(oo.hasOwnProperty(h)?i||(i=[]):(i=i||[]).push(h,null));for(h in r){var u=r[h];if(l=s!=null?s[h]:void 0,r.hasOwnProperty(h)&&u!==l&&(u!=null||l!=null))if(h==="style")if(l){for(a in l)!l.hasOwnProperty(a)||u&&u.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in u)u.hasOwnProperty(a)&&l[a]!==u[a]&&(n||(n={}),n[a]=u[a])}else n||(i||(i=[]),i.push(h,n)),n=u;else h==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,l=l?l.__html:void 0,u!=null&&l!==u&&(i=i||[]).push(h,u)):h==="children"?typeof u!="string"&&typeof u!="number"||(i=i||[]).push(h,""+u):h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&(oo.hasOwnProperty(h)?(u!=null&&h==="onScroll"&&Ne("scroll",t),i||l===u||(i=[])):(i=i||[]).push(h,u))}n&&(i=i||[]).push("style",n);var h=i;(e.updateQueue=h)&&(e.flags|=4)}};Dy=function(t,e,n,r){n!==r&&(e.flags|=4)};function Vi(t,e){if(!Le)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Tt(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function t1(t,e,n){var r=e.pendingProps;switch(Od(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Tt(e),null;case 1:return Wt(e.type)&&rl(),Tt(e),null;case 3:return r=e.stateNode,Zs(),Ve($t),Ve(kt),Gd(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(xa(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Sn!==null&&(Hc(Sn),Sn=null))),Lc(t,e),Tt(e),null;case 5:qd(e);var s=es(_o.current);if(n=e.type,t!==null&&e.stateNode!=null)by(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(H(166));return Tt(e),null}if(t=es(jn.current),xa(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[Dn]=e,r[yo]=i,t=(e.mode&1)!==0,n){case"dialog":Ne("cancel",r),Ne("close",r);break;case"iframe":case"object":case"embed":Ne("load",r);break;case"video":case"audio":for(s=0;s<Bi.length;s++)Ne(Bi[s],r);break;case"source":Ne("error",r);break;case"img":case"image":case"link":Ne("error",r),Ne("load",r);break;case"details":Ne("toggle",r);break;case"input":Vf(r,i),Ne("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Ne("invalid",r);break;case"textarea":Lf(r,i),Ne("invalid",r)}cc(n,i),s=null;for(var a in i)if(i.hasOwnProperty(a)){var l=i[a];a==="children"?typeof l=="string"?r.textContent!==l&&(i.suppressHydrationWarning!==!0&&_a(r.textContent,l,t),s=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&_a(r.textContent,l,t),s=["children",""+l]):oo.hasOwnProperty(a)&&l!=null&&a==="onScroll"&&Ne("scroll",r)}switch(n){case"input":da(r),Mf(r,i,!0);break;case"textarea":da(r),Of(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=nl)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{a=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=og(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=a.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=a.createElement(n,{is:r.is}):(t=a.createElement(n),n==="select"&&(a=t,r.multiple?a.multiple=!0:r.size&&(a.size=r.size))):t=a.createElementNS(t,n),t[Dn]=e,t[yo]=r,Py(t,e,!1,!1),e.stateNode=t;e:{switch(a=dc(n,r),n){case"dialog":Ne("cancel",t),Ne("close",t),s=r;break;case"iframe":case"object":case"embed":Ne("load",t),s=r;break;case"video":case"audio":for(s=0;s<Bi.length;s++)Ne(Bi[s],t);s=r;break;case"source":Ne("error",t),s=r;break;case"img":case"image":case"link":Ne("error",t),Ne("load",t),s=r;break;case"details":Ne("toggle",t),s=r;break;case"input":Vf(t,r),s=ic(t,r),Ne("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=Be({},r,{value:void 0}),Ne("invalid",t);break;case"textarea":Lf(t,r),s=lc(t,r),Ne("invalid",t);break;default:s=r}cc(n,s),l=s;for(i in l)if(l.hasOwnProperty(i)){var u=l[i];i==="style"?ug(t,u):i==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&ag(t,u)):i==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&ao(t,u):typeof u=="number"&&ao(t,""+u):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(oo.hasOwnProperty(i)?u!=null&&i==="onScroll"&&Ne("scroll",t):u!=null&&Ed(t,i,u,a))}switch(n){case"input":da(t),Mf(t,r,!1);break;case"textarea":da(t),Of(t);break;case"option":r.value!=null&&t.setAttribute("value",""+jr(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?Us(t,!!r.multiple,i,!1):r.defaultValue!=null&&Us(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=nl)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Tt(e),null;case 6:if(t&&e.stateNode!=null)Dy(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(H(166));if(n=es(_o.current),es(jn.current),xa(e)){if(r=e.stateNode,n=e.memoizedProps,r[Dn]=e,(i=r.nodeValue!==n)&&(t=nn,t!==null))switch(t.tag){case 3:_a(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&_a(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Dn]=e,e.stateNode=r}return Tt(e),null;case 13:if(Ve(Fe),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Le&&en!==null&&e.mode&1&&!(e.flags&128))Yg(),Xs(),e.flags|=98560,i=!1;else if(i=xa(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(H(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(H(317));i[Dn]=e}else Xs(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Tt(e),i=!1}else Sn!==null&&(Hc(Sn),Sn=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Fe.current&1?ot===0&&(ot=3):ih())),e.updateQueue!==null&&(e.flags|=4),Tt(e),null);case 4:return Zs(),Lc(t,e),t===null&&mo(e.stateNode.containerInfo),Tt(e),null;case 10:return Ud(e.type._context),Tt(e),null;case 17:return Wt(e.type)&&rl(),Tt(e),null;case 19:if(Ve(Fe),i=e.memoizedState,i===null)return Tt(e),null;if(r=(e.flags&128)!==0,a=i.rendering,a===null)if(r)Vi(i,!1);else{if(ot!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(a=cl(t),a!==null){for(e.flags|=128,Vi(i,!1),r=a.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,a=i.alternate,a===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=a.childLanes,i.lanes=a.lanes,i.child=a.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=a.memoizedProps,i.memoizedState=a.memoizedState,i.updateQueue=a.updateQueue,i.type=a.type,t=a.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return be(Fe,Fe.current&1|2),e.child}t=t.sibling}i.tail!==null&&Ke()>ti&&(e.flags|=128,r=!0,Vi(i,!1),e.lanes=4194304)}else{if(!r)if(t=cl(a),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Vi(i,!0),i.tail===null&&i.tailMode==="hidden"&&!a.alternate&&!Le)return Tt(e),null}else 2*Ke()-i.renderingStartTime>ti&&n!==1073741824&&(e.flags|=128,r=!0,Vi(i,!1),e.lanes=4194304);i.isBackwards?(a.sibling=e.child,e.child=a):(n=i.last,n!==null?n.sibling=a:e.child=a,i.last=a)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Ke(),e.sibling=null,n=Fe.current,be(Fe,r?n&1|2:n&1),e):(Tt(e),null);case 22:case 23:return sh(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Zt&1073741824&&(Tt(e),e.subtreeFlags&6&&(e.flags|=8192)):Tt(e),null;case 24:return null;case 25:return null}throw Error(H(156,e.tag))}function n1(t,e){switch(Od(e),e.tag){case 1:return Wt(e.type)&&rl(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Zs(),Ve($t),Ve(kt),Gd(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return qd(e),null;case 13:if(Ve(Fe),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(H(340));Xs()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Ve(Fe),null;case 4:return Zs(),null;case 10:return Ud(e.type._context),null;case 22:case 23:return sh(),null;case 24:return null;default:return null}}var Ea=!1,At=!1,r1=typeof WeakSet=="function"?WeakSet:Set,ee=null;function zs(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){He(t,e,r)}else n.current=null}function Oc(t,e,n){try{n()}catch(r){He(t,e,r)}}var Cp=!1;function s1(t,e){if(wc=Za,t=Lg(),Md(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var a=0,l=-1,u=-1,h=0,p=0,y=t,m=null;t:for(;;){for(var C;y!==n||s!==0&&y.nodeType!==3||(l=a+s),y!==i||r!==0&&y.nodeType!==3||(u=a+r),y.nodeType===3&&(a+=y.nodeValue.length),(C=y.firstChild)!==null;)m=y,y=C;for(;;){if(y===t)break t;if(m===n&&++h===s&&(l=a),m===i&&++p===r&&(u=a),(C=y.nextSibling)!==null)break;y=m,m=y.parentNode}y=C}n=l===-1||u===-1?null:{start:l,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(Sc={focusedElem:t,selectionRange:n},Za=!1,ee=e;ee!==null;)if(e=ee,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,ee=t;else for(;ee!==null;){e=ee;try{var R=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(R!==null){var P=R.memoizedProps,O=R.memoizedState,k=e.stateNode,A=k.getSnapshotBeforeUpdate(e.elementType===e.type?P:xn(e.type,P),O);k.__reactInternalSnapshotBeforeUpdate=A}break;case 3:var w=e.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(H(163))}}catch(b){He(e,e.return,b)}if(t=e.sibling,t!==null){t.return=e.return,ee=t;break}ee=e.return}return R=Cp,Cp=!1,R}function Zi(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&Oc(e,n,i)}s=s.next}while(s!==r)}}function Ol(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Fc(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function Ny(t){var e=t.alternate;e!==null&&(t.alternate=null,Ny(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Dn],delete e[yo],delete e[Ic],delete e[zx],delete e[Bx])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function jy(t){return t.tag===5||t.tag===3||t.tag===4}function kp(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||jy(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function zc(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=nl));else if(r!==4&&(t=t.child,t!==null))for(zc(t,e,n),t=t.sibling;t!==null;)zc(t,e,n),t=t.sibling}function Bc(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Bc(t,e,n),t=t.sibling;t!==null;)Bc(t,e,n),t=t.sibling}var ft=null,wn=!1;function fr(t,e,n){for(n=n.child;n!==null;)Vy(t,e,n),n=n.sibling}function Vy(t,e,n){if(Nn&&typeof Nn.onCommitFiberUnmount=="function")try{Nn.onCommitFiberUnmount(Pl,n)}catch{}switch(n.tag){case 5:At||zs(n,e);case 6:var r=ft,s=wn;ft=null,fr(t,e,n),ft=r,wn=s,ft!==null&&(wn?(t=ft,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):ft.removeChild(n.stateNode));break;case 18:ft!==null&&(wn?(t=ft,n=n.stateNode,t.nodeType===8?Vu(t.parentNode,n):t.nodeType===1&&Vu(t,n),ho(t)):Vu(ft,n.stateNode));break;case 4:r=ft,s=wn,ft=n.stateNode.containerInfo,wn=!0,fr(t,e,n),ft=r,wn=s;break;case 0:case 11:case 14:case 15:if(!At&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,a=i.destroy;i=i.tag,a!==void 0&&(i&2||i&4)&&Oc(n,e,a),s=s.next}while(s!==r)}fr(t,e,n);break;case 1:if(!At&&(zs(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){He(n,e,l)}fr(t,e,n);break;case 21:fr(t,e,n);break;case 22:n.mode&1?(At=(r=At)||n.memoizedState!==null,fr(t,e,n),At=r):fr(t,e,n);break;default:fr(t,e,n)}}function Rp(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new r1),e.forEach(function(r){var s=f1.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function _n(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,a=e,l=a;e:for(;l!==null;){switch(l.tag){case 5:ft=l.stateNode,wn=!1;break e;case 3:ft=l.stateNode.containerInfo,wn=!0;break e;case 4:ft=l.stateNode.containerInfo,wn=!0;break e}l=l.return}if(ft===null)throw Error(H(160));Vy(i,a,s),ft=null,wn=!1;var u=s.alternate;u!==null&&(u.return=null),s.return=null}catch(h){He(s,e,h)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)My(e,t),e=e.sibling}function My(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(_n(e,t),Pn(t),r&4){try{Zi(3,t,t.return),Ol(3,t)}catch(P){He(t,t.return,P)}try{Zi(5,t,t.return)}catch(P){He(t,t.return,P)}}break;case 1:_n(e,t),Pn(t),r&512&&n!==null&&zs(n,n.return);break;case 5:if(_n(e,t),Pn(t),r&512&&n!==null&&zs(n,n.return),t.flags&32){var s=t.stateNode;try{ao(s,"")}catch(P){He(t,t.return,P)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,a=n!==null?n.memoizedProps:i,l=t.type,u=t.updateQueue;if(t.updateQueue=null,u!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&sg(s,i),dc(l,a);var h=dc(l,i);for(a=0;a<u.length;a+=2){var p=u[a],y=u[a+1];p==="style"?ug(s,y):p==="dangerouslySetInnerHTML"?ag(s,y):p==="children"?ao(s,y):Ed(s,p,y,h)}switch(l){case"input":oc(s,i);break;case"textarea":ig(s,i);break;case"select":var m=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var C=i.value;C!=null?Us(s,!!i.multiple,C,!1):m!==!!i.multiple&&(i.defaultValue!=null?Us(s,!!i.multiple,i.defaultValue,!0):Us(s,!!i.multiple,i.multiple?[]:"",!1))}s[yo]=i}catch(P){He(t,t.return,P)}}break;case 6:if(_n(e,t),Pn(t),r&4){if(t.stateNode===null)throw Error(H(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(P){He(t,t.return,P)}}break;case 3:if(_n(e,t),Pn(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{ho(e.containerInfo)}catch(P){He(t,t.return,P)}break;case 4:_n(e,t),Pn(t);break;case 13:_n(e,t),Pn(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(nh=Ke())),r&4&&Rp(t);break;case 22:if(p=n!==null&&n.memoizedState!==null,t.mode&1?(At=(h=At)||p,_n(e,t),At=h):_n(e,t),Pn(t),r&8192){if(h=t.memoizedState!==null,(t.stateNode.isHidden=h)&&!p&&t.mode&1)for(ee=t,p=t.child;p!==null;){for(y=ee=p;ee!==null;){switch(m=ee,C=m.child,m.tag){case 0:case 11:case 14:case 15:Zi(4,m,m.return);break;case 1:zs(m,m.return);var R=m.stateNode;if(typeof R.componentWillUnmount=="function"){r=m,n=m.return;try{e=r,R.props=e.memoizedProps,R.state=e.memoizedState,R.componentWillUnmount()}catch(P){He(r,n,P)}}break;case 5:zs(m,m.return);break;case 22:if(m.memoizedState!==null){bp(y);continue}}C!==null?(C.return=m,ee=C):bp(y)}p=p.sibling}e:for(p=null,y=t;;){if(y.tag===5){if(p===null){p=y;try{s=y.stateNode,h?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=y.stateNode,u=y.memoizedProps.style,a=u!=null&&u.hasOwnProperty("display")?u.display:null,l.style.display=lg("display",a))}catch(P){He(t,t.return,P)}}}else if(y.tag===6){if(p===null)try{y.stateNode.nodeValue=h?"":y.memoizedProps}catch(P){He(t,t.return,P)}}else if((y.tag!==22&&y.tag!==23||y.memoizedState===null||y===t)&&y.child!==null){y.child.return=y,y=y.child;continue}if(y===t)break e;for(;y.sibling===null;){if(y.return===null||y.return===t)break e;p===y&&(p=null),y=y.return}p===y&&(p=null),y.sibling.return=y.return,y=y.sibling}}break;case 19:_n(e,t),Pn(t),r&4&&Rp(t);break;case 21:break;default:_n(e,t),Pn(t)}}function Pn(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(jy(n)){var r=n;break e}n=n.return}throw Error(H(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(ao(s,""),r.flags&=-33);var i=kp(t);Bc(t,i,s);break;case 3:case 4:var a=r.stateNode.containerInfo,l=kp(t);zc(t,l,a);break;default:throw Error(H(161))}}catch(u){He(t,t.return,u)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function i1(t,e,n){ee=t,Ly(t)}function Ly(t,e,n){for(var r=(t.mode&1)!==0;ee!==null;){var s=ee,i=s.child;if(s.tag===22&&r){var a=s.memoizedState!==null||Ea;if(!a){var l=s.alternate,u=l!==null&&l.memoizedState!==null||At;l=Ea;var h=At;if(Ea=a,(At=u)&&!h)for(ee=s;ee!==null;)a=ee,u=a.child,a.tag===22&&a.memoizedState!==null?Dp(s):u!==null?(u.return=a,ee=u):Dp(s);for(;i!==null;)ee=i,Ly(i),i=i.sibling;ee=s,Ea=l,At=h}Pp(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,ee=i):Pp(t)}}function Pp(t){for(;ee!==null;){var e=ee;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:At||Ol(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!At)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:xn(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&pp(e,i,r);break;case 3:var a=e.updateQueue;if(a!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}pp(e,a,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var u=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var h=e.alternate;if(h!==null){var p=h.memoizedState;if(p!==null){var y=p.dehydrated;y!==null&&ho(y)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(H(163))}At||e.flags&512&&Fc(e)}catch(m){He(e,e.return,m)}}if(e===t){ee=null;break}if(n=e.sibling,n!==null){n.return=e.return,ee=n;break}ee=e.return}}function bp(t){for(;ee!==null;){var e=ee;if(e===t){ee=null;break}var n=e.sibling;if(n!==null){n.return=e.return,ee=n;break}ee=e.return}}function Dp(t){for(;ee!==null;){var e=ee;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Ol(4,e)}catch(u){He(e,n,u)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(u){He(e,s,u)}}var i=e.return;try{Fc(e)}catch(u){He(e,i,u)}break;case 5:var a=e.return;try{Fc(e)}catch(u){He(e,a,u)}}}catch(u){He(e,e.return,u)}if(e===t){ee=null;break}var l=e.sibling;if(l!==null){l.return=e.return,ee=l;break}ee=e.return}}var o1=Math.ceil,fl=or.ReactCurrentDispatcher,eh=or.ReactCurrentOwner,fn=or.ReactCurrentBatchConfig,ve=0,dt=null,Je=null,gt=0,Zt=0,Bs=zr(0),ot=0,Eo=null,ls=0,Fl=0,th=0,eo=null,zt=null,nh=0,ti=1/0,Hn=null,pl=!1,Uc=null,Cr=null,Ta=!1,xr=null,ml=0,to=0,$c=null,Fa=-1,za=0;function Nt(){return ve&6?Ke():Fa!==-1?Fa:Fa=Ke()}function kr(t){return t.mode&1?ve&2&&gt!==0?gt&-gt:$x.transition!==null?(za===0&&(za=wg()),za):(t=Te,t!==0||(t=window.event,t=t===void 0?16:kg(t.type)),t):1}function Tn(t,e,n,r){if(50<to)throw to=0,$c=null,Error(H(185));Vo(t,n,r),(!(ve&2)||t!==dt)&&(t===dt&&(!(ve&2)&&(Fl|=n),ot===4&&yr(t,gt)),Ht(t,r),n===1&&ve===0&&!(e.mode&1)&&(ti=Ke()+500,Vl&&Br()))}function Ht(t,e){var n=t.callbackNode;$_(t,e);var r=Ja(t,t===dt?gt:0);if(r===0)n!==null&&Bf(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&Bf(n),e===1)t.tag===0?Ux(Np.bind(null,t)):Gg(Np.bind(null,t)),Ox(function(){!(ve&6)&&Br()}),n=null;else{switch(Sg(r)){case 1:n=kd;break;case 4:n=_g;break;case 16:n=Xa;break;case 536870912:n=xg;break;default:n=Xa}n=Hy(n,Oy.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function Oy(t,e){if(Fa=-1,za=0,ve&6)throw Error(H(327));var n=t.callbackNode;if(Gs()&&t.callbackNode!==n)return null;var r=Ja(t,t===dt?gt:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=gl(t,r);else{e=r;var s=ve;ve|=2;var i=zy();(dt!==t||gt!==e)&&(Hn=null,ti=Ke()+500,ns(t,e));do try{u1();break}catch(l){Fy(t,l)}while(!0);Bd(),fl.current=i,ve=s,Je!==null?e=0:(dt=null,gt=0,e=ot)}if(e!==0){if(e===2&&(s=gc(t),s!==0&&(r=s,e=Wc(t,s))),e===1)throw n=Eo,ns(t,0),yr(t,r),Ht(t,Ke()),n;if(e===6)yr(t,r);else{if(s=t.current.alternate,!(r&30)&&!a1(s)&&(e=gl(t,r),e===2&&(i=gc(t),i!==0&&(r=i,e=Wc(t,i))),e===1))throw n=Eo,ns(t,0),yr(t,r),Ht(t,Ke()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(H(345));case 2:Yr(t,zt,Hn);break;case 3:if(yr(t,r),(r&130023424)===r&&(e=nh+500-Ke(),10<e)){if(Ja(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){Nt(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=Tc(Yr.bind(null,t,zt,Hn),e);break}Yr(t,zt,Hn);break;case 4:if(yr(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var a=31-En(r);i=1<<a,a=e[a],a>s&&(s=a),r&=~i}if(r=s,r=Ke()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*o1(r/1960))-r,10<r){t.timeoutHandle=Tc(Yr.bind(null,t,zt,Hn),r);break}Yr(t,zt,Hn);break;case 5:Yr(t,zt,Hn);break;default:throw Error(H(329))}}}return Ht(t,Ke()),t.callbackNode===n?Oy.bind(null,t):null}function Wc(t,e){var n=eo;return t.current.memoizedState.isDehydrated&&(ns(t,e).flags|=256),t=gl(t,e),t!==2&&(e=zt,zt=n,e!==null&&Hc(e)),t}function Hc(t){zt===null?zt=t:zt.push.apply(zt,t)}function a1(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!In(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function yr(t,e){for(e&=~th,e&=~Fl,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-En(e),r=1<<n;t[n]=-1,e&=~r}}function Np(t){if(ve&6)throw Error(H(327));Gs();var e=Ja(t,0);if(!(e&1))return Ht(t,Ke()),null;var n=gl(t,e);if(t.tag!==0&&n===2){var r=gc(t);r!==0&&(e=r,n=Wc(t,r))}if(n===1)throw n=Eo,ns(t,0),yr(t,e),Ht(t,Ke()),n;if(n===6)throw Error(H(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Yr(t,zt,Hn),Ht(t,Ke()),null}function rh(t,e){var n=ve;ve|=1;try{return t(e)}finally{ve=n,ve===0&&(ti=Ke()+500,Vl&&Br())}}function us(t){xr!==null&&xr.tag===0&&!(ve&6)&&Gs();var e=ve;ve|=1;var n=fn.transition,r=Te;try{if(fn.transition=null,Te=1,t)return t()}finally{Te=r,fn.transition=n,ve=e,!(ve&6)&&Br()}}function sh(){Zt=Bs.current,Ve(Bs)}function ns(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,Lx(n)),Je!==null)for(n=Je.return;n!==null;){var r=n;switch(Od(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&rl();break;case 3:Zs(),Ve($t),Ve(kt),Gd();break;case 5:qd(r);break;case 4:Zs();break;case 13:Ve(Fe);break;case 19:Ve(Fe);break;case 10:Ud(r.type._context);break;case 22:case 23:sh()}n=n.return}if(dt=t,Je=t=Rr(t.current,null),gt=Zt=e,ot=0,Eo=null,th=Fl=ls=0,zt=eo=null,Zr!==null){for(e=0;e<Zr.length;e++)if(n=Zr[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var a=i.next;i.next=s,r.next=a}n.pending=r}Zr=null}return t}function Fy(t,e){do{var n=Je;try{if(Bd(),Ma.current=hl,dl){for(var r=ze.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}dl=!1}if(as=0,ct=st=ze=null,Ji=!1,xo=0,eh.current=null,n===null||n.return===null){ot=1,Eo=e,Je=null;break}e:{var i=t,a=n.return,l=n,u=e;if(e=gt,l.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var h=u,p=l,y=p.tag;if(!(p.mode&1)&&(y===0||y===11||y===15)){var m=p.alternate;m?(p.updateQueue=m.updateQueue,p.memoizedState=m.memoizedState,p.lanes=m.lanes):(p.updateQueue=null,p.memoizedState=null)}var C=xp(a);if(C!==null){C.flags&=-257,wp(C,a,l,i,e),C.mode&1&&_p(i,h,e),e=C,u=h;var R=e.updateQueue;if(R===null){var P=new Set;P.add(u),e.updateQueue=P}else R.add(u);break e}else{if(!(e&1)){_p(i,h,e),ih();break e}u=Error(H(426))}}else if(Le&&l.mode&1){var O=xp(a);if(O!==null){!(O.flags&65536)&&(O.flags|=256),wp(O,a,l,i,e),Fd(ei(u,l));break e}}i=u=ei(u,l),ot!==4&&(ot=2),eo===null?eo=[i]:eo.push(i),i=a;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var k=Sy(i,u,e);fp(i,k);break e;case 1:l=u;var A=i.type,w=i.stateNode;if(!(i.flags&128)&&(typeof A.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(Cr===null||!Cr.has(w)))){i.flags|=65536,e&=-e,i.lanes|=e;var b=Ey(i,l,e);fp(i,b);break e}}i=i.return}while(i!==null)}Uy(n)}catch(j){e=j,Je===n&&n!==null&&(Je=n=n.return);continue}break}while(!0)}function zy(){var t=fl.current;return fl.current=hl,t===null?hl:t}function ih(){(ot===0||ot===3||ot===2)&&(ot=4),dt===null||!(ls&268435455)&&!(Fl&268435455)||yr(dt,gt)}function gl(t,e){var n=ve;ve|=2;var r=zy();(dt!==t||gt!==e)&&(Hn=null,ns(t,e));do try{l1();break}catch(s){Fy(t,s)}while(!0);if(Bd(),ve=n,fl.current=r,Je!==null)throw Error(H(261));return dt=null,gt=0,ot}function l1(){for(;Je!==null;)By(Je)}function u1(){for(;Je!==null&&!j_();)By(Je)}function By(t){var e=Wy(t.alternate,t,Zt);t.memoizedProps=t.pendingProps,e===null?Uy(t):Je=e,eh.current=null}function Uy(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=n1(n,e),n!==null){n.flags&=32767,Je=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{ot=6,Je=null;return}}else if(n=t1(n,e,Zt),n!==null){Je=n;return}if(e=e.sibling,e!==null){Je=e;return}Je=e=t}while(e!==null);ot===0&&(ot=5)}function Yr(t,e,n){var r=Te,s=fn.transition;try{fn.transition=null,Te=1,c1(t,e,n,r)}finally{fn.transition=s,Te=r}return null}function c1(t,e,n,r){do Gs();while(xr!==null);if(ve&6)throw Error(H(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(H(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(W_(t,i),t===dt&&(Je=dt=null,gt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Ta||(Ta=!0,Hy(Xa,function(){return Gs(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=fn.transition,fn.transition=null;var a=Te;Te=1;var l=ve;ve|=4,eh.current=null,s1(t,n),My(n,t),Px(Sc),Za=!!wc,Sc=wc=null,t.current=n,i1(n),V_(),ve=l,Te=a,fn.transition=i}else t.current=n;if(Ta&&(Ta=!1,xr=t,ml=s),i=t.pendingLanes,i===0&&(Cr=null),O_(n.stateNode),Ht(t,Ke()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(pl)throw pl=!1,t=Uc,Uc=null,t;return ml&1&&t.tag!==0&&Gs(),i=t.pendingLanes,i&1?t===$c?to++:(to=0,$c=t):to=0,Br(),null}function Gs(){if(xr!==null){var t=Sg(ml),e=fn.transition,n=Te;try{if(fn.transition=null,Te=16>t?16:t,xr===null)var r=!1;else{if(t=xr,xr=null,ml=0,ve&6)throw Error(H(331));var s=ve;for(ve|=4,ee=t.current;ee!==null;){var i=ee,a=i.child;if(ee.flags&16){var l=i.deletions;if(l!==null){for(var u=0;u<l.length;u++){var h=l[u];for(ee=h;ee!==null;){var p=ee;switch(p.tag){case 0:case 11:case 15:Zi(8,p,i)}var y=p.child;if(y!==null)y.return=p,ee=y;else for(;ee!==null;){p=ee;var m=p.sibling,C=p.return;if(Ny(p),p===h){ee=null;break}if(m!==null){m.return=C,ee=m;break}ee=C}}}var R=i.alternate;if(R!==null){var P=R.child;if(P!==null){R.child=null;do{var O=P.sibling;P.sibling=null,P=O}while(P!==null)}}ee=i}}if(i.subtreeFlags&2064&&a!==null)a.return=i,ee=a;else e:for(;ee!==null;){if(i=ee,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Zi(9,i,i.return)}var k=i.sibling;if(k!==null){k.return=i.return,ee=k;break e}ee=i.return}}var A=t.current;for(ee=A;ee!==null;){a=ee;var w=a.child;if(a.subtreeFlags&2064&&w!==null)w.return=a,ee=w;else e:for(a=A;ee!==null;){if(l=ee,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Ol(9,l)}}catch(j){He(l,l.return,j)}if(l===a){ee=null;break e}var b=l.sibling;if(b!==null){b.return=l.return,ee=b;break e}ee=l.return}}if(ve=s,Br(),Nn&&typeof Nn.onPostCommitFiberRoot=="function")try{Nn.onPostCommitFiberRoot(Pl,t)}catch{}r=!0}return r}finally{Te=n,fn.transition=e}}return!1}function jp(t,e,n){e=ei(n,e),e=Sy(t,e,1),t=Ar(t,e,1),e=Nt(),t!==null&&(Vo(t,1,e),Ht(t,e))}function He(t,e,n){if(t.tag===3)jp(t,t,n);else for(;e!==null;){if(e.tag===3){jp(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Cr===null||!Cr.has(r))){t=ei(n,t),t=Ey(e,t,1),e=Ar(e,t,1),t=Nt(),e!==null&&(Vo(e,1,t),Ht(e,t));break}}e=e.return}}function d1(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Nt(),t.pingedLanes|=t.suspendedLanes&n,dt===t&&(gt&n)===n&&(ot===4||ot===3&&(gt&130023424)===gt&&500>Ke()-nh?ns(t,0):th|=n),Ht(t,e)}function $y(t,e){e===0&&(t.mode&1?(e=pa,pa<<=1,!(pa&130023424)&&(pa=4194304)):e=1);var n=Nt();t=tr(t,e),t!==null&&(Vo(t,e,n),Ht(t,n))}function h1(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),$y(t,n)}function f1(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(H(314))}r!==null&&r.delete(e),$y(t,n)}var Wy;Wy=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||$t.current)Ut=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Ut=!1,e1(t,e,n);Ut=!!(t.flags&131072)}else Ut=!1,Le&&e.flags&1048576&&Qg(e,ol,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Oa(t,e),t=e.pendingProps;var s=Ys(e,kt.current);qs(e,n),s=Kd(null,e,r,t,s,n);var i=Yd();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Wt(r)?(i=!0,sl(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Wd(e),s.updater=Ll,e.stateNode=s,s._reactInternals=e,bc(e,r,t,n),e=jc(null,e,r,!0,i,n)):(e.tag=0,Le&&i&&Ld(e),Dt(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Oa(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=m1(r),t=xn(r,t),s){case 0:e=Nc(null,e,r,t,n);break e;case 1:e=Tp(null,e,r,t,n);break e;case 11:e=Sp(null,e,r,t,n);break e;case 14:e=Ep(null,e,r,xn(r.type,t),n);break e}throw Error(H(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:xn(r,s),Nc(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:xn(r,s),Tp(t,e,r,s,n);case 3:e:{if(Cy(e),t===null)throw Error(H(387));r=e.pendingProps,i=e.memoizedState,s=i.element,ey(t,e),ul(e,r,null,n);var a=e.memoizedState;if(r=a.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=ei(Error(H(423)),e),e=Ip(t,e,r,n,s);break e}else if(r!==s){s=ei(Error(H(424)),e),e=Ip(t,e,r,n,s);break e}else for(en=Ir(e.stateNode.containerInfo.firstChild),nn=e,Le=!0,Sn=null,n=Jg(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Xs(),r===s){e=nr(t,e,n);break e}Dt(t,e,r,n)}e=e.child}return e;case 5:return ty(e),t===null&&kc(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,a=s.children,Ec(r,s)?a=null:i!==null&&Ec(r,i)&&(e.flags|=32),Ay(t,e),Dt(t,e,a,n),e.child;case 6:return t===null&&kc(e),null;case 13:return ky(t,e,n);case 4:return Hd(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Js(e,null,r,n):Dt(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:xn(r,s),Sp(t,e,r,s,n);case 7:return Dt(t,e,e.pendingProps,n),e.child;case 8:return Dt(t,e,e.pendingProps.children,n),e.child;case 12:return Dt(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,a=s.value,be(al,r._currentValue),r._currentValue=a,i!==null)if(In(i.value,a)){if(i.children===s.children&&!$t.current){e=nr(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var l=i.dependencies;if(l!==null){a=i.child;for(var u=l.firstContext;u!==null;){if(u.context===r){if(i.tag===1){u=Yn(-1,n&-n),u.tag=2;var h=i.updateQueue;if(h!==null){h=h.shared;var p=h.pending;p===null?u.next=u:(u.next=p.next,p.next=u),h.pending=u}}i.lanes|=n,u=i.alternate,u!==null&&(u.lanes|=n),Rc(i.return,n,e),l.lanes|=n;break}u=u.next}}else if(i.tag===10)a=i.type===e.type?null:i.child;else if(i.tag===18){if(a=i.return,a===null)throw Error(H(341));a.lanes|=n,l=a.alternate,l!==null&&(l.lanes|=n),Rc(a,n,e),a=i.sibling}else a=i.child;if(a!==null)a.return=i;else for(a=i;a!==null;){if(a===e){a=null;break}if(i=a.sibling,i!==null){i.return=a.return,a=i;break}a=a.return}i=a}Dt(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,qs(e,n),s=mn(s),r=r(s),e.flags|=1,Dt(t,e,r,n),e.child;case 14:return r=e.type,s=xn(r,e.pendingProps),s=xn(r.type,s),Ep(t,e,r,s,n);case 15:return Ty(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:xn(r,s),Oa(t,e),e.tag=1,Wt(r)?(t=!0,sl(e)):t=!1,qs(e,n),wy(e,r,s),bc(e,r,s,n),jc(null,e,r,!0,t,n);case 19:return Ry(t,e,n);case 22:return Iy(t,e,n)}throw Error(H(156,e.tag))};function Hy(t,e){return vg(t,e)}function p1(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function dn(t,e,n,r){return new p1(t,e,n,r)}function oh(t){return t=t.prototype,!(!t||!t.isReactComponent)}function m1(t){if(typeof t=="function")return oh(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Id)return 11;if(t===Ad)return 14}return 2}function Rr(t,e){var n=t.alternate;return n===null?(n=dn(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Ba(t,e,n,r,s,i){var a=2;if(r=t,typeof t=="function")oh(t)&&(a=1);else if(typeof t=="string")a=5;else e:switch(t){case bs:return rs(n.children,s,i,e);case Td:a=8,s|=8;break;case tc:return t=dn(12,n,e,s|2),t.elementType=tc,t.lanes=i,t;case nc:return t=dn(13,n,e,s),t.elementType=nc,t.lanes=i,t;case rc:return t=dn(19,n,e,s),t.elementType=rc,t.lanes=i,t;case tg:return zl(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Zm:a=10;break e;case eg:a=9;break e;case Id:a=11;break e;case Ad:a=14;break e;case pr:a=16,r=null;break e}throw Error(H(130,t==null?t:typeof t,""))}return e=dn(a,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function rs(t,e,n,r){return t=dn(7,t,r,e),t.lanes=n,t}function zl(t,e,n,r){return t=dn(22,t,r,e),t.elementType=tg,t.lanes=n,t.stateNode={isHidden:!1},t}function $u(t,e,n){return t=dn(6,t,null,e),t.lanes=n,t}function Wu(t,e,n){return e=dn(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function g1(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Tu(0),this.expirationTimes=Tu(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Tu(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function ah(t,e,n,r,s,i,a,l,u){return t=new g1(t,e,n,l,u),e===1?(e=1,i===!0&&(e|=8)):e=0,i=dn(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Wd(i),t}function y1(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ps,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function qy(t){if(!t)return Vr;t=t._reactInternals;e:{if(ps(t)!==t||t.tag!==1)throw Error(H(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Wt(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(H(171))}if(t.tag===1){var n=t.type;if(Wt(n))return qg(t,n,e)}return e}function Gy(t,e,n,r,s,i,a,l,u){return t=ah(n,r,!0,t,s,i,a,l,u),t.context=qy(null),n=t.current,r=Nt(),s=kr(n),i=Yn(r,s),i.callback=e??null,Ar(n,i,s),t.current.lanes=s,Vo(t,s,r),Ht(t,r),t}function Bl(t,e,n,r){var s=e.current,i=Nt(),a=kr(s);return n=qy(n),e.context===null?e.context=n:e.pendingContext=n,e=Yn(i,a),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Ar(s,e,a),t!==null&&(Tn(t,s,a,i),Va(t,s,a)),a}function yl(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Vp(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function lh(t,e){Vp(t,e),(t=t.alternate)&&Vp(t,e)}function v1(){return null}var Qy=typeof reportError=="function"?reportError:function(t){console.error(t)};function uh(t){this._internalRoot=t}Ul.prototype.render=uh.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(H(409));Bl(t,e,null,null)};Ul.prototype.unmount=uh.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;us(function(){Bl(null,t,null,null)}),e[er]=null}};function Ul(t){this._internalRoot=t}Ul.prototype.unstable_scheduleHydration=function(t){if(t){var e=Ig();t={blockedOn:null,target:t,priority:e};for(var n=0;n<gr.length&&e!==0&&e<gr[n].priority;n++);gr.splice(n,0,t),n===0&&Cg(t)}};function ch(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function $l(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Mp(){}function _1(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var h=yl(a);i.call(h)}}var a=Gy(e,r,t,0,null,!1,!1,"",Mp);return t._reactRootContainer=a,t[er]=a.current,mo(t.nodeType===8?t.parentNode:t),us(),a}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var l=r;r=function(){var h=yl(u);l.call(h)}}var u=ah(t,0,!1,null,null,!1,!1,"",Mp);return t._reactRootContainer=u,t[er]=u.current,mo(t.nodeType===8?t.parentNode:t),us(function(){Bl(e,u,n,r)}),u}function Wl(t,e,n,r,s){var i=n._reactRootContainer;if(i){var a=i;if(typeof s=="function"){var l=s;s=function(){var u=yl(a);l.call(u)}}Bl(e,a,t,s)}else a=_1(n,e,t,s,r);return yl(a)}Eg=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=zi(e.pendingLanes);n!==0&&(Rd(e,n|1),Ht(e,Ke()),!(ve&6)&&(ti=Ke()+500,Br()))}break;case 13:us(function(){var r=tr(t,1);if(r!==null){var s=Nt();Tn(r,t,1,s)}}),lh(t,1)}};Pd=function(t){if(t.tag===13){var e=tr(t,134217728);if(e!==null){var n=Nt();Tn(e,t,134217728,n)}lh(t,134217728)}};Tg=function(t){if(t.tag===13){var e=kr(t),n=tr(t,e);if(n!==null){var r=Nt();Tn(n,t,e,r)}lh(t,e)}};Ig=function(){return Te};Ag=function(t,e){var n=Te;try{return Te=t,e()}finally{Te=n}};fc=function(t,e,n){switch(e){case"input":if(oc(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=jl(r);if(!s)throw Error(H(90));rg(r),oc(r,s)}}}break;case"textarea":ig(t,n);break;case"select":e=n.value,e!=null&&Us(t,!!n.multiple,e,!1)}};hg=rh;fg=us;var x1={usingClientEntryPoint:!1,Events:[Lo,Vs,jl,cg,dg,rh]},Mi={findFiberByHostInstance:Jr,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},w1={bundleType:Mi.bundleType,version:Mi.version,rendererPackageName:Mi.rendererPackageName,rendererConfig:Mi.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:or.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=gg(t),t===null?null:t.stateNode},findFiberByHostInstance:Mi.findFiberByHostInstance||v1,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ia=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ia.isDisabled&&Ia.supportsFiber)try{Pl=Ia.inject(w1),Nn=Ia}catch{}}sn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=x1;sn.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!ch(e))throw Error(H(200));return y1(t,e,null,n)};sn.createRoot=function(t,e){if(!ch(t))throw Error(H(299));var n=!1,r="",s=Qy;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=ah(t,1,!1,null,null,n,!1,r,s),t[er]=e.current,mo(t.nodeType===8?t.parentNode:t),new uh(e)};sn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(H(188)):(t=Object.keys(t).join(","),Error(H(268,t)));return t=gg(e),t=t===null?null:t.stateNode,t};sn.flushSync=function(t){return us(t)};sn.hydrate=function(t,e,n){if(!$l(e))throw Error(H(200));return Wl(null,t,e,!0,n)};sn.hydrateRoot=function(t,e,n){if(!ch(t))throw Error(H(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",a=Qy;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(a=n.onRecoverableError)),e=Gy(e,null,t,1,n??null,s,!1,i,a),t[er]=e.current,mo(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new Ul(e)};sn.render=function(t,e,n){if(!$l(e))throw Error(H(200));return Wl(null,t,e,!1,n)};sn.unmountComponentAtNode=function(t){if(!$l(t))throw Error(H(40));return t._reactRootContainer?(us(function(){Wl(null,null,t,!1,function(){t._reactRootContainer=null,t[er]=null})}),!0):!1};sn.unstable_batchedUpdates=rh;sn.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!$l(n))throw Error(H(200));if(t==null||t._reactInternals===void 0)throw Error(H(38));return Wl(t,e,n,!1,r)};sn.version="18.3.1-next-f1338f8080-20240426";function Ky(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Ky)}catch(t){console.error(t)}}Ky(),Km.exports=sn;var S1=Km.exports,Yy,Lp=S1;Yy=Lp.createRoot,Lp.hydrateRoot;var Op={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xy=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},E1=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],a=t[n++],l=t[n++],u=((s&7)<<18|(i&63)<<12|(a&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{const i=t[n++],a=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|a&63)}}return e.join("")},Jy={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],a=s+1<t.length,l=a?t[s+1]:0,u=s+2<t.length,h=u?t[s+2]:0,p=i>>2,y=(i&3)<<4|l>>4;let m=(l&15)<<2|h>>6,C=h&63;u||(C=64,a||(m=64)),r.push(n[p],n[y],n[m],n[C])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(Xy(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):E1(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],l=s<t.length?n[t.charAt(s)]:0;++s;const h=s<t.length?n[t.charAt(s)]:64;++s;const y=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||l==null||h==null||y==null)throw new T1;const m=i<<2|l>>4;if(r.push(m),h!==64){const C=l<<4&240|h>>2;if(r.push(C),y!==64){const R=h<<6&192|y;r.push(R)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class T1 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const I1=function(t){const e=Xy(t);return Jy.encodeByteArray(e,!0)},Zy=function(t){return I1(t).replace(/\./g,"")},A1=function(t){try{return Jy.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function C1(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k1=()=>C1().__FIREBASE_DEFAULTS__,R1=()=>{if(typeof process>"u"||typeof Op>"u")return;const t=Op.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},P1=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&A1(t[1]);return e&&JSON.parse(e)},dh=()=>{try{return k1()||R1()||P1()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},b1=t=>{var e,n;return(n=(e=dh())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},D1=t=>{const e=b1(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},e0=()=>{var t;return(t=dh())===null||t===void 0?void 0:t.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N1{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function j1(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function V1(){var t;const e=(t=dh())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function M1(){return!V1()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function L1(){try{return typeof indexedDB=="object"}catch{return!1}}function O1(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F1="FirebaseError";class hi extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=F1,Object.setPrototypeOf(this,hi.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,t0.prototype.create)}}class t0{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],a=i?z1(i,r):"Error",l=`${this.serviceName}: ${a} (${s}).`;return new hi(s,l,r)}}function z1(t,e){return t.replace(B1,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const B1=/\{\$([^}]+)}/g;function vl(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],a=e[s];if(Fp(i)&&Fp(a)){if(!vl(i,a))return!1}else if(i!==a)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function Fp(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function An(t){return t&&t._delegate?t._delegate:t}class ni{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xr="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U1{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new N1;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(W1(e))try{this.getOrInitializeService({instanceIdentifier:Xr})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=Xr){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Xr){return this.instances.has(e)}getOptions(e=Xr){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,a]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(i);r===l&&a.resolve(s)}return s}onInit(e,n){var r;const s=this.normalizeInstanceIdentifier(n),i=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;i.add(e),this.onInitCallbacks.set(s,i);const a=this.instances.get(s);return a&&e(a,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:$1(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Xr){return this.component?this.component.multipleInstances?e:Xr:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function $1(t){return t===Xr?void 0:t}function W1(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H1{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new U1(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ye;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(ye||(ye={}));const q1={debug:ye.DEBUG,verbose:ye.VERBOSE,info:ye.INFO,warn:ye.WARN,error:ye.ERROR,silent:ye.SILENT},G1=ye.INFO,Q1={[ye.DEBUG]:"log",[ye.VERBOSE]:"log",[ye.INFO]:"info",[ye.WARN]:"warn",[ye.ERROR]:"error"},K1=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=Q1[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class n0{constructor(e){this.name=e,this._logLevel=G1,this._logHandler=K1,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ye))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?q1[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ye.DEBUG,...e),this._logHandler(this,ye.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ye.VERBOSE,...e),this._logHandler(this,ye.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ye.INFO,...e),this._logHandler(this,ye.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ye.WARN,...e),this._logHandler(this,ye.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ye.ERROR,...e),this._logHandler(this,ye.ERROR,...e)}}const Y1=(t,e)=>e.some(n=>t instanceof n);let zp,Bp;function X1(){return zp||(zp=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function J1(){return Bp||(Bp=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const r0=new WeakMap,qc=new WeakMap,s0=new WeakMap,Hu=new WeakMap,hh=new WeakMap;function Z1(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",a)},i=()=>{n(Pr(t.result)),s()},a=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",a)});return e.then(n=>{n instanceof IDBCursor&&r0.set(n,t)}).catch(()=>{}),hh.set(e,t),e}function ew(t){if(qc.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",a),t.removeEventListener("abort",a)},i=()=>{n(),s()},a=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",a),t.addEventListener("abort",a)});qc.set(t,e)}let Gc={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return qc.get(t);if(e==="objectStoreNames")return t.objectStoreNames||s0.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Pr(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function tw(t){Gc=t(Gc)}function nw(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(qu(this),e,...n);return s0.set(r,e.sort?e.sort():[e]),Pr(r)}:J1().includes(t)?function(...e){return t.apply(qu(this),e),Pr(r0.get(this))}:function(...e){return Pr(t.apply(qu(this),e))}}function rw(t){return typeof t=="function"?nw(t):(t instanceof IDBTransaction&&ew(t),Y1(t,X1())?new Proxy(t,Gc):t)}function Pr(t){if(t instanceof IDBRequest)return Z1(t);if(Hu.has(t))return Hu.get(t);const e=rw(t);return e!==t&&(Hu.set(t,e),hh.set(e,t)),e}const qu=t=>hh.get(t);function sw(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const a=indexedDB.open(t,e),l=Pr(a);return r&&a.addEventListener("upgradeneeded",u=>{r(Pr(a.result),u.oldVersion,u.newVersion,Pr(a.transaction),u)}),n&&a.addEventListener("blocked",u=>n(u.oldVersion,u.newVersion,u)),l.then(u=>{i&&u.addEventListener("close",()=>i()),s&&u.addEventListener("versionchange",h=>s(h.oldVersion,h.newVersion,h))}).catch(()=>{}),l}const iw=["get","getKey","getAll","getAllKeys","count"],ow=["put","add","delete","clear"],Gu=new Map;function Up(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Gu.get(e))return Gu.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=ow.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||iw.includes(n)))return;const i=async function(a,...l){const u=this.transaction(a,s?"readwrite":"readonly");let h=u.store;return r&&(h=h.index(l.shift())),(await Promise.all([h[n](...l),s&&u.done]))[0]};return Gu.set(e,i),i}tw(t=>({...t,get:(e,n,r)=>Up(e,n)||t.get(e,n,r),has:(e,n)=>!!Up(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aw{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(lw(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function lw(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Qc="@firebase/app",$p="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rr=new n0("@firebase/app"),uw="@firebase/app-compat",cw="@firebase/analytics-compat",dw="@firebase/analytics",hw="@firebase/app-check-compat",fw="@firebase/app-check",pw="@firebase/auth",mw="@firebase/auth-compat",gw="@firebase/database",yw="@firebase/data-connect",vw="@firebase/database-compat",_w="@firebase/functions",xw="@firebase/functions-compat",ww="@firebase/installations",Sw="@firebase/installations-compat",Ew="@firebase/messaging",Tw="@firebase/messaging-compat",Iw="@firebase/performance",Aw="@firebase/performance-compat",Cw="@firebase/remote-config",kw="@firebase/remote-config-compat",Rw="@firebase/storage",Pw="@firebase/storage-compat",bw="@firebase/firestore",Dw="@firebase/vertexai-preview",Nw="@firebase/firestore-compat",jw="firebase",Vw="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kc="[DEFAULT]",Mw={[Qc]:"fire-core",[uw]:"fire-core-compat",[dw]:"fire-analytics",[cw]:"fire-analytics-compat",[fw]:"fire-app-check",[hw]:"fire-app-check-compat",[pw]:"fire-auth",[mw]:"fire-auth-compat",[gw]:"fire-rtdb",[yw]:"fire-data-connect",[vw]:"fire-rtdb-compat",[_w]:"fire-fn",[xw]:"fire-fn-compat",[ww]:"fire-iid",[Sw]:"fire-iid-compat",[Ew]:"fire-fcm",[Tw]:"fire-fcm-compat",[Iw]:"fire-perf",[Aw]:"fire-perf-compat",[Cw]:"fire-rc",[kw]:"fire-rc-compat",[Rw]:"fire-gcs",[Pw]:"fire-gcs-compat",[bw]:"fire-fst",[Nw]:"fire-fst-compat",[Dw]:"fire-vertex","fire-js":"fire-js",[jw]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _l=new Map,Lw=new Map,Yc=new Map;function Wp(t,e){try{t.container.addComponent(e)}catch(n){rr.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function To(t){const e=t.name;if(Yc.has(e))return rr.debug(`There were multiple attempts to register component ${e}.`),!1;Yc.set(e,t);for(const n of _l.values())Wp(n,t);for(const n of Lw.values())Wp(n,t);return!0}function i0(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ow={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},br=new t0("app","Firebase",Ow);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fw{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new ni("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw br.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zw=Vw;function o0(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:Kc,automaticDataCollectionEnabled:!1},e),s=r.name;if(typeof s!="string"||!s)throw br.create("bad-app-name",{appName:String(s)});if(n||(n=e0()),!n)throw br.create("no-options");const i=_l.get(s);if(i){if(vl(n,i.options)&&vl(r,i.config))return i;throw br.create("duplicate-app",{appName:s})}const a=new H1(s);for(const u of Yc.values())a.addComponent(u);const l=new Fw(n,r,a);return _l.set(s,l),l}function Bw(t=Kc){const e=_l.get(t);if(!e&&t===Kc&&e0())return o0();if(!e)throw br.create("no-app",{appName:t});return e}function Dr(t,e,n){var r;let s=(r=Mw[t])!==null&&r!==void 0?r:t;n&&(s+=`-${n}`);const i=s.match(/\s|\//),a=e.match(/\s|\//);if(i||a){const l=[`Unable to register library "${s}" with version "${e}":`];i&&l.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&a&&l.push("and"),a&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),rr.warn(l.join(" "));return}To(new ni(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uw="firebase-heartbeat-database",$w=1,Io="firebase-heartbeat-store";let Qu=null;function a0(){return Qu||(Qu=sw(Uw,$w,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Io)}catch(n){console.warn(n)}}}}).catch(t=>{throw br.create("idb-open",{originalErrorMessage:t.message})})),Qu}async function Ww(t){try{const n=(await a0()).transaction(Io),r=await n.objectStore(Io).get(l0(t));return await n.done,r}catch(e){if(e instanceof hi)rr.warn(e.message);else{const n=br.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});rr.warn(n.message)}}}async function Hp(t,e){try{const r=(await a0()).transaction(Io,"readwrite");await r.objectStore(Io).put(e,l0(t)),await r.done}catch(n){if(n instanceof hi)rr.warn(n.message);else{const r=br.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});rr.warn(r.message)}}}function l0(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hw=1024,qw=30*24*60*60*1e3;class Gw{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new Kw(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=qp();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(a=>a.date===i)?void 0:(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{const l=new Date(a.date).valueOf();return Date.now()-l<=qw}),this._storage.overwrite(this._heartbeatsCache))}catch(r){rr.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=qp(),{heartbeatsToSend:r,unsentEntries:s}=Qw(this._heartbeatsCache.heartbeats),i=Zy(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return rr.warn(n),""}}}function qp(){return new Date().toISOString().substring(0,10)}function Qw(t,e=Hw){const n=[];let r=t.slice();for(const s of t){const i=n.find(a=>a.agent===s.agent);if(i){if(i.dates.push(s.date),Gp(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),Gp(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class Kw{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return L1()?O1().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await Ww(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return Hp(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return Hp(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function Gp(t){return Zy(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yw(t){To(new ni("platform-logger",e=>new aw(e),"PRIVATE")),To(new ni("heartbeat",e=>new Gw(e),"PRIVATE")),Dr(Qc,$p,t),Dr(Qc,$p,"esm2017"),Dr("fire-js","")}Yw("");var Xw="firebase",Jw="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Dr(Xw,Jw,"app");var Qp=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var ss,u0;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(S,v){function T(){}T.prototype=v.prototype,S.D=v.prototype,S.prototype=new T,S.prototype.constructor=S,S.C=function(I,_,E){for(var x=Array(arguments.length-2),X=2;X<arguments.length;X++)x[X-2]=arguments[X];return v.prototype[_].apply(I,x)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(S,v,T){T||(T=0);var I=Array(16);if(typeof v=="string")for(var _=0;16>_;++_)I[_]=v.charCodeAt(T++)|v.charCodeAt(T++)<<8|v.charCodeAt(T++)<<16|v.charCodeAt(T++)<<24;else for(_=0;16>_;++_)I[_]=v[T++]|v[T++]<<8|v[T++]<<16|v[T++]<<24;v=S.g[0],T=S.g[1],_=S.g[2];var E=S.g[3],x=v+(E^T&(_^E))+I[0]+3614090360&4294967295;v=T+(x<<7&4294967295|x>>>25),x=E+(_^v&(T^_))+I[1]+3905402710&4294967295,E=v+(x<<12&4294967295|x>>>20),x=_+(T^E&(v^T))+I[2]+606105819&4294967295,_=E+(x<<17&4294967295|x>>>15),x=T+(v^_&(E^v))+I[3]+3250441966&4294967295,T=_+(x<<22&4294967295|x>>>10),x=v+(E^T&(_^E))+I[4]+4118548399&4294967295,v=T+(x<<7&4294967295|x>>>25),x=E+(_^v&(T^_))+I[5]+1200080426&4294967295,E=v+(x<<12&4294967295|x>>>20),x=_+(T^E&(v^T))+I[6]+2821735955&4294967295,_=E+(x<<17&4294967295|x>>>15),x=T+(v^_&(E^v))+I[7]+4249261313&4294967295,T=_+(x<<22&4294967295|x>>>10),x=v+(E^T&(_^E))+I[8]+1770035416&4294967295,v=T+(x<<7&4294967295|x>>>25),x=E+(_^v&(T^_))+I[9]+2336552879&4294967295,E=v+(x<<12&4294967295|x>>>20),x=_+(T^E&(v^T))+I[10]+4294925233&4294967295,_=E+(x<<17&4294967295|x>>>15),x=T+(v^_&(E^v))+I[11]+2304563134&4294967295,T=_+(x<<22&4294967295|x>>>10),x=v+(E^T&(_^E))+I[12]+1804603682&4294967295,v=T+(x<<7&4294967295|x>>>25),x=E+(_^v&(T^_))+I[13]+4254626195&4294967295,E=v+(x<<12&4294967295|x>>>20),x=_+(T^E&(v^T))+I[14]+2792965006&4294967295,_=E+(x<<17&4294967295|x>>>15),x=T+(v^_&(E^v))+I[15]+1236535329&4294967295,T=_+(x<<22&4294967295|x>>>10),x=v+(_^E&(T^_))+I[1]+4129170786&4294967295,v=T+(x<<5&4294967295|x>>>27),x=E+(T^_&(v^T))+I[6]+3225465664&4294967295,E=v+(x<<9&4294967295|x>>>23),x=_+(v^T&(E^v))+I[11]+643717713&4294967295,_=E+(x<<14&4294967295|x>>>18),x=T+(E^v&(_^E))+I[0]+3921069994&4294967295,T=_+(x<<20&4294967295|x>>>12),x=v+(_^E&(T^_))+I[5]+3593408605&4294967295,v=T+(x<<5&4294967295|x>>>27),x=E+(T^_&(v^T))+I[10]+38016083&4294967295,E=v+(x<<9&4294967295|x>>>23),x=_+(v^T&(E^v))+I[15]+3634488961&4294967295,_=E+(x<<14&4294967295|x>>>18),x=T+(E^v&(_^E))+I[4]+3889429448&4294967295,T=_+(x<<20&4294967295|x>>>12),x=v+(_^E&(T^_))+I[9]+568446438&4294967295,v=T+(x<<5&4294967295|x>>>27),x=E+(T^_&(v^T))+I[14]+3275163606&4294967295,E=v+(x<<9&4294967295|x>>>23),x=_+(v^T&(E^v))+I[3]+4107603335&4294967295,_=E+(x<<14&4294967295|x>>>18),x=T+(E^v&(_^E))+I[8]+1163531501&4294967295,T=_+(x<<20&4294967295|x>>>12),x=v+(_^E&(T^_))+I[13]+2850285829&4294967295,v=T+(x<<5&4294967295|x>>>27),x=E+(T^_&(v^T))+I[2]+4243563512&4294967295,E=v+(x<<9&4294967295|x>>>23),x=_+(v^T&(E^v))+I[7]+1735328473&4294967295,_=E+(x<<14&4294967295|x>>>18),x=T+(E^v&(_^E))+I[12]+2368359562&4294967295,T=_+(x<<20&4294967295|x>>>12),x=v+(T^_^E)+I[5]+4294588738&4294967295,v=T+(x<<4&4294967295|x>>>28),x=E+(v^T^_)+I[8]+2272392833&4294967295,E=v+(x<<11&4294967295|x>>>21),x=_+(E^v^T)+I[11]+1839030562&4294967295,_=E+(x<<16&4294967295|x>>>16),x=T+(_^E^v)+I[14]+4259657740&4294967295,T=_+(x<<23&4294967295|x>>>9),x=v+(T^_^E)+I[1]+2763975236&4294967295,v=T+(x<<4&4294967295|x>>>28),x=E+(v^T^_)+I[4]+1272893353&4294967295,E=v+(x<<11&4294967295|x>>>21),x=_+(E^v^T)+I[7]+4139469664&4294967295,_=E+(x<<16&4294967295|x>>>16),x=T+(_^E^v)+I[10]+3200236656&4294967295,T=_+(x<<23&4294967295|x>>>9),x=v+(T^_^E)+I[13]+681279174&4294967295,v=T+(x<<4&4294967295|x>>>28),x=E+(v^T^_)+I[0]+3936430074&4294967295,E=v+(x<<11&4294967295|x>>>21),x=_+(E^v^T)+I[3]+3572445317&4294967295,_=E+(x<<16&4294967295|x>>>16),x=T+(_^E^v)+I[6]+76029189&4294967295,T=_+(x<<23&4294967295|x>>>9),x=v+(T^_^E)+I[9]+3654602809&4294967295,v=T+(x<<4&4294967295|x>>>28),x=E+(v^T^_)+I[12]+3873151461&4294967295,E=v+(x<<11&4294967295|x>>>21),x=_+(E^v^T)+I[15]+530742520&4294967295,_=E+(x<<16&4294967295|x>>>16),x=T+(_^E^v)+I[2]+3299628645&4294967295,T=_+(x<<23&4294967295|x>>>9),x=v+(_^(T|~E))+I[0]+4096336452&4294967295,v=T+(x<<6&4294967295|x>>>26),x=E+(T^(v|~_))+I[7]+1126891415&4294967295,E=v+(x<<10&4294967295|x>>>22),x=_+(v^(E|~T))+I[14]+2878612391&4294967295,_=E+(x<<15&4294967295|x>>>17),x=T+(E^(_|~v))+I[5]+4237533241&4294967295,T=_+(x<<21&4294967295|x>>>11),x=v+(_^(T|~E))+I[12]+1700485571&4294967295,v=T+(x<<6&4294967295|x>>>26),x=E+(T^(v|~_))+I[3]+2399980690&4294967295,E=v+(x<<10&4294967295|x>>>22),x=_+(v^(E|~T))+I[10]+4293915773&4294967295,_=E+(x<<15&4294967295|x>>>17),x=T+(E^(_|~v))+I[1]+2240044497&4294967295,T=_+(x<<21&4294967295|x>>>11),x=v+(_^(T|~E))+I[8]+1873313359&4294967295,v=T+(x<<6&4294967295|x>>>26),x=E+(T^(v|~_))+I[15]+4264355552&4294967295,E=v+(x<<10&4294967295|x>>>22),x=_+(v^(E|~T))+I[6]+2734768916&4294967295,_=E+(x<<15&4294967295|x>>>17),x=T+(E^(_|~v))+I[13]+1309151649&4294967295,T=_+(x<<21&4294967295|x>>>11),x=v+(_^(T|~E))+I[4]+4149444226&4294967295,v=T+(x<<6&4294967295|x>>>26),x=E+(T^(v|~_))+I[11]+3174756917&4294967295,E=v+(x<<10&4294967295|x>>>22),x=_+(v^(E|~T))+I[2]+718787259&4294967295,_=E+(x<<15&4294967295|x>>>17),x=T+(E^(_|~v))+I[9]+3951481745&4294967295,S.g[0]=S.g[0]+v&4294967295,S.g[1]=S.g[1]+(_+(x<<21&4294967295|x>>>11))&4294967295,S.g[2]=S.g[2]+_&4294967295,S.g[3]=S.g[3]+E&4294967295}r.prototype.u=function(S,v){v===void 0&&(v=S.length);for(var T=v-this.blockSize,I=this.B,_=this.h,E=0;E<v;){if(_==0)for(;E<=T;)s(this,S,E),E+=this.blockSize;if(typeof S=="string"){for(;E<v;)if(I[_++]=S.charCodeAt(E++),_==this.blockSize){s(this,I),_=0;break}}else for(;E<v;)if(I[_++]=S[E++],_==this.blockSize){s(this,I),_=0;break}}this.h=_,this.o+=v},r.prototype.v=function(){var S=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);S[0]=128;for(var v=1;v<S.length-8;++v)S[v]=0;var T=8*this.o;for(v=S.length-8;v<S.length;++v)S[v]=T&255,T/=256;for(this.u(S),S=Array(16),v=T=0;4>v;++v)for(var I=0;32>I;I+=8)S[T++]=this.g[v]>>>I&255;return S};function i(S,v){var T=l;return Object.prototype.hasOwnProperty.call(T,S)?T[S]:T[S]=v(S)}function a(S,v){this.h=v;for(var T=[],I=!0,_=S.length-1;0<=_;_--){var E=S[_]|0;I&&E==v||(T[_]=E,I=!1)}this.g=T}var l={};function u(S){return-128<=S&&128>S?i(S,function(v){return new a([v|0],0>v?-1:0)}):new a([S|0],0>S?-1:0)}function h(S){if(isNaN(S)||!isFinite(S))return y;if(0>S)return O(h(-S));for(var v=[],T=1,I=0;S>=T;I++)v[I]=S/T|0,T*=4294967296;return new a(v,0)}function p(S,v){if(S.length==0)throw Error("number format error: empty string");if(v=v||10,2>v||36<v)throw Error("radix out of range: "+v);if(S.charAt(0)=="-")return O(p(S.substring(1),v));if(0<=S.indexOf("-"))throw Error('number format error: interior "-" character');for(var T=h(Math.pow(v,8)),I=y,_=0;_<S.length;_+=8){var E=Math.min(8,S.length-_),x=parseInt(S.substring(_,_+E),v);8>E?(E=h(Math.pow(v,E)),I=I.j(E).add(h(x))):(I=I.j(T),I=I.add(h(x)))}return I}var y=u(0),m=u(1),C=u(16777216);t=a.prototype,t.m=function(){if(P(this))return-O(this).m();for(var S=0,v=1,T=0;T<this.g.length;T++){var I=this.i(T);S+=(0<=I?I:4294967296+I)*v,v*=4294967296}return S},t.toString=function(S){if(S=S||10,2>S||36<S)throw Error("radix out of range: "+S);if(R(this))return"0";if(P(this))return"-"+O(this).toString(S);for(var v=h(Math.pow(S,6)),T=this,I="";;){var _=b(T,v).g;T=k(T,_.j(v));var E=((0<T.g.length?T.g[0]:T.h)>>>0).toString(S);if(T=_,R(T))return E+I;for(;6>E.length;)E="0"+E;I=E+I}},t.i=function(S){return 0>S?0:S<this.g.length?this.g[S]:this.h};function R(S){if(S.h!=0)return!1;for(var v=0;v<S.g.length;v++)if(S.g[v]!=0)return!1;return!0}function P(S){return S.h==-1}t.l=function(S){return S=k(this,S),P(S)?-1:R(S)?0:1};function O(S){for(var v=S.g.length,T=[],I=0;I<v;I++)T[I]=~S.g[I];return new a(T,~S.h).add(m)}t.abs=function(){return P(this)?O(this):this},t.add=function(S){for(var v=Math.max(this.g.length,S.g.length),T=[],I=0,_=0;_<=v;_++){var E=I+(this.i(_)&65535)+(S.i(_)&65535),x=(E>>>16)+(this.i(_)>>>16)+(S.i(_)>>>16);I=x>>>16,E&=65535,x&=65535,T[_]=x<<16|E}return new a(T,T[T.length-1]&-2147483648?-1:0)};function k(S,v){return S.add(O(v))}t.j=function(S){if(R(this)||R(S))return y;if(P(this))return P(S)?O(this).j(O(S)):O(O(this).j(S));if(P(S))return O(this.j(O(S)));if(0>this.l(C)&&0>S.l(C))return h(this.m()*S.m());for(var v=this.g.length+S.g.length,T=[],I=0;I<2*v;I++)T[I]=0;for(I=0;I<this.g.length;I++)for(var _=0;_<S.g.length;_++){var E=this.i(I)>>>16,x=this.i(I)&65535,X=S.i(_)>>>16,G=S.i(_)&65535;T[2*I+2*_]+=x*G,A(T,2*I+2*_),T[2*I+2*_+1]+=E*G,A(T,2*I+2*_+1),T[2*I+2*_+1]+=x*X,A(T,2*I+2*_+1),T[2*I+2*_+2]+=E*X,A(T,2*I+2*_+2)}for(I=0;I<v;I++)T[I]=T[2*I+1]<<16|T[2*I];for(I=v;I<2*v;I++)T[I]=0;return new a(T,0)};function A(S,v){for(;(S[v]&65535)!=S[v];)S[v+1]+=S[v]>>>16,S[v]&=65535,v++}function w(S,v){this.g=S,this.h=v}function b(S,v){if(R(v))throw Error("division by zero");if(R(S))return new w(y,y);if(P(S))return v=b(O(S),v),new w(O(v.g),O(v.h));if(P(v))return v=b(S,O(v)),new w(O(v.g),v.h);if(30<S.g.length){if(P(S)||P(v))throw Error("slowDivide_ only works with positive integers.");for(var T=m,I=v;0>=I.l(S);)T=j(T),I=j(I);var _=M(T,1),E=M(I,1);for(I=M(I,2),T=M(T,2);!R(I);){var x=E.add(I);0>=x.l(S)&&(_=_.add(T),E=x),I=M(I,1),T=M(T,1)}return v=k(S,_.j(v)),new w(_,v)}for(_=y;0<=S.l(v);){for(T=Math.max(1,Math.floor(S.m()/v.m())),I=Math.ceil(Math.log(T)/Math.LN2),I=48>=I?1:Math.pow(2,I-48),E=h(T),x=E.j(v);P(x)||0<x.l(S);)T-=I,E=h(T),x=E.j(v);R(E)&&(E=m),_=_.add(E),S=k(S,x)}return new w(_,S)}t.A=function(S){return b(this,S).h},t.and=function(S){for(var v=Math.max(this.g.length,S.g.length),T=[],I=0;I<v;I++)T[I]=this.i(I)&S.i(I);return new a(T,this.h&S.h)},t.or=function(S){for(var v=Math.max(this.g.length,S.g.length),T=[],I=0;I<v;I++)T[I]=this.i(I)|S.i(I);return new a(T,this.h|S.h)},t.xor=function(S){for(var v=Math.max(this.g.length,S.g.length),T=[],I=0;I<v;I++)T[I]=this.i(I)^S.i(I);return new a(T,this.h^S.h)};function j(S){for(var v=S.g.length+1,T=[],I=0;I<v;I++)T[I]=S.i(I)<<1|S.i(I-1)>>>31;return new a(T,S.h)}function M(S,v){var T=v>>5;v%=32;for(var I=S.g.length-T,_=[],E=0;E<I;E++)_[E]=0<v?S.i(E+T)>>>v|S.i(E+T+1)<<32-v:S.i(E+T);return new a(_,S.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,u0=r,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=h,a.fromString=p,ss=a}).apply(typeof Qp<"u"?Qp:typeof self<"u"?self:typeof window<"u"?window:{});var Aa=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var c0,Ui,d0,Ua,Xc,h0,f0,p0;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(o,c,f){return o==Array.prototype||o==Object.prototype||(o[c]=f.value),o};function n(o){o=[typeof globalThis=="object"&&globalThis,o,typeof window=="object"&&window,typeof self=="object"&&self,typeof Aa=="object"&&Aa];for(var c=0;c<o.length;++c){var f=o[c];if(f&&f.Math==Math)return f}throw Error("Cannot find global object")}var r=n(this);function s(o,c){if(c)e:{var f=r;o=o.split(".");for(var g=0;g<o.length-1;g++){var D=o[g];if(!(D in f))break e;f=f[D]}o=o[o.length-1],g=f[o],c=c(g),c!=g&&c!=null&&e(f,o,{configurable:!0,writable:!0,value:c})}}function i(o,c){o instanceof String&&(o+="");var f=0,g=!1,D={next:function(){if(!g&&f<o.length){var V=f++;return{value:c(V,o[V]),done:!1}}return g=!0,{done:!0,value:void 0}}};return D[Symbol.iterator]=function(){return D},D}s("Array.prototype.values",function(o){return o||function(){return i(this,function(c,f){return f})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},l=this||self;function u(o){var c=typeof o;return c=c!="object"?c:o?Array.isArray(o)?"array":c:"null",c=="array"||c=="object"&&typeof o.length=="number"}function h(o){var c=typeof o;return c=="object"&&o!=null||c=="function"}function p(o,c,f){return o.call.apply(o.bind,arguments)}function y(o,c,f){if(!o)throw Error();if(2<arguments.length){var g=Array.prototype.slice.call(arguments,2);return function(){var D=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(D,g),o.apply(c,D)}}return function(){return o.apply(c,arguments)}}function m(o,c,f){return m=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?p:y,m.apply(null,arguments)}function C(o,c){var f=Array.prototype.slice.call(arguments,1);return function(){var g=f.slice();return g.push.apply(g,arguments),o.apply(this,g)}}function R(o,c){function f(){}f.prototype=c.prototype,o.aa=c.prototype,o.prototype=new f,o.prototype.constructor=o,o.Qb=function(g,D,V){for(var Y=Array(arguments.length-2),Ce=2;Ce<arguments.length;Ce++)Y[Ce-2]=arguments[Ce];return c.prototype[D].apply(g,Y)}}function P(o){const c=o.length;if(0<c){const f=Array(c);for(let g=0;g<c;g++)f[g]=o[g];return f}return[]}function O(o,c){for(let f=1;f<arguments.length;f++){const g=arguments[f];if(u(g)){const D=o.length||0,V=g.length||0;o.length=D+V;for(let Y=0;Y<V;Y++)o[D+Y]=g[Y]}else o.push(g)}}class k{constructor(c,f){this.i=c,this.j=f,this.h=0,this.g=null}get(){let c;return 0<this.h?(this.h--,c=this.g,this.g=c.next,c.next=null):c=this.i(),c}}function A(o){return/^[\s\xa0]*$/.test(o)}function w(){var o=l.navigator;return o&&(o=o.userAgent)?o:""}function b(o){return b[" "](o),o}b[" "]=function(){};var j=w().indexOf("Gecko")!=-1&&!(w().toLowerCase().indexOf("webkit")!=-1&&w().indexOf("Edge")==-1)&&!(w().indexOf("Trident")!=-1||w().indexOf("MSIE")!=-1)&&w().indexOf("Edge")==-1;function M(o,c,f){for(const g in o)c.call(f,o[g],g,o)}function S(o,c){for(const f in o)c.call(void 0,o[f],f,o)}function v(o){const c={};for(const f in o)c[f]=o[f];return c}const T="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function I(o,c){let f,g;for(let D=1;D<arguments.length;D++){g=arguments[D];for(f in g)o[f]=g[f];for(let V=0;V<T.length;V++)f=T[V],Object.prototype.hasOwnProperty.call(g,f)&&(o[f]=g[f])}}function _(o){var c=1;o=o.split(":");const f=[];for(;0<c&&o.length;)f.push(o.shift()),c--;return o.length&&f.push(o.join(":")),f}function E(o){l.setTimeout(()=>{throw o},0)}function x(){var o=F;let c=null;return o.g&&(c=o.g,o.g=o.g.next,o.g||(o.h=null),c.next=null),c}class X{constructor(){this.h=this.g=null}add(c,f){const g=G.get();g.set(c,f),this.h?this.h.next=g:this.g=g,this.h=g}}var G=new k(()=>new U,o=>o.reset());class U{constructor(){this.next=this.g=this.h=null}set(c,f){this.h=c,this.g=f,this.next=null}reset(){this.next=this.g=this.h=null}}let B,N=!1,F=new X,W=()=>{const o=l.Promise.resolve(void 0);B=()=>{o.then(te)}};var te=()=>{for(var o;o=x();){try{o.h.call(o.g)}catch(f){E(f)}var c=G;c.j(o),100>c.h&&(c.h++,o.next=c.g,c.g=o)}N=!1};function Z(){this.s=this.s,this.C=this.C}Z.prototype.s=!1,Z.prototype.ma=function(){this.s||(this.s=!0,this.N())},Z.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function oe(o,c){this.type=o,this.g=this.target=c,this.defaultPrevented=!1}oe.prototype.h=function(){this.defaultPrevented=!0};var Ae=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var o=!1,c=Object.defineProperty({},"passive",{get:function(){o=!0}});try{const f=()=>{};l.addEventListener("test",f,c),l.removeEventListener("test",f,c)}catch{}return o}();function me(o,c){if(oe.call(this,o?o.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,o){var f=this.type=o.type,g=o.changedTouches&&o.changedTouches.length?o.changedTouches[0]:null;if(this.target=o.target||o.srcElement,this.g=c,c=o.relatedTarget){if(j){e:{try{b(c.nodeName);var D=!0;break e}catch{}D=!1}D||(c=null)}}else f=="mouseover"?c=o.fromElement:f=="mouseout"&&(c=o.toElement);this.relatedTarget=c,g?(this.clientX=g.clientX!==void 0?g.clientX:g.pageX,this.clientY=g.clientY!==void 0?g.clientY:g.pageY,this.screenX=g.screenX||0,this.screenY=g.screenY||0):(this.clientX=o.clientX!==void 0?o.clientX:o.pageX,this.clientY=o.clientY!==void 0?o.clientY:o.pageY,this.screenX=o.screenX||0,this.screenY=o.screenY||0),this.button=o.button,this.key=o.key||"",this.ctrlKey=o.ctrlKey,this.altKey=o.altKey,this.shiftKey=o.shiftKey,this.metaKey=o.metaKey,this.pointerId=o.pointerId||0,this.pointerType=typeof o.pointerType=="string"?o.pointerType:he[o.pointerType]||"",this.state=o.state,this.i=o,o.defaultPrevented&&me.aa.h.call(this)}}R(me,oe);var he={2:"touch",3:"pen",4:"mouse"};me.prototype.h=function(){me.aa.h.call(this);var o=this.i;o.preventDefault?o.preventDefault():o.returnValue=!1};var de="closure_listenable_"+(1e6*Math.random()|0),Oe=0;function Se(o,c,f,g,D){this.listener=o,this.proxy=null,this.src=c,this.type=f,this.capture=!!g,this.ha=D,this.key=++Oe,this.da=this.fa=!1}function re(o){o.da=!0,o.listener=null,o.proxy=null,o.src=null,o.ha=null}function Re(o){this.src=o,this.g={},this.h=0}Re.prototype.add=function(o,c,f,g,D){var V=o.toString();o=this.g[V],o||(o=this.g[V]=[],this.h++);var Y=Pe(o,c,g,D);return-1<Y?(c=o[Y],f||(c.fa=!1)):(c=new Se(c,this.src,V,!!g,D),c.fa=f,o.push(c)),c};function qe(o,c){var f=c.type;if(f in o.g){var g=o.g[f],D=Array.prototype.indexOf.call(g,c,void 0),V;(V=0<=D)&&Array.prototype.splice.call(g,D,1),V&&(re(c),o.g[f].length==0&&(delete o.g[f],o.h--))}}function Pe(o,c,f,g){for(var D=0;D<o.length;++D){var V=o[D];if(!V.da&&V.listener==c&&V.capture==!!f&&V.ha==g)return D}return-1}var xt="closure_lm_"+(1e6*Math.random()|0),qt={};function Gt(o,c,f,g,D){if(Array.isArray(c)){for(var V=0;V<c.length;V++)Gt(o,c[V],f,g,D);return null}return f=Go(f),o&&o[de]?o.K(c,f,h(g)?!!g.capture:!1,D):Qt(o,c,f,!1,g,D)}function Qt(o,c,f,g,D,V){if(!c)throw Error("Invalid event type");var Y=h(D)?!!D.capture:!!D,Ce=$e(o);if(Ce||(o[xt]=Ce=new Re(o)),f=Ce.add(c,f,g,Y,V),f.proxy)return f;if(g=Kt(),f.proxy=g,g.src=o,g.listener=f,o.addEventListener)Ae||(D=Y),D===void 0&&(D=!1),o.addEventListener(c.toString(),g,D);else if(o.attachEvent)o.attachEvent(kn(c.toString()),g);else if(o.addListener&&o.removeListener)o.addListener(g);else throw Error("addEventListener and attachEvent are unavailable.");return f}function Kt(){function o(f){return c.call(o.src,o.listener,f)}const c=lr;return o}function Yt(o,c,f,g,D){if(Array.isArray(c))for(var V=0;V<c.length;V++)Yt(o,c[V],f,g,D);else g=h(g)?!!g.capture:!!g,f=Go(f),o&&o[de]?(o=o.i,c=String(c).toString(),c in o.g&&(V=o.g[c],f=Pe(V,f,g,D),-1<f&&(re(V[f]),Array.prototype.splice.call(V,f,1),V.length==0&&(delete o.g[c],o.h--)))):o&&(o=$e(o))&&(c=o.g[c.toString()],o=-1,c&&(o=Pe(c,f,g,D)),(f=-1<o?c[o]:null)&&ar(f))}function ar(o){if(typeof o!="number"&&o&&!o.da){var c=o.src;if(c&&c[de])qe(c.i,o);else{var f=o.type,g=o.proxy;c.removeEventListener?c.removeEventListener(f,g,o.capture):c.detachEvent?c.detachEvent(kn(f),g):c.addListener&&c.removeListener&&c.removeListener(g),(f=$e(c))?(qe(f,o),f.h==0&&(f.src=null,c[xt]=null)):re(o)}}}function kn(o){return o in qt?qt[o]:qt[o]="on"+o}function lr(o,c){if(o.da)o=!0;else{c=new me(c,this);var f=o.listener,g=o.ha||o.src;o.fa&&ar(o),o=f.call(g,c)}return o}function $e(o){return o=o[xt],o instanceof Re?o:null}var yi="__closure_events_fn_"+(1e9*Math.random()>>>0);function Go(o){return typeof o=="function"?o:(o[yi]||(o[yi]=function(c){return o.handleEvent(c)}),o[yi])}function lt(){Z.call(this),this.i=new Re(this),this.M=this,this.F=null}R(lt,Z),lt.prototype[de]=!0,lt.prototype.removeEventListener=function(o,c,f,g){Yt(this,o,c,f,g)};function et(o,c){var f,g=o.F;if(g)for(f=[];g;g=g.F)f.push(g);if(o=o.M,g=c.type||c,typeof c=="string")c=new oe(c,o);else if(c instanceof oe)c.target=c.target||o;else{var D=c;c=new oe(g,o),I(c,D)}if(D=!0,f)for(var V=f.length-1;0<=V;V--){var Y=c.g=f[V];D=$r(Y,g,!0,c)&&D}if(Y=c.g=o,D=$r(Y,g,!0,c)&&D,D=$r(Y,g,!1,c)&&D,f)for(V=0;V<f.length;V++)Y=c.g=f[V],D=$r(Y,g,!1,c)&&D}lt.prototype.N=function(){if(lt.aa.N.call(this),this.i){var o=this.i,c;for(c in o.g){for(var f=o.g[c],g=0;g<f.length;g++)re(f[g]);delete o.g[c],o.h--}}this.F=null},lt.prototype.K=function(o,c,f,g){return this.i.add(String(o),c,!1,f,g)},lt.prototype.L=function(o,c,f,g){return this.i.add(String(o),c,!0,f,g)};function $r(o,c,f,g){if(c=o.i.g[String(c)],!c)return!0;c=c.concat();for(var D=!0,V=0;V<c.length;++V){var Y=c[V];if(Y&&!Y.da&&Y.capture==f){var Ce=Y.listener,ht=Y.ha||Y.src;Y.fa&&qe(o.i,Y),D=Ce.call(ht,g)!==!1&&D}}return D&&!g.defaultPrevented}function au(o,c,f){if(typeof o=="function")f&&(o=m(o,f));else if(o&&typeof o.handleEvent=="function")o=m(o.handleEvent,o);else throw Error("Invalid listener argument");return 2147483647<Number(c)?-1:l.setTimeout(o,c||0)}function Qo(o){o.g=au(()=>{o.g=null,o.i&&(o.i=!1,Qo(o))},o.l);const c=o.h;o.h=null,o.m.apply(null,c)}class Ee extends Z{constructor(c,f){super(),this.m=c,this.l=f,this.h=null,this.i=!1,this.g=null}j(c){this.h=arguments,this.g?this.i=!0:Qo(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Rn(o){Z.call(this),this.h=o,this.g={}}R(Rn,Z);var Wr=[];function vs(o){M(o.g,function(c,f){this.g.hasOwnProperty(f)&&ar(c)},o),o.g={}}Rn.prototype.N=function(){Rn.aa.N.call(this),vs(this)},Rn.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Ko=l.JSON.stringify,Yo=l.JSON.parse,lu=class{stringify(o){return l.JSON.stringify(o,void 0)}parse(o){return l.JSON.parse(o,void 0)}};function _s(){}_s.prototype.h=null;function xs(o){return o.h||(o.h=o.i())}function ur(){}var yn={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Lt(){oe.call(this,"d")}R(Lt,oe);function Fn(){oe.call(this,"c")}R(Fn,oe);var Rt={},Xo=null;function ws(){return Xo=Xo||new lt}Rt.La="serverreachability";function vi(o){oe.call(this,Rt.La,o)}R(vi,oe);function cr(o){const c=ws();et(c,new vi(c))}Rt.STAT_EVENT="statevent";function _i(o,c){oe.call(this,Rt.STAT_EVENT,o),this.stat=c}R(_i,oe);function tt(o){const c=ws();et(c,new _i(c,o))}Rt.Ma="timingevent";function xi(o,c){oe.call(this,Rt.Ma,o),this.size=c}R(xi,oe);function an(o,c){if(typeof o!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){o()},c)}function Hr(){this.g=!0}Hr.prototype.xa=function(){this.g=!1};function zn(o,c,f,g,D,V){o.info(function(){if(o.g)if(V)for(var Y="",Ce=V.split("&"),ht=0;ht<Ce.length;ht++){var xe=Ce[ht].split("=");if(1<xe.length){var wt=xe[0];xe=xe[1];var St=wt.split("_");Y=2<=St.length&&St[1]=="type"?Y+(wt+"="+xe+"&"):Y+(wt+"=redacted&")}}else Y=null;else Y=V;return"XMLHTTP REQ ("+g+") [attempt "+D+"]: "+c+`
`+f+`
`+Y})}function uu(o,c,f,g,D,V,Y){o.info(function(){return"XMLHTTP RESP ("+g+") [ attempt "+D+"]: "+c+`
`+f+`
`+V+" "+Y})}function q(o,c,f,g){o.info(function(){return"XMLHTTP TEXT ("+c+"): "+Q(o,f)+(g?" "+g:"")})}function K(o,c){o.info(function(){return"TIMEOUT: "+c})}Hr.prototype.info=function(){};function Q(o,c){if(!o.g)return c;if(!c)return null;try{var f=JSON.parse(c);if(f){for(o=0;o<f.length;o++)if(Array.isArray(f[o])){var g=f[o];if(!(2>g.length)){var D=g[1];if(Array.isArray(D)&&!(1>D.length)){var V=D[0];if(V!="noop"&&V!="stop"&&V!="close")for(var Y=1;Y<D.length;Y++)D[Y]=""}}}}return Ko(f)}catch{return c}}var se={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},_e={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Ge;function nt(){}R(nt,_s),nt.prototype.g=function(){return new XMLHttpRequest},nt.prototype.i=function(){return{}},Ge=new nt;function Me(o,c,f,g){this.j=o,this.i=c,this.l=f,this.R=g||1,this.U=new Rn(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new rt}function rt(){this.i=null,this.g="",this.h=!1}var Pt={},Bn={};function wi(o,c,f){o.L=1,o.v=ea($n(c)),o.m=f,o.P=!0,Ss(o,null)}function Ss(o,c){o.F=Date.now(),qr(o),o.A=$n(o.v);var f=o.A,g=o.R;Array.isArray(g)||(g=[String(g)]),af(f.i,"t",g),o.C=0,f=o.j.J,o.h=new rt,o.g=If(o.j,f?c:null,!o.m),0<o.O&&(o.M=new Ee(m(o.Y,o,o.g),o.O)),c=o.U,f=o.g,g=o.ca;var D="readystatechange";Array.isArray(D)||(D&&(Wr[0]=D.toString()),D=Wr);for(var V=0;V<D.length;V++){var Y=Gt(f,D[V],g||c.handleEvent,!1,c.h||c);if(!Y)break;c.g[Y.key]=Y}c=o.H?v(o.H):{},o.m?(o.u||(o.u="POST"),c["Content-Type"]="application/x-www-form-urlencoded",o.g.ea(o.A,o.u,o.m,c)):(o.u="GET",o.g.ea(o.A,o.u,null,c)),cr(),zn(o.i,o.u,o.A,o.l,o.R,o.m)}Me.prototype.ca=function(o){o=o.target;const c=this.M;c&&Wn(o)==3?c.j():this.Y(o)},Me.prototype.Y=function(o){try{if(o==this.g)e:{const St=Wn(this.g);var c=this.g.Ba();const Is=this.g.Z();if(!(3>St)&&(St!=3||this.g&&(this.h.h||this.g.oa()||pf(this.g)))){this.J||St!=4||c==7||(c==8||0>=Is?cr(3):cr(2)),Ye(this);var f=this.g.Z();this.X=f;t:if(Xt(this)){var g=pf(this.g);o="";var D=g.length,V=Wn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Un(this),bt(this);var Y="";break t}this.h.i=new l.TextDecoder}for(c=0;c<D;c++)this.h.h=!0,o+=this.h.i.decode(g[c],{stream:!(V&&c==D-1)});g.length=0,this.h.g+=o,this.C=0,Y=this.h.g}else Y=this.g.oa();if(this.o=f==200,uu(this.i,this.u,this.A,this.l,this.R,St,f),this.o){if(this.T&&!this.K){t:{if(this.g){var Ce,ht=this.g;if((Ce=ht.g?ht.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!A(Ce)){var xe=Ce;break t}}xe=null}if(f=xe)q(this.i,this.l,f,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,du(this,f);else{this.o=!1,this.s=3,tt(12),Un(this),bt(this);break e}}if(this.P){f=!0;let vn;for(;!this.J&&this.C<Y.length;)if(vn=cu(this,Y),vn==Bn){St==4&&(this.s=4,tt(14),f=!1),q(this.i,this.l,null,"[Incomplete Response]");break}else if(vn==Pt){this.s=4,tt(15),q(this.i,this.l,Y,"[Invalid Chunk]"),f=!1;break}else q(this.i,this.l,vn,null),du(this,vn);if(Xt(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),St!=4||Y.length!=0||this.h.h||(this.s=1,tt(16),f=!1),this.o=this.o&&f,!f)q(this.i,this.l,Y,"[Invalid Chunked Response]"),Un(this),bt(this);else if(0<Y.length&&!this.W){this.W=!0;var wt=this.j;wt.g==this&&wt.ba&&!wt.M&&(wt.j.info("Great, no buffering proxy detected. Bytes received: "+Y.length),yu(wt),wt.M=!0,tt(11))}}else q(this.i,this.l,Y,null),du(this,Y);St==4&&Un(this),this.o&&!this.J&&(St==4?wf(this.j,this):(this.o=!1,qr(this)))}else Kv(this.g),f==400&&0<Y.indexOf("Unknown SID")?(this.s=3,tt(12)):(this.s=0,tt(13)),Un(this),bt(this)}}}catch{}finally{}};function Xt(o){return o.g?o.u=="GET"&&o.L!=2&&o.j.Ca:!1}function cu(o,c){var f=o.C,g=c.indexOf(`
`,f);return g==-1?Bn:(f=Number(c.substring(f,g)),isNaN(f)?Pt:(g+=1,g+f>c.length?Bn:(c=c.slice(g,g+f),o.C=g+f,c)))}Me.prototype.cancel=function(){this.J=!0,Un(this)};function qr(o){o.S=Date.now()+o.I,le(o,o.I)}function le(o,c){if(o.B!=null)throw Error("WatchDog timer not null");o.B=an(m(o.ba,o),c)}function Ye(o){o.B&&(l.clearTimeout(o.B),o.B=null)}Me.prototype.ba=function(){this.B=null;const o=Date.now();0<=o-this.S?(K(this.i,this.A),this.L!=2&&(cr(),tt(17)),Un(this),this.s=2,bt(this)):le(this,this.S-o)};function bt(o){o.j.G==0||o.J||wf(o.j,o)}function Un(o){Ye(o);var c=o.M;c&&typeof c.ma=="function"&&c.ma(),o.M=null,vs(o.U),o.g&&(c=o.g,o.g=null,c.abort(),c.ma())}function du(o,c){try{var f=o.j;if(f.G!=0&&(f.g==o||hu(f.h,o))){if(!o.K&&hu(f.h,o)&&f.G==3){try{var g=f.Da.g.parse(c)}catch{g=null}if(Array.isArray(g)&&g.length==3){var D=g;if(D[0]==0){e:if(!f.u){if(f.g)if(f.g.F+3e3<o.F)oa(f),sa(f);else break e;gu(f),tt(18)}}else f.za=D[1],0<f.za-f.T&&37500>D[2]&&f.F&&f.v==0&&!f.C&&(f.C=an(m(f.Za,f),6e3));if(1>=Xh(f.h)&&f.ca){try{f.ca()}catch{}f.ca=void 0}}else Qr(f,11)}else if((o.K||f.g==o)&&oa(f),!A(c))for(D=f.Da.g.parse(c),c=0;c<D.length;c++){let xe=D[c];if(f.T=xe[0],xe=xe[1],f.G==2)if(xe[0]=="c"){f.K=xe[1],f.ia=xe[2];const wt=xe[3];wt!=null&&(f.la=wt,f.j.info("VER="+f.la));const St=xe[4];St!=null&&(f.Aa=St,f.j.info("SVER="+f.Aa));const Is=xe[5];Is!=null&&typeof Is=="number"&&0<Is&&(g=1.5*Is,f.L=g,f.j.info("backChannelRequestTimeoutMs_="+g)),g=f;const vn=o.g;if(vn){const la=vn.g?vn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(la){var V=g.h;V.g||la.indexOf("spdy")==-1&&la.indexOf("quic")==-1&&la.indexOf("h2")==-1||(V.j=V.l,V.g=new Set,V.h&&(fu(V,V.h),V.h=null))}if(g.D){const vu=vn.g?vn.g.getResponseHeader("X-HTTP-Session-Id"):null;vu&&(g.ya=vu,De(g.I,g.D,vu))}}f.G=3,f.l&&f.l.ua(),f.ba&&(f.R=Date.now()-o.F,f.j.info("Handshake RTT: "+f.R+"ms")),g=f;var Y=o;if(g.qa=Tf(g,g.J?g.ia:null,g.W),Y.K){Jh(g.h,Y);var Ce=Y,ht=g.L;ht&&(Ce.I=ht),Ce.B&&(Ye(Ce),qr(Ce)),g.g=Y}else _f(g);0<f.i.length&&ia(f)}else xe[0]!="stop"&&xe[0]!="close"||Qr(f,7);else f.G==3&&(xe[0]=="stop"||xe[0]=="close"?xe[0]=="stop"?Qr(f,7):mu(f):xe[0]!="noop"&&f.l&&f.l.ta(xe),f.v=0)}}cr(4)}catch{}}var Nv=class{constructor(o,c){this.g=o,this.map=c}};function Kh(o){this.l=o||10,l.PerformanceNavigationTiming?(o=l.performance.getEntriesByType("navigation"),o=0<o.length&&(o[0].nextHopProtocol=="hq"||o[0].nextHopProtocol=="h2")):o=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=o?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Yh(o){return o.h?!0:o.g?o.g.size>=o.j:!1}function Xh(o){return o.h?1:o.g?o.g.size:0}function hu(o,c){return o.h?o.h==c:o.g?o.g.has(c):!1}function fu(o,c){o.g?o.g.add(c):o.h=c}function Jh(o,c){o.h&&o.h==c?o.h=null:o.g&&o.g.has(c)&&o.g.delete(c)}Kh.prototype.cancel=function(){if(this.i=Zh(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const o of this.g.values())o.cancel();this.g.clear()}};function Zh(o){if(o.h!=null)return o.i.concat(o.h.D);if(o.g!=null&&o.g.size!==0){let c=o.i;for(const f of o.g.values())c=c.concat(f.D);return c}return P(o.i)}function jv(o){if(o.V&&typeof o.V=="function")return o.V();if(typeof Map<"u"&&o instanceof Map||typeof Set<"u"&&o instanceof Set)return Array.from(o.values());if(typeof o=="string")return o.split("");if(u(o)){for(var c=[],f=o.length,g=0;g<f;g++)c.push(o[g]);return c}c=[],f=0;for(g in o)c[f++]=o[g];return c}function Vv(o){if(o.na&&typeof o.na=="function")return o.na();if(!o.V||typeof o.V!="function"){if(typeof Map<"u"&&o instanceof Map)return Array.from(o.keys());if(!(typeof Set<"u"&&o instanceof Set)){if(u(o)||typeof o=="string"){var c=[];o=o.length;for(var f=0;f<o;f++)c.push(f);return c}c=[],f=0;for(const g in o)c[f++]=g;return c}}}function ef(o,c){if(o.forEach&&typeof o.forEach=="function")o.forEach(c,void 0);else if(u(o)||typeof o=="string")Array.prototype.forEach.call(o,c,void 0);else for(var f=Vv(o),g=jv(o),D=g.length,V=0;V<D;V++)c.call(void 0,g[V],f&&f[V],o)}var tf=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Mv(o,c){if(o){o=o.split("&");for(var f=0;f<o.length;f++){var g=o[f].indexOf("="),D=null;if(0<=g){var V=o[f].substring(0,g);D=o[f].substring(g+1)}else V=o[f];c(V,D?decodeURIComponent(D.replace(/\+/g," ")):"")}}}function Gr(o){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,o instanceof Gr){this.h=o.h,Jo(this,o.j),this.o=o.o,this.g=o.g,Zo(this,o.s),this.l=o.l;var c=o.i,f=new Ti;f.i=c.i,c.g&&(f.g=new Map(c.g),f.h=c.h),nf(this,f),this.m=o.m}else o&&(c=String(o).match(tf))?(this.h=!1,Jo(this,c[1]||"",!0),this.o=Si(c[2]||""),this.g=Si(c[3]||"",!0),Zo(this,c[4]),this.l=Si(c[5]||"",!0),nf(this,c[6]||"",!0),this.m=Si(c[7]||"")):(this.h=!1,this.i=new Ti(null,this.h))}Gr.prototype.toString=function(){var o=[],c=this.j;c&&o.push(Ei(c,rf,!0),":");var f=this.g;return(f||c=="file")&&(o.push("//"),(c=this.o)&&o.push(Ei(c,rf,!0),"@"),o.push(encodeURIComponent(String(f)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f=this.s,f!=null&&o.push(":",String(f))),(f=this.l)&&(this.g&&f.charAt(0)!="/"&&o.push("/"),o.push(Ei(f,f.charAt(0)=="/"?Fv:Ov,!0))),(f=this.i.toString())&&o.push("?",f),(f=this.m)&&o.push("#",Ei(f,Bv)),o.join("")};function $n(o){return new Gr(o)}function Jo(o,c,f){o.j=f?Si(c,!0):c,o.j&&(o.j=o.j.replace(/:$/,""))}function Zo(o,c){if(c){if(c=Number(c),isNaN(c)||0>c)throw Error("Bad port number "+c);o.s=c}else o.s=null}function nf(o,c,f){c instanceof Ti?(o.i=c,Uv(o.i,o.h)):(f||(c=Ei(c,zv)),o.i=new Ti(c,o.h))}function De(o,c,f){o.i.set(c,f)}function ea(o){return De(o,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),o}function Si(o,c){return o?c?decodeURI(o.replace(/%25/g,"%2525")):decodeURIComponent(o):""}function Ei(o,c,f){return typeof o=="string"?(o=encodeURI(o).replace(c,Lv),f&&(o=o.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),o):null}function Lv(o){return o=o.charCodeAt(0),"%"+(o>>4&15).toString(16)+(o&15).toString(16)}var rf=/[#\/\?@]/g,Ov=/[#\?:]/g,Fv=/[#\?]/g,zv=/[#\?@]/g,Bv=/#/g;function Ti(o,c){this.h=this.g=null,this.i=o||null,this.j=!!c}function dr(o){o.g||(o.g=new Map,o.h=0,o.i&&Mv(o.i,function(c,f){o.add(decodeURIComponent(c.replace(/\+/g," ")),f)}))}t=Ti.prototype,t.add=function(o,c){dr(this),this.i=null,o=Es(this,o);var f=this.g.get(o);return f||this.g.set(o,f=[]),f.push(c),this.h+=1,this};function sf(o,c){dr(o),c=Es(o,c),o.g.has(c)&&(o.i=null,o.h-=o.g.get(c).length,o.g.delete(c))}function of(o,c){return dr(o),c=Es(o,c),o.g.has(c)}t.forEach=function(o,c){dr(this),this.g.forEach(function(f,g){f.forEach(function(D){o.call(c,D,g,this)},this)},this)},t.na=function(){dr(this);const o=Array.from(this.g.values()),c=Array.from(this.g.keys()),f=[];for(let g=0;g<c.length;g++){const D=o[g];for(let V=0;V<D.length;V++)f.push(c[g])}return f},t.V=function(o){dr(this);let c=[];if(typeof o=="string")of(this,o)&&(c=c.concat(this.g.get(Es(this,o))));else{o=Array.from(this.g.values());for(let f=0;f<o.length;f++)c=c.concat(o[f])}return c},t.set=function(o,c){return dr(this),this.i=null,o=Es(this,o),of(this,o)&&(this.h-=this.g.get(o).length),this.g.set(o,[c]),this.h+=1,this},t.get=function(o,c){return o?(o=this.V(o),0<o.length?String(o[0]):c):c};function af(o,c,f){sf(o,c),0<f.length&&(o.i=null,o.g.set(Es(o,c),P(f)),o.h+=f.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const o=[],c=Array.from(this.g.keys());for(var f=0;f<c.length;f++){var g=c[f];const V=encodeURIComponent(String(g)),Y=this.V(g);for(g=0;g<Y.length;g++){var D=V;Y[g]!==""&&(D+="="+encodeURIComponent(String(Y[g]))),o.push(D)}}return this.i=o.join("&")};function Es(o,c){return c=String(c),o.j&&(c=c.toLowerCase()),c}function Uv(o,c){c&&!o.j&&(dr(o),o.i=null,o.g.forEach(function(f,g){var D=g.toLowerCase();g!=D&&(sf(this,g),af(this,D,f))},o)),o.j=c}function $v(o,c){const f=new Hr;if(l.Image){const g=new Image;g.onload=C(hr,f,"TestLoadImage: loaded",!0,c,g),g.onerror=C(hr,f,"TestLoadImage: error",!1,c,g),g.onabort=C(hr,f,"TestLoadImage: abort",!1,c,g),g.ontimeout=C(hr,f,"TestLoadImage: timeout",!1,c,g),l.setTimeout(function(){g.ontimeout&&g.ontimeout()},1e4),g.src=o}else c(!1)}function Wv(o,c){const f=new Hr,g=new AbortController,D=setTimeout(()=>{g.abort(),hr(f,"TestPingServer: timeout",!1,c)},1e4);fetch(o,{signal:g.signal}).then(V=>{clearTimeout(D),V.ok?hr(f,"TestPingServer: ok",!0,c):hr(f,"TestPingServer: server error",!1,c)}).catch(()=>{clearTimeout(D),hr(f,"TestPingServer: error",!1,c)})}function hr(o,c,f,g,D){try{D&&(D.onload=null,D.onerror=null,D.onabort=null,D.ontimeout=null),g(f)}catch{}}function Hv(){this.g=new lu}function qv(o,c,f){const g=f||"";try{ef(o,function(D,V){let Y=D;h(D)&&(Y=Ko(D)),c.push(g+V+"="+encodeURIComponent(Y))})}catch(D){throw c.push(g+"type="+encodeURIComponent("_badmap")),D}}function ta(o){this.l=o.Ub||null,this.j=o.eb||!1}R(ta,_s),ta.prototype.g=function(){return new na(this.l,this.j)},ta.prototype.i=function(o){return function(){return o}}({});function na(o,c){lt.call(this),this.D=o,this.o=c,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}R(na,lt),t=na.prototype,t.open=function(o,c){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=o,this.A=c,this.readyState=1,Ai(this)},t.send=function(o){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const c={headers:this.u,method:this.B,credentials:this.m,cache:void 0};o&&(c.body=o),(this.D||l).fetch(new Request(this.A,c)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Ii(this)),this.readyState=0},t.Sa=function(o){if(this.g&&(this.l=o,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=o.headers,this.readyState=2,Ai(this)),this.g&&(this.readyState=3,Ai(this),this.g)))if(this.responseType==="arraybuffer")o.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in o){if(this.j=o.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;lf(this)}else o.text().then(this.Ra.bind(this),this.ga.bind(this))};function lf(o){o.j.read().then(o.Pa.bind(o)).catch(o.ga.bind(o))}t.Pa=function(o){if(this.g){if(this.o&&o.value)this.response.push(o.value);else if(!this.o){var c=o.value?o.value:new Uint8Array(0);(c=this.v.decode(c,{stream:!o.done}))&&(this.response=this.responseText+=c)}o.done?Ii(this):Ai(this),this.readyState==3&&lf(this)}},t.Ra=function(o){this.g&&(this.response=this.responseText=o,Ii(this))},t.Qa=function(o){this.g&&(this.response=o,Ii(this))},t.ga=function(){this.g&&Ii(this)};function Ii(o){o.readyState=4,o.l=null,o.j=null,o.v=null,Ai(o)}t.setRequestHeader=function(o,c){this.u.append(o,c)},t.getResponseHeader=function(o){return this.h&&this.h.get(o.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const o=[],c=this.h.entries();for(var f=c.next();!f.done;)f=f.value,o.push(f[0]+": "+f[1]),f=c.next();return o.join(`\r
`)};function Ai(o){o.onreadystatechange&&o.onreadystatechange.call(o)}Object.defineProperty(na.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(o){this.m=o?"include":"same-origin"}});function uf(o){let c="";return M(o,function(f,g){c+=g,c+=":",c+=f,c+=`\r
`}),c}function pu(o,c,f){e:{for(g in f){var g=!1;break e}g=!0}g||(f=uf(f),typeof o=="string"?f!=null&&encodeURIComponent(String(f)):De(o,c,f))}function We(o){lt.call(this),this.headers=new Map,this.o=o||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}R(We,lt);var Gv=/^https?$/i,Qv=["POST","PUT"];t=We.prototype,t.Ha=function(o){this.J=o},t.ea=function(o,c,f,g){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+o);c=c?c.toUpperCase():"GET",this.D=o,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Ge.g(),this.v=this.o?xs(this.o):xs(Ge),this.g.onreadystatechange=m(this.Ea,this);try{this.B=!0,this.g.open(c,String(o),!0),this.B=!1}catch(V){cf(this,V);return}if(o=f||"",f=new Map(this.headers),g)if(Object.getPrototypeOf(g)===Object.prototype)for(var D in g)f.set(D,g[D]);else if(typeof g.keys=="function"&&typeof g.get=="function")for(const V of g.keys())f.set(V,g.get(V));else throw Error("Unknown input type for opt_headers: "+String(g));g=Array.from(f.keys()).find(V=>V.toLowerCase()=="content-type"),D=l.FormData&&o instanceof l.FormData,!(0<=Array.prototype.indexOf.call(Qv,c,void 0))||g||D||f.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[V,Y]of f)this.g.setRequestHeader(V,Y);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{ff(this),this.u=!0,this.g.send(o),this.u=!1}catch(V){cf(this,V)}};function cf(o,c){o.h=!1,o.g&&(o.j=!0,o.g.abort(),o.j=!1),o.l=c,o.m=5,df(o),ra(o)}function df(o){o.A||(o.A=!0,et(o,"complete"),et(o,"error"))}t.abort=function(o){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=o||7,et(this,"complete"),et(this,"abort"),ra(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ra(this,!0)),We.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?hf(this):this.bb())},t.bb=function(){hf(this)};function hf(o){if(o.h&&typeof a<"u"&&(!o.v[1]||Wn(o)!=4||o.Z()!=2)){if(o.u&&Wn(o)==4)au(o.Ea,0,o);else if(et(o,"readystatechange"),Wn(o)==4){o.h=!1;try{const Y=o.Z();e:switch(Y){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var c=!0;break e;default:c=!1}var f;if(!(f=c)){var g;if(g=Y===0){var D=String(o.D).match(tf)[1]||null;!D&&l.self&&l.self.location&&(D=l.self.location.protocol.slice(0,-1)),g=!Gv.test(D?D.toLowerCase():"")}f=g}if(f)et(o,"complete"),et(o,"success");else{o.m=6;try{var V=2<Wn(o)?o.g.statusText:""}catch{V=""}o.l=V+" ["+o.Z()+"]",df(o)}}finally{ra(o)}}}}function ra(o,c){if(o.g){ff(o);const f=o.g,g=o.v[0]?()=>{}:null;o.g=null,o.v=null,c||et(o,"ready");try{f.onreadystatechange=g}catch{}}}function ff(o){o.I&&(l.clearTimeout(o.I),o.I=null)}t.isActive=function(){return!!this.g};function Wn(o){return o.g?o.g.readyState:0}t.Z=function(){try{return 2<Wn(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(o){if(this.g){var c=this.g.responseText;return o&&c.indexOf(o)==0&&(c=c.substring(o.length)),Yo(c)}};function pf(o){try{if(!o.g)return null;if("response"in o.g)return o.g.response;switch(o.H){case"":case"text":return o.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in o.g)return o.g.mozResponseArrayBuffer}return null}catch{return null}}function Kv(o){const c={};o=(o.g&&2<=Wn(o)&&o.g.getAllResponseHeaders()||"").split(`\r
`);for(let g=0;g<o.length;g++){if(A(o[g]))continue;var f=_(o[g]);const D=f[0];if(f=f[1],typeof f!="string")continue;f=f.trim();const V=c[D]||[];c[D]=V,V.push(f)}S(c,function(g){return g.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ci(o,c,f){return f&&f.internalChannelParams&&f.internalChannelParams[o]||c}function mf(o){this.Aa=0,this.i=[],this.j=new Hr,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Ci("failFast",!1,o),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Ci("baseRetryDelayMs",5e3,o),this.cb=Ci("retryDelaySeedMs",1e4,o),this.Wa=Ci("forwardChannelMaxRetries",2,o),this.wa=Ci("forwardChannelRequestTimeoutMs",2e4,o),this.pa=o&&o.xmlHttpFactory||void 0,this.Xa=o&&o.Tb||void 0,this.Ca=o&&o.useFetchStreams||!1,this.L=void 0,this.J=o&&o.supportsCrossDomainXhr||!1,this.K="",this.h=new Kh(o&&o.concurrentRequestLimit),this.Da=new Hv,this.P=o&&o.fastHandshake||!1,this.O=o&&o.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=o&&o.Rb||!1,o&&o.xa&&this.j.xa(),o&&o.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&o&&o.detectBufferingProxy||!1,this.ja=void 0,o&&o.longPollingTimeout&&0<o.longPollingTimeout&&(this.ja=o.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=mf.prototype,t.la=8,t.G=1,t.connect=function(o,c,f,g){tt(0),this.W=o,this.H=c||{},f&&g!==void 0&&(this.H.OSID=f,this.H.OAID=g),this.F=this.X,this.I=Tf(this,null,this.W),ia(this)};function mu(o){if(gf(o),o.G==3){var c=o.U++,f=$n(o.I);if(De(f,"SID",o.K),De(f,"RID",c),De(f,"TYPE","terminate"),ki(o,f),c=new Me(o,o.j,c),c.L=2,c.v=ea($n(f)),f=!1,l.navigator&&l.navigator.sendBeacon)try{f=l.navigator.sendBeacon(c.v.toString(),"")}catch{}!f&&l.Image&&(new Image().src=c.v,f=!0),f||(c.g=If(c.j,null),c.g.ea(c.v)),c.F=Date.now(),qr(c)}Ef(o)}function sa(o){o.g&&(yu(o),o.g.cancel(),o.g=null)}function gf(o){sa(o),o.u&&(l.clearTimeout(o.u),o.u=null),oa(o),o.h.cancel(),o.s&&(typeof o.s=="number"&&l.clearTimeout(o.s),o.s=null)}function ia(o){if(!Yh(o.h)&&!o.s){o.s=!0;var c=o.Ga;B||W(),N||(B(),N=!0),F.add(c,o),o.B=0}}function Yv(o,c){return Xh(o.h)>=o.h.j-(o.s?1:0)?!1:o.s?(o.i=c.D.concat(o.i),!0):o.G==1||o.G==2||o.B>=(o.Va?0:o.Wa)?!1:(o.s=an(m(o.Ga,o,c),Sf(o,o.B)),o.B++,!0)}t.Ga=function(o){if(this.s)if(this.s=null,this.G==1){if(!o){this.U=Math.floor(1e5*Math.random()),o=this.U++;const D=new Me(this,this.j,o);let V=this.o;if(this.S&&(V?(V=v(V),I(V,this.S)):V=this.S),this.m!==null||this.O||(D.H=V,V=null),this.P)e:{for(var c=0,f=0;f<this.i.length;f++){t:{var g=this.i[f];if("__data__"in g.map&&(g=g.map.__data__,typeof g=="string")){g=g.length;break t}g=void 0}if(g===void 0)break;if(c+=g,4096<c){c=f;break e}if(c===4096||f===this.i.length-1){c=f+1;break e}}c=1e3}else c=1e3;c=vf(this,D,c),f=$n(this.I),De(f,"RID",o),De(f,"CVER",22),this.D&&De(f,"X-HTTP-Session-Id",this.D),ki(this,f),V&&(this.O?c="headers="+encodeURIComponent(String(uf(V)))+"&"+c:this.m&&pu(f,this.m,V)),fu(this.h,D),this.Ua&&De(f,"TYPE","init"),this.P?(De(f,"$req",c),De(f,"SID","null"),D.T=!0,wi(D,f,null)):wi(D,f,c),this.G=2}}else this.G==3&&(o?yf(this,o):this.i.length==0||Yh(this.h)||yf(this))};function yf(o,c){var f;c?f=c.l:f=o.U++;const g=$n(o.I);De(g,"SID",o.K),De(g,"RID",f),De(g,"AID",o.T),ki(o,g),o.m&&o.o&&pu(g,o.m,o.o),f=new Me(o,o.j,f,o.B+1),o.m===null&&(f.H=o.o),c&&(o.i=c.D.concat(o.i)),c=vf(o,f,1e3),f.I=Math.round(.5*o.wa)+Math.round(.5*o.wa*Math.random()),fu(o.h,f),wi(f,g,c)}function ki(o,c){o.H&&M(o.H,function(f,g){De(c,g,f)}),o.l&&ef({},function(f,g){De(c,g,f)})}function vf(o,c,f){f=Math.min(o.i.length,f);var g=o.l?m(o.l.Na,o.l,o):null;e:{var D=o.i;let V=-1;for(;;){const Y=["count="+f];V==-1?0<f?(V=D[0].g,Y.push("ofs="+V)):V=0:Y.push("ofs="+V);let Ce=!0;for(let ht=0;ht<f;ht++){let xe=D[ht].g;const wt=D[ht].map;if(xe-=V,0>xe)V=Math.max(0,D[ht].g-100),Ce=!1;else try{qv(wt,Y,"req"+xe+"_")}catch{g&&g(wt)}}if(Ce){g=Y.join("&");break e}}}return o=o.i.splice(0,f),c.D=o,g}function _f(o){if(!o.g&&!o.u){o.Y=1;var c=o.Fa;B||W(),N||(B(),N=!0),F.add(c,o),o.v=0}}function gu(o){return o.g||o.u||3<=o.v?!1:(o.Y++,o.u=an(m(o.Fa,o),Sf(o,o.v)),o.v++,!0)}t.Fa=function(){if(this.u=null,xf(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var o=2*this.R;this.j.info("BP detection timer enabled: "+o),this.A=an(m(this.ab,this),o)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,tt(10),sa(this),xf(this))};function yu(o){o.A!=null&&(l.clearTimeout(o.A),o.A=null)}function xf(o){o.g=new Me(o,o.j,"rpc",o.Y),o.m===null&&(o.g.H=o.o),o.g.O=0;var c=$n(o.qa);De(c,"RID","rpc"),De(c,"SID",o.K),De(c,"AID",o.T),De(c,"CI",o.F?"0":"1"),!o.F&&o.ja&&De(c,"TO",o.ja),De(c,"TYPE","xmlhttp"),ki(o,c),o.m&&o.o&&pu(c,o.m,o.o),o.L&&(o.g.I=o.L);var f=o.g;o=o.ia,f.L=1,f.v=ea($n(c)),f.m=null,f.P=!0,Ss(f,o)}t.Za=function(){this.C!=null&&(this.C=null,sa(this),gu(this),tt(19))};function oa(o){o.C!=null&&(l.clearTimeout(o.C),o.C=null)}function wf(o,c){var f=null;if(o.g==c){oa(o),yu(o),o.g=null;var g=2}else if(hu(o.h,c))f=c.D,Jh(o.h,c),g=1;else return;if(o.G!=0){if(c.o)if(g==1){f=c.m?c.m.length:0,c=Date.now()-c.F;var D=o.B;g=ws(),et(g,new xi(g,f)),ia(o)}else _f(o);else if(D=c.s,D==3||D==0&&0<c.X||!(g==1&&Yv(o,c)||g==2&&gu(o)))switch(f&&0<f.length&&(c=o.h,c.i=c.i.concat(f)),D){case 1:Qr(o,5);break;case 4:Qr(o,10);break;case 3:Qr(o,6);break;default:Qr(o,2)}}}function Sf(o,c){let f=o.Ta+Math.floor(Math.random()*o.cb);return o.isActive()||(f*=2),f*c}function Qr(o,c){if(o.j.info("Error code "+c),c==2){var f=m(o.fb,o),g=o.Xa;const D=!g;g=new Gr(g||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||Jo(g,"https"),ea(g),D?$v(g.toString(),f):Wv(g.toString(),f)}else tt(2);o.G=0,o.l&&o.l.sa(c),Ef(o),gf(o)}t.fb=function(o){o?(this.j.info("Successfully pinged google.com"),tt(2)):(this.j.info("Failed to ping google.com"),tt(1))};function Ef(o){if(o.G=0,o.ka=[],o.l){const c=Zh(o.h);(c.length!=0||o.i.length!=0)&&(O(o.ka,c),O(o.ka,o.i),o.h.i.length=0,P(o.i),o.i.length=0),o.l.ra()}}function Tf(o,c,f){var g=f instanceof Gr?$n(f):new Gr(f);if(g.g!="")c&&(g.g=c+"."+g.g),Zo(g,g.s);else{var D=l.location;g=D.protocol,c=c?c+"."+D.hostname:D.hostname,D=+D.port;var V=new Gr(null);g&&Jo(V,g),c&&(V.g=c),D&&Zo(V,D),f&&(V.l=f),g=V}return f=o.D,c=o.ya,f&&c&&De(g,f,c),De(g,"VER",o.la),ki(o,g),g}function If(o,c,f){if(c&&!o.J)throw Error("Can't create secondary domain capable XhrIo object.");return c=o.Ca&&!o.pa?new We(new ta({eb:f})):new We(o.pa),c.Ha(o.J),c}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Af(){}t=Af.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function aa(){}aa.prototype.g=function(o,c){return new Jt(o,c)};function Jt(o,c){lt.call(this),this.g=new mf(c),this.l=o,this.h=c&&c.messageUrlParams||null,o=c&&c.messageHeaders||null,c&&c.clientProtocolHeaderRequired&&(o?o["X-Client-Protocol"]="webchannel":o={"X-Client-Protocol":"webchannel"}),this.g.o=o,o=c&&c.initMessageHeaders||null,c&&c.messageContentType&&(o?o["X-WebChannel-Content-Type"]=c.messageContentType:o={"X-WebChannel-Content-Type":c.messageContentType}),c&&c.va&&(o?o["X-WebChannel-Client-Profile"]=c.va:o={"X-WebChannel-Client-Profile":c.va}),this.g.S=o,(o=c&&c.Sb)&&!A(o)&&(this.g.m=o),this.v=c&&c.supportsCrossDomainXhr||!1,this.u=c&&c.sendRawJson||!1,(c=c&&c.httpSessionIdParam)&&!A(c)&&(this.g.D=c,o=this.h,o!==null&&c in o&&(o=this.h,c in o&&delete o[c])),this.j=new Ts(this)}R(Jt,lt),Jt.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Jt.prototype.close=function(){mu(this.g)},Jt.prototype.o=function(o){var c=this.g;if(typeof o=="string"){var f={};f.__data__=o,o=f}else this.u&&(f={},f.__data__=Ko(o),o=f);c.i.push(new Nv(c.Ya++,o)),c.G==3&&ia(c)},Jt.prototype.N=function(){this.g.l=null,delete this.j,mu(this.g),delete this.g,Jt.aa.N.call(this)};function Cf(o){Lt.call(this),o.__headers__&&(this.headers=o.__headers__,this.statusCode=o.__status__,delete o.__headers__,delete o.__status__);var c=o.__sm__;if(c){e:{for(const f in c){o=f;break e}o=void 0}(this.i=o)&&(o=this.i,c=c!==null&&o in c?c[o]:void 0),this.data=c}else this.data=o}R(Cf,Lt);function kf(){Fn.call(this),this.status=1}R(kf,Fn);function Ts(o){this.g=o}R(Ts,Af),Ts.prototype.ua=function(){et(this.g,"a")},Ts.prototype.ta=function(o){et(this.g,new Cf(o))},Ts.prototype.sa=function(o){et(this.g,new kf)},Ts.prototype.ra=function(){et(this.g,"b")},aa.prototype.createWebChannel=aa.prototype.g,Jt.prototype.send=Jt.prototype.o,Jt.prototype.open=Jt.prototype.m,Jt.prototype.close=Jt.prototype.close,p0=function(){return new aa},f0=function(){return ws()},h0=Rt,Xc={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},se.NO_ERROR=0,se.TIMEOUT=8,se.HTTP_ERROR=6,Ua=se,_e.COMPLETE="complete",d0=_e,ur.EventType=yn,yn.OPEN="a",yn.CLOSE="b",yn.ERROR="c",yn.MESSAGE="d",lt.prototype.listen=lt.prototype.K,Ui=ur,We.prototype.listenOnce=We.prototype.L,We.prototype.getLastError=We.prototype.Ka,We.prototype.getLastErrorCode=We.prototype.Ba,We.prototype.getStatus=We.prototype.Z,We.prototype.getResponseJson=We.prototype.Oa,We.prototype.getResponseText=We.prototype.oa,We.prototype.send=We.prototype.ea,We.prototype.setWithCredentials=We.prototype.Ha,c0=We}).apply(typeof Aa<"u"?Aa:typeof self<"u"?self:typeof window<"u"?window:{});const Kp="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ft{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Ft.UNAUTHENTICATED=new Ft(null),Ft.GOOGLE_CREDENTIALS=new Ft("google-credentials-uid"),Ft.FIRST_PARTY=new Ft("first-party-uid"),Ft.MOCK_USER=new Ft("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let fi="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cs=new n0("@firebase/firestore");function Li(){return cs.logLevel}function ne(t,...e){if(cs.logLevel<=ye.DEBUG){const n=e.map(fh);cs.debug(`Firestore (${fi}): ${t}`,...n)}}function sr(t,...e){if(cs.logLevel<=ye.ERROR){const n=e.map(fh);cs.error(`Firestore (${fi}): ${t}`,...n)}}function Ao(t,...e){if(cs.logLevel<=ye.WARN){const n=e.map(fh);cs.warn(`Firestore (${fi}): ${t}`,...n)}}function fh(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ae(t="Unexpected state"){const e=`FIRESTORE (${fi}) INTERNAL ASSERTION FAILED: `+t;throw sr(e),new Error(e)}function Ie(t,e){t||ae()}function ce(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class J extends hi{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xn{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zw{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class eS{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Ft.UNAUTHENTICATED))}shutdown(){}}class tS{constructor(e){this.t=e,this.currentUser=Ft.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){Ie(this.o===void 0);let r=this.i;const s=u=>this.i!==r?(r=this.i,n(u)):Promise.resolve();let i=new Xn;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Xn,e.enqueueRetryable(()=>s(this.currentUser))};const a=()=>{const u=i;e.enqueueRetryable(async()=>{await u.promise,await s(this.currentUser)})},l=u=>{ne("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(u=>l(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?l(u):(ne("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Xn)}},0),a()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(ne("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Ie(typeof r.accessToken=="string"),new Zw(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Ie(e===null||typeof e=="string"),new Ft(e)}}class nS{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=Ft.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class rS{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new nS(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(Ft.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class sS{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class iS{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){Ie(this.o===void 0);const r=i=>{i.error!=null&&ne("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const a=i.token!==this.R;return this.R=i.token,ne("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{ne("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.A.getImmediate({optional:!0});i?s(i):ne("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(Ie(typeof n.token=="string"),this.R=n.token,new sS(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oS(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m0{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const s=oS(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%e.length))}return r}}function we(t,e){return t<e?-1:t>e?1:0}function ri(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class at{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new J(z.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new J(z.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new J(z.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new J(z.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return at.fromMillis(Date.now())}static fromDate(e){return at.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new at(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?we(this.nanoseconds,e.nanoseconds):we(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ue{constructor(e){this.timestamp=e}static fromTimestamp(e){return new ue(e)}static min(){return new ue(new at(0,0))}static max(){return new ue(new at(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Co{constructor(e,n,r){n===void 0?n=0:n>e.length&&ae(),r===void 0?r=e.length-n:r>e.length-n&&ae(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return Co.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Co?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=e.get(s),a=n.get(s);if(i<a)return-1;if(i>a)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class je extends Co{construct(e,n,r){return new je(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new J(z.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new je(n)}static emptyPath(){return new je([])}}const aS=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class mt extends Co{construct(e,n,r){return new mt(e,n,r)}static isValidIdentifier(e){return aS.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),mt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new mt(["__name__"])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new J(z.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let a=!1;for(;s<e.length;){const l=e[s];if(l==="\\"){if(s+1===e.length)throw new J(z.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[s+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new J(z.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,s+=2}else l==="`"?(a=!a,s++):l!=="."||a?(r+=l,s++):(i(),s++)}if(i(),a)throw new J(z.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new mt(n)}static emptyPath(){return new mt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ie{constructor(e){this.path=e}static fromPath(e){return new ie(je.fromString(e))}static fromName(e){return new ie(je.fromString(e).popFirst(5))}static empty(){return new ie(je.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&je.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return je.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ie(new je(e.slice()))}}function lS(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=ue.fromTimestamp(r===1e9?new at(n+1,0):new at(n,r));return new Mr(s,ie.empty(),e)}function uS(t){return new Mr(t.readTime,t.key,-1)}class Mr{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new Mr(ue.min(),ie.empty(),-1)}static max(){return new Mr(ue.max(),ie.empty(),-1)}}function cS(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=ie.comparator(t.documentKey,e.documentKey),n!==0?n:we(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dS="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class hS{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Fo(t){if(t.code!==z.FAILED_PRECONDITION||t.message!==dS)throw t;ne("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ${constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&ae(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new $((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof $?n:$.resolve(n)}catch(n){return $.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):$.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):$.reject(n)}static resolve(e){return new $((n,r)=>{n(e)})}static reject(e){return new $((n,r)=>{r(e)})}static waitFor(e){return new $((n,r)=>{let s=0,i=0,a=!1;e.forEach(l=>{++s,l.next(()=>{++i,a&&i===s&&n()},u=>r(u))}),a=!0,i===s&&n()})}static or(e){let n=$.resolve(!1);for(const r of e)n=n.next(s=>s?$.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new $((r,s)=>{const i=e.length,a=new Array(i);let l=0;for(let u=0;u<i;u++){const h=u;n(e[h]).next(p=>{a[h]=p,++l,l===i&&r(a)},p=>s(p))}})}static doWhile(e,n){return new $((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}function fS(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function zo(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ph{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ie(r),this.se=r=>n.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}ph.oe=-1;function Hl(t){return t==null}function xl(t){return t===0&&1/t==-1/0}function pS(t){return typeof t=="number"&&Number.isInteger(t)&&!xl(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yp(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function ms(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function g0(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ue{constructor(e,n){this.comparator=e,this.root=n||pt.EMPTY}insert(e,n){return new Ue(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,pt.BLACK,null,null))}remove(e){return new Ue(this.comparator,this.root.remove(e,this.comparator).copy(null,null,pt.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Ca(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Ca(this.root,e,this.comparator,!1)}getReverseIterator(){return new Ca(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Ca(this.root,e,this.comparator,!0)}}class Ca{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class pt{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??pt.RED,this.left=s??pt.EMPTY,this.right=i??pt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new pt(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return pt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return pt.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,pt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,pt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw ae();const e=this.left.check();if(e!==this.right.check())throw ae();return e+(this.isRed()?0:1)}}pt.EMPTY=null,pt.RED=!0,pt.BLACK=!1;pt.EMPTY=new class{constructor(){this.size=0}get key(){throw ae()}get value(){throw ae()}get color(){throw ae()}get left(){throw ae()}get right(){throw ae()}copy(e,n,r,s,i){return this}insert(e,n,r){return new pt(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yt{constructor(e){this.comparator=e,this.data=new Ue(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new Xp(this.data.getIterator())}getIteratorFrom(e){return new Xp(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof yt)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new yt(this.comparator);return n.data=e,n}}class Xp{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tn{constructor(e){this.fields=e,e.sort(mt.comparator)}static empty(){return new tn([])}unionWith(e){let n=new yt(mt.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new tn(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return ri(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y0 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _t{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new y0("Invalid base64 string: "+i):i}}(e);return new _t(n)}static fromUint8Array(e){const n=function(s){let i="";for(let a=0;a<s.length;++a)i+=String.fromCharCode(s[a]);return i}(e);return new _t(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return we(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}_t.EMPTY_BYTE_STRING=new _t("");const mS=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Lr(t){if(Ie(!!t),typeof t=="string"){let e=0;const n=mS.exec(t);if(Ie(!!n),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Qe(t.seconds),nanos:Qe(t.nanos)}}function Qe(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function ds(t){return typeof t=="string"?_t.fromBase64String(t):_t.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mh(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function gh(t){const e=t.mapValue.fields.__previous_value__;return mh(e)?gh(e):e}function ko(t){const e=Lr(t.mapValue.fields.__local_write_time__.timestampValue);return new at(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gS{constructor(e,n,r,s,i,a,l,u,h){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=a,this.autoDetectLongPolling=l,this.longPollingOptions=u,this.useFetchStreams=h}}class Ro{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new Ro("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Ro&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ka={mapValue:{}};function hs(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?mh(t)?4:vS(t)?9007199254740991:yS(t)?10:11:ae()}function Ln(t,e){if(t===e)return!0;const n=hs(t);if(n!==hs(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return ko(t).isEqual(ko(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const a=Lr(s.timestampValue),l=Lr(i.timestampValue);return a.seconds===l.seconds&&a.nanos===l.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return ds(s.bytesValue).isEqual(ds(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return Qe(s.geoPointValue.latitude)===Qe(i.geoPointValue.latitude)&&Qe(s.geoPointValue.longitude)===Qe(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return Qe(s.integerValue)===Qe(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const a=Qe(s.doubleValue),l=Qe(i.doubleValue);return a===l?xl(a)===xl(l):isNaN(a)&&isNaN(l)}return!1}(t,e);case 9:return ri(t.arrayValue.values||[],e.arrayValue.values||[],Ln);case 10:case 11:return function(s,i){const a=s.mapValue.fields||{},l=i.mapValue.fields||{};if(Yp(a)!==Yp(l))return!1;for(const u in a)if(a.hasOwnProperty(u)&&(l[u]===void 0||!Ln(a[u],l[u])))return!1;return!0}(t,e);default:return ae()}}function Po(t,e){return(t.values||[]).find(n=>Ln(n,e))!==void 0}function si(t,e){if(t===e)return 0;const n=hs(t),r=hs(e);if(n!==r)return we(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return we(t.booleanValue,e.booleanValue);case 2:return function(i,a){const l=Qe(i.integerValue||i.doubleValue),u=Qe(a.integerValue||a.doubleValue);return l<u?-1:l>u?1:l===u?0:isNaN(l)?isNaN(u)?0:-1:1}(t,e);case 3:return Jp(t.timestampValue,e.timestampValue);case 4:return Jp(ko(t),ko(e));case 5:return we(t.stringValue,e.stringValue);case 6:return function(i,a){const l=ds(i),u=ds(a);return l.compareTo(u)}(t.bytesValue,e.bytesValue);case 7:return function(i,a){const l=i.split("/"),u=a.split("/");for(let h=0;h<l.length&&h<u.length;h++){const p=we(l[h],u[h]);if(p!==0)return p}return we(l.length,u.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,a){const l=we(Qe(i.latitude),Qe(a.latitude));return l!==0?l:we(Qe(i.longitude),Qe(a.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return Zp(t.arrayValue,e.arrayValue);case 10:return function(i,a){var l,u,h,p;const y=i.fields||{},m=a.fields||{},C=(l=y.value)===null||l===void 0?void 0:l.arrayValue,R=(u=m.value)===null||u===void 0?void 0:u.arrayValue,P=we(((h=C==null?void 0:C.values)===null||h===void 0?void 0:h.length)||0,((p=R==null?void 0:R.values)===null||p===void 0?void 0:p.length)||0);return P!==0?P:Zp(C,R)}(t.mapValue,e.mapValue);case 11:return function(i,a){if(i===ka.mapValue&&a===ka.mapValue)return 0;if(i===ka.mapValue)return 1;if(a===ka.mapValue)return-1;const l=i.fields||{},u=Object.keys(l),h=a.fields||{},p=Object.keys(h);u.sort(),p.sort();for(let y=0;y<u.length&&y<p.length;++y){const m=we(u[y],p[y]);if(m!==0)return m;const C=si(l[u[y]],h[p[y]]);if(C!==0)return C}return we(u.length,p.length)}(t.mapValue,e.mapValue);default:throw ae()}}function Jp(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return we(t,e);const n=Lr(t),r=Lr(e),s=we(n.seconds,r.seconds);return s!==0?s:we(n.nanos,r.nanos)}function Zp(t,e){const n=t.values||[],r=e.values||[];for(let s=0;s<n.length&&s<r.length;++s){const i=si(n[s],r[s]);if(i)return i}return we(n.length,r.length)}function ii(t){return Jc(t)}function Jc(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=Lr(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return ds(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return ie.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",s=!0;for(const i of n.values||[])s?s=!1:r+=",",r+=Jc(i);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",i=!0;for(const a of r)i?i=!1:s+=",",s+=`${a}:${Jc(n.fields[a])}`;return s+"}"}(t.mapValue):ae()}function em(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Zc(t){return!!t&&"integerValue"in t}function yh(t){return!!t&&"arrayValue"in t}function tm(t){return!!t&&"nullValue"in t}function nm(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function $a(t){return!!t&&"mapValue"in t}function yS(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="__vector__"}function no(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return ms(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=no(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=no(t.arrayValue.values[n]);return e}return Object.assign({},t)}function vS(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bt{constructor(e){this.value=e}static empty(){return new Bt({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!$a(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=no(n)}setAll(e){let n=mt.emptyPath(),r={},s=[];e.forEach((a,l)=>{if(!n.isImmediateParentOf(l)){const u=this.getFieldsMap(n);this.applyChanges(u,r,s),r={},s=[],n=l.popLast()}a?r[l.lastSegment()]=no(a):s.push(l.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());$a(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Ln(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];$a(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){ms(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new Bt(no(this.value))}}function v0(t){const e=[];return ms(t.fields,(n,r)=>{const s=new mt([n]);if($a(r)){const i=v0(r.mapValue).fields;if(i.length===0)e.push(s);else for(const a of i)e.push(s.child(a))}else e.push(s)}),new tn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ct{constructor(e,n,r,s,i,a,l){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=a,this.documentState=l}static newInvalidDocument(e){return new Ct(e,0,ue.min(),ue.min(),ue.min(),Bt.empty(),0)}static newFoundDocument(e,n,r,s){return new Ct(e,1,n,ue.min(),r,s,0)}static newNoDocument(e,n){return new Ct(e,2,n,ue.min(),ue.min(),Bt.empty(),0)}static newUnknownDocument(e,n){return new Ct(e,3,n,ue.min(),ue.min(),Bt.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(ue.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Bt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Bt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ue.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Ct&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Ct(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wl{constructor(e,n){this.position=e,this.inclusive=n}}function rm(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],a=t.position[s];if(i.field.isKeyField()?r=ie.comparator(ie.fromName(a.referenceValue),n.key):r=si(a,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function sm(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Ln(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sl{constructor(e,n="asc"){this.field=e,this.dir=n}}function _S(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _0{}class Ze extends _0{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new wS(e,n,r):n==="array-contains"?new TS(e,r):n==="in"?new IS(e,r):n==="not-in"?new AS(e,r):n==="array-contains-any"?new CS(e,r):new Ze(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new SS(e,r):new ES(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(si(n,this.value)):n!==null&&hs(this.value)===hs(n)&&this.matchesComparison(si(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ae()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Cn extends _0{constructor(e,n){super(),this.filters=e,this.op=n,this.ae=null}static create(e,n){return new Cn(e,n)}matches(e){return x0(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function x0(t){return t.op==="and"}function w0(t){return xS(t)&&x0(t)}function xS(t){for(const e of t.filters)if(e instanceof Cn)return!1;return!0}function ed(t){if(t instanceof Ze)return t.field.canonicalString()+t.op.toString()+ii(t.value);if(w0(t))return t.filters.map(e=>ed(e)).join(",");{const e=t.filters.map(n=>ed(n)).join(",");return`${t.op}(${e})`}}function S0(t,e){return t instanceof Ze?function(r,s){return s instanceof Ze&&r.op===s.op&&r.field.isEqual(s.field)&&Ln(r.value,s.value)}(t,e):t instanceof Cn?function(r,s){return s instanceof Cn&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,a,l)=>i&&S0(a,s.filters[l]),!0):!1}(t,e):void ae()}function E0(t){return t instanceof Ze?function(n){return`${n.field.canonicalString()} ${n.op} ${ii(n.value)}`}(t):t instanceof Cn?function(n){return n.op.toString()+" {"+n.getFilters().map(E0).join(" ,")+"}"}(t):"Filter"}class wS extends Ze{constructor(e,n,r){super(e,n,r),this.key=ie.fromName(r.referenceValue)}matches(e){const n=ie.comparator(e.key,this.key);return this.matchesComparison(n)}}class SS extends Ze{constructor(e,n){super(e,"in",n),this.keys=T0("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class ES extends Ze{constructor(e,n){super(e,"not-in",n),this.keys=T0("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function T0(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>ie.fromName(r.referenceValue))}class TS extends Ze{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return yh(n)&&Po(n.arrayValue,this.value)}}class IS extends Ze{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Po(this.value.arrayValue,n)}}class AS extends Ze{constructor(e,n){super(e,"not-in",n)}matches(e){if(Po(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!Po(this.value.arrayValue,n)}}class CS extends Ze{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!yh(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Po(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kS{constructor(e,n=null,r=[],s=[],i=null,a=null,l=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=a,this.endAt=l,this.ue=null}}function im(t,e=null,n=[],r=[],s=null,i=null,a=null){return new kS(t,e,n,r,s,i,a)}function vh(t){const e=ce(t);if(e.ue===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>ed(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),Hl(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>ii(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>ii(r)).join(",")),e.ue=n}return e.ue}function _h(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!_S(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!S0(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!sm(t.startAt,e.startAt)&&sm(t.endAt,e.endAt)}function td(t){return ie.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bo{constructor(e,n=null,r=[],s=[],i=null,a="F",l=null,u=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=a,this.startAt=l,this.endAt=u,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function RS(t,e,n,r,s,i,a,l){return new Bo(t,e,n,r,s,i,a,l)}function xh(t){return new Bo(t)}function om(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function I0(t){return t.collectionGroup!==null}function ro(t){const e=ce(t);if(e.ce===null){e.ce=[];const n=new Set;for(const i of e.explicitOrderBy)e.ce.push(i),n.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let l=new yt(mt.comparator);return a.filters.forEach(u=>{u.getFlattenedFilters().forEach(h=>{h.isInequality()&&(l=l.add(h.field))})}),l})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.ce.push(new Sl(i,r))}),n.has(mt.keyField().canonicalString())||e.ce.push(new Sl(mt.keyField(),r))}return e.ce}function Vn(t){const e=ce(t);return e.le||(e.le=PS(e,ro(t))),e.le}function PS(t,e){if(t.limitType==="F")return im(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new Sl(s.field,i)});const n=t.endAt?new wl(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new wl(t.startAt.position,t.startAt.inclusive):null;return im(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function nd(t,e){const n=t.filters.concat([e]);return new Bo(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function rd(t,e,n){return new Bo(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function ql(t,e){return _h(Vn(t),Vn(e))&&t.limitType===e.limitType}function A0(t){return`${vh(Vn(t))}|lt:${t.limitType}`}function Cs(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>E0(s)).join(", ")}]`),Hl(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>ii(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>ii(s)).join(",")),`Target(${r})`}(Vn(t))}; limitType=${t.limitType})`}function Gl(t,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):ie.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(t,e)&&function(r,s){for(const i of ro(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(r,s){return!(r.startAt&&!function(a,l,u){const h=rm(a,l,u);return a.inclusive?h<=0:h<0}(r.startAt,ro(r),s)||r.endAt&&!function(a,l,u){const h=rm(a,l,u);return a.inclusive?h>=0:h>0}(r.endAt,ro(r),s))}(t,e)}function bS(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function C0(t){return(e,n)=>{let r=!1;for(const s of ro(t)){const i=DS(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function DS(t,e,n){const r=t.field.isKeyField()?ie.comparator(e.key,n.key):function(i,a,l){const u=a.data.field(i),h=l.data.field(i);return u!==null&&h!==null?si(u,h):ae()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return ae()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pi{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){ms(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return g0(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NS=new Ue(ie.comparator);function ir(){return NS}const k0=new Ue(ie.comparator);function $i(...t){let e=k0;for(const n of t)e=e.insert(n.key,n);return e}function R0(t){let e=k0;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function ts(){return so()}function P0(){return so()}function so(){return new pi(t=>t.toString(),(t,e)=>t.isEqual(e))}const jS=new Ue(ie.comparator),VS=new yt(ie.comparator);function pe(...t){let e=VS;for(const n of t)e=e.add(n);return e}const MS=new yt(we);function LS(){return MS}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wh(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:xl(e)?"-0":e}}function b0(t){return{integerValue:""+t}}function OS(t,e){return pS(e)?b0(e):wh(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ql{constructor(){this._=void 0}}function FS(t,e,n){return t instanceof bo?function(s,i){const a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&mh(i)&&(i=gh(i)),i&&(a.fields.__previous_value__=i),{mapValue:a}}(n,e):t instanceof Do?N0(t,e):t instanceof No?j0(t,e):function(s,i){const a=D0(s,i),l=am(a)+am(s.Pe);return Zc(a)&&Zc(s.Pe)?b0(l):wh(s.serializer,l)}(t,e)}function zS(t,e,n){return t instanceof Do?N0(t,e):t instanceof No?j0(t,e):n}function D0(t,e){return t instanceof El?function(r){return Zc(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class bo extends Ql{}class Do extends Ql{constructor(e){super(),this.elements=e}}function N0(t,e){const n=V0(e);for(const r of t.elements)n.some(s=>Ln(s,r))||n.push(r);return{arrayValue:{values:n}}}class No extends Ql{constructor(e){super(),this.elements=e}}function j0(t,e){let n=V0(e);for(const r of t.elements)n=n.filter(s=>!Ln(s,r));return{arrayValue:{values:n}}}class El extends Ql{constructor(e,n){super(),this.serializer=e,this.Pe=n}}function am(t){return Qe(t.integerValue||t.doubleValue)}function V0(t){return yh(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BS{constructor(e,n){this.field=e,this.transform=n}}function US(t,e){return t.field.isEqual(e.field)&&function(r,s){return r instanceof Do&&s instanceof Do||r instanceof No&&s instanceof No?ri(r.elements,s.elements,Ln):r instanceof El&&s instanceof El?Ln(r.Pe,s.Pe):r instanceof bo&&s instanceof bo}(t.transform,e.transform)}class $S{constructor(e,n){this.version=e,this.transformResults=n}}class pn{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new pn}static exists(e){return new pn(void 0,e)}static updateTime(e){return new pn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Wa(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Kl{}function M0(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Sh(t.key,pn.none()):new Uo(t.key,t.data,pn.none());{const n=t.data,r=Bt.empty();let s=new yt(mt.comparator);for(let i of e.fields)if(!s.has(i)){let a=n.field(i);a===null&&i.length>1&&(i=i.popLast(),a=n.field(i)),a===null?r.delete(i):r.set(i,a),s=s.add(i)}return new Ur(t.key,r,new tn(s.toArray()),pn.none())}}function WS(t,e,n){t instanceof Uo?function(s,i,a){const l=s.value.clone(),u=um(s.fieldTransforms,i,a.transformResults);l.setAll(u),i.convertToFoundDocument(a.version,l).setHasCommittedMutations()}(t,e,n):t instanceof Ur?function(s,i,a){if(!Wa(s.precondition,i))return void i.convertToUnknownDocument(a.version);const l=um(s.fieldTransforms,i,a.transformResults),u=i.data;u.setAll(L0(s)),u.setAll(l),i.convertToFoundDocument(a.version,u).setHasCommittedMutations()}(t,e,n):function(s,i,a){i.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,n)}function io(t,e,n,r){return t instanceof Uo?function(i,a,l,u){if(!Wa(i.precondition,a))return l;const h=i.value.clone(),p=cm(i.fieldTransforms,u,a);return h.setAll(p),a.convertToFoundDocument(a.version,h).setHasLocalMutations(),null}(t,e,n,r):t instanceof Ur?function(i,a,l,u){if(!Wa(i.precondition,a))return l;const h=cm(i.fieldTransforms,u,a),p=a.data;return p.setAll(L0(i)),p.setAll(h),a.convertToFoundDocument(a.version,p).setHasLocalMutations(),l===null?null:l.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(y=>y.field))}(t,e,n,r):function(i,a,l){return Wa(i.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):l}(t,e,n)}function HS(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=D0(r.transform,s||null);i!=null&&(n===null&&(n=Bt.empty()),n.set(r.field,i))}return n||null}function lm(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&ri(r,s,(i,a)=>US(i,a))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Uo extends Kl{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Ur extends Kl{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function L0(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function um(t,e,n){const r=new Map;Ie(t.length===n.length);for(let s=0;s<n.length;s++){const i=t[s],a=i.transform,l=e.data.field(i.field);r.set(i.field,zS(a,l,n[s]))}return r}function cm(t,e,n){const r=new Map;for(const s of t){const i=s.transform,a=n.data.field(s.field);r.set(s.field,FS(i,a,e))}return r}class Sh extends Kl{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class qS extends Kl{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GS{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&WS(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=io(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=io(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=P0();return this.mutations.forEach(s=>{const i=e.get(s.key),a=i.overlayedDocument;let l=this.applyToLocalView(a,i.mutatedFields);l=n.has(s.key)?null:l;const u=M0(a,l);u!==null&&r.set(s.key,u),a.isValidDocument()||a.convertToNoDocument(ue.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),pe())}isEqual(e){return this.batchId===e.batchId&&ri(this.mutations,e.mutations,(n,r)=>lm(n,r))&&ri(this.baseMutations,e.baseMutations,(n,r)=>lm(n,r))}}class Eh{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){Ie(e.mutations.length===r.length);let s=function(){return jS}();const i=e.mutations;for(let a=0;a<i.length;a++)s=s.insert(i[a].key,r[a].version);return new Eh(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QS{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KS{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Xe,ge;function YS(t){switch(t){default:return ae();case z.CANCELLED:case z.UNKNOWN:case z.DEADLINE_EXCEEDED:case z.RESOURCE_EXHAUSTED:case z.INTERNAL:case z.UNAVAILABLE:case z.UNAUTHENTICATED:return!1;case z.INVALID_ARGUMENT:case z.NOT_FOUND:case z.ALREADY_EXISTS:case z.PERMISSION_DENIED:case z.FAILED_PRECONDITION:case z.ABORTED:case z.OUT_OF_RANGE:case z.UNIMPLEMENTED:case z.DATA_LOSS:return!0}}function O0(t){if(t===void 0)return sr("GRPC error has no .code"),z.UNKNOWN;switch(t){case Xe.OK:return z.OK;case Xe.CANCELLED:return z.CANCELLED;case Xe.UNKNOWN:return z.UNKNOWN;case Xe.DEADLINE_EXCEEDED:return z.DEADLINE_EXCEEDED;case Xe.RESOURCE_EXHAUSTED:return z.RESOURCE_EXHAUSTED;case Xe.INTERNAL:return z.INTERNAL;case Xe.UNAVAILABLE:return z.UNAVAILABLE;case Xe.UNAUTHENTICATED:return z.UNAUTHENTICATED;case Xe.INVALID_ARGUMENT:return z.INVALID_ARGUMENT;case Xe.NOT_FOUND:return z.NOT_FOUND;case Xe.ALREADY_EXISTS:return z.ALREADY_EXISTS;case Xe.PERMISSION_DENIED:return z.PERMISSION_DENIED;case Xe.FAILED_PRECONDITION:return z.FAILED_PRECONDITION;case Xe.ABORTED:return z.ABORTED;case Xe.OUT_OF_RANGE:return z.OUT_OF_RANGE;case Xe.UNIMPLEMENTED:return z.UNIMPLEMENTED;case Xe.DATA_LOSS:return z.DATA_LOSS;default:return ae()}}(ge=Xe||(Xe={}))[ge.OK=0]="OK",ge[ge.CANCELLED=1]="CANCELLED",ge[ge.UNKNOWN=2]="UNKNOWN",ge[ge.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ge[ge.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ge[ge.NOT_FOUND=5]="NOT_FOUND",ge[ge.ALREADY_EXISTS=6]="ALREADY_EXISTS",ge[ge.PERMISSION_DENIED=7]="PERMISSION_DENIED",ge[ge.UNAUTHENTICATED=16]="UNAUTHENTICATED",ge[ge.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ge[ge.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ge[ge.ABORTED=10]="ABORTED",ge[ge.OUT_OF_RANGE=11]="OUT_OF_RANGE",ge[ge.UNIMPLEMENTED=12]="UNIMPLEMENTED",ge[ge.INTERNAL=13]="INTERNAL",ge[ge.UNAVAILABLE=14]="UNAVAILABLE",ge[ge.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XS(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JS=new ss([4294967295,4294967295],0);function dm(t){const e=XS().encode(t),n=new u0;return n.update(e),new Uint8Array(n.digest())}function hm(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new ss([n,r],0),new ss([s,i],0)]}class Th{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Wi(`Invalid padding: ${n}`);if(r<0)throw new Wi(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Wi(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new Wi(`Invalid padding when bitmap length is 0: ${n}`);this.Ie=8*e.length-n,this.Te=ss.fromNumber(this.Ie)}Ee(e,n,r){let s=e.add(n.multiply(ss.fromNumber(r)));return s.compare(JS)===1&&(s=new ss([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const n=dm(e),[r,s]=hm(n);for(let i=0;i<this.hashCount;i++){const a=this.Ee(r,s,i);if(!this.de(a))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),a=new Th(i,s,n);return r.forEach(l=>a.insert(l)),a}insert(e){if(this.Ie===0)return;const n=dm(e),[r,s]=hm(n);for(let i=0;i<this.hashCount;i++){const a=this.Ee(r,s,i);this.Ae(a)}}Ae(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class Wi extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yl{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,$o.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new Yl(ue.min(),s,new Ue(we),ir(),pe())}}class $o{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new $o(r,n,pe(),pe(),pe())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ha{constructor(e,n,r,s){this.Re=e,this.removedTargetIds=n,this.key=r,this.Ve=s}}class F0{constructor(e,n){this.targetId=e,this.me=n}}class z0{constructor(e,n,r=_t.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class fm{constructor(){this.fe=0,this.ge=mm(),this.pe=_t.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=pe(),n=pe(),r=pe();return this.ge.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:ae()}}),new $o(this.pe,this.ye,e,n,r)}Ce(){this.we=!1,this.ge=mm()}Fe(e,n){this.we=!0,this.ge=this.ge.insert(e,n)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Ie(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class ZS{constructor(e){this.Le=e,this.Be=new Map,this.ke=ir(),this.qe=pm(),this.Qe=new Ue(we)}Ke(e){for(const n of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(n,e.Ve):this.Ue(n,e.key,e.Ve);for(const n of e.removedTargetIds)this.Ue(n,e.key,e.Ve)}We(e){this.forEachTarget(e,n=>{const r=this.Ge(n);switch(e.state){case 0:this.ze(n)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(n);break;case 3:this.ze(n)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(n)&&(this.je(n),r.De(e.resumeToken));break;default:ae()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Be.forEach((r,s)=>{this.ze(s)&&n(s)})}He(e){const n=e.targetId,r=e.me.count,s=this.Je(n);if(s){const i=s.target;if(td(i))if(r===0){const a=new ie(i.path);this.Ue(n,a,Ct.newNoDocument(a,ue.min()))}else Ie(r===1);else{const a=this.Ye(n);if(a!==r){const l=this.Ze(e),u=l?this.Xe(l,e,a):1;if(u!==0){this.je(n);const h=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(n,h)}}}}}Ze(e){const n=e.me.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=n;let a,l;try{a=ds(r).toUint8Array()}catch(u){if(u instanceof y0)return Ao("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{l=new Th(a,s,i)}catch(u){return Ao(u instanceof Wi?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return l.Ie===0?null:l}Xe(e,n,r){return n.me.count===r-this.nt(e,n.targetId)?0:2}nt(e,n){const r=this.Le.getRemoteKeysForTarget(n);let s=0;return r.forEach(i=>{const a=this.Le.tt(),l=`projects/${a.projectId}/databases/${a.database}/documents/${i.path.canonicalString()}`;e.mightContain(l)||(this.Ue(n,i,null),s++)}),s}rt(e){const n=new Map;this.Be.forEach((i,a)=>{const l=this.Je(a);if(l){if(i.current&&td(l.target)){const u=new ie(l.target.path);this.ke.get(u)!==null||this.it(a,u)||this.Ue(a,u,Ct.newNoDocument(u,e))}i.be&&(n.set(a,i.ve()),i.Ce())}});let r=pe();this.qe.forEach((i,a)=>{let l=!0;a.forEachWhile(u=>{const h=this.Je(u);return!h||h.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(r=r.add(i))}),this.ke.forEach((i,a)=>a.setReadTime(e));const s=new Yl(e,n,this.Qe,this.ke,r);return this.ke=ir(),this.qe=pm(),this.Qe=new Ue(we),s}$e(e,n){if(!this.ze(e))return;const r=this.it(e,n.key)?2:0;this.Ge(e).Fe(n.key,r),this.ke=this.ke.insert(n.key,n),this.qe=this.qe.insert(n.key,this.st(n.key).add(e))}Ue(e,n,r){if(!this.ze(e))return;const s=this.Ge(e);this.it(e,n)?s.Fe(n,1):s.Me(n),this.qe=this.qe.insert(n,this.st(n).delete(e)),r&&(this.ke=this.ke.insert(n,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const n=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let n=this.Be.get(e);return n||(n=new fm,this.Be.set(e,n)),n}st(e){let n=this.qe.get(e);return n||(n=new yt(we),this.qe=this.qe.insert(e,n)),n}ze(e){const n=this.Je(e)!==null;return n||ne("WatchChangeAggregator","Detected inactive target",e),n}Je(e){const n=this.Be.get(e);return n&&n.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new fm),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.Ue(e,n,null)})}it(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}}function pm(){return new Ue(ie.comparator)}function mm(){return new Ue(ie.comparator)}const eE={asc:"ASCENDING",desc:"DESCENDING"},tE={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},nE={and:"AND",or:"OR"};class rE{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function sd(t,e){return t.useProto3Json||Hl(e)?e:{value:e}}function Tl(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function B0(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function sE(t,e){return Tl(t,e.toTimestamp())}function Mn(t){return Ie(!!t),ue.fromTimestamp(function(n){const r=Lr(n);return new at(r.seconds,r.nanos)}(t))}function Ih(t,e){return id(t,e).canonicalString()}function id(t,e){const n=function(s){return new je(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?n:n.child(e)}function U0(t){const e=je.fromString(t);return Ie(G0(e)),e}function od(t,e){return Ih(t.databaseId,e.path)}function Ku(t,e){const n=U0(e);if(n.get(1)!==t.databaseId.projectId)throw new J(z.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new J(z.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new ie(W0(n))}function $0(t,e){return Ih(t.databaseId,e)}function iE(t){const e=U0(t);return e.length===4?je.emptyPath():W0(e)}function ad(t){return new je(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function W0(t){return Ie(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function gm(t,e,n){return{name:od(t,e),fields:n.value.mapValue.fields}}function oE(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:ae()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(h,p){return h.useProto3Json?(Ie(p===void 0||typeof p=="string"),_t.fromBase64String(p||"")):(Ie(p===void 0||p instanceof Buffer||p instanceof Uint8Array),_t.fromUint8Array(p||new Uint8Array))}(t,e.targetChange.resumeToken),a=e.targetChange.cause,l=a&&function(h){const p=h.code===void 0?z.UNKNOWN:O0(h.code);return new J(p,h.message||"")}(a);n=new z0(r,s,i,l||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=Ku(t,r.document.name),i=Mn(r.document.updateTime),a=r.document.createTime?Mn(r.document.createTime):ue.min(),l=new Bt({mapValue:{fields:r.document.fields}}),u=Ct.newFoundDocument(s,i,a,l),h=r.targetIds||[],p=r.removedTargetIds||[];n=new Ha(h,p,u.key,u)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=Ku(t,r.document),i=r.readTime?Mn(r.readTime):ue.min(),a=Ct.newNoDocument(s,i),l=r.removedTargetIds||[];n=new Ha([],l,a.key,a)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=Ku(t,r.document),i=r.removedTargetIds||[];n=new Ha([],i,s,null)}else{if(!("filter"in e))return ae();{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,a=new KS(s,i),l=r.targetId;n=new F0(l,a)}}return n}function aE(t,e){let n;if(e instanceof Uo)n={update:gm(t,e.key,e.value)};else if(e instanceof Sh)n={delete:od(t,e.key)};else if(e instanceof Ur)n={update:gm(t,e.key,e.data),updateMask:gE(e.fieldMask)};else{if(!(e instanceof qS))return ae();n={verify:od(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(i,a){const l=a.transform;if(l instanceof bo)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof Do)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof No)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof El)return{fieldPath:a.field.canonicalString(),increment:l.Pe};throw ae()}(0,r))),e.precondition.isNone||(n.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:sE(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:ae()}(t,e.precondition)),n}function lE(t,e){return t&&t.length>0?(Ie(e!==void 0),t.map(n=>function(s,i){let a=s.updateTime?Mn(s.updateTime):Mn(i);return a.isEqual(ue.min())&&(a=Mn(i)),new $S(a,s.transformResults||[])}(n,e))):[]}function uE(t,e){return{documents:[$0(t,e.path)]}}function cE(t,e){const n={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=$0(t,s);const i=function(h){if(h.length!==0)return q0(Cn.create(h,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const a=function(h){if(h.length!==0)return h.map(p=>function(m){return{field:ks(m.field),direction:fE(m.dir)}}(p))}(e.orderBy);a&&(n.structuredQuery.orderBy=a);const l=sd(t,e.limit);return l!==null&&(n.structuredQuery.limit=l),e.startAt&&(n.structuredQuery.startAt=function(h){return{before:h.inclusive,values:h.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(h){return{before:!h.inclusive,values:h.position}}(e.endAt)),{_t:n,parent:s}}function dE(t){let e=iE(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){Ie(r===1);const p=n.from[0];p.allDescendants?s=p.collectionId:e=e.child(p.collectionId)}let i=[];n.where&&(i=function(y){const m=H0(y);return m instanceof Cn&&w0(m)?m.getFilters():[m]}(n.where));let a=[];n.orderBy&&(a=function(y){return y.map(m=>function(R){return new Sl(Rs(R.field),function(O){switch(O){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(R.direction))}(m))}(n.orderBy));let l=null;n.limit&&(l=function(y){let m;return m=typeof y=="object"?y.value:y,Hl(m)?null:m}(n.limit));let u=null;n.startAt&&(u=function(y){const m=!!y.before,C=y.values||[];return new wl(C,m)}(n.startAt));let h=null;return n.endAt&&(h=function(y){const m=!y.before,C=y.values||[];return new wl(C,m)}(n.endAt)),RS(e,s,a,i,l,"F",u,h)}function hE(t,e){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ae()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function H0(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=Rs(n.unaryFilter.field);return Ze.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=Rs(n.unaryFilter.field);return Ze.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Rs(n.unaryFilter.field);return Ze.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=Rs(n.unaryFilter.field);return Ze.create(a,"!=",{nullValue:"NULL_VALUE"});default:return ae()}}(t):t.fieldFilter!==void 0?function(n){return Ze.create(Rs(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return ae()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return Cn.create(n.compositeFilter.filters.map(r=>H0(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return ae()}}(n.compositeFilter.op))}(t):ae()}function fE(t){return eE[t]}function pE(t){return tE[t]}function mE(t){return nE[t]}function ks(t){return{fieldPath:t.canonicalString()}}function Rs(t){return mt.fromServerFormat(t.fieldPath)}function q0(t){return t instanceof Ze?function(n){if(n.op==="=="){if(nm(n.value))return{unaryFilter:{field:ks(n.field),op:"IS_NAN"}};if(tm(n.value))return{unaryFilter:{field:ks(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(nm(n.value))return{unaryFilter:{field:ks(n.field),op:"IS_NOT_NAN"}};if(tm(n.value))return{unaryFilter:{field:ks(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ks(n.field),op:pE(n.op),value:n.value}}}(t):t instanceof Cn?function(n){const r=n.getFilters().map(s=>q0(s));return r.length===1?r[0]:{compositeFilter:{op:mE(n.op),filters:r}}}(t):ae()}function gE(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function G0(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wr{constructor(e,n,r,s,i=ue.min(),a=ue.min(),l=_t.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=l,this.expectedCount=u}withSequenceNumber(e){return new wr(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new wr(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new wr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new wr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yE{constructor(e){this.ct=e}}function vE(t){const e=dE({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?rd(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _E{constructor(){this.un=new xE}addToCollectionParentIndex(e,n){return this.un.add(n),$.resolve()}getCollectionParents(e,n){return $.resolve(this.un.getEntries(n))}addFieldIndex(e,n){return $.resolve()}deleteFieldIndex(e,n){return $.resolve()}deleteAllFieldIndexes(e){return $.resolve()}createTargetIndexes(e,n){return $.resolve()}getDocumentsMatchingTarget(e,n){return $.resolve(null)}getIndexType(e,n){return $.resolve(0)}getFieldIndexes(e,n){return $.resolve([])}getNextCollectionGroupToUpdate(e){return $.resolve(null)}getMinOffset(e,n){return $.resolve(Mr.min())}getMinOffsetFromCollectionGroup(e,n){return $.resolve(Mr.min())}updateCollectionGroup(e,n,r){return $.resolve()}updateIndexEntries(e,n){return $.resolve()}}class xE{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new yt(je.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new yt(je.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oi{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new oi(0)}static kn(){return new oi(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wE{constructor(){this.changes=new pi(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Ct.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?$.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SE{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EE{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&io(r.mutation,s,tn.empty(),at.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,pe()).next(()=>r))}getLocalViewOfDocuments(e,n,r=pe()){const s=ts();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let a=$i();return i.forEach((l,u)=>{a=a.insert(l,u.overlayedDocument)}),a}))}getOverlayedDocuments(e,n){const r=ts();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,pe()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((a,l)=>{n.set(a,l)})})}computeViews(e,n,r,s){let i=ir();const a=so(),l=function(){return so()}();return n.forEach((u,h)=>{const p=r.get(h.key);s.has(h.key)&&(p===void 0||p.mutation instanceof Ur)?i=i.insert(h.key,h):p!==void 0?(a.set(h.key,p.mutation.getFieldMask()),io(p.mutation,h,p.mutation.getFieldMask(),at.now())):a.set(h.key,tn.empty())}),this.recalculateAndSaveOverlays(e,i).next(u=>(u.forEach((h,p)=>a.set(h,p)),n.forEach((h,p)=>{var y;return l.set(h,new SE(p,(y=a.get(h))!==null&&y!==void 0?y:null))}),l))}recalculateAndSaveOverlays(e,n){const r=so();let s=new Ue((a,l)=>a-l),i=pe();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(a=>{for(const l of a)l.keys().forEach(u=>{const h=n.get(u);if(h===null)return;let p=r.get(u)||tn.empty();p=l.applyToLocalView(h,p),r.set(u,p);const y=(s.get(l.batchId)||pe()).add(u);s=s.insert(l.batchId,y)})}).next(()=>{const a=[],l=s.getReverseIterator();for(;l.hasNext();){const u=l.getNext(),h=u.key,p=u.value,y=P0();p.forEach(m=>{if(!i.has(m)){const C=M0(n.get(m),r.get(m));C!==null&&y.set(m,C),i=i.add(m)}}),a.push(this.documentOverlayCache.saveOverlays(e,h,y))}return $.waitFor(a)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,s){return function(a){return ie.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):I0(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,s):this.getDocumentsMatchingCollectionQuery(e,n,r,s)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const a=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):$.resolve(ts());let l=-1,u=i;return a.next(h=>$.forEach(h,(p,y)=>(l<y.largestBatchId&&(l=y.largestBatchId),i.get(p)?$.resolve():this.remoteDocumentCache.getEntry(e,p).next(m=>{u=u.insert(p,m)}))).next(()=>this.populateOverlays(e,h,i)).next(()=>this.computeViews(e,u,h,pe())).next(p=>({batchId:l,changes:R0(p)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new ie(n)).next(r=>{let s=$i();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r,s){const i=n.collectionGroup;let a=$i();return this.indexManager.getCollectionParents(e,i).next(l=>$.forEach(l,u=>{const h=function(y,m){return new Bo(m,null,y.explicitOrderBy.slice(),y.filters.slice(),y.limit,y.limitType,y.startAt,y.endAt)}(n,u.child(i));return this.getDocumentsMatchingCollectionQuery(e,h,r,s).next(p=>{p.forEach((y,m)=>{a=a.insert(y,m)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,n,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(a=>(i=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,i,s))).next(a=>{i.forEach((u,h)=>{const p=h.getKey();a.get(p)===null&&(a=a.insert(p,Ct.newInvalidDocument(p)))});let l=$i();return a.forEach((u,h)=>{const p=i.get(u);p!==void 0&&io(p.mutation,h,tn.empty(),at.now()),Gl(n,h)&&(l=l.insert(u,h))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TE{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,n){return $.resolve(this.hr.get(n))}saveBundleMetadata(e,n){return this.hr.set(n.id,function(s){return{id:s.id,version:s.version,createTime:Mn(s.createTime)}}(n)),$.resolve()}getNamedQuery(e,n){return $.resolve(this.Pr.get(n))}saveNamedQuery(e,n){return this.Pr.set(n.name,function(s){return{name:s.name,query:vE(s.bundledQuery),readTime:Mn(s.readTime)}}(n)),$.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IE{constructor(){this.overlays=new Ue(ie.comparator),this.Ir=new Map}getOverlay(e,n){return $.resolve(this.overlays.get(n))}getOverlays(e,n){const r=ts();return $.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.ht(e,n,i)}),$.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.Ir.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.Ir.delete(r)),$.resolve()}getOverlaysForCollection(e,n,r){const s=ts(),i=n.length+1,a=new ie(n.child("")),l=this.overlays.getIteratorFrom(a);for(;l.hasNext();){const u=l.getNext().value,h=u.getKey();if(!n.isPrefixOf(h.path))break;h.path.length===i&&u.largestBatchId>r&&s.set(u.getKey(),u)}return $.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new Ue((h,p)=>h-p);const a=this.overlays.getIterator();for(;a.hasNext();){const h=a.getNext().value;if(h.getKey().getCollectionGroup()===n&&h.largestBatchId>r){let p=i.get(h.largestBatchId);p===null&&(p=ts(),i=i.insert(h.largestBatchId,p)),p.set(h.getKey(),h)}}const l=ts(),u=i.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((h,p)=>l.set(h,p)),!(l.size()>=s)););return $.resolve(l)}ht(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const a=this.Ir.get(s.largestBatchId).delete(r.key);this.Ir.set(s.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new QS(n,r));let i=this.Ir.get(n);i===void 0&&(i=pe(),this.Ir.set(n,i)),this.Ir.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AE{constructor(){this.sessionToken=_t.EMPTY_BYTE_STRING}getSessionToken(e){return $.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,$.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ah{constructor(){this.Tr=new yt(ut.Er),this.dr=new yt(ut.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,n){const r=new ut(e,n);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Vr(new ut(e,n))}mr(e,n){e.forEach(r=>this.removeReference(r,n))}gr(e){const n=new ie(new je([])),r=new ut(n,e),s=new ut(n,e+1),i=[];return this.dr.forEachInRange([r,s],a=>{this.Vr(a),i.push(a.key)}),i}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const n=new ie(new je([])),r=new ut(n,e),s=new ut(n,e+1);let i=pe();return this.dr.forEachInRange([r,s],a=>{i=i.add(a.key)}),i}containsKey(e){const n=new ut(e,0),r=this.Tr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class ut{constructor(e,n){this.key=e,this.wr=n}static Er(e,n){return ie.comparator(e.key,n.key)||we(e.wr,n.wr)}static Ar(e,n){return we(e.wr,n.wr)||ie.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CE{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Sr=1,this.br=new yt(ut.Er)}checkEmpty(e){return $.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new GS(i,n,r,s);this.mutationQueue.push(a);for(const l of s)this.br=this.br.add(new ut(l.key,i)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return $.resolve(a)}lookupMutationBatch(e,n){return $.resolve(this.Dr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.vr(r),i=s<0?0:s;return $.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return $.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return $.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new ut(n,0),s=new ut(n,Number.POSITIVE_INFINITY),i=[];return this.br.forEachInRange([r,s],a=>{const l=this.Dr(a.wr);i.push(l)}),$.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new yt(we);return n.forEach(s=>{const i=new ut(s,0),a=new ut(s,Number.POSITIVE_INFINITY);this.br.forEachInRange([i,a],l=>{r=r.add(l.wr)})}),$.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;ie.isDocumentKey(i)||(i=i.child(""));const a=new ut(new ie(i),0);let l=new yt(we);return this.br.forEachWhile(u=>{const h=u.key.path;return!!r.isPrefixOf(h)&&(h.length===s&&(l=l.add(u.wr)),!0)},a),$.resolve(this.Cr(l))}Cr(e){const n=[];return e.forEach(r=>{const s=this.Dr(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){Ie(this.Fr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return $.forEach(n.mutations,s=>{const i=new ut(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,n){const r=new ut(n,0),s=this.br.firstAfterOrEqual(r);return $.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,$.resolve()}Fr(e,n){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const n=this.vr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kE{constructor(e){this.Mr=e,this.docs=function(){return new Ue(ie.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,a=this.Mr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:a}),this.size+=a-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return $.resolve(r?r.document.mutableCopy():Ct.newInvalidDocument(n))}getEntries(e,n){let r=ir();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():Ct.newInvalidDocument(s))}),$.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let i=ir();const a=n.path,l=new ie(a.child("")),u=this.docs.getIteratorFrom(l);for(;u.hasNext();){const{key:h,value:{document:p}}=u.getNext();if(!a.isPrefixOf(h.path))break;h.path.length>a.length+1||cS(uS(p),r)<=0||(s.has(p.key)||Gl(n,p))&&(i=i.insert(p.key,p.mutableCopy()))}return $.resolve(i)}getAllFromCollectionGroup(e,n,r,s){ae()}Or(e,n){return $.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new RE(this)}getSize(e){return $.resolve(this.size)}}class RE extends wE{constructor(e){super(),this.cr=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.cr.addEntry(e,s)):this.cr.removeEntry(r)}),$.waitFor(n)}getFromCache(e,n){return this.cr.getEntry(e,n)}getAllFromCache(e,n){return this.cr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PE{constructor(e){this.persistence=e,this.Nr=new pi(n=>vh(n),_h),this.lastRemoteSnapshotVersion=ue.min(),this.highestTargetId=0,this.Lr=0,this.Br=new Ah,this.targetCount=0,this.kr=oi.Bn()}forEachTarget(e,n){return this.Nr.forEach((r,s)=>n(s)),$.resolve()}getLastRemoteSnapshotVersion(e){return $.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return $.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),$.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Lr&&(this.Lr=n),$.resolve()}Kn(e){this.Nr.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.kr=new oi(n),this.highestTargetId=n),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,n){return this.Kn(n),this.targetCount+=1,$.resolve()}updateTargetData(e,n){return this.Kn(n),$.resolve()}removeTargetData(e,n){return this.Nr.delete(n.target),this.Br.gr(n.targetId),this.targetCount-=1,$.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.Nr.forEach((a,l)=>{l.sequenceNumber<=n&&r.get(l.targetId)===null&&(this.Nr.delete(a),i.push(this.removeMatchingKeysForTargetId(e,l.targetId)),s++)}),$.waitFor(i).next(()=>s)}getTargetCount(e){return $.resolve(this.targetCount)}getTargetData(e,n){const r=this.Nr.get(n)||null;return $.resolve(r)}addMatchingKeys(e,n,r){return this.Br.Rr(n,r),$.resolve()}removeMatchingKeys(e,n,r){this.Br.mr(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(a=>{i.push(s.markPotentiallyOrphaned(e,a))}),$.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this.Br.gr(n),$.resolve()}getMatchingKeysForTargetId(e,n){const r=this.Br.yr(n);return $.resolve(r)}containsKey(e,n){return $.resolve(this.Br.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bE{constructor(e,n){this.qr={},this.overlays={},this.Qr=new ph(0),this.Kr=!1,this.Kr=!0,this.$r=new AE,this.referenceDelegate=e(this),this.Ur=new PE(this),this.indexManager=new _E,this.remoteDocumentCache=function(s){return new kE(s)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new yE(n),this.Gr=new TE(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new IE,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.qr[e.toKey()];return r||(r=new CE(n,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,n,r){ne("MemoryPersistence","Starting transaction:",e);const s=new DE(this.Qr.next());return this.referenceDelegate.zr(),r(s).next(i=>this.referenceDelegate.jr(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Hr(e,n){return $.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,n)))}}class DE extends hS{constructor(e){super(),this.currentSequenceNumber=e}}class Ch{constructor(e){this.persistence=e,this.Jr=new Ah,this.Yr=null}static Zr(e){return new Ch(e)}get Xr(){if(this.Yr)return this.Yr;throw ae()}addReference(e,n,r){return this.Jr.addReference(r,n),this.Xr.delete(r.toString()),$.resolve()}removeReference(e,n,r){return this.Jr.removeReference(r,n),this.Xr.add(r.toString()),$.resolve()}markPotentiallyOrphaned(e,n){return this.Xr.add(n.toString()),$.resolve()}removeTarget(e,n){this.Jr.gr(n.targetId).forEach(s=>this.Xr.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.Xr.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}zr(){this.Yr=new Set}jr(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return $.forEach(this.Xr,r=>{const s=ie.fromPath(r);return this.ei(e,s).next(i=>{i||n.removeEntry(s,ue.min())})}).next(()=>(this.Yr=null,n.apply(e)))}updateLimboDocument(e,n){return this.ei(e,n).next(r=>{r?this.Xr.delete(n.toString()):this.Xr.add(n.toString())})}Wr(e){return 0}ei(e,n){return $.or([()=>$.resolve(this.Jr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Hr(e,n)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kh{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.$i=r,this.Ui=s}static Wi(e,n){let r=pe(),s=pe();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new kh(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NE{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jE{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return M1()?8:fS(j1())>0?6:4}()}initialize(e,n){this.Ji=e,this.indexManager=n,this.Gi=!0}getDocumentsMatchingQuery(e,n,r,s){const i={result:null};return this.Yi(e,n).next(a=>{i.result=a}).next(()=>{if(!i.result)return this.Zi(e,n,s,r).next(a=>{i.result=a})}).next(()=>{if(i.result)return;const a=new NE;return this.Xi(e,n,a).next(l=>{if(i.result=l,this.zi)return this.es(e,n,a,l.size)})}).next(()=>i.result)}es(e,n,r,s){return r.documentReadCount<this.ji?(Li()<=ye.DEBUG&&ne("QueryEngine","SDK will not create cache indexes for query:",Cs(n),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),$.resolve()):(Li()<=ye.DEBUG&&ne("QueryEngine","Query:",Cs(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.Hi*s?(Li()<=ye.DEBUG&&ne("QueryEngine","The SDK decides to create cache indexes for query:",Cs(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Vn(n))):$.resolve())}Yi(e,n){if(om(n))return $.resolve(null);let r=Vn(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=rd(n,null,"F"),r=Vn(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const a=pe(...i);return this.Ji.getDocuments(e,a).next(l=>this.indexManager.getMinOffset(e,r).next(u=>{const h=this.ts(n,l);return this.ns(n,h,a,u.readTime)?this.Yi(e,rd(n,null,"F")):this.rs(e,h,n,u)}))})))}Zi(e,n,r,s){return om(n)||s.isEqual(ue.min())?$.resolve(null):this.Ji.getDocuments(e,r).next(i=>{const a=this.ts(n,i);return this.ns(n,a,r,s)?$.resolve(null):(Li()<=ye.DEBUG&&ne("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Cs(n)),this.rs(e,a,n,lS(s,-1)).next(l=>l))})}ts(e,n){let r=new yt(C0(e));return n.forEach((s,i)=>{Gl(e,i)&&(r=r.add(i))}),r}ns(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Xi(e,n,r){return Li()<=ye.DEBUG&&ne("QueryEngine","Using full collection scan to execute query:",Cs(n)),this.Ji.getDocumentsMatchingQuery(e,n,Mr.min(),r)}rs(e,n,r,s){return this.Ji.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(a=>{i=i.insert(a.key,a)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VE{constructor(e,n,r,s){this.persistence=e,this.ss=n,this.serializer=s,this.os=new Ue(we),this._s=new pi(i=>vh(i),_h),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new EE(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.os))}}function ME(t,e,n,r){return new VE(t,e,n,r)}async function Q0(t,e){const n=ce(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.ls(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const a=[],l=[];let u=pe();for(const h of s){a.push(h.batchId);for(const p of h.mutations)u=u.add(p.key)}for(const h of i){l.push(h.batchId);for(const p of h.mutations)u=u.add(p.key)}return n.localDocuments.getDocuments(r,u).next(h=>({hs:h,removedBatchIds:a,addedBatchIds:l}))})})}function LE(t,e){const n=ce(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.cs.newChangeBuffer({trackRemovals:!0});return function(l,u,h,p){const y=h.batch,m=y.keys();let C=$.resolve();return m.forEach(R=>{C=C.next(()=>p.getEntry(u,R)).next(P=>{const O=h.docVersions.get(R);Ie(O!==null),P.version.compareTo(O)<0&&(y.applyToRemoteDocument(P,h),P.isValidDocument()&&(P.setReadTime(h.commitVersion),p.addEntry(P)))})}),C.next(()=>l.mutationQueue.removeMutationBatch(u,y))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(l){let u=pe();for(let h=0;h<l.mutationResults.length;++h)l.mutationResults[h].transformResults.length>0&&(u=u.add(l.batch.mutations[h].key));return u}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function K0(t){const e=ce(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Ur.getLastRemoteSnapshotVersion(n))}function OE(t,e){const n=ce(t),r=e.snapshotVersion;let s=n.os;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const a=n.cs.newChangeBuffer({trackRemovals:!0});s=n.os;const l=[];e.targetChanges.forEach((p,y)=>{const m=s.get(y);if(!m)return;l.push(n.Ur.removeMatchingKeys(i,p.removedDocuments,y).next(()=>n.Ur.addMatchingKeys(i,p.addedDocuments,y)));let C=m.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(y)!==null?C=C.withResumeToken(_t.EMPTY_BYTE_STRING,ue.min()).withLastLimboFreeSnapshotVersion(ue.min()):p.resumeToken.approximateByteSize()>0&&(C=C.withResumeToken(p.resumeToken,r)),s=s.insert(y,C),function(P,O,k){return P.resumeToken.approximateByteSize()===0||O.snapshotVersion.toMicroseconds()-P.snapshotVersion.toMicroseconds()>=3e8?!0:k.addedDocuments.size+k.modifiedDocuments.size+k.removedDocuments.size>0}(m,C,p)&&l.push(n.Ur.updateTargetData(i,C))});let u=ir(),h=pe();if(e.documentUpdates.forEach(p=>{e.resolvedLimboDocuments.has(p)&&l.push(n.persistence.referenceDelegate.updateLimboDocument(i,p))}),l.push(FE(i,a,e.documentUpdates).next(p=>{u=p.Ps,h=p.Is})),!r.isEqual(ue.min())){const p=n.Ur.getLastRemoteSnapshotVersion(i).next(y=>n.Ur.setTargetsMetadata(i,i.currentSequenceNumber,r));l.push(p)}return $.waitFor(l).next(()=>a.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,u,h)).next(()=>u)}).then(i=>(n.os=s,i))}function FE(t,e,n){let r=pe(),s=pe();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let a=ir();return n.forEach((l,u)=>{const h=i.get(l);u.isFoundDocument()!==h.isFoundDocument()&&(s=s.add(l)),u.isNoDocument()&&u.version.isEqual(ue.min())?(e.removeEntry(l,u.readTime),a=a.insert(l,u)):!h.isValidDocument()||u.version.compareTo(h.version)>0||u.version.compareTo(h.version)===0&&h.hasPendingWrites?(e.addEntry(u),a=a.insert(l,u)):ne("LocalStore","Ignoring outdated watch update for ",l,". Current version:",h.version," Watch version:",u.version)}),{Ps:a,Is:s}})}function zE(t,e){const n=ce(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function BE(t,e){const n=ce(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.Ur.getTargetData(r,e).next(i=>i?(s=i,$.resolve(s)):n.Ur.allocateTargetId(r).next(a=>(s=new wr(e,a,"TargetPurposeListen",r.currentSequenceNumber),n.Ur.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.os.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.os=n.os.insert(r.targetId,r),n._s.set(e,r.targetId)),r})}async function ld(t,e,n){const r=ce(t),s=r.os.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,a=>r.persistence.referenceDelegate.removeTarget(a,s))}catch(a){if(!zo(a))throw a;ne("LocalStore",`Failed to update sequence numbers for target ${e}: ${a}`)}r.os=r.os.remove(e),r._s.delete(s.target)}function ym(t,e,n){const r=ce(t);let s=ue.min(),i=pe();return r.persistence.runTransaction("Execute query","readwrite",a=>function(u,h,p){const y=ce(u),m=y._s.get(p);return m!==void 0?$.resolve(y.os.get(m)):y.Ur.getTargetData(h,p)}(r,a,Vn(e)).next(l=>{if(l)return s=l.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(a,l.targetId).next(u=>{i=u})}).next(()=>r.ss.getDocumentsMatchingQuery(a,e,n?s:ue.min(),n?i:pe())).next(l=>(UE(r,bS(e),l),{documents:l,Ts:i})))}function UE(t,e,n){let r=t.us.get(e)||ue.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.us.set(e,r)}class vm{constructor(){this.activeTargetIds=LS()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class $E{constructor(){this.so=new vm,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,n,r){this.oo[e]=n}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new vm,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WE{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _m{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){ne("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){ne("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ra=null;function Yu(){return Ra===null?Ra=function(){return 268435456+Math.round(2147483648*Math.random())}():Ra++,"0x"+Ra.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HE={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qE{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const It="WebChannelConnection";class GE extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const r=n.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+n.host,this.vo=`projects/${s}/databases/${i}`,this.Co=this.databaseId.database==="(default)"?`project_id=${s}`:`project_id=${s}&database_id=${i}`}get Fo(){return!1}Mo(n,r,s,i,a){const l=Yu(),u=this.xo(n,r.toUriEncodedString());ne("RestConnection",`Sending RPC '${n}' ${l}:`,u,s);const h={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(h,i,a),this.No(n,u,h,s).then(p=>(ne("RestConnection",`Received RPC '${n}' ${l}: `,p),p),p=>{throw Ao("RestConnection",`RPC '${n}' ${l} failed with error: `,p,"url: ",u,"request:",s),p})}Lo(n,r,s,i,a,l){return this.Mo(n,r,s,i,a)}Oo(n,r,s){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+fi}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((i,a)=>n[a]=i),s&&s.headers.forEach((i,a)=>n[a]=i)}xo(n,r){const s=HE[n];return`${this.Do}/v1/${r}:${s}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,n,r,s){const i=Yu();return new Promise((a,l)=>{const u=new c0;u.setWithCredentials(!0),u.listenOnce(d0.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case Ua.NO_ERROR:const p=u.getResponseJson();ne(It,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(p)),a(p);break;case Ua.TIMEOUT:ne(It,`RPC '${e}' ${i} timed out`),l(new J(z.DEADLINE_EXCEEDED,"Request time out"));break;case Ua.HTTP_ERROR:const y=u.getStatus();if(ne(It,`RPC '${e}' ${i} failed with status:`,y,"response text:",u.getResponseText()),y>0){let m=u.getResponseJson();Array.isArray(m)&&(m=m[0]);const C=m==null?void 0:m.error;if(C&&C.status&&C.message){const R=function(O){const k=O.toLowerCase().replace(/_/g,"-");return Object.values(z).indexOf(k)>=0?k:z.UNKNOWN}(C.status);l(new J(R,C.message))}else l(new J(z.UNKNOWN,"Server responded with status "+u.getStatus()))}else l(new J(z.UNAVAILABLE,"Connection failed."));break;default:ae()}}finally{ne(It,`RPC '${e}' ${i} completed.`)}});const h=JSON.stringify(s);ne(It,`RPC '${e}' ${i} sending request:`,s),u.send(n,"POST",h,r,15)})}Bo(e,n,r){const s=Yu(),i=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=p0(),l=f0(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(u.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(u.useFetchStreams=!0),this.Oo(u.initMessageHeaders,n,r),u.encodeInitMessageHeaders=!0;const p=i.join("");ne(It,`Creating RPC '${e}' stream ${s}: ${p}`,u);const y=a.createWebChannel(p,u);let m=!1,C=!1;const R=new qE({Io:O=>{C?ne(It,`Not sending because RPC '${e}' stream ${s} is closed:`,O):(m||(ne(It,`Opening RPC '${e}' stream ${s} transport.`),y.open(),m=!0),ne(It,`RPC '${e}' stream ${s} sending:`,O),y.send(O))},To:()=>y.close()}),P=(O,k,A)=>{O.listen(k,w=>{try{A(w)}catch(b){setTimeout(()=>{throw b},0)}})};return P(y,Ui.EventType.OPEN,()=>{C||(ne(It,`RPC '${e}' stream ${s} transport opened.`),R.yo())}),P(y,Ui.EventType.CLOSE,()=>{C||(C=!0,ne(It,`RPC '${e}' stream ${s} transport closed`),R.So())}),P(y,Ui.EventType.ERROR,O=>{C||(C=!0,Ao(It,`RPC '${e}' stream ${s} transport errored:`,O),R.So(new J(z.UNAVAILABLE,"The operation could not be completed")))}),P(y,Ui.EventType.MESSAGE,O=>{var k;if(!C){const A=O.data[0];Ie(!!A);const w=A,b=w.error||((k=w[0])===null||k===void 0?void 0:k.error);if(b){ne(It,`RPC '${e}' stream ${s} received error:`,b);const j=b.status;let M=function(T){const I=Xe[T];if(I!==void 0)return O0(I)}(j),S=b.message;M===void 0&&(M=z.INTERNAL,S="Unknown error status: "+j+" with message "+b.message),C=!0,R.So(new J(M,S)),y.close()}else ne(It,`RPC '${e}' stream ${s} received:`,A),R.bo(A)}}),P(l,h0.STAT_EVENT,O=>{O.stat===Xc.PROXY?ne(It,`RPC '${e}' stream ${s} detected buffering proxy`):O.stat===Xc.NOPROXY&&ne(It,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{R.wo()},0),R}}function Xu(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xl(t){return new rE(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y0{constructor(e,n,r=1e3,s=1.5,i=6e4){this.ui=e,this.timerId=n,this.ko=r,this.qo=s,this.Qo=i,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const n=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),s=Math.max(0,n-r);s>0&&ne("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Ko} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,s,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X0{constructor(e,n,r,s,i,a,l,u){this.ui=e,this.Ho=r,this.Jo=s,this.connection=i,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=l,this.listener=u,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new Y0(e,n)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,n){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():n&&n.code===z.RESOURCE_EXHAUSTED?(sr(n.toString()),sr("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):n&&n.code===z.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(n)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),n=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.Yo===n&&this.P_(r,s)},r=>{e(()=>{const s=new J(z.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(s)})})}P_(e,n){const r=this.h_(this.Yo);this.stream=this.T_(e,n),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(s=>{r(()=>this.I_(s))}),this.stream.onMessage(s=>{r(()=>++this.e_==1?this.E_(s):this.onNext(s))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return ne("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return n=>{this.ui.enqueueAndForget(()=>this.Yo===e?n():(ne("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class QE extends X0{constructor(e,n,r,s,i,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,a),this.serializer=i}T_(e,n){return this.connection.Bo("Listen",e,n)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const n=oE(this.serializer,e),r=function(i){if(!("targetChange"in i))return ue.min();const a=i.targetChange;return a.targetIds&&a.targetIds.length?ue.min():a.readTime?Mn(a.readTime):ue.min()}(e);return this.listener.d_(n,r)}A_(e){const n={};n.database=ad(this.serializer),n.addTarget=function(i,a){let l;const u=a.target;if(l=td(u)?{documents:uE(i,u)}:{query:cE(i,u)._t},l.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){l.resumeToken=B0(i,a.resumeToken);const h=sd(i,a.expectedCount);h!==null&&(l.expectedCount=h)}else if(a.snapshotVersion.compareTo(ue.min())>0){l.readTime=Tl(i,a.snapshotVersion.toTimestamp());const h=sd(i,a.expectedCount);h!==null&&(l.expectedCount=h)}return l}(this.serializer,e);const r=hE(this.serializer,e);r&&(n.labels=r),this.a_(n)}R_(e){const n={};n.database=ad(this.serializer),n.removeTarget=e,this.a_(n)}}class KE extends X0{constructor(e,n,r,s,i,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,a),this.serializer=i}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,n){return this.connection.Bo("Write",e,n)}E_(e){return Ie(!!e.streamToken),this.lastStreamToken=e.streamToken,Ie(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){Ie(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const n=lE(e.writeResults,e.commitTime),r=Mn(e.commitTime);return this.listener.g_(r,n)}p_(){const e={};e.database=ad(this.serializer),this.a_(e)}m_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>aE(this.serializer,r))};this.a_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YE extends class{}{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.y_=!1}w_(){if(this.y_)throw new J(z.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,n,r,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,a])=>this.connection.Mo(e,id(n,r),s,i,a)).catch(i=>{throw i.name==="FirebaseError"?(i.code===z.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new J(z.UNKNOWN,i.toString())})}Lo(e,n,r,s,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,l])=>this.connection.Lo(e,id(n,r),s,a,l,i)).catch(a=>{throw a.name==="FirebaseError"?(a.code===z.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new J(z.UNKNOWN,a.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class XE{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(sr(n),this.D_=!1):ne("OnlineStateTracker",n)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JE{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=i,this.k_._o(a=>{r.enqueueAndForget(async()=>{gs(this)&&(ne("RemoteStore","Restarting streams for network reachability change."),await async function(u){const h=ce(u);h.L_.add(4),await Wo(h),h.q_.set("Unknown"),h.L_.delete(4),await Jl(h)}(this))})}),this.q_=new XE(r,s)}}async function Jl(t){if(gs(t))for(const e of t.B_)await e(!0)}async function Wo(t){for(const e of t.B_)await e(!1)}function J0(t,e){const n=ce(t);n.N_.has(e.targetId)||(n.N_.set(e.targetId,e),Dh(n)?bh(n):mi(n).r_()&&Ph(n,e))}function Rh(t,e){const n=ce(t),r=mi(n);n.N_.delete(e),r.r_()&&Z0(n,e),n.N_.size===0&&(r.r_()?r.o_():gs(n)&&n.q_.set("Unknown"))}function Ph(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ue.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}mi(t).A_(e)}function Z0(t,e){t.Q_.xe(e),mi(t).R_(e)}function bh(t){t.Q_=new ZS({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),mi(t).start(),t.q_.v_()}function Dh(t){return gs(t)&&!mi(t).n_()&&t.N_.size>0}function gs(t){return ce(t).L_.size===0}function ev(t){t.Q_=void 0}async function ZE(t){t.q_.set("Online")}async function eT(t){t.N_.forEach((e,n)=>{Ph(t,e)})}async function tT(t,e){ev(t),Dh(t)?(t.q_.M_(e),bh(t)):t.q_.set("Unknown")}async function nT(t,e,n){if(t.q_.set("Online"),e instanceof z0&&e.state===2&&e.cause)try{await async function(s,i){const a=i.cause;for(const l of i.targetIds)s.N_.has(l)&&(await s.remoteSyncer.rejectListen(l,a),s.N_.delete(l),s.Q_.removeTarget(l))}(t,e)}catch(r){ne("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Il(t,r)}else if(e instanceof Ha?t.Q_.Ke(e):e instanceof F0?t.Q_.He(e):t.Q_.We(e),!n.isEqual(ue.min()))try{const r=await K0(t.localStore);n.compareTo(r)>=0&&await function(i,a){const l=i.Q_.rt(a);return l.targetChanges.forEach((u,h)=>{if(u.resumeToken.approximateByteSize()>0){const p=i.N_.get(h);p&&i.N_.set(h,p.withResumeToken(u.resumeToken,a))}}),l.targetMismatches.forEach((u,h)=>{const p=i.N_.get(u);if(!p)return;i.N_.set(u,p.withResumeToken(_t.EMPTY_BYTE_STRING,p.snapshotVersion)),Z0(i,u);const y=new wr(p.target,u,h,p.sequenceNumber);Ph(i,y)}),i.remoteSyncer.applyRemoteEvent(l)}(t,n)}catch(r){ne("RemoteStore","Failed to raise snapshot:",r),await Il(t,r)}}async function Il(t,e,n){if(!zo(e))throw e;t.L_.add(1),await Wo(t),t.q_.set("Offline"),n||(n=()=>K0(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{ne("RemoteStore","Retrying IndexedDB access"),await n(),t.L_.delete(1),await Jl(t)})}function tv(t,e){return e().catch(n=>Il(t,n,e))}async function Zl(t){const e=ce(t),n=Or(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;rT(e);)try{const s=await zE(e.localStore,r);if(s===null){e.O_.length===0&&n.o_();break}r=s.batchId,sT(e,s)}catch(s){await Il(e,s)}nv(e)&&rv(e)}function rT(t){return gs(t)&&t.O_.length<10}function sT(t,e){t.O_.push(e);const n=Or(t);n.r_()&&n.V_&&n.m_(e.mutations)}function nv(t){return gs(t)&&!Or(t).n_()&&t.O_.length>0}function rv(t){Or(t).start()}async function iT(t){Or(t).p_()}async function oT(t){const e=Or(t);for(const n of t.O_)e.m_(n.mutations)}async function aT(t,e,n){const r=t.O_.shift(),s=Eh.from(r,e,n);await tv(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await Zl(t)}async function lT(t,e){e&&Or(t).V_&&await async function(r,s){if(function(a){return YS(a)&&a!==z.ABORTED}(s.code)){const i=r.O_.shift();Or(r).s_(),await tv(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await Zl(r)}}(t,e),nv(t)&&rv(t)}async function xm(t,e){const n=ce(t);n.asyncQueue.verifyOperationInProgress(),ne("RemoteStore","RemoteStore received new credentials");const r=gs(n);n.L_.add(3),await Wo(n),r&&n.q_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.L_.delete(3),await Jl(n)}async function uT(t,e){const n=ce(t);e?(n.L_.delete(2),await Jl(n)):e||(n.L_.add(2),await Wo(n),n.q_.set("Unknown"))}function mi(t){return t.K_||(t.K_=function(n,r,s){const i=ce(n);return i.w_(),new QE(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:ZE.bind(null,t),Ro:eT.bind(null,t),mo:tT.bind(null,t),d_:nT.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),Dh(t)?bh(t):t.q_.set("Unknown")):(await t.K_.stop(),ev(t))})),t.K_}function Or(t){return t.U_||(t.U_=function(n,r,s){const i=ce(n);return i.w_(),new KE(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:iT.bind(null,t),mo:lT.bind(null,t),f_:oT.bind(null,t),g_:aT.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await Zl(t)):(await t.U_.stop(),t.O_.length>0&&(ne("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nh{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new Xn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,s,i){const a=Date.now()+r,l=new Nh(e,n,a,s,i);return l.start(r),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new J(z.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function jh(t,e){if(sr("AsyncQueue",`${e}: ${t}`),zo(t))return new J(z.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qs{constructor(e){this.comparator=e?(n,r)=>e(n,r)||ie.comparator(n.key,r.key):(n,r)=>ie.comparator(n.key,r.key),this.keyedMap=$i(),this.sortedSet=new Ue(this.comparator)}static emptySet(e){return new Qs(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Qs)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new Qs;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wm{constructor(){this.W_=new Ue(ie.comparator)}track(e){const n=e.doc.key,r=this.W_.get(n);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(n,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(n):e.type===1&&r.type===2?this.W_=this.W_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):ae():this.W_=this.W_.insert(n,e)}G_(){const e=[];return this.W_.inorderTraversal((n,r)=>{e.push(r)}),e}}class ai{constructor(e,n,r,s,i,a,l,u,h){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=a,this.syncStateChanged=l,this.excludesMetadataChanges=u,this.hasCachedResults=h}static fromInitialDocuments(e,n,r,s,i){const a=[];return n.forEach(l=>{a.push({type:0,doc:l})}),new ai(e,n,Qs.emptySet(n),a,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&ql(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cT{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class dT{constructor(){this.queries=Sm(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(n,r){const s=ce(n),i=s.queries;s.queries=Sm(),i.forEach((a,l)=>{for(const u of l.j_)u.onError(r)})})(this,new J(z.ABORTED,"Firestore shutting down"))}}function Sm(){return new pi(t=>A0(t),ql)}async function sv(t,e){const n=ce(t);let r=3;const s=e.query;let i=n.queries.get(s);i?!i.H_()&&e.J_()&&(r=2):(i=new cT,r=e.J_()?0:1);try{switch(r){case 0:i.z_=await n.onListen(s,!0);break;case 1:i.z_=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(a){const l=jh(a,`Initialization of query '${Cs(e.query)}' failed`);return void e.onError(l)}n.queries.set(s,i),i.j_.push(e),e.Z_(n.onlineState),i.z_&&e.X_(i.z_)&&Vh(n)}async function iv(t,e){const n=ce(t),r=e.query;let s=3;const i=n.queries.get(r);if(i){const a=i.j_.indexOf(e);a>=0&&(i.j_.splice(a,1),i.j_.length===0?s=e.J_()?0:1:!i.H_()&&e.J_()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function hT(t,e){const n=ce(t);let r=!1;for(const s of e){const i=s.query,a=n.queries.get(i);if(a){for(const l of a.j_)l.X_(s)&&(r=!0);a.z_=s}}r&&Vh(n)}function fT(t,e,n){const r=ce(t),s=r.queries.get(e);if(s)for(const i of s.j_)i.onError(n);r.queries.delete(e)}function Vh(t){t.Y_.forEach(e=>{e.next()})}var ud,Em;(Em=ud||(ud={})).ea="default",Em.Cache="cache";class ov{constructor(e,n,r){this.query=e,this.ta=n,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new ai(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.na?this.ia(e)&&(this.ta.next(e),n=!0):this.sa(e,this.onlineState)&&(this.oa(e),n=!0),this.ra=e,n}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let n=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),n=!0),n}sa(e,n){if(!e.fromCache||!this.J_())return!0;const r=n!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const n=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}oa(e){e=ai.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==ud.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class av{constructor(e){this.key=e}}class lv{constructor(e){this.key=e}}class pT{constructor(e,n){this.query=e,this.Ta=n,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=pe(),this.mutatedKeys=pe(),this.Aa=C0(e),this.Ra=new Qs(this.Aa)}get Va(){return this.Ta}ma(e,n){const r=n?n.fa:new wm,s=n?n.Ra:this.Ra;let i=n?n.mutatedKeys:this.mutatedKeys,a=s,l=!1;const u=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,h=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((p,y)=>{const m=s.get(p),C=Gl(this.query,y)?y:null,R=!!m&&this.mutatedKeys.has(m.key),P=!!C&&(C.hasLocalMutations||this.mutatedKeys.has(C.key)&&C.hasCommittedMutations);let O=!1;m&&C?m.data.isEqual(C.data)?R!==P&&(r.track({type:3,doc:C}),O=!0):this.ga(m,C)||(r.track({type:2,doc:C}),O=!0,(u&&this.Aa(C,u)>0||h&&this.Aa(C,h)<0)&&(l=!0)):!m&&C?(r.track({type:0,doc:C}),O=!0):m&&!C&&(r.track({type:1,doc:m}),O=!0,(u||h)&&(l=!0)),O&&(C?(a=a.add(C),i=P?i.add(p):i.delete(p)):(a=a.delete(p),i=i.delete(p)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const p=this.query.limitType==="F"?a.last():a.first();a=a.delete(p.key),i=i.delete(p.key),r.track({type:1,doc:p})}return{Ra:a,fa:r,ns:l,mutatedKeys:i}}ga(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,s){const i=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const a=e.fa.G_();a.sort((p,y)=>function(C,R){const P=O=>{switch(O){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ae()}};return P(C)-P(R)}(p.type,y.type)||this.Aa(p.doc,y.doc)),this.pa(r),s=s!=null&&s;const l=n&&!s?this.ya():[],u=this.da.size===0&&this.current&&!s?1:0,h=u!==this.Ea;return this.Ea=u,a.length!==0||h?{snapshot:new ai(this.query,e.Ra,i,a,e.mutatedKeys,u===0,h,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:l}:{wa:l}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new wm,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(n=>this.Ta=this.Ta.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ta=this.Ta.delete(n)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=pe(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const n=[];return e.forEach(r=>{this.da.has(r)||n.push(new lv(r))}),this.da.forEach(r=>{e.has(r)||n.push(new av(r))}),n}ba(e){this.Ta=e.Ts,this.da=pe();const n=this.ma(e.documents);return this.applyChanges(n,!0)}Da(){return ai.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class mT{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class gT{constructor(e){this.key=e,this.va=!1}}class yT{constructor(e,n,r,s,i,a){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=a,this.Ca={},this.Fa=new pi(l=>A0(l),ql),this.Ma=new Map,this.xa=new Set,this.Oa=new Ue(ie.comparator),this.Na=new Map,this.La=new Ah,this.Ba={},this.ka=new Map,this.qa=oi.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function vT(t,e,n=!0){const r=pv(t);let s;const i=r.Fa.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.Da()):s=await uv(r,e,n,!0),s}async function _T(t,e){const n=pv(t);await uv(n,e,!0,!1)}async function uv(t,e,n,r){const s=await BE(t.localStore,Vn(e)),i=s.targetId,a=t.sharedClientState.addLocalQueryTarget(i,n);let l;return r&&(l=await xT(t,e,i,a==="current",s.resumeToken)),t.isPrimaryClient&&n&&J0(t.remoteStore,s),l}async function xT(t,e,n,r,s){t.Ka=(y,m,C)=>async function(P,O,k,A){let w=O.view.ma(k);w.ns&&(w=await ym(P.localStore,O.query,!1).then(({documents:S})=>O.view.ma(S,w)));const b=A&&A.targetChanges.get(O.targetId),j=A&&A.targetMismatches.get(O.targetId)!=null,M=O.view.applyChanges(w,P.isPrimaryClient,b,j);return Im(P,O.targetId,M.wa),M.snapshot}(t,y,m,C);const i=await ym(t.localStore,e,!0),a=new pT(e,i.Ts),l=a.ma(i.documents),u=$o.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),h=a.applyChanges(l,t.isPrimaryClient,u);Im(t,n,h.wa);const p=new mT(e,n,a);return t.Fa.set(e,p),t.Ma.has(n)?t.Ma.get(n).push(e):t.Ma.set(n,[e]),h.snapshot}async function wT(t,e,n){const r=ce(t),s=r.Fa.get(e),i=r.Ma.get(s.targetId);if(i.length>1)return r.Ma.set(s.targetId,i.filter(a=>!ql(a,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await ld(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&Rh(r.remoteStore,s.targetId),cd(r,s.targetId)}).catch(Fo)):(cd(r,s.targetId),await ld(r.localStore,s.targetId,!0))}async function ST(t,e){const n=ce(t),r=n.Fa.get(e),s=n.Ma.get(r.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Rh(n.remoteStore,r.targetId))}async function ET(t,e,n){const r=PT(t);try{const s=await function(a,l){const u=ce(a),h=at.now(),p=l.reduce((C,R)=>C.add(R.key),pe());let y,m;return u.persistence.runTransaction("Locally write mutations","readwrite",C=>{let R=ir(),P=pe();return u.cs.getEntries(C,p).next(O=>{R=O,R.forEach((k,A)=>{A.isValidDocument()||(P=P.add(k))})}).next(()=>u.localDocuments.getOverlayedDocuments(C,R)).next(O=>{y=O;const k=[];for(const A of l){const w=HS(A,y.get(A.key).overlayedDocument);w!=null&&k.push(new Ur(A.key,w,v0(w.value.mapValue),pn.exists(!0)))}return u.mutationQueue.addMutationBatch(C,h,k,l)}).next(O=>{m=O;const k=O.applyToLocalDocumentSet(y,P);return u.documentOverlayCache.saveOverlays(C,O.batchId,k)})}).then(()=>({batchId:m.batchId,changes:R0(y)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(a,l,u){let h=a.Ba[a.currentUser.toKey()];h||(h=new Ue(we)),h=h.insert(l,u),a.Ba[a.currentUser.toKey()]=h}(r,s.batchId,n),await Ho(r,s.changes),await Zl(r.remoteStore)}catch(s){const i=jh(s,"Failed to persist write");n.reject(i)}}async function cv(t,e){const n=ce(t);try{const r=await OE(n.localStore,e);e.targetChanges.forEach((s,i)=>{const a=n.Na.get(i);a&&(Ie(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?a.va=!0:s.modifiedDocuments.size>0?Ie(a.va):s.removedDocuments.size>0&&(Ie(a.va),a.va=!1))}),await Ho(n,r,e)}catch(r){await Fo(r)}}function Tm(t,e,n){const r=ce(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.Fa.forEach((i,a)=>{const l=a.view.Z_(e);l.snapshot&&s.push(l.snapshot)}),function(a,l){const u=ce(a);u.onlineState=l;let h=!1;u.queries.forEach((p,y)=>{for(const m of y.j_)m.Z_(l)&&(h=!0)}),h&&Vh(u)}(r.eventManager,e),s.length&&r.Ca.d_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function TT(t,e,n){const r=ce(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.Na.get(e),i=s&&s.key;if(i){let a=new Ue(ie.comparator);a=a.insert(i,Ct.newNoDocument(i,ue.min()));const l=pe().add(i),u=new Yl(ue.min(),new Map,new Ue(we),a,l);await cv(r,u),r.Oa=r.Oa.remove(i),r.Na.delete(e),Mh(r)}else await ld(r.localStore,e,!1).then(()=>cd(r,e,n)).catch(Fo)}async function IT(t,e){const n=ce(t),r=e.batch.batchId;try{const s=await LE(n.localStore,e);hv(n,r,null),dv(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Ho(n,s)}catch(s){await Fo(s)}}async function AT(t,e,n){const r=ce(t);try{const s=await function(a,l){const u=ce(a);return u.persistence.runTransaction("Reject batch","readwrite-primary",h=>{let p;return u.mutationQueue.lookupMutationBatch(h,l).next(y=>(Ie(y!==null),p=y.keys(),u.mutationQueue.removeMutationBatch(h,y))).next(()=>u.mutationQueue.performConsistencyCheck(h)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(h,p,l)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,p)).next(()=>u.localDocuments.getDocuments(h,p))})}(r.localStore,e);hv(r,e,n),dv(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await Ho(r,s)}catch(s){await Fo(s)}}function dv(t,e){(t.ka.get(e)||[]).forEach(n=>{n.resolve()}),t.ka.delete(e)}function hv(t,e,n){const r=ce(t);let s=r.Ba[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.Ba[r.currentUser.toKey()]=s}}function cd(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Ma.get(e))t.Fa.delete(r),n&&t.Ca.$a(r,n);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(r=>{t.La.containsKey(r)||fv(t,r)})}function fv(t,e){t.xa.delete(e.path.canonicalString());const n=t.Oa.get(e);n!==null&&(Rh(t.remoteStore,n),t.Oa=t.Oa.remove(e),t.Na.delete(n),Mh(t))}function Im(t,e,n){for(const r of n)r instanceof av?(t.La.addReference(r.key,e),CT(t,r)):r instanceof lv?(ne("SyncEngine","Document no longer in limbo: "+r.key),t.La.removeReference(r.key,e),t.La.containsKey(r.key)||fv(t,r.key)):ae()}function CT(t,e){const n=e.key,r=n.path.canonicalString();t.Oa.get(n)||t.xa.has(r)||(ne("SyncEngine","New document in limbo: "+n),t.xa.add(r),Mh(t))}function Mh(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const n=new ie(je.fromString(e)),r=t.qa.next();t.Na.set(r,new gT(n)),t.Oa=t.Oa.insert(n,r),J0(t.remoteStore,new wr(Vn(xh(n.path)),r,"TargetPurposeLimboResolution",ph.oe))}}async function Ho(t,e,n){const r=ce(t),s=[],i=[],a=[];r.Fa.isEmpty()||(r.Fa.forEach((l,u)=>{a.push(r.Ka(u,e,n).then(h=>{var p;if((h||n)&&r.isPrimaryClient){const y=h?!h.fromCache:(p=n==null?void 0:n.targetChanges.get(u.targetId))===null||p===void 0?void 0:p.current;r.sharedClientState.updateQueryState(u.targetId,y?"current":"not-current")}if(h){s.push(h);const y=kh.Wi(u.targetId,h);i.push(y)}}))}),await Promise.all(a),r.Ca.d_(s),await async function(u,h){const p=ce(u);try{await p.persistence.runTransaction("notifyLocalViewChanges","readwrite",y=>$.forEach(h,m=>$.forEach(m.$i,C=>p.persistence.referenceDelegate.addReference(y,m.targetId,C)).next(()=>$.forEach(m.Ui,C=>p.persistence.referenceDelegate.removeReference(y,m.targetId,C)))))}catch(y){if(!zo(y))throw y;ne("LocalStore","Failed to update sequence numbers: "+y)}for(const y of h){const m=y.targetId;if(!y.fromCache){const C=p.os.get(m),R=C.snapshotVersion,P=C.withLastLimboFreeSnapshotVersion(R);p.os=p.os.insert(m,P)}}}(r.localStore,i))}async function kT(t,e){const n=ce(t);if(!n.currentUser.isEqual(e)){ne("SyncEngine","User change. New user:",e.toKey());const r=await Q0(n.localStore,e);n.currentUser=e,function(i,a){i.ka.forEach(l=>{l.forEach(u=>{u.reject(new J(z.CANCELLED,a))})}),i.ka.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Ho(n,r.hs)}}function RT(t,e){const n=ce(t),r=n.Na.get(e);if(r&&r.va)return pe().add(r.key);{let s=pe();const i=n.Ma.get(e);if(!i)return s;for(const a of i){const l=n.Fa.get(a);s=s.unionWith(l.view.Va)}return s}}function pv(t){const e=ce(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=cv.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=RT.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=TT.bind(null,e),e.Ca.d_=hT.bind(null,e.eventManager),e.Ca.$a=fT.bind(null,e.eventManager),e}function PT(t){const e=ce(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=IT.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=AT.bind(null,e),e}class Al{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Xl(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,n){return null}Ha(e,n){return null}za(e){return ME(this.persistence,new jE,e.initialUser,this.serializer)}Ga(e){return new bE(Ch.Zr,this.serializer)}Wa(e){return new $E}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Al.provider={build:()=>new Al};class dd{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Tm(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=kT.bind(null,this.syncEngine),await uT(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new dT}()}createDatastore(e){const n=Xl(e.databaseInfo.databaseId),r=function(i){return new GE(i)}(e.databaseInfo);return function(i,a,l,u){return new YE(i,a,l,u)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,s,i,a,l){return new JE(r,s,i,a,l)}(this.localStore,this.datastore,e.asyncQueue,n=>Tm(this.syncEngine,n,0),function(){return _m.D()?new _m:new WE}())}createSyncEngine(e,n){return function(s,i,a,l,u,h,p){const y=new yT(s,i,a,l,u,h);return p&&(y.Qa=!0),y}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(s){const i=ce(s);ne("RemoteStore","RemoteStore shutting down."),i.L_.add(5),await Wo(i),i.k_.shutdown(),i.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}dd.provider={build:()=>new dd};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mv{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):sr("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bT{constructor(e,n,r,s,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=Ft.UNAUTHENTICATED,this.clientId=m0.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async a=>{ne("FirestoreClient","Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(r,a=>(ne("FirestoreClient","Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Xn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=jh(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Ju(t,e){t.asyncQueue.verifyOperationInProgress(),ne("FirestoreClient","Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await Q0(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function Am(t,e){t.asyncQueue.verifyOperationInProgress();const n=await DT(t);ne("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>xm(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,s)=>xm(e.remoteStore,s)),t._onlineComponents=e}async function DT(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){ne("FirestoreClient","Using user provided OfflineComponentProvider");try{await Ju(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(s){return s.name==="FirebaseError"?s.code===z.FAILED_PRECONDITION||s.code===z.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(n))throw n;Ao("Error using user provided cache. Falling back to memory cache: "+n),await Ju(t,new Al)}}else ne("FirestoreClient","Using default OfflineComponentProvider"),await Ju(t,new Al);return t._offlineComponents}async function gv(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(ne("FirestoreClient","Using user provided OnlineComponentProvider"),await Am(t,t._uninitializedComponentsProvider._online)):(ne("FirestoreClient","Using default OnlineComponentProvider"),await Am(t,new dd))),t._onlineComponents}function NT(t){return gv(t).then(e=>e.syncEngine)}async function yv(t){const e=await gv(t),n=e.eventManager;return n.onListen=vT.bind(null,e.syncEngine),n.onUnlisten=wT.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=_T.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=ST.bind(null,e.syncEngine),n}function jT(t,e,n={}){const r=new Xn;return t.asyncQueue.enqueueAndForget(async()=>function(i,a,l,u,h){const p=new mv({next:m=>{p.Za(),a.enqueueAndForget(()=>iv(i,y));const C=m.docs.has(l);!C&&m.fromCache?h.reject(new J(z.UNAVAILABLE,"Failed to get document because the client is offline.")):C&&m.fromCache&&u&&u.source==="server"?h.reject(new J(z.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):h.resolve(m)},error:m=>h.reject(m)}),y=new ov(xh(l.path),p,{includeMetadataChanges:!0,_a:!0});return sv(i,y)}(await yv(t),t.asyncQueue,e,n,r)),r.promise}function VT(t,e,n={}){const r=new Xn;return t.asyncQueue.enqueueAndForget(async()=>function(i,a,l,u,h){const p=new mv({next:m=>{p.Za(),a.enqueueAndForget(()=>iv(i,y)),m.fromCache&&u.source==="server"?h.reject(new J(z.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):h.resolve(m)},error:m=>h.reject(m)}),y=new ov(l,p,{includeMetadataChanges:!0,_a:!0});return sv(i,y)}(await yv(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vv(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cm=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _v(t,e,n){if(!n)throw new J(z.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function MT(t,e,n,r){if(e===!0&&r===!0)throw new J(z.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function km(t){if(!ie.isDocumentKey(t))throw new J(z.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Rm(t){if(ie.isDocumentKey(t))throw new J(z.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function eu(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":ae()}function On(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new J(z.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=eu(t);throw new J(z.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pm{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new J(z.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new J(z.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}MT("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=vv((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new J(z.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new J(z.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new J(z.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Lh{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Pm({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new J(z.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new J(z.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Pm(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new eS;switch(r.type){case"firstParty":return new rS(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new J(z.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=Cm.get(n);r&&(ne("ComponentProvider","Removing Datastore"),Cm.delete(n),r.terminate())}(this),Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gi{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new gi(this.firestore,e,this._query)}}class jt{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Nr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new jt(this.firestore,e,this._key)}}class Nr extends gi{constructor(e,n,r){super(e,n,xh(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new jt(this.firestore,null,new ie(e))}withConverter(e){return new Nr(this.firestore,e,this._path)}}function vr(t,e,...n){if(t=An(t),_v("collection","path",e),t instanceof Lh){const r=je.fromString(e,...n);return Rm(r),new Nr(t,null,r)}{if(!(t instanceof jt||t instanceof Nr))throw new J(z.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(je.fromString(e,...n));return Rm(r),new Nr(t.firestore,null,r)}}function cn(t,e,...n){if(t=An(t),arguments.length===1&&(e=m0.newId()),_v("doc","path",e),t instanceof Lh){const r=je.fromString(e,...n);return km(r),new jt(t,null,new ie(r))}{if(!(t instanceof jt||t instanceof Nr))throw new J(z.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(je.fromString(e,...n));return km(r),new jt(t.firestore,t instanceof Nr?t.converter:null,new ie(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bm{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new Y0(this,"async_queue_retry"),this.Vu=()=>{const r=Xu();r&&ne("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;const n=Xu();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const n=Xu();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const n=new Xn;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!zo(e))throw e;ne("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const n=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;const s=function(a){let l=a.message||"";return a.stack&&(l=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),l}(r);throw sr("INTERNAL UNHANDLED ERROR: ",s),r}).then(r=>(this.du=!1,r))));return this.mu=n,n}enqueueAfterDelay(e,n,r){this.fu(),this.Ru.indexOf(e)>-1&&(n=0);const s=Nh.createAndSchedule(this,e,n,r,i=>this.yu(i));return this.Tu.push(s),s}fu(){this.Eu&&ae()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const n of this.Tu)if(n.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.Tu)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const n=this.Tu.indexOf(e);this.Tu.splice(n,1)}}class ys extends Lh{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new bm,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new bm(e),this._firestoreClient=void 0,await e}}}function LT(t,e,n){n||(n="(default)");const r=i0(t,"firestore");if(r.isInitialized(n)){const s=r.getImmediate({identifier:n}),i=r.getOptions(n);if(vl(i,e))return s;throw new J(z.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(e.cacheSizeBytes!==void 0&&e.localCache!==void 0)throw new J(z.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(e.cacheSizeBytes!==void 0&&e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new J(z.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return r.initialize({options:e,instanceIdentifier:n})}function Oh(t){if(t._terminated)throw new J(z.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||OT(t),t._firestoreClient}function OT(t){var e,n,r;const s=t._freezeSettings(),i=function(l,u,h,p){return new gS(l,u,h,p.host,p.ssl,p.experimentalForceLongPolling,p.experimentalAutoDetectLongPolling,vv(p.experimentalLongPollingOptions),p.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,s);t._componentsProvider||!((n=s.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=s.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),t._firestoreClient=new bT(t._authCredentials,t._appCheckCredentials,t._queue,i,t._componentsProvider&&function(l){const u=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(u),_online:u}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class li{constructor(e){this._byteString=e}static fromBase64String(e){try{return new li(_t.fromBase64String(e))}catch(n){throw new J(z.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new li(_t.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tu{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new J(z.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new mt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nu{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fh{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new J(z.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new J(z.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return we(this._lat,e._lat)||we(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zh{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FT=/^__.*__$/;class zT{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new Ur(e,this.data,this.fieldMask,n,this.fieldTransforms):new Uo(e,this.data,n,this.fieldTransforms)}}class xv{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new Ur(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function wv(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ae()}}class Bh{constructor(e,n,r,s,i,a){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.vu(),this.fieldTransforms=i||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new Bh(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Fu({path:r,xu:!1});return s.Ou(e),s}Nu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Fu({path:r,xu:!1});return s.vu(),s}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return Cl(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(wv(this.Cu)&&FT.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class BT{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Xl(e)}Qu(e,n,r,s=!1){return new Bh({Cu:e,methodName:n,qu:r,path:mt.emptyPath(),xu:!1,ku:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function ru(t){const e=t._freezeSettings(),n=Xl(t._databaseId);return new BT(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Sv(t,e,n,r,s,i={}){const a=t.Qu(i.merge||i.mergeFields?2:0,e,n,s);$h("Data must be an object, but it was:",a,r);const l=Ev(r,a);let u,h;if(i.merge)u=new tn(a.fieldMask),h=a.fieldTransforms;else if(i.mergeFields){const p=[];for(const y of i.mergeFields){const m=hd(e,y,n);if(!a.contains(m))throw new J(z.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);Iv(p,m)||p.push(m)}u=new tn(p),h=a.fieldTransforms.filter(y=>u.covers(y.field))}else u=null,h=a.fieldTransforms;return new zT(new Bt(l),u,h)}class su extends nu{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof su}}class Uh extends nu{_toFieldTransform(e){return new BS(e.path,new bo)}isEqual(e){return e instanceof Uh}}function UT(t,e,n,r){const s=t.Qu(1,e,n);$h("Data must be an object, but it was:",s,r);const i=[],a=Bt.empty();ms(r,(u,h)=>{const p=Wh(e,u,n);h=An(h);const y=s.Nu(p);if(h instanceof su)i.push(p);else{const m=qo(h,y);m!=null&&(i.push(p),a.set(p,m))}});const l=new tn(i);return new xv(a,l,s.fieldTransforms)}function $T(t,e,n,r,s,i){const a=t.Qu(1,e,n),l=[hd(e,r,n)],u=[s];if(i.length%2!=0)throw new J(z.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<i.length;m+=2)l.push(hd(e,i[m])),u.push(i[m+1]);const h=[],p=Bt.empty();for(let m=l.length-1;m>=0;--m)if(!Iv(h,l[m])){const C=l[m];let R=u[m];R=An(R);const P=a.Nu(C);if(R instanceof su)h.push(C);else{const O=qo(R,P);O!=null&&(h.push(C),p.set(C,O))}}const y=new tn(h);return new xv(p,y,a.fieldTransforms)}function WT(t,e,n,r=!1){return qo(n,t.Qu(r?4:3,e))}function qo(t,e){if(Tv(t=An(t)))return $h("Unsupported field value:",e,t),Ev(t,e);if(t instanceof nu)return function(r,s){if(!wv(s.Cu))throw s.Bu(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Bu(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,s){const i=[];let a=0;for(const l of r){let u=qo(l,s.Lu(a));u==null&&(u={nullValue:"NULL_VALUE"}),i.push(u),a++}return{arrayValue:{values:i}}}(t,e)}return function(r,s){if((r=An(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return OS(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=at.fromDate(r);return{timestampValue:Tl(s.serializer,i)}}if(r instanceof at){const i=new at(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Tl(s.serializer,i)}}if(r instanceof Fh)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof li)return{bytesValue:B0(s.serializer,r._byteString)};if(r instanceof jt){const i=s.databaseId,a=r.firestore._databaseId;if(!a.isEqual(i))throw s.Bu(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:Ih(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof zh)return function(a,l){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:a.toArray().map(u=>{if(typeof u!="number")throw l.Bu("VectorValues must only contain numeric values.");return wh(l.serializer,u)})}}}}}}(r,s);throw s.Bu(`Unsupported field value: ${eu(r)}`)}(t,e)}function Ev(t,e){const n={};return g0(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ms(t,(r,s)=>{const i=qo(s,e.Mu(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function Tv(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof at||t instanceof Fh||t instanceof li||t instanceof jt||t instanceof nu||t instanceof zh)}function $h(t,e,n){if(!Tv(n)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(n)){const r=eu(n);throw r==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+r)}}function hd(t,e,n){if((e=An(e))instanceof tu)return e._internalPath;if(typeof e=="string")return Wh(t,e);throw Cl("Field path arguments must be of type string or ",t,!1,void 0,n)}const HT=new RegExp("[~\\*/\\[\\]]");function Wh(t,e,n){if(e.search(HT)>=0)throw Cl(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new tu(...e.split("."))._internalPath}catch{throw Cl(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Cl(t,e,n,r,s){const i=r&&!r.isEmpty(),a=s!==void 0;let l=`Function ${e}() called with invalid data`;n&&(l+=" (via `toFirestore()`)"),l+=". ";let u="";return(i||a)&&(u+=" (found",i&&(u+=` in field ${r}`),a&&(u+=` in document ${s}`),u+=")"),new J(z.INVALID_ARGUMENT,l+t+u)}function Iv(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Av{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new jt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new qT(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(Hh("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class qT extends Av{data(){return super.data()}}function Hh(t,e){return typeof e=="string"?Wh(t,e):e instanceof tu?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GT(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new J(z.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class qh{}class QT extends qh{}function qa(t,e,...n){let r=[];e instanceof qh&&r.push(e),r=r.concat(n),function(i){const a=i.filter(u=>u instanceof Gh).length,l=i.filter(u=>u instanceof iu).length;if(a>1||a>0&&l>0)throw new J(z.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)t=s._apply(t);return t}class iu extends QT{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new iu(e,n,r)}_apply(e){const n=this._parse(e);return Cv(e._query,n),new gi(e.firestore,e.converter,nd(e._query,n))}_parse(e){const n=ru(e.firestore);return function(i,a,l,u,h,p,y){let m;if(h.isKeyField()){if(p==="array-contains"||p==="array-contains-any")throw new J(z.INVALID_ARGUMENT,`Invalid Query. You can't perform '${p}' queries on documentId().`);if(p==="in"||p==="not-in"){jm(y,p);const C=[];for(const R of y)C.push(Nm(u,i,R));m={arrayValue:{values:C}}}else m=Nm(u,i,y)}else p!=="in"&&p!=="not-in"&&p!=="array-contains-any"||jm(y,p),m=WT(l,a,y,p==="in"||p==="not-in");return Ze.create(h,p,m)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function Dm(t,e,n){const r=e,s=Hh("where",t);return iu._create(s,r,n)}class Gh extends qh{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new Gh(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:Cn.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(s,i){let a=s;const l=i.getFlattenedFilters();for(const u of l)Cv(a,u),a=nd(a,u)}(e._query,n),new gi(e.firestore,e.converter,nd(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function Nm(t,e,n){if(typeof(n=An(n))=="string"){if(n==="")throw new J(z.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!I0(e)&&n.indexOf("/")!==-1)throw new J(z.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(je.fromString(n));if(!ie.isDocumentKey(r))throw new J(z.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return em(t,new ie(r))}if(n instanceof jt)return em(t,n._key);throw new J(z.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${eu(n)}.`)}function jm(t,e){if(!Array.isArray(t)||t.length===0)throw new J(z.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Cv(t,e){const n=function(s,i){for(const a of s)for(const l of a.getFlattenedFilters())if(i.indexOf(l.op)>=0)return l.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new J(z.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new J(z.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class KT{convertValue(e,n="none"){switch(hs(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Qe(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(ds(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw ae()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return ms(e,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertVectorValue(e){var n,r,s;const i=(s=(r=(n=e.fields)===null||n===void 0?void 0:n.value.arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.map(a=>Qe(a.doubleValue));return new zh(i)}convertGeoPoint(e){return new Fh(Qe(e.latitude),Qe(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=gh(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(ko(e));default:return null}}convertTimestamp(e){const n=Lr(e);return new at(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=je.fromString(e);Ie(G0(r));const s=new Ro(r.get(1),r.get(3)),i=new ie(r.popFirst(5));return s.isEqual(n)||sr(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kv(t,e,n){let r;return r=t?t.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hi{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Rv extends Av{constructor(e,n,r,s,i,a){super(e,n,r,s,a),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new Ga(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(Hh("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class Ga extends Rv{data(e={}){return super.data(e)}}class YT{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new Hi(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new Ga(this._firestore,this._userDataWriter,r.key,r,new Hi(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new J(z.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let a=0;return s._snapshot.docChanges.map(l=>{const u=new Ga(s._firestore,s._userDataWriter,l.doc.key,l.doc,new Hi(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);return l.doc,{type:"added",doc:u,oldIndex:-1,newIndex:a++}})}{let a=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(l=>i||l.type!==3).map(l=>{const u=new Ga(s._firestore,s._userDataWriter,l.doc.key,l.doc,new Hi(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);let h=-1,p=-1;return l.type!==0&&(h=a.indexOf(l.doc.key),a=a.delete(l.doc.key)),l.type!==1&&(a=a.add(l.doc),p=a.indexOf(l.doc.key)),{type:XT(l.type),doc:u,oldIndex:h,newIndex:p}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function XT(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ae()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JT(t){t=On(t,jt);const e=On(t.firestore,ys);return jT(Oh(e),t._key).then(n=>eI(e,t,n))}class Pv extends KT{constructor(e){super(),this.firestore=e}convertBytes(e){return new li(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new jt(this.firestore,null,n)}}function qi(t){t=On(t,gi);const e=On(t.firestore,ys),n=Oh(e),r=new Pv(e);return GT(t._query),VT(n,t._query).then(s=>new YT(e,r,t,s))}function ZT(t,e,n){t=On(t,jt);const r=On(t.firestore,ys),s=kv(t.converter,e);return ou(r,[Sv(ru(r),"setDoc",t._key,s,t.converter!==null,n).toMutation(t._key,pn.none())])}function Gn(t,e,n,...r){t=On(t,jt);const s=On(t.firestore,ys),i=ru(s);let a;return a=typeof(e=An(e))=="string"||e instanceof tu?$T(i,"updateDoc",t._key,e,n,r):UT(i,"updateDoc",t._key,e),ou(s,[a.toMutation(t._key,pn.exists(!0))])}function Zu(t){return ou(On(t.firestore,ys),[new Sh(t._key,pn.none())])}function Qh(t,e){const n=On(t.firestore,ys),r=cn(t),s=kv(t.converter,e);return ou(n,[Sv(ru(t.firestore),"addDoc",r._key,s,t.converter!==null,{}).toMutation(r._key,pn.exists(!1))]).then(()=>r)}function ou(t,e){return function(r,s){const i=new Xn;return r.asyncQueue.enqueueAndForget(async()=>ET(await NT(r),s,i)),i.promise}(Oh(t),e)}function eI(t,e,n){const r=n.docs.get(e._key),s=new Pv(t);return new Rv(t,s,e._key,r,new Hi(n.hasPendingWrites,n.fromCache),e.converter)}function hn(){return new Uh("serverTimestamp")}(function(e,n=!0){(function(s){fi=s})(zw),To(new ni("firestore",(r,{instanceIdentifier:s,options:i})=>{const a=r.getProvider("app").getImmediate(),l=new ys(new tS(r.getProvider("auth-internal")),new iS(r.getProvider("app-check-internal")),function(h,p){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new J(z.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ro(h.options.projectId,p)}(a,s),a);return i=Object.assign({useFetchStreams:n},i),l._setSettings(i),l},"PUBLIC").setMultipleInstances(!0)),Dr(Kp,"4.7.3",e),Dr(Kp,"4.7.3","esm2017")})();/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bv="functions";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tI{constructor(e,n,r){this.auth=null,this.messaging=null,this.appCheck=null,this.auth=e.getImmediate({optional:!0}),this.messaging=n.getImmediate({optional:!0}),this.auth||e.get().then(s=>this.auth=s,()=>{}),this.messaging||n.get().then(s=>this.messaging=s,()=>{}),this.appCheck||r.get().then(s=>this.appCheck=s,()=>{})}async getAuthToken(){if(this.auth)try{const e=await this.auth.getToken();return e==null?void 0:e.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.appCheck){const n=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return n.error?null:n.token}return null}async getContext(e){const n=await this.getAuthToken(),r=await this.getMessagingToken(),s=await this.getAppCheckToken(e);return{authToken:n,messagingToken:r,appCheckToken:s}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fd="us-central1";class nI{constructor(e,n,r,s,i=fd,a){this.app=e,this.fetchImpl=a,this.emulatorOrigin=null,this.contextProvider=new tI(n,r,s),this.cancelAllRequests=new Promise(l=>{this.deleteService=()=>Promise.resolve(l())});try{const l=new URL(i);this.customDomain=l.origin+(l.pathname==="/"?"":l.pathname),this.region=fd}catch{this.customDomain=null,this.region=i}}_delete(){return this.deleteService()}_url(e){const n=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${n}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${n}.cloudfunctions.net/${e}`}}function rI(t,e,n){t.emulatorOrigin=`http://${e}:${n}`}const Vm="@firebase/functions",Mm="0.11.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sI="auth-internal",iI="app-check-internal",oI="messaging-internal";function aI(t,e){const n=(r,{instanceIdentifier:s})=>{const i=r.getProvider("app").getImmediate(),a=r.getProvider(sI),l=r.getProvider(oI),u=r.getProvider(iI);return new nI(i,a,l,u,s,t)};To(new ni(bv,n,"PUBLIC").setMultipleInstances(!0)),Dr(Vm,Mm,e),Dr(Vm,Mm,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lI(t=Bw(),e=fd){const r=i0(An(t),bv).getImmediate({identifier:e}),s=D1("functions");return s&&uI(r,...s),r}function uI(t,e,n){rI(An(t),e,n)}aI(fetch.bind(self));const cI={apiKey:'"AIzaSyDRdl4zhwoZumVtphmJ19orZ8HoR0WQQZM",',authDomain:'"qualtrics-game-backend.firebaseapp.com",',projectId:'"qualtrics-game-backend",',storageBucket:'"qualtrics-game-backend.firebasestorage.app",',messagingSenderId:'"441267092549",',appId:"1:441267092549:web:6ce075f5f3ea7cf958772c"},Dv=o0(cI),it=LT(Dv,{experimentalForceLongPolling:!1,useFetchStreams:!1});lI(Dv);const ke={init(){localStorage.getItem("sessionId")||(localStorage.setItem("sessionId",this.generateSessionId()),localStorage.setItem("sessionStartTime",Date.now().toString())),localStorage.getItem("semesterStartTime")||localStorage.setItem("semesterStartTime",Date.now().toString())},generateSessionId(){return`session_${Date.now()}_${Math.random().toString(36).substr(2,9)}`},async logEvent(t,e){const n=localStorage.getItem("sessionId")||this.generateSessionId(),r=parseInt(localStorage.getItem("sessionStartTime")||Date.now()),s=Date.now(),i=s-r,a=(i/1e3).toFixed(1),l=Math.floor(i/6e4),u=Math.floor(i%6e4/1e3),h=`${l}:${u.toString().padStart(2,"0")}`,p={sessionId:n,type:t,timestamp:new Date().toISOString(),clientTimestamp:s,timeElapsedSeconds:parseFloat(a),readableTime:h,semesterTime:this.getSemesterTime(),...this.convertTimesToSeconds(e)};try{await Qh(vr(it,"events"),p)}catch(y){console.error("Failed to log event:",y),this.storeOfflineEvent(p)}},convertTimesToSeconds(t){const e={...t},n=["timeTaken","timeSpent","totalTime","timeOnPreviousPage","averageTime","timeBetweenHelpAndSubmit"];for(const r of n)e[r]!==void 0&&e[r]!==null&&(e[`${r}Seconds`]=(e[r]/1e3).toFixed(1),delete e[r]);return e.timeProgression&&(e.timeProgressionSeconds=e.timeProgression.map(r=>(r/1e3).toFixed(1)),delete e.timeProgression),e.timePerAttempt&&(e.timePerAttemptSeconds=e.timePerAttempt.map(r=>(r/1e3).toFixed(1)),delete e.timePerAttempt),e},getSemesterTime(){const t=parseInt(localStorage.getItem("semesterStartTime")||Date.now()),e=Date.now()-t,n=(e/1e3).toFixed(1),r=Math.floor(e/6e4),s=Math.floor(e%6e4/1e3);return{elapsedSeconds:parseFloat(n),readable:`${r}:${s.toString().padStart(2,"0")}`,minutes:r,seconds:s}},getCurrentContext(){const t=parseInt(localStorage.getItem("sessionStartTime")||Date.now()),e=((Date.now()-t)/1e3).toFixed(1);return{currentTask:localStorage.getItem("currentTask"),gameMode:localStorage.getItem("gameMode"),totalCompleted:this.getCompletedTaskCount(),currentStreak:this.getCurrentStreak(),sessionDurationSeconds:parseFloat(e)}},calculateImprovementTrend(t){if(!t||t.length<3)return"needs_more_data";const n=t.slice(-5).map(s=>s.accuracy),r=this.calculateTrend(n);return r>5?"rapid_improvement":r>2?"steady_improvement":r>0?"slight_improvement":r>-2?"stable":r>-5?"slight_decline":"rapid_decline"},calculateImprovementRate(t){if(!t||t.length<2)return{overall:0,trend:0,isImproving:!1,dataPoints:t?t.length:0};const e=t[0].accuracy,r=t[t.length-1].accuracy-e;if(t.length<3)return{overall:r,trend:r,isImproving:r>0,dataPoints:t.length};const s=Math.floor(t.length/2),i=t.slice(0,s).reduce((u,h)=>u+h.accuracy,0)/s,l=t.slice(s).reduce((u,h)=>u+h.accuracy,0)/(t.length-s)-i;return{overall:r,trend:l,isImproving:l>0,dataPoints:t.length}},setPageStartTime(t){t&&localStorage.setItem(`pageStartTime_${t}`,Date.now().toString())},getTimeOnCurrentPage(t){if(!t)return 0;const e=localStorage.getItem(`pageStartTime_${t}`);return e?Date.now()-parseInt(e):0},ensureSession(){localStorage.getItem("sessionId")||this.init()},async trackAIHelpResponse(t,e){return this.logEvent("ai_help_response",{taskId:t,...e})},async trackTaskAttempt(t,e){return this.logEvent("task_attempt",{taskId:t,...e})},async trackUserAction(t,e){return this.logEvent("user_action",{action:t,...e})},async syncOfflineEvents(){return console.log("Syncing offline events..."),Promise.resolve()},async trackTaskComplete(t,e){return this.logEvent("task_complete",{taskId:t,...e})},async trackPageSwitch(t,e,n){return this.logEvent("page_switch",{from:t,to:e,isAutoAdvance:n})},trackAITaskHelp(t,e){return this.logEvent("ai_task_help",{taskType:t,...e})}};ke.init();const Jn={seedRandom:null,currentSeed:null,initializeSeed(t){this.currentSeed=t;let e=t;this.seedRandom=function(){return e=(e*9301+49297)%233280,e/233280}},getRandom(){return this.seedRandom?this.seedRandom():Math.random()},generateCountingPattern(t){const e=t<=10?"easy":t<=25?"medium":"hard";let n;e==="easy"?n=(t-1)%5+1:e==="medium"?n=(t-11)%5+6:n=(t-26)%5+11;const s={easy:{1:{target:"the",type:"word"},2:{target:"and",type:"word"},3:{target:"of",type:"word"},4:{target:"a",type:"word"},5:{target:"in",type:"word"}},medium:{6:{target:"e",type:"letter"},7:{target:"a",type:"letter"},8:{target:"i",type:"letter"},9:{target:"o",type:"letter"},10:{target:"s",type:"letter"}},hard:{11:{targets:["a","e"],type:"multi-letter"},12:{targets:["i","o"],type:"multi-letter"},13:{targets:["s","t"],type:"multi-letter"},14:{targets:["n","r"],type:"multi-letter"},15:{targets:["l","d"],type:"multi-letter"}}}[e][n];let i="";return s.type==="word"?i=`Count how many times the word "${s.target}" appears:`:s.type==="letter"?i=`Count how many times the letter "${s.target}" appears (case-insensitive):`:i=`Count how many times the letters "${s.targets[0]}" and "${s.targets[1]}" appear in total:`,{...s,instruction:i,difficulty:e,difficultyLabel:e.charAt(0).toUpperCase()+e.slice(1)}},generateSliderPattern(t){const e=t<=10?"easy":t<=25?"medium":"hard";let n,r,s;return e==="easy"?(n=Math.floor(this.getRandom()*11),r=1,s=!0):e==="medium"?(n=Math.round(this.getRandom()*10*10)/10,r=.1,s=!0):(n=Math.round(this.getRandom()*10*100)/100,r=.01,s=(t-26)%5!==0),{target:n,step:r,showValue:s,difficulty:e,difficultyLabel:e.charAt(0).toUpperCase()+e.slice(1),precision:e==="easy"?0:e==="medium"?1:2}},generateTypingPattern(t){const e=t<=10?"easy":t<=25?"medium":"hard",n={easy:["hello world","quick test","type this","easy mode","simple text","good job","keep going","nice work","almost done","level up"],medium:["HeLLo WoRLd","QuIcK tEsT","TyPe ThIs","MeDiUm MoDe","MiXeD cAsE","KeEp GoInG","NiCe WoRk","AlMoSt DoNe","LeVeL uP","ChAlLeNgE","TeSt RuN","NeXt LeVeL","TrY aGaIn","GoOd LuCk","FiNaL tEsT"],hard:["Test@123","Go4It!Now","X9%Y8&Z7*","P6!Q5?R4+","Z1@Y2#X3$","M7&N8*O9!","J4%K5^L6&","D1!E2@F3#","A7$B8%C9^","V3*W4+X5=","Q2#R3$S4%","H5^I6&J7*","K8(L9)M0!","N1@O2#P3$","T4%U5^V6&","W7*X8(Y9)","C0!D1@E2#","F3$G4%H5^","I6&J7*K8(","L9)M0!N1@","O2#P3$Q4%","R5^S6&T7*","U8(V9)W0!","X1@Y2#Z3$","A4%B5^C6&"]};let r;if(e==="easy"){const s=(t-1)%n.easy.length;r=n.easy[s]}else if(e==="medium"){const s=(t-11)%n.medium.length;r=n.medium[s]}else{const s=(t-26)%n.hard.length;r=n.hard[s]}return{pattern:r,difficulty:e,difficultyLabel:e.charAt(0).toUpperCase()+e.slice(1)}},textPassages:["The University of California, Berkeley (UC Berkeley, Berkeley, Cal, or California) is a public land-grant research university in Berkeley, California, United States. Founded in 1868 and named after the Anglo-Irish philosopher George Berkeley, it is the state's first land-grant university and is the founding campus of the University of California system.","Berkeley has an enrollment of more than 45,000 students. The university is organized around fifteen schools of study on the same campus, including the College of Chemistry, the College of Engineering, College of Letters and Science, and the Haas School of Business.",'The Berkeley campus encompasses approximately 1,232 acres, though the "central campus" occupies only the low-lying western 178 acres. The campus contains numerous wooded areas, including the Eucalyptus Grove and Strawberry Creek, which runs through the center of campus.',"Oski the Bear (Oski) is the official mascot of the University of California, Berkeley, representing the California Golden Bears. Named after the Oski Yell, he made his debut at a freshman rally in the Greek Theatre on September 25, 1941.","Berkeley faculty, alumni, and researchers have won 111 Nobel laureates, 25 Turing Award winners, and 19 Academy Award winners. The university has produced many notable alumni in various fields including science, politics, business, and entertainment.","The university's athletic teams compete as the California Golden Bears and are members of the Atlantic Coast Conference for most sports. Berkeley teams have won 107 national championships, including 45 NCAA national championships.","Research at Berkeley is conducted within departments, organized research units, and interdisciplinary research centers. Berkeley operates Lawrence Berkeley National Laboratory, manages Los Alamos National Laboratory, and is a founding partner of the Space Sciences Laboratory.","The Berkeley campus offers over 350 degree programs through its 14 colleges and schools. Popular majors include Computer Science, Economics, Political Science, and Business Administration. The student-faculty ratio is 17:1.","Berkeley's libraries contain more than 13 million volumes and maintain special collections including the Mark Twain Papers, the Oral History Center, and the Bancroft Library, which houses the largest collection of materials on California history.","The campus is home to several museums including the Berkeley Art Museum and Pacific Film Archive, the Lawrence Hall of Science, and the UC Botanical Garden. These facilities serve both educational and public outreach purposes.","Notable Berkeley inventions and discoveries include the cyclotron, the atomic bomb, the flu vaccine, and vitamin E. Berkeley researchers discovered 16 chemical elements of the periodic table, more than any other university.","The Free Speech Movement, which took place during the 1964-65 academic year, was a pivotal moment in the history of civil liberties in the United States. It began when students protested a ban on political activities on campus.","Berkeley's Campanile, known as Sather Tower, is the third-tallest clock tower in the world at 307 feet. It was completed in 1914 and is visible for miles, serving as a symbol of the university.","The university operates on a semester system, with fall semester beginning in late August and spring semester beginning in mid-January. Berkeley offers over 5,000 courses each semester across all disciplines.",`Cal Bears have won at least one team national title in 13 different sports. The university's traditional rival is Stanford University, with the annual football game known as "The Big Game" dating back to 1892.`],getTextPassage(t){if(this.seedRandom){const e=Math.floor(this.getRandom()*this.textPassages.length),n=(t-1+e)%this.textPassages.length;return this.textPassages[n]}else{const e=(t-1)%this.textPassages.length;return this.textPassages[e]}}};function pd({taskNum:t,onComplete:e,isPractice:n=!1,currentTaskId:r}){const[s,i]=L.useState(""),[a,l]=L.useState(""),[u,h]=L.useState(null),[p,y]=L.useState(""),[m,C]=L.useState(null),[R,P]=L.useState(""),[O,k]=L.useState(""),[A]=L.useState(Date.now()),[w,b]=L.useState(""),[j,M]=L.useState(!1),[S,v]=L.useState(new Set),T=L.useRef(0);L.useRef(null);const I=(G,U=null,B=null)=>{const N=document.createElement("canvas"),F=N.getContext("2d");N.width=900,N.height=400,F.fillStyle="#fafafa",F.fillRect(0,0,N.width,N.height),F.strokeStyle="#e0e0e0",F.lineWidth=2,F.strokeRect(0,0,N.width,N.height),F.font="24px monospace",F.fillStyle="#333";const W=36,te=25,Z=N.width-te*2;return((me,he)=>{const de=me.split(" "),Oe=[];let Se="";for(let re of de){const Re=Se+(Se?" ":"")+re;F.measureText(Re).width>he&&Se?(Oe.push(Se),Se=re):Se=Re}return Se&&Oe.push(Se),Oe})(G,Z).forEach((me,he)=>{const de=te+(he+1)*W;let Oe=te;if(t<=5){const Se=me.split(" ");let re=0;Se.forEach(Re=>{const qe=B&&B.has(re),Pe=U&&U.some(xt=>Re.toLowerCase()===xt.toLowerCase());if(qe){const xt=F.measureText(Re).width;F.fillStyle="yellow",F.fillRect(Oe-2,de-18,xt+4,24)}else if(Pe){const xt=F.measureText(Re).width;F.fillStyle="rgba(255, 215, 0, 0.4)",F.fillRect(Oe-2,de-18,xt+4,24)}F.fillStyle="#333",F.fillText(Re,Oe,de),Oe+=F.measureText(Re+" ").width,re++})}else for(let Se=0;Se<me.length;Se++){const re=me[Se],Re=F.measureText(re).width;U&&U.some(Pe=>re.toLowerCase()===Pe.toLowerCase())&&(F.fillStyle="rgba(255, 215, 0, 0.4)",F.fillRect(Oe-1,de-18,Re+2,24)),F.fillStyle="#333",F.fillText(re,Oe,de),Oe+=Re}}),N.toDataURL()};L.useEffect(()=>{y(0),C(null),T.current=0},[t]),L.useEffect(()=>{const G=async(B,N)=>{const F=document.createElement("canvas"),W=F.getContext("2d");F.width=900,F.height=350,W.fillStyle="#fafafa",W.fillRect(0,0,F.width,F.height),W.strokeStyle="#e0e0e0",W.lineWidth=2,W.strokeRect(0,0,F.width,F.height),W.font="24px monospace";const te=36,Z=20,oe=F.width-Z*2,me=((he,de)=>{const Oe=he.split(" "),Se=[];let re="";for(let Re of Oe){const qe=re+(re?" ":"")+Re;W.measureText(qe).width>de&&re?(Se.push(re),re=Re):re=qe}return re&&Se.push(re),Se})(R,oe);for(let he=0;he<B.length;he++)B[he],me.forEach((de,Oe)=>{const Se=Z+(Oe+1)*te;let re=Z;for(let Re=0;Re<de.length;Re++){const qe=de[Re],Pe=W.measureText(qe).width;B.some(qt=>qe.toLowerCase()===qt.toLowerCase())&&(W.fillStyle="rgba(255, 255, 0, 0.6)",W.fillRect(re-1,Se-20,Pe+2,26)),W.fillStyle="#333",W.fillText(qe,re,Se),re+=Pe}}),b(F.toDataURL()),await new Promise(de=>setTimeout(de,300));setTimeout(()=>{y(N.toString())},300)},U=async B=>{const{action:N,highlightWords:F,suggestedCount:W,animate:te,isMultiLetter:Z,targetLetters:oe}=B.detail||{};if(N==="highlightAndCount"){if(Z&&Array.isArray(oe)){te&&await G(oe,W);return}if(Array.isArray(F)&&te){R.split(" ");let Ae=[];for(let me=0;me<F.length;me++){Ae.push(F[me]);const he=document.createElement("canvas"),de=he.getContext("2d");he.width=900,he.height=350,de.fillStyle="#fafafa",de.fillRect(0,0,he.width,he.height),de.strokeStyle="#e0e0e0",de.lineWidth=2,de.strokeRect(0,0,he.width,he.height),de.font="24px monospace";const Oe=36,Se=20,re=he.width-Se*2;((Pe,xt)=>{const qt=Pe.split(" "),Gt=[];let Qt="";for(let Kt of qt){const Yt=Qt+(Qt?" ":"")+Kt;de.measureText(Yt).width>xt&&Qt?(Gt.push(Qt),Qt=Kt):Qt=Yt}return Qt&&Gt.push(Qt),Gt})(R,re).forEach((Pe,xt)=>{const qt=Se+(xt+1)*Oe;let Gt=Se;Pe.split(" ").forEach(Kt=>{const Yt=de.measureText(Kt).width;Ae.some(kn=>{const lr=Kt.replace(/[.,;!?]/g,"").toLowerCase(),$e=kn.replace(/[.,;!?]/g,"").toLowerCase();return lr===$e})&&(de.fillStyle="rgba(255, 255, 0, 0.5)",de.fillRect(Gt-2,qt-18,Yt+4,24)),de.fillStyle="#333",de.fillText(Kt,Gt,qt),Gt+=de.measureText(Kt+" ").width})}),b(he.toDataURL()),await new Promise(Pe=>setTimeout(Pe,200))}setTimeout(()=>{y(W.toString())},300)}}};return window.addEventListener("aiCountingHelp",U),()=>window.removeEventListener("aiCountingHelp",U)},[R,t]),L.useEffect(()=>{var F;const G=Jn.generateCountingPattern(t),U=Jn.getTextPassage(t);P(U),i(G.target||((F=G.targets)==null?void 0:F.join(", "))),l(G.instruction);let B=0;if(G.type==="word"){const W=new RegExp(`\\b${G.target}\\b`,"gi"),te=U.match(W);B=te?te.length:0}else if(G.type==="letter"){const W=new RegExp(G.target,"gi"),te=U.match(W);B=te?te.length:0}else G.type==="multi-letter"&&G.targets.forEach(W=>{const te=new RegExp(W,"gi"),Z=U.match(te);B+=Z?Z.length:0});h(B);const N=I(U,null);b(N)},[t]);const _=async()=>{const G=Date.now()-A,U=parseInt(p,10)||0,B=u??0,N=Math.abs(U-B),F=`g1t${t}`,W=localStorage.getItem(`lastAIHelp_${F}`);if(W){const oe=JSON.parse(W),Ae=Date.now()-oe.timestamp,me=U===oe.suggestion?"accepted":"modified";await ke.trackAIHelpResponse(F,oe.type,oe.suggestion,me,U,Ae),localStorage.removeItem(`lastAIHelp_${F}`)}let te=0;N===0?te=2:N<=1?te=1:te=0,T.current+=1,await ke.trackTaskAttempt(F,T.current,!0,G,U,B);const Z=localStorage.getItem("sessionId");if(Z&&!Z.startsWith("offline-"))try{await Gn(cn(it,"sessions",Z),{[`taskAccuracies.g1t${t}`]:te===2?100:te===1?70:0,[`taskTimes.g1t${t}`]:G,[`taskPoints.g1t${t}`]:te,lastActivity:hn()})}catch(oe){console.error("Error storing accuracy:",oe)}C(te===2?" Perfect! 2 points earned!":te===1?` Off by ${N} - 1 point earned!`:` Off by ${N} - 0 points earned.`),setTimeout(()=>{e==null||e(`g1t${t}`,{attempts:T.current,totalTime:G,accuracy:te===2?100:te===1?70:0,userAnswer:U,correctAnswer:B,points:te})},500)},x=Jn.generateCountingPattern(t).difficultyLabel,X=t<=5?"easy":t<=10?"medium":"hard";return d.jsxs("div",{className:"task counting",children:[d.jsxs("h3",{children:["Research Content - Level ",t]}),d.jsx("div",{className:`difficulty-badge ${X}`,children:x}),d.jsxs("p",{className:"instruction",children:[d.jsx("strong",{children:a}),d.jsx("br",{}),d.jsx("span",{className:"hint",children:"(Case-insensitive)"})]}),d.jsxs("div",{className:"text-display text-to-count","data-counting-text":R,children:[d.jsx("div",{className:"count-target","data-pattern":s,style:{display:"none"},children:s}),w?d.jsx("img",{src:w,alt:"Text passage for counting",style:{width:"100%",maxWidth:"900px",height:"auto",maxHeight:"350px",objectFit:"contain",border:"none",userSelect:"none",pointerEvents:"none"},onContextMenu:G=>G.preventDefault(),draggable:!1}):d.jsx("div",{dangerouslySetInnerHTML:{__html:O}})]}),d.jsxs("div",{className:"input-section",children:[d.jsx("label",{children:"Your answer:"}),d.jsx("input",{type:"number",min:"0",max:"999",value:p,onChange:G=>y(G.target.value),onKeyPress:G=>{G.key==="Enter"&&_()},placeholder:"Enter count"})]}),d.jsx("button",{onClick:_,className:"submit-btn",style:{display:"block",margin:"20px auto 0"},children:"Submit"}),m&&d.jsx("div",{className:`feedback ${m.includes("2 points")?"correct":m.includes("0 points")?"incorrect":"partial"}`,children:m})]})}function md({taskNum:t,onComplete:e,isPractice:n=!1,currentTaskId:r}){const[s,i]=L.useState(5),[a,l]=L.useState(0),[u,h]=L.useState(null),[p]=L.useState(Date.now()),[y,m]=L.useState(1),[C,R]=L.useState(!0),[P,O]=L.useState(!1),[k,A]=L.useState(!1),[w,b]=L.useState(!1),[j,M]=L.useState(!1),S=L.useRef(null),v=L.useRef(0);L.useEffect(()=>{if(n)i(3),m(1),R(!0);else{const B=Jn.generateSliderPattern(t);i(B.target),m(B.step),R(B.showValue)}l(0),h(null),v.current=0},[t,n]),L.useEffect(()=>{const B=N=>{const{action:F,value:W,animate:te}=N.detail;if(F==="moveSlider")if(A(!0),te){const Z=parseFloat(a),oe=parseFloat(W),Ae=1e3,me=30;let he=0;const de=setInterval(()=>{he++;const Oe=he/me,Se=1-Math.pow(1-Oe,3),re=Z+(oe-Z)*Se;l(parseFloat(re.toFixed(2))),he>=me&&(clearInterval(de),A(!1),l(parseFloat(oe.toFixed(2))))},Ae/me)}else l(parseFloat(W.toFixed(2))),A(!1)};return window.addEventListener("aiSliderHelp",B),()=>window.removeEventListener("aiSliderHelp",B)},[a]),L.useEffect(()=>{const B=N=>{N.key==="Enter"&&!k&&E()};return document.addEventListener("keypress",B),()=>document.removeEventListener("keypress",B)},[k,a,s]);const T=B=>{if(k)return;const N=S.current;if(!N)return;B.preventDefault();const F=N.getBoundingClientRect(),W=a/10,te=F.left+F.width*W,Z=B.clientX||B.touches&&B.touches[0].clientX;Math.abs(Z-te)<30&&(b(!0),M(!0))},I=B=>{if(!w||k)return;const N=S.current;if(!N)return;const F=N.getBoundingClientRect(),W=B.clientX||B.touches&&B.touches[0].clientX,Z=Math.max(0,Math.min(1,(W-F.left)/F.width))*10,oe=Math.round(Z/y)*y;l(parseFloat(oe.toFixed(2)))},_=()=>{b(!1)};L.useEffect(()=>{if(w){const B=F=>I(F),N=()=>_();return document.addEventListener("mousemove",B),document.addEventListener("mouseup",N),document.addEventListener("touchmove",B),document.addEventListener("touchend",N),()=>{document.removeEventListener("mousemove",B),document.removeEventListener("mouseup",N),document.removeEventListener("touchmove",B),document.removeEventListener("touchend",N)}}},[w,y,k]);const E=async()=>{const B=Date.now()-p,N=parseFloat(a),F=Math.abs(N-s),W=`g2t${t}`,te=localStorage.getItem(`lastAIHelp_${W}`);if(te){const Ae=JSON.parse(te),me=Date.now()-Ae.timestamp,he=N===Ae.suggestion?"accepted":"modified";await ke.trackAIHelpResponse(W,Ae.type,Ae.suggestion,he,N,me),localStorage.removeItem(`lastAIHelp_${W}`)}let Z=0;F===0?Z=2:F<=1?Z=1:Z=0,v.current+=1,await ke.trackTaskAttempt(W,v.current,!0,B,N,s);const oe=localStorage.getItem("sessionId");if(oe&&!oe.startsWith("offline-"))try{await Gn(cn(it,"sessions",oe),{[`taskDifferences.g2t${t}`]:F,[`taskTimes.g2t${t}`]:B,[`taskPoints.g2t${t}`]:Z,lastActivity:hn()})}catch(Ae){console.error("Error storing difference:",Ae)}h(Z===2?" Perfect! 2 points earned!":Z===1?` Off by ${F.toFixed(2)} - 1 point earned!`:` Off by ${F.toFixed(2)} - 0 points earned.`),setTimeout(()=>{e(`g2t${t}`,{attempts:v.current,totalTime:B,accuracy:Z===2?100:Z===1?70:0,userAnswer:N,correctAnswer:s,points:Z})},500)},x=Jn.generateSliderPattern(t),X=x.difficultyLabel,G=x.difficulty,U=()=>{const B=[];for(let N=0;N<=10;N++)B.push(d.jsxs("div",{style:{position:"absolute",left:`${N*10}%`,transform:"translateX(-50%)",textAlign:"center"},children:[d.jsx("div",{style:{width:"2px",height:"12px",background:"#666",margin:"0 auto"}}),d.jsx("div",{style:{fontSize:"12px",color:"#666",marginTop:"2px"},children:N})]},N));return B};return d.jsxs("div",{className:`task slider ${k?"ai-controlled":""}`,children:[d.jsxs("h3",{children:["Material Creation - Level ",t]}),d.jsx("div",{className:`difficulty-badge ${G}`,children:X}),d.jsxs("p",{className:"instruction",children:["Move the slider to:"," ",d.jsx("strong",{className:"target-value","data-target-value":s,children:s}),d.jsx("br",{}),d.jsx("span",{style:{fontSize:"14px",color:"#666",fontStyle:"italic"},children:!j&&"Hold and drag the slider handle to move it"})]}),d.jsxs("div",{className:"slider-container",children:[d.jsxs("div",{className:"range-labels",children:[d.jsx("span",{children:"0"}),d.jsx("span",{children:"10"})]}),d.jsxs("div",{style:{position:"relative",padding:"20px 0 30px 0"},children:[d.jsx("div",{style:{position:"absolute",width:"100%",height:"20px",top:"0"},children:U()}),d.jsx("div",{style:{position:"relative",marginTop:"20px"},children:d.jsx("input",{ref:S,type:"range",min:"0",max:"10",step:y,value:a,onChange:B=>{!w&&!k&&(l(parseFloat(B.target.value)),M(!0))},className:"slider-input",style:{width:"100%",cursor:w?"grabbing":"grab"},onMouseDown:T,onTouchStart:T})})]}),d.jsx("div",{className:"current-value",children:C?parseFloat(a).toFixed(n?0:x.precision):"??"})]}),d.jsx("button",{onClick:E,className:"submit-btn",disabled:k,style:{display:"block",margin:"20px auto 0"},children:"Submit"}),u&&d.jsx("div",{className:`feedback ${u.includes("2 points")?"correct":u.includes("0 points")?"incorrect":"partial"}`,children:u})]})}function gd({taskNum:t,onComplete:e,isPractice:n=!1,currentTaskId:r}){const[s,i]=L.useState(""),[a,l]=L.useState(""),[u,h]=L.useState(null),[p]=L.useState(Date.now()),[y,m]=L.useState(""),[C,R]=L.useState(!1),P=L.useRef(0),O=j=>{const M=document.createElement("canvas"),S=M.getContext("2d");return M.width=600,M.height=150,S.fillStyle="#f5f5f5",S.fillRect(0,0,M.width,M.height),S.font='bold 40px "Courier New", monospace',S.fillStyle="#333",S.textAlign="center",S.textBaseline="middle",S.fillText(j,M.width/2,M.height/2),M.toDataURL()};L.useEffect(()=>{const M=Jn.generateTypingPattern(t).pattern;i(M);const S=O(M);m(S)},[t]),L.useEffect(()=>{l(""),h(null),P.current=0},[t]),L.useEffect(()=>{const j=M=>{const{action:S,text:v,typeSpeed:T}=M.detail;if(S==="autoType"&&v){R(!0),l("");let I="",_=0;const E=setInterval(()=>{_<v.length?(I+=v[_],l(I),_++):(clearInterval(E),R(!1))},T||50);return()=>clearInterval(E)}};return window.addEventListener("aiTypingHelp",j),()=>window.removeEventListener("aiTypingHelp",j)},[]);const k=async()=>{const j=Date.now()-p,M=`g3t${t}`,S=localStorage.getItem(`lastAIHelp_${M}`);if(S){const E=JSON.parse(S),x=Date.now()-E.timestamp,X=a===E.suggestion?"accepted":"modified";await ke.trackAIHelpResponse(M,E.type,E.suggestion,X,a,x),localStorage.removeItem(`lastAIHelp_${M}`)}const T=((E,x)=>{const X=E.length,G=x.length,U=Array(X+1).fill(null).map(()=>Array(G+1).fill(0));for(let B=0;B<=X;B++)U[B][0]=B;for(let B=0;B<=G;B++)U[0][B]=B;for(let B=1;B<=X;B++)for(let N=1;N<=G;N++)E[B-1]===x[N-1]?U[B][N]=U[B-1][N-1]:U[B][N]=Math.min(U[B-1][N]+1,U[B][N-1]+1,U[B-1][N-1]+1);return U[X][G]})(a,s);let I=0;T===0?I=2:T===1?I=1:I=0,P.current+=1,await ke.trackTaskAttempt(M,P.current,!0,j,a,s);const _=localStorage.getItem("sessionId");if(_&&!_.startsWith("offline-"))try{await Gn(cn(it,"sessions",_),{[`taskAccuracies.g3t${t}`]:I===2?100:I===1?70:0,[`taskTimes.g3t${t}`]:j,[`taskPoints.g3t${t}`]:I,lastActivity:hn()})}catch(E){console.error("Error storing accuracy:",E)}h(I===2?" Perfect! 2 points earned!":I===1?" 1 typo - 1 point earned!":` ${T} errors - 0 points earned.`),setTimeout(()=>{e(`g3t${t}`,{attempts:P.current,totalTime:j,accuracy:I===2?100:I===1?70:0,userAnswer:a,correctAnswer:s,points:I})},500)},A=Jn.generateTypingPattern(t),w=A.difficultyLabel,b=A.difficulty;return d.jsxs("div",{className:"task typing",style:{maxWidth:"100%"},children:[d.jsxs("h3",{children:["Student Engagement - Level ",t]}),d.jsx("div",{className:`difficulty-badge ${b}`,children:w}),d.jsx("p",{className:"instruction",children:"Type this pattern exactly:"}),d.jsxs("div",{className:"pattern-display",children:[d.jsx("div",{className:"typing-pattern","data-typing-pattern":s,style:{display:"none"},children:s}),y?d.jsx("img",{src:y,alt:"Pattern to type",style:{width:"100%",maxWidth:"600px",height:"auto",userSelect:"none",pointerEvents:"none"},onContextMenu:j=>j.preventDefault(),draggable:!1}):d.jsx("span",{className:"pattern-text",children:s})]}),d.jsx("div",{className:"input-section",style:{width:"90%",maxWidth:"900px",margin:"20px auto 0"},children:d.jsx("input",{type:"text",inputMode:"text",autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:!1,value:a,onChange:j=>!C&&l(j.target.value),onKeyPress:j=>{j.key==="Enter"&&!C&&(j.preventDefault(),k())},placeholder:"Type here...",className:"typing-input",disabled:C,style:{backgroundColor:C?"#e3f2fd":"white",transition:"background-color 0.3s",width:"100%",maxWidth:"100%",fontFamily:'"Courier New", monospace',fontSize:"28px",padding:"12px 14px",border:"2px solid #e0e0e0",borderRadius:"8px",boxSizing:"border-box"}})}),d.jsx("button",{onClick:k,className:"submit-btn",disabled:C,style:{display:"block",margin:"20px auto 0"},children:"Submit"}),u&&d.jsx("div",{className:`feedback ${u.includes("2 points")?"correct":u.includes("0 points")?"incorrect":"partial"}`,children:u})]})}function dI({current:t,completed:e,onSwitch:n,limitMode:r,taskPoints:s={},categoryMultipliers:i={},starGoals:a={},categoryPoints:l={},timeRemaining:u=null}){const h=()=>{const w=l.materials||0,b=1+(l.research||0)*.15,j=parseFloat(localStorage.getItem("engagementInterest")||"0")||0;return w*b+j},p=parseFloat(localStorage.getItem("engagementInterest")||"0")||0,y=1+(l.research||0)*.15,m=[];for(let w=1;w<=3;w++)for(let b=1;b<=50;b++){const j=["Research","Materials","Engage"][w-1];m.push({id:`g${w}t${b}`,label:`${j} ${b}`,game:w})}const C=w=>{const b=w.id[1],j=parseInt(w.id.substring(3));if(j===1)return!0;const M=`g${b}t${j-1}`;return e[M]===!0},R={2:m.filter(w=>w.game===2),1:m.filter(w=>w.game===1),3:m.filter(w=>w.game===3)},P={1:"#9C27B0",2:"#4CAF50",3:"#f44336"},O={1:"",2:"",3:""},k={1:"Research",2:"Materials",3:"Engagement"},A={1:"research",2:"materials",3:"engagement"};return d.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"25px",boxShadow:"0 2px 10px rgba(0,0,0,0.1)",marginBottom:"20px"},children:[d.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"20px",marginBottom:"25px"},children:[2,1,3].map(w=>{const b=R[w],j=b.filter(_=>e[_.id]).length,M=A[w],S=j+1,v=w==="1"?(l.research||0)*.15:0,T=w==="3"?(l.engagement||0)*.0015:0,I=v>0||T>0;return d.jsxs("div",{style:{background:`linear-gradient(135deg, ${P[w]}10 0%, ${P[w]}05 100%)`,borderRadius:"12px",border:`2px solid ${P[w]}20`,padding:"20px",position:"relative",overflow:"hidden",boxShadow:I?`0 0 20px ${P[w]}20`:"none",transition:"all 0.3s ease"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"15px"},children:[d.jsx("span",{style:{fontSize:"28px"},children:O[w]}),d.jsxs("div",{style:{flex:1},children:[d.jsx("h3",{style:{margin:0,color:P[w],fontSize:"18px",fontWeight:"bold"},children:k[w]}),d.jsxs("div",{style:{fontSize:"12px",color:"#666",marginTop:"2px"},children:["Level ",Math.min(S,15)]})]}),l&&l[M]>0&&d.jsxs("div",{style:{background:P[w],color:"white",padding:"6px 12px",borderRadius:"20px",fontSize:"14px",fontWeight:"bold"},children:[l[M]," pts"]})]}),w==="1"&&(l.research||0)>0&&d.jsxs("div",{style:{position:"absolute",top:"10px",right:"10px",background:"#fff3cd",color:"#856404",padding:"4px 8px",borderRadius:"12px",fontSize:"11px",fontWeight:"bold",border:"1px solid #ffc107"},children:["+",(l.research*15).toFixed(0),"%"]}),w==="3"&&(l.engagement||0)>0&&d.jsxs("div",{style:{position:"absolute",top:"10px",right:"10px",background:"#fff3cd",color:"#856404",padding:"4px 8px",borderRadius:"12px",fontSize:"11px",fontWeight:"bold",border:"1px solid #ffc107"},children:["+",((l.engagement||0)*.15).toFixed(1),"% interest/task"]}),d.jsx("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap"},children:b.filter(_=>parseInt(_.id.substring(3))<=S).map(_=>{const E=C(_),x=e[_.id],X=t===_.id,G=parseInt(_.id.substring(3)),U=s[_.id]||0;return d.jsxs("button",{disabled:!E||x,onClick:()=>E&&!x&&n(_.id),style:{position:"relative",width:"40px",height:"40px",padding:"0",fontSize:"14px",fontWeight:X?"bold":"500",border:`2px solid ${X?P[w]:x?`${P[w]}40`:"#e0e0e0"}`,borderRadius:"8px",background:X?P[w]:x?`${P[w]}10`:"white",color:X?"white":x?P[w]:"#333",cursor:E&&!x?"pointer":"not-allowed",transition:"all 0.2s ease",opacity:x?.7:1,boxShadow:X?`0 2px 8px ${P[w]}40`:"none"},onMouseEnter:B=>{E&&!X&&!x&&(B.currentTarget.style.transform="translateY(-2px)",B.currentTarget.style.boxShadow=`0 4px 12px ${P[w]}30`)},onMouseLeave:B=>{E&&!X&&!x&&(B.currentTarget.style.transform="translateY(0)",B.currentTarget.style.boxShadow="none")},title:x?`Level ${G} completed (${U} pts)`:E?`Start Level ${G}`:`Complete Level ${G-1} first`,children:[G,x&&d.jsx("span",{style:{position:"absolute",top:"-4px",right:"-4px",background:P[w],color:"white",width:"16px",height:"16px",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"10px",fontWeight:"bold"},children:""}),x&&d.jsx("div",{style:{position:"absolute",bottom:"2px",left:"50%",transform:"translateX(-50%)",display:"flex",gap:"2px"},children:U===0?d.jsx("div",{style:{width:"6px",height:"6px",borderRadius:"50%",border:`1px solid ${P[w]}`,background:"transparent"}}):[...Array(Math.min(U,2))].map((B,N)=>d.jsx("div",{style:{width:"4px",height:"4px",borderRadius:"50%",background:P[w]}},N))})]},_.id)})})]},w)})}),d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"20px",background:"#f8f9fa",borderRadius:"8px",flexWrap:"wrap",gap:"20px"},children:[u!==null&&d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[d.jsx("span",{style:{fontSize:"24px"},children:""}),d.jsxs("div",{children:[d.jsxs("div",{style:{fontSize:"24px",fontWeight:"bold",color:u<60?"#f44336":"#333"},children:[Math.floor(u/60),":",(u%60).toString().padStart(2,"0")]}),u<180&&u>0&&d.jsx("div",{style:{fontSize:"11px",color:"#ff9800"},children:"Hurry up!"})]})]}),d.jsxs("div",{style:{textAlign:"center"},children:[d.jsx("div",{style:{fontSize:"12px",color:"#666",marginBottom:"2px"},children:"Tasks Completed"}),d.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#333"},children:Object.keys(e).length})]}),d.jsxs("div",{style:{textAlign:"center"},children:[d.jsx("div",{style:{fontSize:"12px",color:"#666",marginBottom:"2px"},children:"Student Learning"}),d.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#2196F3"},children:Math.round(h())}),d.jsxs("div",{style:{fontSize:"10px",color:"#999"},children:[l.materials||0," (materials)  ",y.toFixed(2)," (research) + ",p.toFixed(1)," (cumulative engagement interest)"]})]}),t&&d.jsxs("div",{style:{padding:"8px 16px",background:t.startsWith("g1")?"#9C27B0":t.startsWith("g2")?"#4CAF50":"#f44336",color:"white",borderRadius:"20px",fontSize:"14px",fontWeight:"bold"},children:["Current:"," ",t.replace("g1t","Research ").replace("g2t","Materials ").replace("g3t","Engage ")]})]})]})}function hI({practiceCompleted:t={},onPracticeComplete:e,onStartMainGame:n,onSelectPractice:r,isAdmin:s=!1}){const[i,a]=L.useState(null),l=(m,C)=>{if(C&&C.points===2){typeof e=="function"&&e(m,C);const R=document.createElement("div");R.className="notification-enter",R.style.cssText="position: fixed; bottom: 20px; left: 20px; background: #4CAF50; color: white; padding: 15px 20px; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); z-index: 10000; max-width: 400px;",R.textContent="Perfect! Practice task completed. Returning to menu...",document.body.appendChild(R),setTimeout(()=>{a(null),document.body.contains(R)&&document.body.removeChild(R)},1500)}else{const R=(C==null?void 0:C.points)||0,P=document.createElement("div");P.className="notification-enter",P.style.cssText="position: fixed; bottom: 20px; left: 20px; background: #ff9800; color: white; padding: 15px 20px; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); z-index: 10000; max-width: 400px;",P.textContent=`Practice requires 100% accuracy. You scored ${R===1?"50%":"0%"}. Try again!`,document.body.appendChild(P),setTimeout(()=>{document.body.contains(P)&&document.body.removeChild(P)},3e3)}},u=t.g2t1&&t.g1t1&&t.g3t1,h=()=>d.jsxs("div",{className:"practice-menu",children:[d.jsxs("h2",{children:["Practice Mode ",!s&&"(Required)"]}),!s&&d.jsxs("div",{style:{background:"linear-gradient(135deg, #fff3cd 0%, #ffebee 100%)",borderRadius:"12px",padding:"16px",marginBottom:"25px",border:"2px solid #f57c00",boxShadow:"0 4px 6px rgba(245, 124, 0, 0.1)",textAlign:"center"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",marginBottom:"8px"},children:[d.jsx("span",{style:{fontSize:"20px"},children:""}),d.jsx("strong",{style:{color:"#e65100",fontSize:"18px"},children:"100% PERFECT ACCURACY REQUIRED"})]}),d.jsxs("div",{style:{color:"#e65100",fontSize:"14px"},children:["You must score 2/2 points (exact answer) on all three practice tasks to proceed.",d.jsx("br",{}),d.jsx("strong",{children:"No partial credit in practice mode!"})]}),d.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"center",marginTop:"12px"},children:[d.jsxs("span",{style:{padding:"4px 12px",background:t.g2t1?"#e8f5e9":"white",borderRadius:"20px",fontSize:"13px",color:t.g2t1?"#4CAF50":"#f57c00",fontWeight:"600",border:`1px solid ${t.g2t1?"#4CAF50":"#ffb74d"}`},children:["Materials ",t.g2t1?"":"Required"]}),d.jsxs("span",{style:{padding:"4px 12px",background:t.g1t1?"#e8f5e9":"white",borderRadius:"20px",fontSize:"13px",color:t.g1t1?"#4CAF50":"#f57c00",fontWeight:"600",border:`1px solid ${t.g1t1?"#4CAF50":"#ffb74d"}`},children:["Research ",t.g1t1?"":"Required"]}),d.jsxs("span",{style:{padding:"4px 12px",background:t.g3t1?"#e8f5e9":"white",borderRadius:"20px",fontSize:"13px",color:t.g3t1?"#4CAF50":"#f57c00",fontWeight:"600",border:`1px solid ${t.g3t1?"#4CAF50":"#ffb74d"}`},children:["Engagement ",t.g3t1?"":"Required"]})]})]}),d.jsx("p",{className:"practice-hint",style:{textAlign:"center",fontSize:"16px",color:"#666",marginBottom:"30px"},children:"Try each task type before starting the main challenge. No time pressure!"}),d.jsxs("div",{className:"practice-cards",children:[d.jsxs("div",{className:"practice-card materials",children:[d.jsx("h3",{children:" Materials"}),d.jsx("p",{children:"Hold and drag slider to match target values"}),d.jsx("p",{style:{fontSize:"13px",color:"#666",marginTop:"10px"},children:"Base points - directly added to score"}),d.jsx("div",{className:"practice-buttons",children:d.jsx("button",{onClick:()=>{a("g2t1"),r&&r("g2t1")},className:t.g2t1?"completed":"",disabled:!1,children:t.g2t1?" Completed":"Try Materials"})})]}),d.jsxs("div",{className:"practice-card research",children:[d.jsx("h3",{children:" Research"}),d.jsx("p",{children:"Count words or letters in text passages"}),d.jsx("p",{style:{fontSize:"13px",color:"#666",marginTop:"10px"},children:"Worth 15% multiplier per point in main game"}),d.jsx("div",{className:"practice-buttons",children:d.jsx("button",{onClick:()=>{a("g1t1"),r&&r("g1t1")},className:t.g1t1?"completed":"",disabled:!1,children:t.g1t1?" Completed":"Try Research"})})]}),d.jsxs("div",{className:"practice-card engagement",children:[d.jsx("h3",{children:" Engagement"}),d.jsx("p",{children:"Type patterns exactly as shown"}),d.jsx("p",{style:{fontSize:"13px",color:"#666",marginTop:"10px"},children:"Worth 0.15% compound interest per point"}),d.jsx("div",{className:"practice-buttons",children:d.jsx("button",{onClick:()=>{a("g3t1"),r&&r("g3t1")},className:t.g3t1?"completed":"",disabled:!1,children:t.g3t1?" Completed":"Try Engagement"})})]})]}),d.jsxs("div",{style:{marginTop:"25px",padding:"15px",background:"#f5f5f5",borderRadius:"8px",textAlign:"center"},children:[d.jsx("h4",{style:{margin:"0 0 10px 0",color:"#333",fontSize:"16px"},children:"Practice Progress:"}),d.jsxs("div",{style:{display:"flex",gap:"10px",justifyContent:"center"},children:[d.jsxs("div",{style:{padding:"8px 15px",background:t.g2t1?"#4CAF50":"#e0e0e0",color:t.g2t1?"white":"#666",borderRadius:"20px",fontSize:"14px"},children:["Materials ",t.g2t1&&""]}),d.jsxs("div",{style:{padding:"8px 15px",background:t.g1t1?"#9C27B0":"#e0e0e0",color:t.g1t1?"white":"#666",borderRadius:"20px",fontSize:"14px"},children:["Research ",t.g1t1&&""]}),d.jsxs("div",{style:{padding:"8px 15px",background:t.g3t1?"#f44336":"#e0e0e0",color:t.g3t1?"white":"#666",borderRadius:"20px",fontSize:"14px"},children:["Engagement ",t.g3t1&&""]})]}),d.jsxs("div",{style:{marginTop:"12px",fontSize:"13px",color:"#666"},children:[d.jsx("strong",{children:"100% accuracy required"})," to complete each practice task"]})]}),d.jsx("div",{style:{textAlign:"center",marginTop:"30px"},children:d.jsx("button",{className:"start-main-game-btn",onClick:n,style:{opacity:!s&&!u?.5:1,cursor:!s&&!u?"not-allowed":"pointer"},disabled:!s&&!u,children:s?"Start Main Game (Admin)":u?"Start Main Game - You're Ready! ":"Complete Practice First"})})]});if(!i)return h();const p=i[1],y=1;return d.jsxs("div",{className:"practice-container",children:[d.jsx("button",{className:"back-to-menu",onClick:()=>a(null),children:" Back to Practice Menu"}),d.jsxs("div",{style:{textAlign:"center",padding:"10px",background:"#fff3cd",borderRadius:"6px",margin:"10px 0",fontSize:"14px",color:"#856404"},children:[d.jsx("strong",{children:"Practice Mode:"})," 100% accuracy required. Will auto-return after completion."]}),d.jsxs("div",{className:"practice-task-wrapper",children:[p==="1"&&d.jsx(pd,{taskNum:y,onComplete:l,isPractice:!0,currentTaskId:i}),p==="2"&&d.jsx(md,{taskNum:y,onComplete:l,isPractice:!0,currentTaskId:i}),p==="3"&&d.jsx(gd,{taskNum:y,onComplete:l,isPractice:!0,currentTaskId:i})]})]})}class fI{constructor(){this.totalAIUsage=0,this.usageCount={materials:0,research:0,engagement:0},this.taskUsageCount={}}getUniversalAttemptNumber(){return this.totalAIUsage}shouldAIBeCorrect(e){let n;return e===1||e===2||e===4||e===5?n=!0:e===3?n=!1:n=Math.random()<.75,n}getTaskUsageCount(e){return this.taskUsageCount[e]||(this.taskUsageCount[e]=0),this.taskUsageCount[e]}incrementTaskUsage(e,n){this.totalAIUsage++,this.usageCount[n]++,this.taskUsageCount[e]||(this.taskUsageCount[e]=0),this.taskUsageCount[e]++}helpWithSlider(e,n){this.incrementTaskUsage(n,"materials");const r=this.getUniversalAttemptNumber();let s;if(this.shouldAIBeCorrect(r))s=e;else if(r===3){const i=Math.random()<.5?-1:1;s=Math.max(0,Math.min(10,e+i))}else if(Math.random()<.5){const i=Math.random()<.5?-1:1;s=Math.max(0,Math.min(10,e+i))}else{const i=(Math.random()<.5?-1:1)*(2+Math.random()*2);s=Math.max(0,Math.min(10,e+i))}return{action:"moveSlider",value:s,animate:!0}}helpWithCounting(e,n,r){this.incrementTaskUsage(r,"research");const s=this.getUniversalAttemptNumber(),i=this.shouldAIBeCorrect(s);return n.length===1||n.includes(" and ")||n.includes(",")?this.helpWithLetterCounting(e,n,s,i):this.helpWithWordCounting(e,n,s,i)}helpWithLetterCounting(e,n,r,s){let i=[];n.includes(" and ")||n.includes(",")?i=n.match(/[a-z]/gi)||[]:i=[n];let a=0;i.forEach(h=>{const p=new RegExp(h,"gi"),y=e.match(p);a+=y?y.length:0});let l=a,u=[...i];if(!s){r===3||Math.random()<.5?l=a+1:l=a+Math.floor(Math.random()*3)+2,l=Math.max(0,l);const p="abcdefghijklmnopqrstuvwxyz".split("").filter(m=>!i.includes(m.toLowerCase())),y=Math.floor(Math.random()*2)+1;for(let m=0;m<y&&p.length>0;m++){const C=Math.floor(Math.random()*p.length);u.push(p[C]),p.splice(C,1)}}return{action:"highlightAndCount",highlightWords:[],suggestedCount:l,animate:!0,isMultiLetter:!0,targetLetters:u}}helpWithWordCounting(e,n,r,s){const i=e.split(/\s+/),a=[];let l=0,u=0;if(i.forEach(h=>{h.replace(/[.,;!?]/g,"").toLowerCase()===n.toLowerCase()&&u++}),s)i.forEach(h=>{h.replace(/[.,;!?]/g,"").toLowerCase()===n.toLowerCase()&&(a.push(h),l++)});else if(r===3){l=u+1,l=Math.max(0,l),i.forEach(p=>{p.replace(/[.,;!?]/g,"").toLowerCase()===n.toLowerCase()&&a.push(p)});const h=i.filter(p=>p.replace(/[.,;!?]/g,"").toLowerCase()!==n.toLowerCase());if(h.length>0&&a.length<l){const p=h[Math.floor(Math.random()*h.length)];a.push(p)}}else{Math.random()<.5?l=u+1:l=u+Math.floor(Math.random()*3)+2,l=Math.max(0,l),i.forEach(p=>{p.replace(/[.,;!?]/g,"").toLowerCase()===n.toLowerCase()&&a.push(p)});const h=i.filter(p=>p.replace(/[.,;!?]/g,"").toLowerCase()!==n.toLowerCase());for(;a.length<l&&h.length>0;){const p=Math.floor(Math.random()*h.length),y=h[p];a.includes(y)||a.push(y),h.splice(p,1)}}return{action:"highlightAndCount",highlightWords:a,suggestedCount:l,animate:!0}}helpWithTyping(e,n){this.incrementTaskUsage(n,"engagement");const r=this.getUniversalAttemptNumber();let s=e;const i={0:["o","O"],o:["0"],O:["0"],1:["l","I","i"],l:["1","I","i"],I:["1","l","i"],i:["1","l","I"],e:["3"],3:["e"],a:["@"],"@":["a"],s:["5","$"],S:["5","$"],5:["s","S"],$:["s","S"],g:["9"],9:["g"],b:["6"],6:["b"],z:["2"],2:["z"],B:["8"],8:["B"]},a=l=>{const u=l.split(""),h=u.map((p,y)=>i[p]?y:-1).filter(p=>p!==-1);if(h.length>0){const p=h[Math.floor(Math.random()*h.length)],y=u[p],m=i[y];m&&m.length>0&&(u[p]=m[Math.floor(Math.random()*m.length)])}else{const p=["transpose","duplicate","missing"],y=p[Math.floor(Math.random()*p.length)],m=Math.floor(Math.random()*u.length);switch(y){case"transpose":m<u.length-1&&([u[m],u[m+1]]=[u[m+1],u[m]]);break;case"duplicate":u.splice(m,0,u[m]);break;case"missing":u.splice(m,1);break}}return u.join("")};if(this.shouldAIBeCorrect(r))s=e;else if(r===3)s=a(e);else if(Math.random()<.5)s=a(e);else{let l=e;const u=Math.floor(Math.random()*3)+2;for(let h=0;h<u;h++)l=a(l);s=l}return{action:"autoType",text:s,typeSpeed:50,perfect:this.shouldAIBeCorrect(r)}}}const Ot=new fI;function pI({bonusPrompts:t=0,currentTask:e="",categoryPoints:n=null,timeRemaining:r=null,calculateStudentLearning:s=()=>0}){const[i,a]=L.useState(!0),[l,u]=L.useState(0),[h,p]=L.useState(!1);L.useEffect(()=>{const E=JSON.parse(sessionStorage.getItem("gameConfig")||"{}");a(E.hasAI!==!1)},[]),L.useEffect(()=>{if(e){const E=Ot.getTaskUsageCount(e)>=1;p(E)}},[e]);const[y,m]=L.useState([{sender:"bot",text:i?"Hello! I'm your AI teaching assistant. You get ONE AI help attempt per task - use it wisely!":"Hello! This is the chat interface. AI assistance is not available for this session."}]),[C,R]=L.useState(""),[P,O]=L.useState(!1),[k,A]=L.useState({materials:0,research:0,engagement:0}),w=L.useRef(null),b=()=>e?e.startsWith("g1")?"research":e.startsWith("g2")?"materials":e.startsWith("g3")?"engagement":null:null,j=(E=null)=>{const x=E||b();if(!x){m(U=>[...U,{sender:"bot",text:"Please start a task first, then I can help you!"}]);return}if(Ot.getTaskUsageCount(e)>=1){m(U=>[...U,{sender:"bot",text:" You've already used AI help for this task. Only 1 AI attempt allowed per task!"}]);return}const G=Date.now();if(G-k[x]<3e3){m(U=>[...U,{sender:"bot",text:"Please wait a moment before requesting help again!"}]);return}switch(A(U=>({...U,[x]:G})),x){case"materials":M();break;case"research":S();break;case"engagement":T();break;default:m(U=>[...U,{sender:"bot",text:"I'm not sure which task you're on. Please try again!"}])}},M=()=>{var U,B;const E=((U=document.querySelector("[data-target-value]"))==null?void 0:U.getAttribute("data-target-value"))||((B=document.querySelector(".target-value"))==null?void 0:B.textContent)||5,x=Ot.helpWithSlider(parseFloat(E),e),X=Ot.getUniversalAttemptNumber(),G=Ot.shouldAIBeCorrect(X);ke.trackAITaskHelp(e,"slider",x.value,G,X),localStorage.setItem(`lastAIHelp_${e}`,JSON.stringify({type:"slider",suggestion:x.value,timestamp:Date.now(),wasCorrect:G})),window.dispatchEvent(new CustomEvent("aiSliderHelp",{detail:x})),u(Ot.totalAIUsage),p(!0),m(N=>[...N,{sender:"bot",text:` Helping with materials...
Suggested value: ${x.value.toFixed(2)}`}])},S=()=>{var X;const E=document.querySelector(".text-to-count"),x=document.querySelector(".count-target");if(E&&x){const G=E.getAttribute("data-counting-text")||"";let U=((X=x.getAttribute("data-pattern"))==null?void 0:X.replace(/['"]/g,"").trim())||"";const B=Ot.helpWithCounting(G,U,e),N=B.suggestedCount;window.dispatchEvent(new CustomEvent("aiCountingHelp",{detail:B}));const F=Ot.getUniversalAttemptNumber(),W=Ot.shouldAIBeCorrect(F);ke.trackAITaskHelp(e,"counting",N,W,F),localStorage.setItem(`lastAIHelp_${e}`,JSON.stringify({type:"counting",suggestion:N,timestamp:Date.now(),wasCorrect:W,highlightedWords:B.highlightWords||[],targetLetters:B.targetLetters||[]})),u(Ot.totalAIUsage),p(!0);const te=B.isMultiLetter?"letters/characters":"words";m(Z=>[...Z,{sender:"bot",text:` Helping with research...
Found ${N} ${te}`}])}},v=()=>{const E=[" CRITICAL STRATEGY: Do tasks in this EXACT order  1 Engagement (builds interest from the start) 2 Research (multiplies future materials) 3 Materials (gets all multipliers). Materials done early = WASTED points!"," MAXIMUM SCORE ORDER: Engagement FIRST  Research SECOND  Materials LAST! Why? Engagement compounds every task, Research only multiplies FUTURE materials. Doing materials early gets ZERO multiplier!"," WARNING: Research multipliers ONLY apply to materials earned AFTER! If you do materials first, you get NO bonus. Always do ALL engagement & research before touching ANY materials!"," PRO TIP: Complete 100% of Engagement tasks first (builds interest early), then 100% of Research (sets up multipliers), THEN do Materials. This order can DOUBLE your score vs doing materials first!"," OPTIMAL PATH: Think of it like this - Engagement = compound interest (starts early), Research = multiplier (affects future only), Materials = base score (save for last). Wrong order = lost points forever!"],x=E[Math.floor(Math.random()*E.length)];m(X=>[...X,{sender:"bot",text:x}]),ke.trackUserAction("planning_help_requested",{response:x,currentTask:e,timestamp:Date.now()})},T=()=>{const E=document.querySelector("[data-typing-pattern]");if(E){const x=E.getAttribute("data-typing-pattern");if(x){const X=Ot.helpWithTyping(x,e),G=Ot.getUniversalAttemptNumber(),U=X.perfect;ke.trackAITaskHelp(e,"typing",X.text,U,G),localStorage.setItem(`lastAIHelp_${e}`,JSON.stringify({type:"typing",suggestion:X.text,timestamp:Date.now(),wasCorrect:U,originalPattern:x})),window.dispatchEvent(new CustomEvent("aiTypingHelp",{detail:X})),u(Ot.totalAIUsage),p(!0),m(B=>[...B,{sender:"bot",text:` Helping with engagement...
Typing: "${X.text.substring(0,30)}${X.text.length>30?"...":""}"`}])}}else m(x=>[...x,{sender:"bot",text:"Please navigate to the engagement tab first!"}])},I=()=>{if(!C.trim())return;if(!i){m(X=>[...X,{sender:"user",text:C},{sender:"bot",text:"AI assistance is not available for this session."}]),R("");return}const E=C.toLowerCase().trim(),x=C;m(X=>[...X,{sender:"user",text:C}]),R(""),O(!0),setTimeout(()=>{let X="",G="general";if(E.includes("help"))if(G="help_request",E.includes("material")||E.includes("slider")){j("materials"),O(!1);return}else if(E.includes("research")||E.includes("count")){j("research"),O(!1);return}else if(E.includes("engagement")||E.includes("typ")){j("engagement"),O(!1);return}else X="Click the help buttons below for task assistance!";else if(E.includes("strategy")||E.includes("plan")||E.includes("order")){G="strategy";const U=[" CRITICAL STRATEGY: Do tasks in this EXACT order  1 Engagement (builds interest from the start) 2 Research (multiplies future materials) 3 Materials (gets all multipliers). Materials done early = WASTED points!"," MAXIMUM SCORE ORDER: Engagement FIRST  Research SECOND  Materials LAST! Why? Engagement compounds every task, Research only multiplies FUTURE materials. Doing materials early gets ZERO multiplier!"," WARNING: Research multipliers ONLY apply to materials earned AFTER! If you do materials first, you get NO bonus. Always do ALL engagement & research before touching ANY materials!"," PRO TIP: Complete 100% of Engagement tasks first (builds interest early), then 100% of Research (sets up multipliers), THEN do Materials. This order can DOUBLE your score vs doing materials first!"," OPTIMAL PATH: Think of it like this - Engagement = compound interest (starts early), Research = multiplier (affects future only), Materials = base score (save for last). Wrong order = lost points forever!"];X=U[Math.floor(Math.random()*U.length)]}else if(E.includes("tip")||E.includes("advice"))G="advice",X="Strategic tip: Do Research tasks first for the multiplier effect, then Materials for base points, finally Engagement for compound interest!";else{const U=["Keep pushing! You're doing great!","Remember: Materials  Research  Engagement = Success!","Focus on accuracy for those 2-point rewards!","The checkpoint at minute 10 can give huge bonuses!","Try the help buttons below for task assistance!"];X=U[Math.floor(Math.random()*U.length)]}ke.trackUserAction("chat_message",{query:x,queryType:G,response:X,currentTask:e,categoryPoints:n,studentLearning:s(),aiUsageCount:Ot.totalAIUsage}),m(U=>[...U,{sender:"bot",text:X}]),O(!1)},800)},_=b();return d.jsxs("div",{className:"chat-container-sidebar",style:{height:"100%",display:"flex",flexDirection:"column"},children:[d.jsxs("div",{className:"chat-header",children:[d.jsx("h3",{children:i?"AI Teaching Assistant":"Chat Interface"}),d.jsx("div",{style:{fontSize:"11px",color:"#888",marginTop:"2px"},children:i?"1 AI help per task (reliability varies)":"AI assistance disabled for this session"}),d.jsxs("div",{style:{marginTop:"10px",padding:"8px",background:"#e3f2fd",borderRadius:"6px",border:"1px solid #2196F3"},children:[d.jsxs("div",{style:{fontSize:"12px",color:"#1976d2",fontWeight:"bold"},children:["Student Learning: ",Math.round(s())," pts"]}),d.jsxs("div",{style:{fontSize:"10px",color:"#666",marginTop:"2px"},children:[n.materials||0," "," ",(1+(n.research||0)*.15).toFixed(2)," + Interest"]})]})]}),d.jsxs("div",{className:"messages-sidebar",children:[y.map((E,x)=>d.jsxs("div",{className:`message ${E.sender}`,children:[d.jsxs("div",{className:"message-sender",children:[E.sender==="user"?"You":i?"AI":"System",":"]}),d.jsx("div",{className:"message-text",children:E.text})]},x)),P&&i&&d.jsxs("div",{className:"message bot",children:[d.jsx("div",{className:"message-sender",children:"AI:"}),d.jsx("div",{className:"message-text typing",children:"..."})]}),d.jsx("div",{ref:w})]}),d.jsxs("div",{className:"chat-input-sidebar",children:[d.jsx("input",{type:"text",placeholder:i?"Ask about strategy and tips here...":"Chat disabled - no AI available",value:C,onChange:E=>R(E.target.value),onKeyPress:E=>E.key==="Enter"&&I(),disabled:!i}),d.jsx("button",{onClick:I,disabled:!C.trim()||!i,children:"Send"})]}),i&&d.jsxs("div",{style:{padding:"15px",borderTop:"1px solid #e0e0e0",background:"#f8f9fa"},children:[d.jsxs("div",{style:{fontSize:"11px",color:"#666",textAlign:"center",marginBottom:"8px",padding:"4px",background:"white",borderRadius:"4px"},children:["AI Usage: ",l," total attempts",h&&d.jsxs("span",{style:{color:"#ff9800",fontWeight:"bold"},children:[" ","| Current task: 1/1 used"]})]}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"8px",marginBottom:"10px"},children:[d.jsxs("div",{style:{gridColumn:"1 / -1",display:"grid",gridTemplateColumns:"1fr 1fr",gap:"8px"},children:[d.jsxs("button",{onClick:()=>j(),disabled:!_||h,style:{padding:"12px",background:h?"#ff9800":_?"#2196F3":"#ccc",color:"white",border:"none",borderRadius:"8px",cursor:_&&!h?"pointer":"not-allowed",fontWeight:"bold",fontSize:"14px",transition:"all 0.2s",display:"flex",alignItems:"center",justifyContent:"center",gap:"6px"},children:[d.jsx("span",{style:{fontSize:"18px"},children:""}),h?"AI Used (1/1)":_?"Help Task":"Start task first"]}),d.jsxs("button",{onClick:v,style:{padding:"12px",background:"#FF9800",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontWeight:"bold",fontSize:"14px",transition:"all 0.2s",display:"flex",alignItems:"center",justifyContent:"center",gap:"6px"},children:[d.jsx("span",{style:{fontSize:"18px"},children:""}),"Help Plan"]})]}),d.jsx("button",{onClick:()=>j("research"),disabled:!e.startsWith("g1")||h,style:{padding:"10px",background:e.startsWith("g1")&&!h?"#9C27B0":h&&e.startsWith("g1")?"#ff9800":"#e0e0e0",color:e.startsWith("g1")||h?"white":"#999",border:"none",borderRadius:"6px",cursor:e.startsWith("g1")&&!h?"pointer":"not-allowed",fontWeight:"bold",fontSize:"12px"},children:" Research"}),d.jsx("button",{onClick:()=>j("materials"),disabled:!e.startsWith("g2")||h,style:{padding:"10px",background:e.startsWith("g2")&&!h?"#4CAF50":h&&e.startsWith("g2")?"#ff9800":"#e0e0e0",color:e.startsWith("g2")||h?"white":"#999",border:"none",borderRadius:"6px",cursor:e.startsWith("g2")&&!h?"pointer":"not-allowed",fontWeight:"bold",fontSize:"12px"},children:" Materials"}),d.jsx("button",{onClick:()=>j("engagement"),disabled:!e.startsWith("g3")||h,style:{padding:"10px",background:e.startsWith("g3")&&!h?"#f44336":h&&e.startsWith("g3")?"#ff9800":"#e0e0e0",color:e.startsWith("g3")||h?"white":"#999",border:"none",borderRadius:"6px",cursor:e.startsWith("g3")&&!h?"pointer":"not-allowed",fontWeight:"bold",fontSize:"12px"},children:" Engage"})]}),d.jsx("div",{style:{fontSize:"11px",color:"#666",textAlign:"center",marginBottom:"8px",padding:"4px",background:"white",borderRadius:"4px"},children:_?d.jsx("span",{style:{color:"#4CAF50"},children:" AI ready to help"}):d.jsx("span",{style:{color:"#999"},children:" Navigate to a task to enable AI help"})})]}),!i&&d.jsxs("div",{style:{padding:"15px",borderTop:"1px solid #e0e0e0",background:"#f5f5f5",textAlign:"center",color:"#666",fontSize:"14px"},children:[d.jsx("div",{style:{marginBottom:"5px"},children:" No AI Assistant"}),d.jsx("div",{style:{fontSize:"12px"},children:"Complete tasks using your own judgment"})]})]})}const kl={generateCode(){const t=Date.now().toString(36),e=Math.random().toString(36).substring(2,8);return`${t}-${e}`.toUpperCase()},async createCode(t={}){return{success:!0,code:this.generateCode(),data:t}},async markCodeAsUsed(t,e){if(!t)return{success:!1,error:"No code provided"};try{const n={code:t,status:"used",usedAt:hn(),sessionId:e,createdAt:hn()};return await ZT(cn(it,"accessCodes",t),n),{success:!0}}catch(n){return console.error("Error marking code as used:",n),{success:!1,error:n.message}}},async checkCodeUsage(t){if(!t)return{used:!1};try{const e=await JT(cn(it,"accessCodes",t));if(e.exists()){const n=e.data();return{used:n.status==="used",sessionId:n.sessionId,usedAt:n.usedAt}}return{used:!1}}catch(e){return console.error("Error checking code usage:",e),{used:!1,error:e.message}}},getCodeFromURL(){const t=new URLSearchParams(window.location.search);return t.get("code")||t.get("c")||null},async verifyQualtricsCode(t){return{valid:!1,reason:"Qualtrics codes not yet supported"}}};function mI({onLoginSuccess:t}){const[e,n]=L.useState(""),[r,s]=L.useState(!1),[i,a]=L.useState(""),[l,u]=L.useState(!1),h={legacy8:/^\d{8}$/,legacy10:/^\d{10}$/,standard:/^30\d{8}$/},p={"ADMIN-MASTER":{role:"master_admin",name:"Master Administrator",hasAI:!1,isMasterInterface:!0},...Array.from({length:10},(w,b)=>({[`ADMIN-TEST${b+1}`]:{role:"test",semesterDuration:72e4,name:`Test User ${b+1}`,hasAI:!0,checkpointSemester2:!0,isTestCode:!0}})).reduce((w,b)=>({...w,...b}),{}),"ADMIN-REGULAR":{role:"admin",semesterDuration:72e4,name:"Admin Regular Mode",hasAI:!0,checkpointSemester2:!0},"ADMIN-FAST":{role:"admin",semesterDuration:12e4,name:"Admin Fast Mode",hasAI:!0,checkpointSemester2:!0},"ADMIN-1-CP":{role:"admin",semesterDuration:12e4,name:"Admin Section 1 WITH Checkpoint",hasAI:!1,checkpointSemester2:!0},"ADMIN-1-NCP":{role:"admin",semesterDuration:12e4,name:"Admin Section 1 NO Checkpoint",hasAI:!1,checkpointSemester2:!1},"ADMIN-2-CP":{role:"admin",semesterDuration:12e4,name:"Admin Section 2 WITH Checkpoint",hasAI:!0,checkpointSemester2:!0},"ADMIN-2-NCP":{role:"admin",semesterDuration:12e4,name:"Admin Section 2 NO Checkpoint",hasAI:!0,checkpointSemester2:!1}},y=["3040748714","3040729812","3040859968","3040852909","3040869211","3040849958","3039838870","15177695","3040849997","3039845630","3040682661","26416809","3039850622","3040869510","3031977170","3040806629","3040848528","3039840443","3040848749","3040849893","3039850830","3039850713"],m=["3040850023","22900589","3039850570","3040882302","3040815651","3040701758","3040852077","3036343361","3040869458","3040705047","3040702343","3039842887","3040848593","3040702603","3039840222","3039840209","3040861190","18565110","3040869302","3040814338","3039754031"],C=["3040705476","3040697715","3039753992","3040729513","3040681595","3040850010","3032682772","3039842484","3040869445","3040814455","3039840781","3040696831","3040705125","3034184066","3039843004","3039842835","3040860072","3040871018","3039839026","3040814429","3040869094","3040748064","3040875945","3040701589","3040682193","3040729422","3040836165","21798975","3038626424","3039753017","3039840287","3040806382"],R=["25958106","3040814351","3040848697","3040684039","3040869289","22971551","3040837218","3040864570","3040705099","3034288430","3040848541","3040864531","3040869237","3032342054","3040682479","3039840170","3032397447","3039850856","3039840118","3040729552","3040683181","3040861073","3031968434","3040882575","3035320237","3040823815","3039842575","24261697","23420611","3032000089","3040882341"],P=[...y,...m,...C,...R],O=w=>{const b=y.includes(w)||m.includes(w),j=C.includes(w)||R.includes(w),M=y.includes(w)||C.includes(w);return{section:b?"01A":j?"02A":"unknown",hasAI:j,checkpointSemester2:M,displayName:`Student ${w} (${b?"01A":"02A"}-${M?"CP":"NCP"})`}},k=w=>{if(p[w])return{valid:!0,type:"master",data:p[w]};for(const[b,j]of Object.entries(h))if(j.test(w)){if(P.includes(w)){const M=O(w);return{valid:!0,type:"student",format:b,condition:M}}return{valid:!1,error:"Student ID not found in registry"}}return{valid:!1,error:"Invalid ID format. Must be 8-10 digit Student ID"}},A=async w=>{if(w.preventDefault(),!e.trim()){a("Please enter your Student ID");return}s(!0),a("");try{const b=k(e.trim());if(!b.valid){a(b.error||"Invalid Student ID"),s(!1);return}let j={timestamp:new Date().toISOString()};if(b.type==="master"){if(j={...j,studentIdentifier:e,role:b.data.role,semesterDuration:b.data.semesterDuration,displayName:b.data.name,section:b.data.isTestCode?"ADMIN-TEST":"ADMIN",hasAI:b.data.hasAI,checkpointSemester2:b.data.checkpointSemester2,isMasterCode:!0,isTestCode:b.data.isTestCode||!1,isMasterInterface:b.data.isMasterInterface||!1},b.data.isMasterInterface){sessionStorage.setItem("gameConfig",JSON.stringify({role:"master_admin",displayName:b.data.name,section:"master_admin",hasAI:!0,checkpointSemester2:!0})),window.location.href=`${window.location.origin}?master=true`;return}}else{const S=b.condition;j={...j,studentIdentifier:e,role:"student",semesterDuration:72e4,displayName:S.displayName,section:S.section,hasAI:S.hasAI,checkpointSemester2:S.checkpointSemester2,isMasterCode:!1}}const M=await kl.createCode(j);M.success?(sessionStorage.setItem("gameConfig",JSON.stringify({semesterDuration:j.semesterDuration,role:j.role,studentId:e,displayName:j.displayName,section:j.section,hasAI:j.hasAI,checkpointSemester2:j.checkpointSemester2})),window.location.href=`${window.location.origin}?code=${M.code}`):a("Failed to generate access code. Please try again.")}catch(b){console.error("Login error:",b),a("System error. Please try again.")}finally{s(!1)}};return d.jsxs("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"#f5f5f5",padding:"20px"},children:[d.jsxs("div",{style:{background:"white",padding:"48px",borderRadius:"16px",boxShadow:"0 20px 40px rgba(0,0,0,0.15)",maxWidth:"480px",width:"100%"},children:[d.jsxs("div",{style:{textAlign:"center",marginBottom:"40px"},children:[d.jsxs("h1",{style:{fontSize:"32px",fontWeight:"700",color:"#1a202c",marginBottom:"8px",lineHeight:"1.2"},children:["Scheduling Challenge:",d.jsx("br",{}),"Can you beat Park?"]}),d.jsx("p",{style:{fontSize:"16px",color:"#718096",marginTop:"12px"},children:"Enter your Student ID to access the game"})]}),d.jsxs("form",{onSubmit:A,children:[d.jsxs("div",{style:{marginBottom:"24px"},children:[d.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#2d3748",fontWeight:"600",fontSize:"14px",textTransform:"uppercase",letterSpacing:"0.025em"},children:"Berkeley Student ID:"}),d.jsx("input",{type:"text",value:e,onChange:w=>n(w.target.value),disabled:r,style:{width:"100%",padding:"14px 16px",fontSize:"16px",border:"2px solid #e2e8f0",borderRadius:"8px",boxSizing:"border-box",fontFamily:"'SF Mono', Monaco, 'Courier New', monospace",transition:"all 0.2s ease",background:"#f7fafc",outline:"none"},onFocus:w=>{w.target.style.borderColor="#2196F3",w.target.style.background="white",w.target.style.boxShadow="0 0 0 3px rgba(33, 150, 243, 0.1)"},onBlur:w=>{w.target.style.borderColor="#e2e8f0",w.target.style.background="#f7fafc",w.target.style.boxShadow="none"}}),d.jsx("div",{style:{marginTop:"8px",fontSize:"13px",color:"#a0aec0",lineHeight:"1.4"},children:"Valid formats: 8 digits or 10 digits (303xxxxxxx)"})]}),i&&d.jsxs("div",{style:{background:"#fed7d7",color:"#c53030",padding:"12px 16px",borderRadius:"8px",marginBottom:"24px",fontSize:"14px",display:"flex",alignItems:"center",border:"1px solid #fc8181"},children:[d.jsx("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"currentColor",style:{marginRight:"8px",flexShrink:0},children:d.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),i]}),d.jsx("button",{type:"submit",disabled:r,style:{width:"100%",padding:"14px 24px",fontSize:"16px",fontWeight:"600",background:r?"#cbd5e0":"#2196F3",color:"white",border:"none",borderRadius:"8px",cursor:r?"not-allowed":"pointer",transition:"all 0.2s ease",boxShadow:r?"none":"0 4px 6px rgba(33, 150, 243, 0.25)",transform:r?"none":"translateY(0)"},onMouseDown:w=>{r||(w.target.style.transform="translateY(2px)",w.target.style.boxShadow="0 2px 4px rgba(33, 150, 243, 0.25)")},onMouseUp:w=>{r||(w.target.style.transform="translateY(0)",w.target.style.boxShadow="0 4px 6px rgba(33, 150, 243, 0.25)")},onMouseOver:w=>{r||(w.target.style.background="#1976D2")},onMouseOut:w=>{r||(w.target.style.background="#2196F3")},children:r?d.jsxs("span",{style:{display:"flex",alignItems:"center",justifyContent:"center"},children:[d.jsxs("svg",{className:"animate-spin",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",style:{marginRight:"8px",animation:"spin 1s linear infinite"},children:[d.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",strokeOpacity:"0.25"}),d.jsx("path",{d:"M4 12a8 8 0 018-8",stroke:"currentColor",strokeWidth:"4",strokeLinecap:"round"})]}),"Verifying Student ID..."]}):"Access Game"})]}),d.jsxs("div",{style:{marginTop:"32px",paddingTop:"24px",borderTop:"1px solid #e2e8f0",textAlign:"center"},children:[d.jsx("p",{style:{fontSize:"14px",color:"#718096",marginBottom:"12px"},children:"Having trouble? Contact your instructor:"}),d.jsxs("p",{style:{fontSize:"16px",color:"#2196F3",fontWeight:"500"},children:["Park Sinchaisri",d.jsx("br",{}),d.jsx("a",{href:"mailto:parksinchaisri@haas.berkeley.edu",style:{color:"#2196F3",textDecoration:"none",borderBottom:"1px solid #2196F3",fontSize:"15px"},children:"parksinchaisri@haas.berkeley.edu"})]}),l&&d.jsxs("div",{style:{marginTop:"12px",padding:"12px",background:"#f7fafc",borderRadius:"8px",fontSize:"11px",color:"#4a5568",lineHeight:"1.8"},children:[d.jsx("strong",{children:"Test Codes:"}),d.jsxs("div",{style:{marginTop:"8px",fontFamily:"monospace"},children:[d.jsx("div",{children:"ADMIN-TEST1 to ADMIN-TEST10 (Test users)"}),d.jsx("div",{children:"ADMIN-1-CP (No AI, With Checkpoint)"}),d.jsx("div",{children:"ADMIN-1-NCP (No AI, No Checkpoint)"}),d.jsx("div",{children:"ADMIN-2-CP (AI, With Checkpoint)"}),d.jsx("div",{children:"ADMIN-2-NCP (AI, No Checkpoint)"}),d.jsx("div",{children:"ADMIN-REGULAR (Original)"}),d.jsx("div",{children:"ADMIN-FAST (2 min test)"}),d.jsx("div",{children:"ADMIN-MASTER (Master interface)"})]})]})]})]}),d.jsx("style",{children:`
          @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
          }
        `})]})}const Lm={async checkDailyLimit(t){var r;if(!t)return{allowed:!0};const e=new Date,n=new Date(e.getFullYear(),e.getMonth(),e.getDate(),0,0,0,0);try{const s=vr(it,"sessions"),i=qa(s,Dm("studentId","==",t),Dm("startTime",">=",n)),a=await qi(i);if(!a.empty){const l=a.docs[0].data(),u=(r=l.startTime)!=null&&r.toDate?l.startTime.toDate():new Date(l.clientStartTime);return{allowed:!1,reason:"daily_limit",existingSession:l,nextAvailable:new Date(n.getTime()+24*60*60*1e3)}}return{allowed:!0}}catch(s){console.error("Error checking daily limit:",s);const i=`played_${t}_${n.toISOString().split("T")[0]}`;return localStorage.getItem(i)?{allowed:!1,reason:"daily_limit",nextAvailable:new Date(n.getTime()+24*60*60*1e3)}:{allowed:!0}}},async markDailyPlay(t){const e=new Date,n=new Date(e.getFullYear(),e.getMonth(),e.getDate(),0,0,0,0),r=`played_${t}_${n.toISOString().split("T")[0]}`;localStorage.setItem(r,"true");const s=new Date(Date.now()-7*24*60*60*1e3);for(let i=0;i<localStorage.length;i++){const a=localStorage.key(i);if(a&&a.startsWith("played_")){const l=a.split("_")[2];l&&new Date(l)<s&&localStorage.removeItem(a)}}},async checkAccess(){try{const t=kl.getCodeFromURL();if(!t)return{allowed:!1,reason:"Please login with your student ID",requiresCode:!0};const e=JSON.parse(sessionStorage.getItem("gameConfig")||"{}"),n=e.role==="admin";if(!n&&e.studentId){const r=await this.checkDailyLimit(e.studentId);if(!r.allowed&&!r.refreshGranted){const i=r.nextAvailable;return{allowed:!1,reason:`You have already completed today's session. Please come back in ${Math.ceil((i-Date.now())/(1e3*60*60))} hours (after midnight).`,dailyLimitReached:!0,nextAvailable:i}}if(sessionStorage.getItem("activeSessionId"))return{allowed:!1,reason:"Page refresh is not allowed during the game. Your session has been terminated.",refreshAttempt:!0}}return e.studentId?(n||await this.markDailyPlay(e.studentId),{allowed:!0,newSession:!0,code:t,codeData:{status:"new",metadata:e},isAdmin:n}):{allowed:!1,reason:"Please login with your Berkeley student ID",requiresCode:!0}}catch(t){console.error("Error in checkAccess:",t);const e=JSON.parse(sessionStorage.getItem("gameConfig")||"{}");return e.role==="admin"?{allowed:!0,newSession:!0,code:kl.getCodeFromURL(),codeData:{status:"error_bypass",metadata:e},isAdmin:!0}:{allowed:!1,reason:"System error. Please try again.",requiresCode:!0}}},async createSession(t=null,e=null,n=!1){try{const r=JSON.parse(sessionStorage.getItem("gameConfig")||"{}"),s=r.role==="admin",i={id:crypto.randomUUID(),accessCode:t,studentId:r.studentId||null,role:r.role||"student",semesterDuration:r.semesterDuration||72e4,displayName:r.displayName||"Student",startTime:hn(),clientStartTime:new Date().toISOString(),status:"active",completedTasks:{},isPractice:n,isAdminSession:s,userAgent:navigator.userAgent,screenResolution:`${window.screen.width}x${window.screen.height}`,section:r.section,hasAI:r.hasAI,checkpointSemester2:r.checkpointSemester2},l=(await Qh(vr(it,"sessions"),i)).id;return localStorage.setItem("sessionId",l),sessionStorage.setItem("activeSessionId",l),s||(window.addEventListener("beforeunload",u=>{u.preventDefault(),u.returnValue="Your progress will be lost if you leave this page.",this.handleSessionAbandonment()}),document.addEventListener("visibilitychange",()=>{!s&&document.hidden&&eventTracker.logEvent("tab_switch",{sessionId:l,timestamp:Date.now(),hidden:!0})})),l}catch(r){console.error("Error creating session:",r);const s=JSON.parse(sessionStorage.getItem("gameConfig")||"{}");if(s.role==="admin"){const i="offline-"+Date.now();localStorage.setItem("sessionId",i),sessionStorage.setItem("activeSessionId",i);const a={id:i,accessCode:t,startTime:Date.now(),status:"active",isOffline:!0,studentId:s.studentId||null,role:s.role||"admin"};return localStorage.setItem("offlineSession",JSON.stringify(a)),i}throw r}},async handleSessionAbandonment(){const t=localStorage.getItem("sessionId");if(t&&!t.startsWith("offline-"))try{await Gn(cn(it,"sessions",t),{status:"abandoned",abandonedAt:hn(),abandonReason:"page_unload"})}catch(e){console.error("Error marking session as abandoned:",e)}sessionStorage.removeItem("activeSessionId"),sessionStorage.removeItem("gameConfig")}};function gI(){const[t,e]=L.useState(""),[n,r]=L.useState(!1),[s,i]=L.useState(""),[a,l]=L.useState(!1),u=async()=>{r(!0),i(""),l(!1);try{const p=await kl.createCode({createdBy:"admin",timestamp:new Date().toISOString()});p.success?e(p.code):i("Failed to generate code: "+p.error)}catch(p){i("Error: "+p.message)}finally{r(!1)}},h=()=>{const p=`${window.location.origin}?code=${t}`;navigator.clipboard.writeText(p),l(!0),setTimeout(()=>l(!1),2e3)};return d.jsxs("div",{style:{padding:"40px",maxWidth:"800px",margin:"0 auto",fontFamily:"system-ui, -apple-system, sans-serif"},children:[d.jsx("h1",{style:{color:"#333",marginBottom:"10px"},children:"Admin Dashboard"}),d.jsx("p",{style:{color:"#666",marginBottom:"30px"},children:"Generate access codes for participants"}),d.jsxs("div",{style:{background:"#f8f9fa",padding:"30px",borderRadius:"8px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:[d.jsx("button",{onClick:u,disabled:n,style:{padding:"12px 30px",fontSize:"16px",background:n?"#ccc":"#4CAF50",color:"white",border:"none",borderRadius:"6px",cursor:n?"not-allowed":"pointer",fontWeight:"bold"},children:n?"Generating...":"Generate New Access Code"}),t&&d.jsxs("div",{style:{marginTop:"30px",padding:"20px",background:"white",borderRadius:"6px",border:"1px solid #e0e0e0"},children:[d.jsx("h3",{style:{margin:"0 0 15px 0",color:"#333"},children:"Generated Code"}),d.jsxs("div",{style:{marginBottom:"20px"},children:[d.jsx("label",{style:{display:"block",marginBottom:"5px",color:"#666",fontSize:"14px"},children:"Access Code:"}),d.jsx("div",{style:{display:"flex",alignItems:"center",gap:"10px",padding:"10px",background:"#f5f5f5",borderRadius:"4px",fontFamily:"monospace",fontSize:"18px",fontWeight:"bold"},children:t})]}),d.jsxs("div",{children:[d.jsx("label",{style:{display:"block",marginBottom:"5px",color:"#666",fontSize:"14px"},children:"Full URL:"}),d.jsxs("div",{style:{display:"flex",gap:"10px",alignItems:"stretch"},children:[d.jsx("input",{type:"text",value:`${window.location.origin}?code=${t}`,readOnly:!0,style:{flex:1,padding:"10px",border:"1px solid #ddd",borderRadius:"4px",fontFamily:"monospace",fontSize:"14px",background:"#f9f9f9"}}),d.jsx("button",{onClick:h,style:{padding:"10px 20px",background:a?"#4CAF50":"#2196F3",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:"bold",whiteSpace:"nowrap"},children:a?" Copied!":"Copy URL"})]})]}),d.jsxs("div",{style:{marginTop:"20px",padding:"15px",background:"#e3f2fd",borderRadius:"4px",fontSize:"14px",color:"#1976d2"},children:[d.jsx("strong",{children:"Note:"})," This code is valid for 24 hours and can only be used once."]})]}),s&&d.jsx("div",{style:{marginTop:"20px",padding:"15px",background:"#ffebee",color:"#c62828",borderRadius:"4px"},children:s})]}),d.jsxs("div",{style:{marginTop:"40px",padding:"20px",background:"#f5f5f5",borderRadius:"6px",fontSize:"14px",color:"#666"},children:[d.jsx("h3",{style:{margin:"0 0 10px 0",color:"#333"},children:"How to use:"}),d.jsxs("ol",{style:{margin:"10px 0",paddingLeft:"20px"},children:[d.jsx("li",{children:"Generate a code using the button above"}),d.jsx("li",{children:"Copy the full URL"}),d.jsx("li",{children:"Share the URL with participants"}),d.jsx("li",{children:"Each participant can use their unique code once"})]})]})]})}function yI({sessionId:t,completedLevels:e,totalTime:n,gameMode:r}){const[s,i]=L.useState(""),[a,l]=L.useState(!1);L.useEffect(()=>{u()},[]);const u=()=>{const p=Date.now().toString(36).toUpperCase(),y=e.toString().padStart(2,"0"),m=r.limit==="time"?"T":"A",C=r.accuracy==="strict"?"S":"L";Math.floor(n/60).toString().padStart(2,"0");const O=`GAME-${`${t}-${y}-${n}`.split("").reduce((k,A)=>k+A.charCodeAt(0),0).toString(36).toUpperCase().slice(-3)}-${y}-${m}${C}-${p}`;i(O)},h=()=>{navigator.clipboard.writeText(s),l(!0),setTimeout(()=>l(!1),3e3)};return d.jsxs("div",{style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",borderRadius:"12px",padding:"30px",marginTop:"30px",color:"white",textAlign:"center",boxShadow:"0 10px 30px rgba(0,0,0,0.2)"},children:[d.jsx("h2",{style:{marginBottom:"20px",fontSize:"24px"},children:" Your Completion Code"}),d.jsx("p",{style:{marginBottom:"20px",opacity:.9,fontSize:"16px"},children:"Copy this code and paste it into the Qualtrics survey to verify your completion:"}),d.jsxs("div",{style:{background:"rgba(255,255,255,0.2)",borderRadius:"8px",padding:"20px",marginBottom:"20px",backdropFilter:"blur(10px)"},children:[d.jsx("div",{style:{fontFamily:"monospace",fontSize:"28px",fontWeight:"bold",letterSpacing:"2px",marginBottom:"15px",wordBreak:"break-all",textShadow:"2px 2px 4px rgba(0,0,0,0.2)"},children:s}),d.jsx("button",{onClick:h,style:{padding:"12px 30px",fontSize:"16px",fontWeight:"bold",background:a?"#4CAF50":"white",color:a?"white":"#764ba2",border:"none",borderRadius:"6px",cursor:"pointer",transition:"all 0.3s",boxShadow:"0 4px 15px rgba(0,0,0,0.2)"},children:a?" Copied!":" Copy Code"})]}),d.jsxs("div",{style:{background:"rgba(255,255,255,0.1)",borderRadius:"6px",padding:"15px",fontSize:"14px",lineHeight:"1.5"},children:[d.jsx("strong",{children:" Important:"})," This code is your proof of completion. Make sure to copy it before closing this window!"]}),d.jsxs("details",{style:{marginTop:"20px",textAlign:"left"},children:[d.jsx("summary",{style:{cursor:"pointer",opacity:.8,fontSize:"12px",marginBottom:"10px"},children:"Code Details "}),d.jsxs("div",{style:{fontSize:"12px",opacity:.7,background:"rgba(0,0,0,0.2)",padding:"10px",borderRadius:"4px",fontFamily:"monospace"},children:[d.jsxs("div",{children:["Levels Completed: ",e,"/45"]}),d.jsxs("div",{children:["Game Mode: ",r.limit==="time"?"Time Challenge":"Task Attempts"]}),d.jsxs("div",{children:["Accuracy Mode: ",r.accuracy==="strict"?"Strict (100%)":"Lenient"]}),d.jsxs("div",{children:["Total Time: ",Math.floor(n/60),"m ",n%60,"s"]}),d.jsxs("div",{children:["Generated: ",new Date().toLocaleString()]})]})]})]})}function vI(){const[t,e]=L.useState([]),[n,r]=L.useState(!0),[s,i]=L.useState(null),[a,l]=L.useState(!1),[u,h]=L.useState(""),p=["3040748714","3040729812","3040859968","3040852909","3040869211","3040849958","3039838870","15177695","3040849997","3039845630","3040682661","26416809","3039850622","3040869510","3031977170","3040806629","3040848528","3039840443","3040848749","3040849893","3039850830","3039850713"],y=["3040850023","22900589","3039850570","3040882302","3040815651","3040701758","3040852077","3036343361","3040869458","3040705047","3040702343","3039842887","3040848593","3040702603","3039840222","3039840209","3040861190","18565110","3040869302","3040814338","3039754031"],m=["3040705476","3040697715","3039753992","3040729513","3040681595","3040850010","3032682772","3039842484","3040869445","3040814455","3039840781","3040696831","3040705125","3034184066","3039843004","3039842835","3040860072","3040871018","3039839026","3040814429","3040869094","3040748064","3040875945","3040701589","3040682193","3040729422","3040836165","21798975","3038626424","3039753017","3039840287","3040806382"],C=["25958106","3040814351","3040848697","3040684039","3040869289","22971551","3040837218","3040864570","3040705099","3034288430","3040848541","3040864531","3040869237","3032342054","3040682479","3039840170","3032397447","3039850856","3039840118","3040729552","3040683181","3040861073","3031968434","3040882575","3035320237","3040823815","3039842575","24261697","23420611","3032000089","3040882341"],R=_=>p.includes(_)?{section:"01A-Checkpoint",hasCheckpoint:!0,isAdmin:!1}:y.includes(_)?{section:"01A-No Checkpoint",hasCheckpoint:!1,isAdmin:!1}:m.includes(_)?{section:"02A-Checkpoint",hasCheckpoint:!0,isAdmin:!1}:C.includes(_)?{section:"02A-No Checkpoint",hasCheckpoint:!1,isAdmin:!1}:_.startsWith("ADMIN-TEST")?{section:"ADMIN-TEST",hasCheckpoint:!0,isAdmin:!0}:_.includes("ADMIN")||_.includes("admin")?{section:"ADMIN",hasCheckpoint:!1,isAdmin:!0}:{section:"Unknown",hasCheckpoint:!1,isAdmin:!1};L.useEffect(()=>{P()},[]);const P=async()=>{r(!0);try{const _=await qi(vr(it,"sessions")),E={};_.forEach(G=>{var B;const U=G.data();if(U.role!=="master_admin"&&U.studentId){const N=R(U.studentId);E[U.studentId]||(E[U.studentId]={studentId:U.studentId,sessions:[],latestAccess:null,totalAccesses:0,displayName:`Student ${U.studentId}`,section:N.section,hasCheckpoint:N.hasCheckpoint,hasPlayed:!0,isAdmin:N.isAdmin}),E[U.studentId].sessions.push({id:G.id,timestamp:(B=U.startTime)!=null&&B.toDate?U.startTime.toDate():new Date(U.clientStartTime),status:U.status,completedTasks:Object.keys(U.completedTasks||{}).length,finalScore:U.finalScore||0,currentSemester:U.currentSemester||1,timeElapsed:U.timeElapsed||U.totalTime||0})}}),Object.values(E).forEach(G=>{var U;G.sessions.sort((B,N)=>N.timestamp-B.timestamp),G.latestAccess=((U=G.sessions[0])==null?void 0:U.timestamp)||null,G.totalAccesses=G.sessions.length});const x=[];[...p,...y,...m,...C].forEach(G=>{if(E[G])x.push(E[G]);else{const U=R(G);x.push({studentId:G,sessions:[],latestAccess:null,totalAccesses:0,displayName:`Student ${G}`,section:U.section,hasCheckpoint:U.hasCheckpoint,hasPlayed:!1,isAdmin:U.isAdmin})}}),x.sort((G,U)=>G.hasPlayed&&!U.hasPlayed?-1:!G.hasPlayed&&U.hasPlayed?1:G.latestAccess&&U.latestAccess?U.latestAccess-G.latestAccess:G.studentId.localeCompare(U.studentId)),e(x)}catch(_){console.error("Error loading student data:",_)}finally{r(!1)}},O=async _=>{l(!0);try{const x=new Date().toISOString().split("T")[0],X=`played_${_}_${x}`;localStorage.removeItem(X),await Qh(vr(it,"accessRefreshes"),{studentId:_,refreshedBy:"MASTER_ADMIN",refreshedAt:hn(),reason:"Manual refresh by admin"}),alert(`Access refreshed for student ${_}. They can now play again today.`),await P()}catch(E){console.error("Error refreshing access:",E),alert(`Failed to refresh access: ${E.message}`)}finally{l(!1)}},k=async()=>{if(confirm(` DANGER: This will permanently delete ALL student sessions, events, and access data.

This action cannot be undone. Are you absolutely sure?`)){l(!0);try{const _=qa(vr(it,"sessions")),E=await qi(_),x=E.docs.map(W=>Zu(W.ref)),X=qa(vr(it,"events")),G=await qi(X),U=G.docs.map(W=>Zu(W.ref)),B=qa(vr(it,"accessRefreshes")),N=await qi(B),F=N.docs.map(W=>Zu(W.ref));Object.keys(localStorage).forEach(W=>{W.startsWith("played_")&&localStorage.removeItem(W)}),await Promise.all([...x,...U,...F]),alert(` All data reset complete!

Deleted:
- ${E.size} sessions
- ${G.size} events
- ${N.size} access refreshes
- All localStorage data`),await P()}catch(_){console.error("Error resetting all data:",_),alert("Failed to reset data. Please check console for details.")}finally{l(!1)}}},A=t.filter(_=>_.studentId.toLowerCase().includes(u.toLowerCase())),w=_=>_?new Intl.DateTimeFormat("en-US",{month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit",hour12:!0}).format(_):"Never",b=_=>!_.sessions||_.sessions.length===0?0:Math.max(..._.sessions.map(E=>E.finalScore||0)),j=_=>!_.sessions||_.sessions.length===0?0:_.sessions.reduce((x,X)=>(X.finalScore||0)>(x.finalScore||0)?X:x,_.sessions[0]).timeElapsed||0,M=_=>{if(!_)return"N/A";const E=Math.floor(_/60),x=_%60;return`${E}:${x.toString().padStart(2,"0")}`},S=t.filter(_=>!_.section.includes("ADMIN")).length,v=t.filter(_=>!_.section.includes("ADMIN")&&_.hasPlayed).length,T=t.filter(_=>!_.section.includes("ADMIN")).reduce((_,E)=>_+E.totalAccesses,0);t.filter(_=>!_.section.includes("ADMIN")&&_.hasPlayed).reduce((_,E)=>_+b(E),0)/(v||1);const I=t.filter(_=>!_.section.includes("ADMIN")&&!_.hasPlayed).length;return d.jsxs("div",{style:{padding:"20px",maxWidth:"1400px",margin:"0 auto"},children:[d.jsx("div",{style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",padding:"30px",borderRadius:"12px",marginBottom:"30px",color:"white"},children:d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[d.jsxs("div",{children:[d.jsx("h1",{style:{margin:"0 0 10px 0"},children:" Master Admin Dashboard"}),d.jsx("p",{style:{margin:0,opacity:.9},children:"Manage student access and view activity logs"})]}),d.jsx("button",{onClick:k,disabled:a,style:{padding:"12px 20px",background:"#f44336",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontWeight:"bold",fontSize:"14px",opacity:a?.6:1},children:a?"Processing...":" Reset All Data"})]})}),d.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"25px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",marginBottom:"30px"},children:[d.jsx("h2",{style:{margin:"0 0 20px 0",color:"#333",fontSize:"20px"},children:" Admin Code Reference"}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(300px, 1fr))",gap:"20px"},children:[d.jsxs("div",{style:{border:"2px solid #4CAF50",borderRadius:"8px",padding:"15px",background:"#f8fff8"},children:[d.jsx("h3",{style:{margin:"0 0 10px 0",color:"#4CAF50",fontSize:"16px"},children:" Test Codes (Internal Use)"}),d.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px"},children:[d.jsxs("li",{children:[d.jsx("code",{children:"ADMIN-TEST1"})," to ",d.jsx("code",{children:"ADMIN-TEST10"})]}),d.jsx("li",{children:"Student-like experience with infinite attempts"}),d.jsx("li",{children:"12-minute duration, AI enabled, checkpoints"}),d.jsx("li",{children:"Data tracked like regular students"})]})]}),d.jsxs("div",{style:{border:"2px solid #2196F3",borderRadius:"8px",padding:"15px",background:"#f8fcff"},children:[d.jsx("h3",{style:{margin:"0 0 10px 0",color:"#2196F3",fontSize:"16px"},children:" Admin Codes (Testing)"}),d.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px"},children:[d.jsxs("li",{children:[d.jsx("code",{children:"ADMIN-REGULAR"})," - Standard 12min, AI enabled"]}),d.jsxs("li",{children:[d.jsx("code",{children:"ADMIN-FAST"})," - Quick 2min test mode"]}),d.jsxs("li",{children:[d.jsx("code",{children:"ADMIN-1-CP"})," - No AI, with checkpoint"]}),d.jsxs("li",{children:[d.jsx("code",{children:"ADMIN-1-NCP"})," - No AI, no checkpoint"]}),d.jsxs("li",{children:[d.jsx("code",{children:"ADMIN-2-CP"})," - AI enabled, with checkpoint"]}),d.jsxs("li",{children:[d.jsx("code",{children:"ADMIN-2-NCP"})," - AI enabled, no checkpoint"]})]})]}),d.jsxs("div",{style:{border:"2px solid #9C27B0",borderRadius:"8px",padding:"15px",background:"#fdf8ff"},children:[d.jsx("h3",{style:{margin:"0 0 10px 0",color:"#9C27B0",fontSize:"16px"},children:" Master Admin"}),d.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px"},children:[d.jsxs("li",{children:[d.jsx("code",{children:"ADMIN-MASTER"})," - Access to this interface"]}),d.jsx("li",{children:"Student data management and analysis"}),d.jsx("li",{children:"Access refresh and data reset capabilities"}),d.jsx("li",{children:"No gameplay, admin interface only"})]})]})]})]}),d.jsxs("div",{style:{background:"white",padding:"20px",borderRadius:"12px",marginBottom:"20px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[d.jsxs("div",{style:{display:"flex",gap:"15px",alignItems:"center"},children:[d.jsx("input",{type:"text",placeholder:"Search by Student ID...",value:u,onChange:_=>h(_.target.value),style:{flex:1,padding:"10px 15px",border:"2px solid #e0e0e0",borderRadius:"8px",fontSize:"14px"}}),d.jsx("button",{onClick:P,disabled:n,style:{padding:"10px 20px",background:"#2196F3",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontWeight:"bold"},children:" Refresh Data"})]}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(5, 1fr)",gap:"15px",marginTop:"20px"},children:[d.jsxs("div",{style:{padding:"15px",background:"#e3f2fd",borderRadius:"8px",textAlign:"center"},children:[d.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#2196F3"},children:S}),d.jsx("div",{style:{fontSize:"12px",color:"#666"},children:"Total Students"})]}),d.jsxs("div",{style:{padding:"15px",background:"#e8f5e9",borderRadius:"8px",textAlign:"center"},children:[d.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#4CAF50"},children:v}),d.jsx("div",{style:{fontSize:"12px",color:"#666"},children:"Have Played"})]}),d.jsxs("div",{style:{padding:"15px",background:"#fff3e0",borderRadius:"8px",textAlign:"center"},children:[d.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#ff9800"},children:T}),d.jsx("div",{style:{fontSize:"12px",color:"#666"},children:"Total Sessions"})]}),d.jsxs("div",{style:{padding:"15px",background:"#fce4ec",borderRadius:"8px",textAlign:"center"},children:[d.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#e91e63"},children:I}),d.jsx("div",{style:{fontSize:"12px",color:"#666"},children:"Never Played"})]}),d.jsxs("div",{style:{padding:"15px",background:"#f3e5f5",borderRadius:"8px",textAlign:"center"},children:[d.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#9c27b0"},children:I}),d.jsx("div",{style:{fontSize:"12px",color:"#666"},children:"Never Played"})]})]})]}),d.jsx("div",{style:{background:"white",borderRadius:"12px",overflow:"hidden",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:d.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[d.jsx("thead",{children:d.jsxs("tr",{style:{background:"#f5f5f5"},children:[d.jsx("th",{style:{padding:"15px",textAlign:"left",fontWeight:"600"},children:"Student ID"}),d.jsx("th",{style:{padding:"15px",textAlign:"left",fontWeight:"600"},children:"Section"}),d.jsx("th",{style:{padding:"15px",textAlign:"center",fontWeight:"600"},children:"Status"}),d.jsx("th",{style:{padding:"15px",textAlign:"center",fontWeight:"600"},children:"Latest Access"}),d.jsx("th",{style:{padding:"15px",textAlign:"center",fontWeight:"600"},children:"Highest Score"}),d.jsx("th",{style:{padding:"15px",textAlign:"center",fontWeight:"600"},children:"Time Taken"}),d.jsx("th",{style:{padding:"15px",textAlign:"center",fontWeight:"600"},children:"Total"}),d.jsx("th",{style:{padding:"15px",textAlign:"center",fontWeight:"600"},children:"Actions"})]})}),d.jsx("tbody",{children:n?d.jsx("tr",{children:d.jsx("td",{colSpan:"8",style:{padding:"40px",textAlign:"center"},children:"Loading student data..."})}):A.length===0?d.jsx("tr",{children:d.jsx("td",{colSpan:"8",style:{padding:"40px",textAlign:"center"},children:"No students found"})}):A.map(_=>{const E=b(_);return d.jsxs("tr",{style:{borderBottom:"1px solid #e0e0e0",background:s===_.studentId?"#f0f8ff":_.hasPlayed?_.isAdmin?"#fff9c4":"white":"#fafafa"},children:[d.jsx("td",{style:{padding:"15px",fontFamily:"monospace"},children:_.studentId}),d.jsx("td",{style:{padding:"15px"},children:d.jsx("span",{style:{padding:"4px 8px",background:_.isAdmin?"#ffeb3b":_.section.includes("01A")?"#e3f2fd":_.section.includes("02A")?"#f3e5f5":"#f5f5f5",borderRadius:"4px",fontSize:"12px",fontWeight:_.isAdmin?"bold":"normal",color:_.isAdmin?"#333":"inherit"},children:_.section})}),d.jsx("td",{style:{padding:"15px",textAlign:"center"},children:_.isAdmin?d.jsx("span",{style:{padding:"4px 8px",background:"#9C27B0",color:"white",borderRadius:"12px",fontSize:"12px",fontWeight:"bold"},children:"Unlimited"}):_.hasPlayed?d.jsx("span",{style:{padding:"4px 8px",background:"#ffeb3b",color:"#f57c00",borderRadius:"12px",fontSize:"12px"},children:"Restricted"}):d.jsx("span",{style:{padding:"4px 8px",background:"#e8f5e9",color:"#2e7d32",borderRadius:"12px",fontSize:"12px"},children:"Active"})}),d.jsx("td",{style:{padding:"15px",textAlign:"center"},children:w(_.latestAccess)}),d.jsx("td",{style:{padding:"15px",textAlign:"center"},children:d.jsx("span",{style:{padding:"4px 8px",background:E>=1e3?"#e8f5e9":E>0?"#fff3e0":"#f5f5f5",color:E>=1e3?"#2e7d32":E>0?"#f57c00":"#999",borderRadius:"12px",fontSize:"12px",fontWeight:"bold"},children:E})}),d.jsx("td",{style:{padding:"15px",textAlign:"center"},children:d.jsx("span",{style:{fontFamily:"monospace",fontSize:"12px",color:"#666",fontWeight:"bold"},children:M(j(_))})}),d.jsx("td",{style:{padding:"15px",textAlign:"center",fontWeight:"bold"},children:_.totalAccesses}),d.jsx("td",{style:{padding:"15px",textAlign:"center"},children:_.isAdmin?d.jsx("span",{style:{color:"#999",fontSize:"12px"},children:"N/A"}):d.jsx("button",{onClick:()=>{i(_.studentId),confirm(`Reset access for Student ${_.studentId} (${_.section})?

This will allow them to play again today.`)&&O(_.studentId)},disabled:a,style:{padding:"6px 12px",background:"#2196F3",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"12px",fontWeight:"bold"},children:" Reset"})})]},_.studentId)})})]})}),d.jsxs("div",{style:{marginTop:"20px",padding:"15px",background:"#f5f5f5",borderRadius:"8px",fontSize:"12px",color:"#666",textAlign:"center"},children:["Access automatically resets at midnight PST. Use refresh button to manually grant access.",d.jsx("br",{}),"Total roster: ",S," students across 4 conditions (01A-Checkpoint, 01A-No Checkpoint, 02A-Checkpoint, 02A-No Checkpoint)"]})]})}function _I(t,e){const n=t.length,r=e.length,s=Array(n+1).fill(null).map(()=>Array(r+1).fill(0));for(let i=0;i<=n;i++)s[i][0]=i;for(let i=0;i<=r;i++)s[0][i]=i;for(let i=1;i<=n;i++)for(let a=1;a<=r;a++)t[i-1]===e[a-1]?s[i][a]=s[i-1][a-1]:s[i][a]=Math.min(s[i-1][a]+1,s[i][a-1]+1,s[i-1][a-1]+1);return s[n][r]}function xI(){const e=new URLSearchParams(window.location.search).get("admin")==="berkeley2024",[n,r]=L.useState("landing"),[s,i]=L.useState(null),[a,l]=L.useState(null),[u,h]=L.useState("g2t1"),[p,y]=L.useState({}),[m,C]=L.useState(0),[R,P]=L.useState(null),[O,k]=L.useState(!1),[A,w]=L.useState(""),[b,j]=L.useState(!0),[M,S]=L.useState(0),[v,T]=L.useState({}),[I,_]=L.useState(0),[E,x]=L.useState(0),[X,G]=L.useState(!1),[U,B]=L.useState(null),[N,F]=L.useState(!1),[W,te]=L.useState(30),[Z,oe]=L.useState(!1),[Ae,me]=L.useState(5),[he,de]=L.useState(!1),[Oe,Se]=L.useState(0),[re,Re]=L.useState(1),[qe]=L.useState(2),[Pe,xt]=L.useState([]),[qt,Gt]=L.useState(null),[Qt,Kt]=L.useState(!1),[Yt,ar]=L.useState(0),[kn,lr]=L.useState(null),[$e,yi]=L.useState({g2t1:!1,g1t1:!1,g3t1:!1}),[Go,lt]=L.useState(1200),[et,$r]=L.useState(1200),[au,Qo]=L.useState(0),[Ee,Rn]=L.useState({materials:0,research:0,engagement:0,bonus:0}),[Wr,vs]=L.useState({}),[Ko,Yo]=L.useState({}),[lu,_s]=L.useState({}),xs=L.useRef(Date.now()),ur=L.useRef(null);L.useRef(null);const yn=L.useRef(null),Lt=L.useRef(null),Fn=L.useRef(Date.now());if(L.useRef(1200),L.useRef(1200),L.useEffect(()=>{Xo()},[]),L.useEffect(()=>{const q=JSON.parse(sessionStorage.getItem("gameConfig")||"{}"),K=q.role==="admin";if(K)return;const Q=()=>{N&&(F(!1),te(30),yn.current&&(clearInterval(yn.current),yn.current=null))},se=()=>{},_e=()=>{Fn.current=Date.now(),Z&&(oe(!1),me(5),Lt.current&&(clearInterval(Lt.current),Lt.current=null))};let Ge;K||(Ge=setInterval(()=>{if(n==="challenge"&&!K&&Date.now()-Fn.current>6e4&&!Z){oe(!0);let rt=5;Lt.current=setInterval(()=>{if(rt--,me(rt),rt<=0){de(!0),clearInterval(Lt.current),ke.logEvent("game_blocked",{reason:"idle",timestamp:Date.now(),studentId:q.studentId,section:q.section});const Pt=localStorage.getItem("sessionId");Pt&&!Pt.startsWith("offline-")&&Gn(cn(it,"sessions",Pt),{status:"blocked",blockedAt:hn(),blockReason:"idle"})}},1e3)}},3e4));const nt=Me=>{!K&&n==="challenge"&&(Me.preventDefault(),Me.returnValue=" WARNING: If you leave this page, you CANNOT return to complete your session. Your progress will be permanently lost.",ke.logEvent("refresh_attempt",{timestamp:Date.now(),studentId:q.studentId,currentMode:n}))};return window.addEventListener("focus",Q),window.addEventListener("blur",se),window.addEventListener("mousemove",_e),window.addEventListener("keypress",_e),window.addEventListener("click",_e),window.addEventListener("beforeunload",nt),()=>{window.removeEventListener("focus",Q),window.removeEventListener("blur",se),window.removeEventListener("mousemove",_e),window.removeEventListener("keypress",_e),window.removeEventListener("click",_e),window.removeEventListener("beforeunload",nt),Ge&&clearInterval(Ge),yn.current&&clearInterval(yn.current),Lt.current&&clearInterval(Lt.current)}},[n]),window.location.search.includes("master=true")&&JSON.parse(sessionStorage.getItem("gameConfig")||"{}").role==="master_admin")return d.jsx(vI,{});if(window.location.search.includes("admin=true"))return d.jsx(gI,{});const Rt=(q=Ee,K=Wr)=>{let Q=0;Object.entries(K).forEach(([Me,rt])=>{const Bn=1+parseInt(Me)*.15;Q+=rt*Bn});const se=parseFloat(localStorage.getItem("engagementInterest")||"0")||0,_e=Q+se,Ge=q.materials||0,nt=q.research||0;return console.log(` STUDENT LEARNING: ${_e.toFixed(1)} pts | Materials: ${Ge} (with sequential multipliers) | Research: ${nt} | Interest: ${se.toFixed(1)} = ${_e.toFixed(1)}`),isNaN(_e)?0:_e},Xo=async()=>{try{const q=new URLSearchParams(window.location.search),K=q.has("code")||q.has("c");if(e&&!sessionStorage.getItem("gameConfig")&&sessionStorage.setItem("gameConfig",JSON.stringify({role:"admin",section:"admin",hasAI:!0,checkpointSemester2:!0,displayName:"Admin User"})),!K){r("studentLogin"),j(!1);return}const{allowed:Q,reason:se,resumeSession:_e,newSession:Ge,code:nt,codeData:Me}=await Lm.checkAccess();if(!Q){k(!0),w(se),j(!1);return}if(_e)P(_e),localStorage.setItem("sessionId",_e);else if(Ge){const rt=await Lm.createSession(nt,Me);P(rt)}await ke.syncOfflineEvents(),j(!1)}catch{j(!1)}},ws=()=>{const q=JSON.parse(sessionStorage.getItem("gameConfig")||"{}");if(!(re===2&&q.checkpointSemester2))return;Kt(!0),Rt()>=300?(ar(300),Rn(_e=>({..._e,bonus:(_e.bonus||0)+300}))):ar(0),G(!0),B("checkpoint")},vi=()=>{const q=JSON.parse(sessionStorage.getItem("gameConfig")||"{}"),K=q.semesterDuration||12e5,Q=Math.floor(K/1e3);lt(Q),$r(Q),xs.current=Date.now(),ur.current=setInterval(()=>{const _e=Date.now()-xs.current,Ge=Math.floor(_e/1e3);S(Ge);const nt=Math.max(0,Q-Ge);if($r(nt),re===2&&q.checkpointSemester2){const rt=q.role==="admin"&&q.semesterDuration===12e4?60:360;Ge===rt&&!Qt&&ws()}nt<=0&&(clearInterval(ur.current),ur.current=null,Hr("semester_complete"))},1e3)},cr=q=>{const Q=JSON.parse(sessionStorage.getItem("gameConfig")||"{}").role==="admin",se=$e.g2t1&&$e.g1t1&&$e.g3t1;l(q),ke.logEvent("practice_choice",{choice:q}),q==="no"?!Q&&!se?(an("You must complete all three practice tasks first!"),r("practice")):_i():r("practice")},_i=()=>{if(!qt){const q=Math.floor(Math.random()*1e6);Gt(q),Jn.initializeSeed(q),R&&!R.startsWith("offline-")&&Gn(cn(it,"sessions",R),{randomSeed:q,[`semesterSeeds.semester${re}`]:q})}localStorage.setItem("engagementInterest","0"),Rn({materials:0,research:0,engagement:0,bonus:0}),vs({}),r("challenge"),y({}),C(0),_(0),x(0),h("g2t1"),Kt(!1),Yo({}),_s({}),vi(),T({g2t1:Date.now()}),ke.setPageStartTime("g2t1"),ke.logEvent("game_start",{practiceCompleted:a==="yes",timestamp:Date.now(),gameMode:s,currentSemester:re,totalSemesters:qe,isAdminMode:e})},tt=async(q,K)=>{Fn.current=Date.now();let Q=0;const se=q.startsWith("g1")?"research":q.startsWith("g2")?"materials":"engagement";if(se==="materials")if(K.points!==void 0)Q=K.points;else{const le=parseFloat(K.userAnswer||K.userValue||0),Ye=parseFloat(K.correctAnswer||K.targetValue||0),bt=Math.abs(le-Ye);bt===0?Q=2:bt<=1?Q=1:Q=0}else if(se==="research")if(K.points!==void 0)Q=K.points;else{const le=parseInt(K.userAnswer||0),Ye=parseInt(K.correctAnswer||0),bt=Math.abs(le-Ye);bt===0?Q=2:bt<=1?Q=1:Q=0}else if(se==="engagement")if(K.points!==void 0)Q=K.points;else{const le=K.userAnswer||"",Ye=K.correctAnswer||"";le===Ye?Q=2:_I(le,Ye)===1?Q=1:Q=0}if(Rn(le=>{const Ye={...le,[se]:le[se]+Q};return console.log(` Updated ${se}: +${Q} (total: ${Ye[se]})`),Ye}),se==="materials"&&Q>0){const le=Ee.research;vs(Ye=>{const bt=Ye[le]||0;return{...Ye,[le]:bt+Q}})}const Ge=.0015*(se==="engagement"?Ee.engagement+Q:Ee.engagement),nt={...Ee,[se]:Ee[se]+Q};let Me=Wr;if(se==="materials"&&Q>0){const le=Ee.research,Ye=Wr[le]||0;Me={...Wr,[le]:Ye+Q}}let rt=0;Object.entries(Me).forEach(([le,Ye])=>{const Un=1+parseInt(le)*.15;rt+=Ye*Un});const Bn=parseFloat(localStorage.getItem("engagementInterest")||"0")+Ge*rt;localStorage.setItem("engagementInterest",Bn.toString()),_s(le=>({...le,[q]:Q})),Yo(le=>({...le,[q]:(le[q]||0)+1}));const wi={...Ee,[se]:Ee[se]+Q},Ss=Rt(wi,Me);Qo(Ss);let Xt="";if(se==="materials"){const le=Math.abs((K.userValue||0)-(K.targetValue||0));le===0?Xt="Perfect materials!":le<=1?Xt=`Off by ${le.toFixed(2)}`:Xt=`Off by ${le.toFixed(2)}`}else if(se==="research"){const le=Math.abs((K.userAnswer||0)-(K.correctAnswer||0));le===0?Xt="Perfect research!":le<=1?Xt=`Off by ${le}`:Xt=`Off by ${le}`}else se==="engagement"&&(Q===2?Xt="Perfect engagement!":Q===1?Xt="One typo":Xt="Multiple errors");if(an(`${Xt} | +${Q} ${se} pts`),y(le=>({...le,[q]:!0})),C(le=>le+1),x(le=>le+1),await ke.trackTaskComplete(q,K.attempts,K.totalTime,K.accuracy||K.difference||0),await ke.logEvent("task_complete",{taskId:q,...K,pointsEarned:Q,categoryPoints:nt,studentLearningScore:Ss,engagementInterest:Bn,completionContext:{totalTasksCompleted:Object.keys(p).length+1,currentGameTime:M,switchesBeforeCompletion:I,bonusPromptsEarned:E+1,timeRemaining:et}}),R&&!R.startsWith("offline-")&&await Gn(cn(it,"sessions",R),{[`completedTasks.${q}`]:!0,[`taskPoints.${q}`]:Q,categoryPoints:nt,studentLearningScore:Ss,engagementInterest:Bn,bonusPrompts:E+1,lastActivity:hn()}),u!==q)return;const cu=q[1],qr=parseInt(q.substring(3));if(qr<50){const le=`g${cu}t${qr+1}`;p[le]||xi(le,!0)}},xi=async(q,K=!1)=>{if(!X){if(p[q]&&!K){an("Task already completed! Choose a different task.");return}if(K||await ke.logEvent("manual_tab_switch",{from:u,to:q,reason:"user_clicked"}),Fn.current=Date.now(),Z&&(oe(!1),me(5),Lt.current&&(clearInterval(Lt.current),Lt.current=null)),u!==q&&!K&&_(Q=>Q+1),await ke.trackPageSwitch(u,q,K),v[u]){const Q=Date.now()-v[u];await ke.logEvent("task_time",{taskId:u,timeSpent:Q,completed:p[u]||!1,leftForTask:q})}h(q),T(Q=>({...Q,[q]:Date.now()})),ke.setPageStartTime(q)}},an=q=>{const K=document.createElement("div");K.className="notification-enter",K.style.cssText="position: fixed; bottom: 20px; left: 20px; background: #2196F3; color: white; padding: 15px 20px; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); z-index: 10000; max-width: 400px;",K.textContent=q,document.body.appendChild(K),setTimeout(()=>{K.className="notification-exit",setTimeout(()=>{document.body.contains(K)&&document.body.removeChild(K)},500)},3e3)},Hr=async(q="semester_complete")=>{ur.current&&clearInterval(ur.current);const K=Math.floor((Date.now()-xs.current-Oe)/1e3),Q=Rt(),se=Ee.bonus||0,_e=Math.round(Q)+se;await ke.logEvent("game_complete",{totalTime:K,totalSwitches:I,completedTasks:Object.keys(p).length,completedLevels:m,completionReason:q,gameMode:s,currentSemester:re,categoryPoints:Ee,studentLearningScore:Q,totalBonus:se,finalScore:_e,finalContext:{practiceCompleted:a==="yes",totalPrompts:3+E,isAdminMode:e}}),R&&!R.startsWith("offline-")&&await Gn(cn(it,"sessions",R),{status:"completed",completedAt:hn(),finalTime:K,totalSwitches:I,completionReason:q,currentSemester:re,finalScore:_e,studentLearningScore:Q}),r("complete")},zn=(q,K)=>{if(K&&K.points&&K.points===2)yi(Q=>({...Q,[q]:!0})),an("Perfect! Practice task completed."),setTimeout(()=>{lr(null)},1500);else{const Q=(K==null?void 0:K.points)||0;an(`Practice requires 100% accuracy. You scored ${Q===1?"50%":"0%"}. Try again!`),setTimeout(()=>{lr(null)},2e3)}},uu=()=>{const q=u[1],K=parseInt(u.substring(3)),Q=n==="practice";return q==="1"?d.jsx(pd,{taskNum:K,onComplete:Q?zn:tt,currentTaskId:u,isPractice:Q}):q==="2"?d.jsx(md,{taskNum:K,onComplete:Q?zn:tt,currentTaskId:u,isPractice:Q}):d.jsx(gd,{taskNum:K,onComplete:Q?zn:tt,currentTaskId:u,isPractice:Q})};if(b)return d.jsx("div",{className:"app",style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:d.jsx("h2",{children:"Loading..."})});if(n==="studentLogin")return d.jsx(mI,{onLoginSuccess:q=>{window.location.href=`${window.location.origin}?code=${q}`}});if(O)return d.jsx("div",{className:"app",children:d.jsxs("div",{style:{maxWidth:"600px",margin:"50px auto",padding:"30px",background:"white",borderRadius:"12px",boxShadow:"0 4px 6px rgba(0,0,0,0.1)"},children:[d.jsx("h2",{style:{color:"#f44336",marginBottom:"20px"},children:"Access Denied"}),d.jsx("p",{style:{fontSize:"18px",marginBottom:"20px"},children:A}),d.jsx("div",{style:{padding:"15px",background:"#ffebee",borderRadius:"8px",border:"1px solid #f44336"},children:d.jsx("p",{style:{color:"#c62828",margin:0},children:"If you believe this is an error, please contact your instructor."})})]})});if(n==="semesterBreak"){const q=JSON.parse(sessionStorage.getItem("gameConfig")||"{}"),K=re===2&&q.checkpointSemester2;return d.jsx("div",{className:"app",children:d.jsxs("div",{style:{maxWidth:"700px",margin:"50px auto",padding:"40px",background:"white",borderRadius:"12px",boxShadow:"0 4px 20px rgba(0,0,0,0.1)",textAlign:"center"},children:[d.jsxs("h1",{style:{color:"#2196F3",marginBottom:"30px"},children:[" Semester ",re-1," Complete!"]}),d.jsxs("div",{style:{background:"#e3f2fd",padding:"20px",borderRadius:"8px",marginBottom:"30px",border:"2px solid #2196F3"},children:[d.jsx("h3",{style:{color:"#1976d2",marginBottom:"10px"},children:"Take a Break!"}),d.jsxs("p",{style:{fontSize:"16px",color:"#666",marginBottom:"0"},children:["Great job completing Semester ",re-1,"! Take a moment to rest your eyes, stretch, or grab some water before continuing."]})]}),K&&d.jsxs("div",{style:{background:"linear-gradient(135deg, #fff3cd 0%, #ffebee 100%)",padding:"25px",borderRadius:"8px",marginBottom:"30px",border:"2px solid #ff9800"},children:[d.jsx("h3",{style:{color:"#f57c00",marginBottom:"15px"},children:" Midterm Checkpoint Coming!"}),d.jsxs("div",{style:{fontSize:"16px",color:"#666",textAlign:"left"},children:[d.jsx("p",{style:{marginBottom:"10px"},children:d.jsx("strong",{children:"Semester 2 includes a midterm exam at the 6-minute mark!"})}),d.jsxs("ul",{style:{marginLeft:"20px",marginBottom:"10px"},children:[d.jsx("li",{children:"Your students will be tested at the midpoint"}),d.jsxs("li",{children:["If student learning  300 points:"," ",d.jsx("strong",{children:"+300 bonus points!"})]}),d.jsx("li",{children:"Build up your teaching effectiveness early to maximize the bonus"})]}),d.jsx("p",{style:{background:"white",padding:"10px",borderRadius:"4px",textAlign:"center",fontWeight:"bold",color:"#f57c00"},children:"Goal: Reach 50+ Student Learning by minute 10"})]})]}),Pe.length>0&&d.jsxs("div",{style:{background:"#f5f5f5",padding:"20px",borderRadius:"8px",marginBottom:"30px"},children:[d.jsx("h4",{style:{color:"#666",marginBottom:"10px"},children:"Your Performance So Far:"}),Pe.map((Q,se)=>d.jsxs("div",{style:{marginBottom:"8px",fontSize:"16px"},children:["Semester ",se+1,":"," ",d.jsxs("strong",{children:[Q.finalScore," points"]})]},se))]}),d.jsxs("div",{style:{marginTop:"30px"},children:[d.jsxs("button",{onClick:()=>{r("challenge"),vi(),T({g2t1:Date.now()}),ke.setPageStartTime("g2t1"),ke.logEvent("semester_start",{semester:re,timestamp:Date.now(),hasCheckpoint:K})},style:{padding:"15px 40px",background:"#4CAF50",color:"white",border:"none",borderRadius:"8px",fontSize:"18px",fontWeight:"bold",cursor:"pointer",boxShadow:"0 4px 6px rgba(0,0,0,0.1)",transition:"all 0.3s"},onMouseOver:Q=>{Q.currentTarget.style.transform="translateY(-2px)",Q.currentTarget.style.boxShadow="0 6px 12px rgba(0,0,0,0.15)"},onMouseOut:Q=>{Q.currentTarget.style.transform="translateY(0)",Q.currentTarget.style.boxShadow="0 4px 6px rgba(0,0,0,0.1)"},children:["I'm Ready - Start Semester ",re]}),d.jsx("p",{style:{marginTop:"15px",fontSize:"14px",color:"#999"},children:"Click when you're ready to continue. The timer will start immediately."})]})]})})}if(n==="landing"){s||i({accuracy:"lenient",limit:"time"});const q=JSON.parse(sessionStorage.getItem("gameConfig")||"{}"),K=q.role==="admin";return d.jsx("div",{className:"app",children:d.jsx("div",{className:"landing-container",children:d.jsxs("div",{className:"landing-card",style:{padding:"40px",maxWidth:"900px"},children:[d.jsxs("h1",{style:{color:"#333",marginBottom:"30px",fontSize:"32px",textAlign:"left"},children:["Can you beat Park? - Semester ",re,"/",qe]}),d.jsxs("div",{className:"game-info",style:{textAlign:"left"},children:[d.jsxs("div",{style:{marginBottom:"35px",textAlign:"left"},children:[d.jsxs("h3",{style:{color:"#f44336",fontSize:"20px",marginBottom:"12px",display:"flex",alignItems:"center",gap:"10px"},children:[d.jsx("span",{style:{fontSize:"24px"},children:""})," Engagement"]}),d.jsx("p",{style:{marginLeft:"34px",fontSize:"16px",lineHeight:"1.6",color:"#555"},children:"Build interest that compounds! Each point adds 0.15% interest after every task completion."})]}),d.jsxs("div",{style:{marginBottom:"35px",textAlign:"left"},children:[d.jsxs("h3",{style:{color:"#9C27B0",fontSize:"20px",marginBottom:"12px",display:"flex",alignItems:"center",gap:"10px"},children:[d.jsx("span",{style:{fontSize:"24px"},children:""})," Research"]}),d.jsx("p",{style:{marginLeft:"34px",fontSize:"16px",lineHeight:"1.6",color:"#555"},children:"Research amplifies your FUTURE materials! Each point adds +15% multiplier to materials earned after the research (order matters!)."})]}),d.jsxs("div",{style:{marginBottom:"35px",textAlign:"left"},children:[d.jsxs("h3",{style:{color:"#4CAF50",fontSize:"20px",marginBottom:"12px",display:"flex",alignItems:"center",gap:"10px"},children:[d.jsx("span",{style:{fontSize:"24px"},children:""})," Materials"]}),d.jsx("p",{style:{marginLeft:"34px",fontSize:"16px",lineHeight:"1.6",color:"#555"},children:"Create teaching materials - each point directly contributes to your goal points!"})]}),d.jsxs("div",{style:{background:"#f0f8ff",borderRadius:"8px",padding:"25px",marginBottom:"30px",border:"2px solid #2196F3"},children:[d.jsxs("h3",{style:{color:"#2196F3",fontSize:"20px",marginBottom:"20px",display:"flex",alignItems:"center",gap:"10px"},children:[d.jsx("span",{style:{fontSize:"24px"},children:""})," Student Learning Formula"]}),d.jsxs("div",{style:{background:"white",padding:"18px",borderRadius:"6px",fontFamily:"monospace",fontSize:"18px",textAlign:"center",marginBottom:"20px",border:"1px solid #e0e0e0",lineHeight:"1.8"},children:["Goal = ",d.jsx("strong",{children:"Materials  (1 + Research0.15) + Engagement Interest"}),d.jsx("br",{}),d.jsxs("div",{style:{fontSize:"14px",marginTop:"10px",fontFamily:"sans-serif"},children:["Research multipliers apply only to materials earned ",d.jsx("em",{children:"after"})," the research"]})]}),d.jsxs("ul",{style:{color:"#333",lineHeight:"2",margin:"0",paddingLeft:"25px",fontSize:"15px",textAlign:"left"},children:[d.jsxs("li",{children:[d.jsx("strong",{children:"Scoring:"})," Exact = 2 pts | Within 1 = 1 pt | Otherwise = 0 pts"]}),d.jsxs("li",{children:[d.jsx("strong",{children:"Timing:"})," Task completion order affects your final score"]}),d.jsxs("li",{children:[d.jsx("strong",{children:"Strategy:"})," Think carefully about when to complete each task type!"]}),re===2&&d.jsxs("li",{children:["At minute ",K?"1":"10",": Exam checkpoint with bonus opportunity (300+ Student Learning = 300 bonus)"]})]})]}),q.hasAI&&d.jsxs("div",{style:{background:"#fff3cd",borderRadius:"6px",padding:"15px",marginBottom:"20px",border:"1px solid #ffc107"},children:[d.jsx("h3",{style:{color:"#856404",fontSize:"16px",marginBottom:"10px"},children:"AI Assistant Available:"}),d.jsxs("ul",{style:{color:"#856404",lineHeight:"1.6",margin:"0",paddingLeft:"20px",fontSize:"14px"},children:[d.jsx("li",{children:"Click the help buttons below each task for AI assistance"}),d.jsx("li",{children:"Unlimited use but reliability varies"}),d.jsx("li",{children:'Type "strategy" or "order" in chat for strategic advice!'})]})]}),re===2&&d.jsxs("div",{style:{background:"#fff3cd",borderRadius:"6px",padding:"15px",marginBottom:"20px",border:"2px solid #ffc107"},children:[d.jsx("h3",{style:{color:"#856404",fontSize:"16px",marginBottom:"10px"},children:" Semester 2: Midterm Checkpoint!"}),d.jsx("p",{style:{color:"#856404",fontSize:"14px",margin:0},children:"At the 10-minute mark, if you have 50+ student learning points, you'll earn a 300-point bonus!"})]})]}),!K&&d.jsxs("div",{style:{background:"linear-gradient(135deg, #ffebee 0%, #ffcdd2 100%)",borderRadius:"12px",padding:"20px",marginTop:"20px",marginBottom:"20px",border:"2px solid #d32f2f",boxShadow:"0 4px 6px rgba(211, 47, 47, 0.1)"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"10px",marginBottom:"12px"},children:[d.jsx("span",{style:{fontSize:"24px"},children:""}),d.jsx("h3",{style:{color:"#b71c1c",margin:0,fontSize:"18px",fontWeight:"600"},children:"ONE ATTEMPT ONLY - NO RESTART"})]}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px",marginBottom:"12px"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[d.jsx("span",{style:{color:"#d32f2f",fontSize:"18px"},children:""}),d.jsxs("span",{style:{fontSize:"14px",color:"#c62828"},children:[d.jsx("strong",{children:"No refresh/close"})," - Session ends"]})]}),d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[d.jsx("span",{style:{color:"#d32f2f",fontSize:"18px"},children:""}),d.jsxs("span",{style:{fontSize:"14px",color:"#c62828"},children:[d.jsx("strong",{children:"No tab switching"})," - 30s warning"]})]})]}),d.jsx("div",{style:{background:"white",padding:"10px",borderRadius:"6px",textAlign:"center",fontSize:"14px",color:"#b71c1c",fontWeight:"600"},children:" Ensure 40 minutes uninterrupted before starting"})]}),d.jsxs("button",{className:"start-button",onClick:()=>r("practiceChoice"),children:["Start Semester ",re]}),e&&d.jsxs("div",{style:{marginTop:"20px",padding:"10px",background:"#ffcccb",borderRadius:"6px",border:"2px solid #ff0000",fontWeight:"bold",color:"#d00"},children:["ADMIN MODE: ",Go/60," minute timer, checkpoint at 1 minute"]}),Pe.length>0&&d.jsxs("div",{style:{marginTop:"20px",padding:"15px",background:"#e3f2fd",borderRadius:"6px",fontSize:"14px"},children:[d.jsx("strong",{children:"Previous Semesters:"}),Pe.map((Q,se)=>d.jsxs("div",{style:{marginTop:"5px"},children:["Semester ",se+1,": ",Q.finalScore," points"]},se))]})]})})})}if(n==="practiceChoice"){const K=JSON.parse(sessionStorage.getItem("gameConfig")||"{}").role==="admin";return d.jsx("div",{className:"app",children:d.jsx("div",{className:"landing-container",children:d.jsxs("div",{className:"landing-card",children:[d.jsx("h2",{style:{color:"#333",marginBottom:"20px"},children:K?"Practice Mode (Optional for Admin)":"Practice Mode (Required)"}),d.jsx("p",{style:{color:"#666",marginBottom:"20px"},children:K?"As an admin, you can skip practice or try it first.":"You must complete all three practice tasks before starting the main game."}),d.jsx("p",{style:{color:"#888",fontSize:"14px",marginBottom:"30px",fontStyle:"italic"},children:"Practice lets you try each teaching task without time pressure."}),!K&&d.jsxs("div",{style:{background:"linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%)",borderRadius:"12px",padding:"20px",marginBottom:"20px",border:"2px solid #1976d2",boxShadow:"0 4px 6px rgba(25, 118, 210, 0.1)"},children:[d.jsxs("h4",{style:{color:"#0d47a1",margin:"0 0 16px 0",fontSize:"18px",fontWeight:"600",display:"flex",alignItems:"center",gap:"8px"},children:[d.jsx("span",{style:{fontSize:"20px"},children:""}),"Required Practice Tasks (100% accuracy needed):"]}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",padding:"12px 16px",background:$e.g2t1?"#e8f5e9":"white",borderRadius:"8px",border:`1px solid ${$e.g2t1?"#4CAF50":"#e0e0e0"}`},children:[d.jsx("span",{style:{fontSize:"24px",marginRight:"12px"},children:""}),d.jsx("span",{style:{flex:1,fontSize:"15px",color:"#424242"},children:d.jsx("strong",{children:"Materials"})}),$e.g2t1?d.jsx("span",{style:{color:"#4CAF50",fontSize:"20px",fontWeight:"bold"},children:""}):d.jsx("span",{style:{background:"#fff3cd",color:"#f57c00",padding:"4px 12px",borderRadius:"12px",fontSize:"12px",fontWeight:"600"},children:"PENDING"})]}),d.jsxs("div",{style:{display:"flex",alignItems:"center",padding:"12px 16px",background:$e.g1t1?"#e8f5e9":"white",borderRadius:"8px",border:`1px solid ${$e.g1t1?"#4CAF50":"#e0e0e0"}`},children:[d.jsx("span",{style:{fontSize:"24px",marginRight:"12px"},children:""}),d.jsx("span",{style:{flex:1,fontSize:"15px",color:"#424242"},children:d.jsx("strong",{children:"Research"})}),$e.g1t1?d.jsx("span",{style:{color:"#4CAF50",fontSize:"20px",fontWeight:"bold"},children:""}):d.jsx("span",{style:{background:"#fff3cd",color:"#f57c00",padding:"4px 12px",borderRadius:"12px",fontSize:"12px",fontWeight:"600"},children:"PENDING"})]}),d.jsxs("div",{style:{display:"flex",alignItems:"center",padding:"12px 16px",background:$e.g3t1?"#e8f5e9":"white",borderRadius:"8px",border:`1px solid ${$e.g3t1?"#4CAF50":"#e0e0e0"}`},children:[d.jsx("span",{style:{fontSize:"24px",marginRight:"12px"},children:""}),d.jsx("span",{style:{flex:1,fontSize:"15px",color:"#424242"},children:d.jsx("strong",{children:"Engagement"})}),$e.g3t1?d.jsx("span",{style:{color:"#4CAF50",fontSize:"20px",fontWeight:"bold"},children:""}):d.jsx("span",{style:{background:"#fff3cd",color:"#f57c00",padding:"4px 12px",borderRadius:"12px",fontSize:"12px",fontWeight:"600"},children:"PENDING"})]})]}),d.jsx("div",{style:{marginTop:"16px",padding:"8px 12px",background:"rgba(255, 255, 255, 0.8)",borderRadius:"6px",fontSize:"13px",color:"#0d47a1",textAlign:"center",fontStyle:"italic"},children:" Each task must be completed perfectly to proceed"})]}),d.jsxs("div",{style:{display:"flex",gap:"20px",justifyContent:"center"},children:[d.jsx("button",{onClick:()=>cr("yes"),style:{padding:"15px 30px",background:"#4CAF50",color:"white",border:"none",borderRadius:"6px",fontSize:"16px",cursor:"pointer"},children:K?"Try Practice Mode":"Start Required Practice"}),K&&d.jsx("button",{onClick:()=>cr("no"),style:{padding:"15px 30px",background:"#2196F3",color:"white",border:"none",borderRadius:"6px",fontSize:"16px",cursor:"pointer"},children:"Skip Practice (Admin)"})]})]})})})}if(n==="practice"){const K=JSON.parse(sessionStorage.getItem("gameConfig")||"{}").role==="admin";if(!kn)return d.jsxs("div",{className:"app",children:[d.jsx("h1",{children:"Teaching Simulation - Practice Mode"}),d.jsx(hI,{practiceCompleted:$e,onPracticeComplete:zn,onSelectPractice:lr,onStartMainGame:()=>{const _e=$e.g2t1&&$e.g1t1&&$e.g3t1;!K&&!_e?an("You must complete all three practice tasks first!"):_i()},isAdmin:K})]});const Q=kn[1],se=1;return d.jsx("div",{className:"app",children:d.jsxs("div",{style:{padding:"20px",maxWidth:"1200px",margin:"0 auto"},children:[d.jsx("button",{onClick:()=>lr(null),style:{marginBottom:"20px",padding:"10px 20px",background:"#666",color:"white",border:"none",borderRadius:"6px",cursor:"pointer"},children:" Back to Practice Menu"}),d.jsxs("div",{style:{textAlign:"center",padding:"10px",background:"#fff3cd",borderRadius:"6px",margin:"10px 0",fontSize:"14px",color:"#856404"},children:[d.jsx("strong",{children:"Practice Mode:"})," 100% accuracy required. Will auto-return after completion."]}),Q==="1"&&d.jsx(pd,{taskNum:se,onComplete:zn,currentTaskId:kn,isPractice:!0}),Q==="2"&&d.jsx(md,{taskNum:se,onComplete:zn,currentTaskId:kn,isPractice:!0}),Q==="3"&&d.jsx(gd,{taskNum:se,onComplete:zn,currentTaskId:kn,isPractice:!0})]})})}if(n==="complete"){const q=Math.floor(M/60),K=M%60,Q=Math.round(Rt()),se=Ee.bonus||0,_e=Q+se,Ge={semester:re,totalTime:M,completedLevels:m,categoryPoints:Ee,switches:I,gameMode:s,randomSeed:qt,studentLearningScore:Q,finalScore:_e},nt=async()=>{const rt=[...Pe,Ge];xt(rt),localStorage.setItem("engagementInterest","0"),Rn({materials:0,research:0,engagement:0,bonus:0}),vs({}),R&&!R.startsWith("offline-")&&await Gn(cn(it,"sessions",R),{[`semesterHistory.semester${re}`]:Ge,currentSemester:re+1,lastActivity:hn()}),Re(re+1),r("semesterBreak"),y({}),C(0),_(0),x(0),S(0),Se(0),h("g2t1"),Kt(!1);const Pt=Math.floor(Math.random()*1e6);Gt(Pt),Jn.initializeSeed(Pt)},Me=re>=qe;return d.jsxs("div",{className:"app",children:[d.jsxs("div",{style:{maxWidth:"800px",margin:"0 auto",padding:"20px"},children:[d.jsx("div",{style:{textAlign:"center",marginBottom:"20px",padding:"15px",background:"#e3f2fd",borderRadius:"8px",border:"2px solid #2196F3"},children:d.jsxs("h2",{style:{color:"#2196F3",margin:0},children:["Semester ",re," of ",qe," Complete!"]})}),Me&&d.jsx(yI,{sessionId:R,completedLevels:m,totalTime:M,gameMode:s}),d.jsxs("div",{style:{textAlign:"center",padding:"40px",background:"white",borderRadius:"12px",boxShadow:"0 2px 10px rgba(0,0,0,0.1)",marginTop:"20px"},children:[d.jsxs("h2",{style:{color:"#333",marginBottom:"20px"},children:[" Semester ",re," Performance"]}),d.jsxs("div",{style:{fontSize:"36px",fontWeight:"bold",color:"#2196F3",marginBottom:"30px"},children:["Final Score: ",_e," points"]}),d.jsxs("div",{style:{background:"#e3f2fd",padding:"20px",borderRadius:"8px",marginBottom:"30px",border:"2px solid #2196F3"},children:[d.jsxs("h3",{style:{margin:"0 0 15px 0",color:"#1976d2"},children:["Student Learning Score: ",Q]}),d.jsxs("div",{style:{fontSize:"16px",color:"#666"},children:["= ",Ee.materials||0," (Materials) "," ",(1+(Ee.research||0)*.15).toFixed(2)," ","(Research)",parseFloat(localStorage.getItem("engagementInterest")||"0")>0&&` + ${parseFloat(localStorage.getItem("engagementInterest")||"0").toFixed(2)} (Interest)`]}),se>0&&d.jsxs("div",{style:{marginTop:"10px",fontSize:"16px",color:"#1976d2"},children:["+ ",se," Checkpoint Bonus"]})]}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(150px, 1fr))",gap:"15px",marginBottom:"30px"},children:[d.jsxs("div",{style:{background:"#f8f9fa",padding:"20px",borderRadius:"8px",border:"2px solid #e0e0e0"},children:[d.jsx("div",{style:{fontSize:"14px",color:"#666",marginBottom:"5px"},children:"Total Time"}),d.jsxs("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#333"},children:[q,"m ",K,"s"]})]}),d.jsxs("div",{style:{background:"#f8f9fa",padding:"20px",borderRadius:"8px",border:"2px solid #e0e0e0"},children:[d.jsx("div",{style:{fontSize:"14px",color:"#666",marginBottom:"5px"},children:"Student Learning"}),d.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#333"},children:Q})]}),(re===2||se>0)&&d.jsxs("div",{style:{background:"#f8f9fa",padding:"20px",borderRadius:"8px",border:"2px solid #e0e0e0"},children:[d.jsx("div",{style:{fontSize:"14px",color:"#666",marginBottom:"5px"},children:"Checkpoint Bonus"}),d.jsxs("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#333"},children:["+",se]})]}),d.jsxs("div",{style:{background:"#f8f9fa",padding:"20px",borderRadius:"8px",border:"2px solid #e0e0e0"},children:[d.jsx("div",{style:{fontSize:"14px",color:"#666",marginBottom:"5px"},children:"Tasks Completed"}),d.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#333"},children:m})]})]}),d.jsx("h3",{style:{color:"#666",marginBottom:"15px"},children:"Teaching Performance by Category"}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"15px",marginBottom:"30px"},children:[d.jsxs("div",{style:{background:"#f0f8f0",padding:"15px",borderRadius:"6px",border:"2px solid #4CAF5020"},children:[d.jsx("div",{style:{color:"#4CAF50",fontWeight:"bold",marginBottom:"5px"},children:" Materials"}),d.jsx("div",{style:{fontSize:"20px",fontWeight:"bold"},children:Ee.materials||0}),d.jsx("div",{style:{fontSize:"12px",color:"#666"},children:"Base points"})]}),d.jsxs("div",{style:{background:"#f8f0ff",padding:"15px",borderRadius:"6px",border:"2px solid #9C27B020"},children:[d.jsx("div",{style:{color:"#9C27B0",fontWeight:"bold",marginBottom:"5px"},children:" Research"}),d.jsx("div",{style:{fontSize:"20px",fontWeight:"bold"},children:Ee.research||0}),d.jsxs("div",{style:{fontSize:"12px",color:"#666"},children:["+",(Ee.research||0)*15,"% to future materials"]})]}),d.jsxs("div",{style:{background:"#fff0f0",padding:"15px",borderRadius:"6px",border:"2px solid #f4433620"},children:[d.jsx("div",{style:{color:"#f44336",fontWeight:"bold",marginBottom:"5px"},children:" Engagement"}),d.jsx("div",{style:{fontSize:"20px",fontWeight:"bold"},children:Ee.engagement||0}),d.jsxs("div",{style:{fontSize:"12px",color:"#666"},children:["+",((Ee.engagement||0)*.15).toFixed(1),"% interest/task"]})]})]})]}),re===2&&Ee.bonus>0&&d.jsxs("div",{style:{marginBottom:"20px",padding:"15px",background:"#fff3cd",borderRadius:"6px",border:"1px solid #ffc107"},children:[d.jsxs("strong",{style:{color:"#856404"},children:[" Exam Season Bonus:"," "]}),d.jsxs("span",{style:{fontSize:"18px",fontWeight:"bold",color:"#856404"},children:["+",Ee.bonus," points"]})]}),Pe.length>0&&d.jsxs("div",{style:{marginTop:"30px",padding:"20px",background:"#f8f9fa",borderRadius:"8px"},children:[d.jsx("h4",{style:{color:"#666",marginBottom:"15px"},children:"Progress Over Semesters"}),d.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(100px, 1fr))",gap:"10px"},children:[...Pe,Ge].map((rt,Pt)=>d.jsxs("div",{style:{padding:"10px",background:Pt===Pe.length?"#e3f2fd":"white",borderRadius:"6px",border:"1px solid #e0e0e0",textAlign:"center"},children:[d.jsxs("div",{style:{fontSize:"12px",color:"#666"},children:["Semester ",Pt+1]}),d.jsx("div",{style:{fontSize:"18px",fontWeight:"bold",color:"#333"},children:rt.finalScore})]},Pt))})]})]}),d.jsx("div",{style:{marginTop:"30px",textAlign:"center"},children:Me?d.jsxs("div",{style:{padding:"20px",background:"#fff3cd",border:"2px solid #ffc107",borderRadius:"8px",textAlign:"center"},children:[d.jsx("h3",{style:{color:"#856404",marginBottom:"10px"},children:" All semesters complete!"}),d.jsx("p",{style:{color:"#856404",marginBottom:"0"},children:"Return to the Qualtrics survey and enter your completion code to finish the study."})]}):d.jsxs("button",{onClick:nt,style:{padding:"15px 40px",background:"#4CAF50",color:"white",border:"none",borderRadius:"8px",fontSize:"18px",fontWeight:"bold",cursor:"pointer",boxShadow:"0 4px 6px rgba(0,0,0,0.1)"},children:["Start Semester ",re+1," "]})})]})}return d.jsxs("div",{className:"app",children:[X&&U==="checkpoint"&&d.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",background:"rgba(0, 0, 0, 0.8)",zIndex:999999,display:"flex",alignItems:"center",justifyContent:"center"},children:d.jsxs("div",{style:{background:"white",padding:"40px",borderRadius:"12px",textAlign:"center",maxWidth:"700px",width:"90%",maxHeight:"90vh",overflow:"auto"},children:[d.jsx("h2",{style:{color:"#4CAF50",marginBottom:"25px",fontSize:"28px"},children:" Midterm Exam Results!"}),d.jsxs("div",{style:{fontSize:"18px",marginBottom:"25px",padding:"20px",background:"#f8f9fa",borderRadius:"8px"},children:[d.jsx("p",{style:{marginBottom:"15px"},children:"The midterm exam has arrived! Let's see how your students performed..."}),d.jsxs("div",{style:{fontSize:"20px",fontWeight:"bold",color:"#1976d2",padding:"15px",background:"white",borderRadius:"6px",margin:"15px 0"},children:["Student Learning Score: ",Math.round(Rt())," ","pts"]})]}),d.jsxs("div",{style:{marginBottom:"25px",padding:"20px",background:"#e3f2fd",borderRadius:"8px",textAlign:"left"},children:[d.jsx("h3",{style:{marginBottom:"15px",textAlign:"center"},children:"Your Teaching Performance:"}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"10px"},children:[d.jsxs("div",{style:{padding:"10px",background:"white",borderRadius:"6px",textAlign:"center"},children:[d.jsx("div",{style:{color:"#4CAF50",fontWeight:"bold"},children:"Materials"}),d.jsxs("div",{style:{fontSize:"20px"},children:[Ee.materials," pts"]})]}),d.jsxs("div",{style:{padding:"10px",background:"white",borderRadius:"6px",textAlign:"center"},children:[d.jsx("div",{style:{color:"#9C27B0",fontWeight:"bold"},children:"Research"}),d.jsxs("div",{style:{fontSize:"20px"},children:[Ee.research," pts"]}),d.jsxs("div",{style:{fontSize:"12px",color:"#666"},children:["",(1+Ee.research*.15).toFixed(2)]})]}),d.jsxs("div",{style:{padding:"10px",background:"white",borderRadius:"6px",textAlign:"center"},children:[d.jsx("div",{style:{color:"#f44336",fontWeight:"bold"},children:"Engagement"}),d.jsxs("div",{style:{fontSize:"20px"},children:[Ee.engagement," pts"]}),d.jsxs("div",{style:{fontSize:"12px",color:"#666"},children:["+",(Ee.engagement*.15).toFixed(1),"% interest"]})]})]})]}),d.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",padding:"20px",borderRadius:"8px",marginBottom:"25px",background:Yt>0?"linear-gradient(135deg, #c8e6c9 0%, #a5d6a7 100%)":"linear-gradient(135deg, #fff3cd 0%, #ffe082 100%)",border:`2px solid ${Yt>0?"#4CAF50":"#ff9800"}`,color:Yt>0?"#2e7d32":"#f57c00"},children:re===2?Yt>0?d.jsxs(d.Fragment,{children:[" Excellent Teaching! +",Yt," bonus points earned!"]}):d.jsxs(d.Fragment,{children:[" Goal was 50+ points (you had"," ",Math.round(Rt()),"). Keep teaching!"]}):d.jsx(d.Fragment,{children:"Checkpoint reached! Keep going!"})}),d.jsxs("div",{style:{marginBottom:"20px",padding:"15px",background:"#f5f5f5",borderRadius:"6px",fontSize:"14px",color:"#666",textAlign:"left"},children:[d.jsx("strong",{children:"Tips for the rest of the semester:"}),d.jsxs("ul",{style:{margin:"10px 0 0 20px",lineHeight:"1.6"},children:[d.jsx("li",{children:"You have about 6 minutes remaining"}),d.jsx("li",{children:"Focus on accuracy - every point counts!"}),d.jsx("li",{children:"Research multiplies everything, Engagement compounds over time"}),d.jsx("li",{children:"Materials give direct points - use them strategically"})]})]}),d.jsx("button",{onClick:()=>{G(!1),B(null)},style:{padding:"12px 35px",background:"#2196F3",color:"white",border:"none",borderRadius:"6px",fontSize:"16px",fontWeight:"bold",cursor:"pointer",boxShadow:"0 3px 6px rgba(0,0,0,0.15)",transition:"all 0.3s"},onMouseOver:q=>{q.currentTarget.style.transform="translateY(-2px)",q.currentTarget.style.boxShadow="0 5px 10px rgba(0,0,0,0.2)"},onMouseOut:q=>{q.currentTarget.style.transform="translateY(0)",q.currentTarget.style.boxShadow="0 3px 6px rgba(0,0,0,0.15)"},children:"Continue Teaching "}),d.jsx("p",{style:{marginTop:"10px",color:"#999",fontSize:"12px"},children:"The timer is paused. Click to continue when ready."})]})}),he&&d.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",background:"rgba(0, 0, 0, 0.9)",zIndex:999999,display:"flex",alignItems:"center",justifyContent:"center"},children:d.jsxs("div",{style:{background:"white",padding:"40px",borderRadius:"10px",textAlign:"center",maxWidth:"500px"},children:[d.jsx("h2",{style:{color:"#f44336",marginBottom:"20px"},children:"Session Ended"}),d.jsx("p",{style:{marginBottom:"30px"},children:"Your session has been terminated due to inactivity or switching away from the game."}),d.jsx("p",{style:{color:"#c62828",fontWeight:"bold"},children:"You cannot restart. This was your only attempt."})]})}),N&&d.jsxs("div",{style:{position:"fixed",top:"20px",right:"20px",background:"#ff9800",color:"white",padding:"15px 20px",borderRadius:"8px",zIndex:1e4,boxShadow:"0 4px 6px rgba(0,0,0,0.1)"},children:[d.jsx("strong",{children:" Focus Warning"}),d.jsx("br",{}),"Game will be blocked in ",W," seconds"]}),Z&&d.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",background:"rgba(0, 0, 0, 0.7)",zIndex:1e4,display:"flex",alignItems:"center",justifyContent:"center"},children:d.jsxs("div",{style:{background:"white",padding:"30px",borderRadius:"10px",textAlign:"center",maxWidth:"400px"},children:[d.jsx("h3",{style:{color:"#ff9800",marginBottom:"15px"},children:"Are you still there?"}),d.jsxs("p",{style:{marginBottom:"20px"},children:["Auto-closing in ",Ae," seconds due to inactivity"]}),d.jsx("button",{onClick:()=>{oe(!1),me(5),Fn.current=Date.now()},style:{padding:"10px 20px",background:"#4CAF50",color:"white",border:"none",borderRadius:"6px",cursor:"pointer"},children:"Continue Playing"})]})}),d.jsxs("div",{style:{padding:"20px",maxWidth:"1400px",margin:"0 auto"},children:[d.jsxs("h1",{style:{marginBottom:"30px",textAlign:"center"},children:["Can you beat Park? - Semester ",re,"/",qe]}),d.jsx(dI,{current:u,completed:p,onSwitch:xi,limitMode:"time",taskPoints:lu,categoryMultipliers:{},starGoals:{},categoryPoints:Ee,timeRemaining:et}),d.jsxs("div",{style:{display:"flex",gap:"20px",alignItems:"stretch",marginTop:"20px",minHeight:"650px",width:"100%"},children:[d.jsx("div",{style:{flex:"0 0 66.666%",minHeight:"650px",display:"flex",alignItems:"center",justifyContent:"center",background:"white",borderRadius:"8px",border:"1px solid #e0e0e0",overflow:"visible"},children:d.jsx("div",{className:"task-container",style:{width:"100%",minHeight:"650px",padding:"20px",display:"flex",alignItems:"center",justifyContent:"center",overflow:"visible"},children:uu()})}),d.jsx("div",{style:{flex:"0 0 33.333%",background:"white",borderRadius:"8px",border:"1px solid #e0e0e0",overflow:"visible",height:"680px",display:"flex",flexDirection:"column"},children:d.jsx(pI,{bonusPrompts:E,currentTask:u,categoryPoints:Ee,categoryMultipliers:{},starGoals:{},timeRemaining:et,calculateStudentLearning:Rt,onAIHelp:q=>{window.dispatchEvent(new CustomEvent("aiHelp",{detail:q}))}})})]})]})]})}Yy(document.getElementById("root")).render(d.jsx(L.StrictMode,{children:d.jsx(xI,{})}));
//# sourceMappingURL=index-B27TA-CT.js.map
